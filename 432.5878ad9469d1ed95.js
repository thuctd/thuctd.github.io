"use strict";(self.webpackChunkdlxl=self.webpackChunkdlxl||[]).push([[432,511],{83432:(B,k,p)=>{p.r(k),p.d(k,{EmailModule:()=>xe});var h=p(85913),N=p(5923),C=p(24561),x=p(51372),g=p(34291),a=p(93075),u=p(69808),t=p(5e3),_=p(45230),b=p(47423),y=p(25245),E=p(68042),v=p(46936),q=p(25862),U=p(86087),Z=p(67322),J=p(77531),M=p(74107),w=p(90508),V=p(30627);function W(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"button",40),t.NdJ("click",function(){return t.CHM(e),t.oxw().reload()}),t.TgZ(1,"mat-icon"),t._uU(2,"undo"),t.qZA()()}2&n&&t.Q6J("@slideIn",void 0)}function X(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"app-search-api",41),t.NdJ("data",function(o){return t.CHM(e),t.oxw().find(o)}),t.qZA()}if(2&n){const e=t.oxw();t.Q6J("api",e.api)}}function z(n,r){1&n&&(t.TgZ(0,"th"),t._uU(1,"Email"),t.qZA())}function tt(n,r){1&n&&(t.TgZ(0,"th"),t._uU(1,"M\xe3 kh\xe1ch h\xe0ng"),t.qZA())}function et(n,r){1&n&&(t.TgZ(0,"th"),t._uU(1,"Kh\xe1ch h\xe0ng"),t.qZA())}function nt(n,r){1&n&&(t.TgZ(0,"th"),t._uU(1,"\u0110\u1ecba ch\u1ec9"),t.qZA())}function it(n,r){1&n&&(t.TgZ(0,"th"),t._uU(1,"M\xe3 G C S"),t.qZA())}function ot(n,r){1&n&&(t.TgZ(0,"th"),t._uU(1,"Ch\u1ee7 t\xe0i kho\u1ea3n"),t.qZA())}function at(n,r){1&n&&(t.TgZ(0,"th"),t._uU(1,"S\u1ed1 t\xe0i kho\u1ea3n"),t.qZA())}function rt(n,r){1&n&&(t.TgZ(0,"th"),t._uU(1,"Ng\xe2n h\xe0ng"),t.qZA())}function st(n,r){1&n&&(t.TgZ(0,"th"),t._uU(1,"Tr\u01b0\u1edbc thu\u1ebf"),t.qZA())}function lt(n,r){1&n&&(t.TgZ(0,"th"),t._uU(1,"Thu\u1ebf"),t.qZA())}function ut(n,r){1&n&&(t.TgZ(0,"th"),t._uU(1,"Ng\xe0y h\xf3a \u0111\u01a1n"),t.qZA())}function ct(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"td",47),t.NdJ("click",function(){t.CHM(e);const o=t.oxw().$implicit;return t.oxw(2).onEdit(o)}),t._uU(1),t.qZA()}if(2&n){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(e.Email)}}function pt(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"td",47),t.NdJ("click",function(){t.CHM(e);const o=t.oxw().$implicit;return t.oxw(2).onEdit(o)}),t._uU(1),t.qZA()}if(2&n){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(e.MaKhachHang)}}function dt(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"td",47),t.NdJ("click",function(){t.CHM(e);const o=t.oxw().$implicit;return t.oxw(2).onEdit(o)}),t._uU(1),t.qZA()}if(2&n){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(e.KhachHang)}}function ht(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"td",47),t.NdJ("click",function(){t.CHM(e);const o=t.oxw().$implicit;return t.oxw(2).onEdit(o)}),t._uU(1),t.qZA()}if(2&n){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(e.DiaChi)}}function mt(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"td",47),t.NdJ("click",function(){t.CHM(e);const o=t.oxw().$implicit;return t.oxw(2).onEdit(o)}),t._uU(1),t.qZA()}if(2&n){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(e.MaGCS)}}function _t(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"td",47),t.NdJ("click",function(){t.CHM(e);const o=t.oxw().$implicit;return t.oxw(2).onEdit(o)}),t._uU(1),t.qZA()}if(2&n){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(e.ChuTaiKhoan)}}function gt(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"td",47),t.NdJ("click",function(){t.CHM(e);const o=t.oxw().$implicit;return t.oxw(2).onEdit(o)}),t._uU(1),t.qZA()}if(2&n){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(e.SoTaiKhoan)}}function ft(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"td",47),t.NdJ("click",function(){t.CHM(e);const o=t.oxw().$implicit;return t.oxw(2).onEdit(o)}),t._uU(1),t.qZA()}if(2&n){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(e.NganHang)}}function Tt(n,r){if(1&n&&(t.TgZ(0,"td"),t._uU(1),t.ALo(2,"number"),t.qZA()),2&n){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(t.lcZ(2,1,e.TruocThue))}}function bt(n,r){if(1&n&&(t.TgZ(0,"td"),t._uU(1),t.ALo(2,"number"),t.qZA()),2&n){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(t.lcZ(2,1,e.Thue))}}function Dt(n,r){if(1&n&&(t.TgZ(0,"td"),t._uU(1),t.ALo(2,"number"),t.qZA()),2&n){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(t.lcZ(2,1,e.NgayHoaDon))}}function Zt(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"mat-icon",50),t.NdJ("click",function(){t.CHM(e);const o=t.oxw().$implicit;return t.oxw(2).onDelete(o)}),t._uU(1,"delete"),t.qZA()}}function xt(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"tr")(1,"td",47),t.NdJ("click",function(){const s=t.CHM(e).$implicit;return t.oxw(2).onEdit(s)}),t._uU(2),t.qZA(),t.YNc(3,ct,2,1,"td",48),t.YNc(4,pt,2,1,"td",48),t.YNc(5,dt,2,1,"td",48),t.YNc(6,ht,2,1,"td",48),t.YNc(7,mt,2,1,"td",48),t.YNc(8,_t,2,1,"td",48),t.YNc(9,gt,2,1,"td",48),t.YNc(10,ft,2,1,"td",48),t.TgZ(11,"td",47),t.NdJ("click",function(){const s=t.CHM(e).$implicit;return t.oxw(2).onEdit(s)}),t._uU(12),t.ALo(13,"number"),t.qZA(),t.TgZ(14,"td",47),t.NdJ("click",function(){const s=t.CHM(e).$implicit;return t.oxw(2).onEdit(s)}),t._uU(15),t.ALo(16,"number"),t.qZA(),t.TgZ(17,"td",47),t.NdJ("click",function(){const s=t.CHM(e).$implicit;return t.oxw(2).onEdit(s)}),t._uU(18),t.ALo(19,"number"),t.qZA(),t.TgZ(20,"td"),t._uU(21),t.ALo(22,"number"),t.qZA(),t.YNc(23,Tt,3,3,"td",44),t.YNc(24,bt,3,3,"td",44),t.TgZ(25,"td"),t._uU(26),t.ALo(27,"number"),t.qZA(),t.TgZ(28,"td"),t._uU(29),t.qZA(),t.TgZ(30,"td"),t._uU(31),t.qZA(),t.YNc(32,Dt,3,3,"td",44),t.TgZ(33,"td"),t._uU(34),t.qZA(),t.TgZ(35,"td"),t.YNc(36,Zt,2,0,"mat-icon",49),t.qZA()()}if(2&n){const e=r.$implicit,i=t.oxw(2);t.xp6(2),t.Oqu(e._id),t.xp6(1),t.Q6J("Device",3),t.xp6(1),t.Q6J("Device",2),t.xp6(1),t.Q6J("Device",2),t.xp6(1),t.Q6J("Device",3),t.xp6(1),t.Q6J("Device",3),t.xp6(1),t.Q6J("Device",3),t.xp6(1),t.Q6J("Device",3),t.xp6(1),t.Q6J("Device",3),t.xp6(2),t.Oqu(t.lcZ(13,21,e.Nam)),t.xp6(3),t.Oqu(t.lcZ(16,23,e.Thang)),t.xp6(3),t.Oqu(t.lcZ(19,25,e.SanLuong)),t.xp6(3),t.Oqu(t.lcZ(22,27,e.DonGia)),t.xp6(2),t.Q6J("Device",3),t.xp6(1),t.Q6J("Device",3),t.xp6(2),t.Oqu(t.lcZ(27,29,e.TongTien)),t.xp6(3),t.Oqu(e.KyHieuHoaDon),t.xp6(2),t.Oqu(e.SoHoaDon),t.xp6(1),t.Q6J("Device",3),t.xp6(2),t.Oqu(e.TrangThai),t.xp6(2),t.Q6J("ngIf",i.checkPer(4))}}function yt(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"table",42)(1,"thead",43)(2,"tr")(3,"th"),t._uU(4,"_id"),t.qZA(),t.YNc(5,z,2,0,"th",44),t.YNc(6,tt,2,0,"th",44),t.YNc(7,et,2,0,"th",44),t.YNc(8,nt,2,0,"th",44),t.YNc(9,it,2,0,"th",44),t.YNc(10,ot,2,0,"th",44),t.YNc(11,at,2,0,"th",44),t.YNc(12,rt,2,0,"th",44),t.TgZ(13,"th"),t._uU(14,"N\u0103m"),t.qZA(),t.TgZ(15,"th"),t._uU(16,"Th\xe1ng"),t.qZA(),t.TgZ(17,"th"),t._uU(18,"S\u1ea3n l\u01b0\u1ee3ng"),t.qZA(),t.TgZ(19,"th"),t._uU(20,"\u0110\u01a1n gi\xe1"),t.qZA(),t.YNc(21,st,2,0,"th",44),t.YNc(22,lt,2,0,"th",44),t.TgZ(23,"th"),t._uU(24,"T\u1ed5ng ti\u1ec1n"),t.qZA(),t.TgZ(25,"th"),t._uU(26,"K\xfd hi\u1ec7u h\xf3a \u0111\u01a1n"),t.qZA(),t.TgZ(27,"th"),t._uU(28,"S\u1ed1 h\xf3a \u0111\u01a1n"),t.qZA(),t.YNc(29,ut,2,0,"th",44),t.TgZ(30,"th"),t._uU(31,"Tr\u1ea1ng th\xe1i"),t.qZA(),t.TgZ(32,"th")(33,"mat-icon",45),t.NdJ("click",function(){return t.CHM(e),t.oxw().reload()}),t._uU(34,"cached"),t.qZA()()()(),t.TgZ(35,"tbody"),t.YNc(36,xt,37,31,"tr",46),t.qZA()()}if(2&n){const e=t.oxw();t.Q6J("@slideIn",void 0),t.xp6(5),t.Q6J("Device",3),t.xp6(1),t.Q6J("Device",2),t.xp6(1),t.Q6J("Device",2),t.xp6(1),t.Q6J("Device",3),t.xp6(1),t.Q6J("Device",3),t.xp6(1),t.Q6J("Device",3),t.xp6(1),t.Q6J("Device",3),t.xp6(1),t.Q6J("Device",3),t.xp6(9),t.Q6J("Device",3),t.xp6(1),t.Q6J("Device",3),t.xp6(7),t.Q6J("Device",3),t.xp6(7),t.Q6J("ngForOf",e.filter.length>0?e.filter:e.items.slice(0,10))("ngForTrackBy",e.trackByFn)}}function Ct(n,r){if(1&n&&(t.TgZ(0,"mat-option",51),t._uU(1),t.qZA()),2&n){const e=r.$implicit;t.s9C("value",e.NoiDung),t.xp6(1),t.hij("",e.NoiDung," ")}}function Et(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"button",52),t.NdJ("click",function(){return t.CHM(e),t.oxw().save()}),t.TgZ(1,"mat-icon"),t._uU(2,"save"),t.qZA()()}2&n&&t.Q6J("@slideIn",void 0)}const vt=function(){return[5,10,25,100]};let At=(()=>{class n{constructor(e,i){this.plus=e,this.fb=i,this.main=this.fb.group({keyWord:[,[]],_id:[,[]],Email:[,[a.kI.required]],MaKhachHang:[,[a.kI.required]],KhachHang:[,[a.kI.required]],DiaChi:[,[a.kI.required]],MaGCS:[,[a.kI.required]],ChuTaiKhoan:[,[a.kI.required]],SoTaiKhoan:[,[a.kI.required]],NganHang:[,[a.kI.required]],Nam:[,[a.kI.required,a.kI.pattern("^[0-9]*$")]],Thang:[,[a.kI.required,a.kI.pattern("^[0-9]*$")]],SanLuong:[,[a.kI.required,a.kI.pattern("^[0-9]*$")]],DonGia:[,[a.kI.required,a.kI.pattern("^[0-9]*$")]],TruocThue:[,[a.kI.required,a.kI.pattern("^[0-9]*$")]],Thue:[,[a.kI.required,a.kI.pattern("^[0-9]*$")]],TongTien:[,[a.kI.required,a.kI.pattern("^[0-9]*$")]],KyHieuHoaDon:[,[]],SoHoaDon:[,[]],NgayHoaDon:[,[a.kI.pattern("^[0-9]*$")]],TrangThai:[,[a.kI.pattern("^[0-9]*$")]]}),this.chart=[],this.title="Thanh to\xe1n \u0110MT",this.dbName="email",this.api="dmt",this.db=null,this.items=[],this.selectedItem=null,this.filter=[]}ngOnInit(){this.plus.setTiTle(this.title),this.plus.IDB_InitDB(this.dbName).subscribe(e=>function(n,r,e,i){return new(e||(e=Promise))(function(s,c){function m(d){try{f(i.next(d))}catch(T){c(T)}}function l(d){try{f(i.throw(d))}catch(T){c(T)}}function f(d){d.done?s(d.value):function o(s){return s instanceof e?s:new e(function(c){c(s)})}(d.value).then(m,l)}f((i=i.apply(n,r||[])).next())})}(this,void 0,void 0,function*(){this.db=e,this.getIDB(),this.plus.updateUserLocal(e,this.api),this.plus.updateAPi.subscribe(i=>{i&&this.getIDB()})}))}getIDB(){console.log("getIDB"),this.filter=[],this.plus.IDB_DB_GetAll(this.db,this.api).subscribe(e=>{this.items=e,this.plus.updateAPi.next(!1)})}ngOnDestroy(){console.log("Destroy",this.api),this.plus.subs.unsubscribe()}save(){if(this.main.invalid)return;const e=this.main.value,i=this.plus.datetoNumObj(this.main.value,[""]);console.log(i),null==e._id?(delete e._id,this.plus.httpPost(this.api,i).subscribe(o=>{o.status&&this.plus.clickBtn("closeModal")})):this.plus.httpPut(this.api,i).subscribe(o=>{o.status&&this.plus.clickBtn("closeModal")})}onEdit(e){this.selectedItem=e;const i=this.plus.dateToHtmlObj(e,[""]);this.main.patchValue(i),this.plus.clickBtn("openModal")}onDelete(e){!confirm("B\u1ea1n mu\u1ed1n x\xf3a?")||(this.plus.load(),this.plus.httpDisable(this.api,e).then(o=>{console.log(o)}))}chooseOpt(e,i,o,s=!1){this.main.controls[i].setValue(e[o]),s&&this.main.controls[i+"ID"].setValue(e._id)}closeModal(){this.main.reset()}search(e){this.filter=e}find(e){this.items=e}checkPer(e){return this.plus.checkPer(this.api,e)}patchForm(){this.main.reset({_id:" "})}reload(){return this.plus.reload(this.dbName+"/"+this.api)}reset(){this.plus.loaded(),this.filter=[],this.getIDB(),this.main.reset({})}changePage(e){this.filter=this.items.slice(e.pageIndex*e.pageSize,(e.pageIndex+1)*e.pageSize)}trackByFn(e,i){return i}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(_.T),t.Y36(a.qu))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-tien-do-dmt"]],decls:119,vars:15,consts:[[1,"container"],["id","add-btn","color","accent","mat-raised-button","","data-toggle","modal","data-target","#modelId",3,"click"],["id","back-btn","mat-raised-button","","color","primary",3,"click",4,"ngIf"],[3,"api","data",4,"ngIf"],[3,"db","api","filter"],[1,"row"],["class","table table-hover",4,"ngIf"],[3,"length","pageSize","pageSizeOptions","page"],["id","openModal","type","button","data-toggle","modal","data-target","#modelId",1,"d-none"],["id","modelId","data-backdrop","static","tabindex","-1","role","dialog","aria-labelledby","modelTitleId","aria-hidden","true",1,"modal","fade"],["role","document",1,"modal-dialog","modal-lg"],[1,"modal-content"],[1,"modal-body"],[1,"container-fluid"],[3,"formGroup"],["hidden","","formControlName","_id"],["required","","type","text","autocomplete","off","matInput","","formControlName","Email"],["matSuffix",""],["type","text","autocomplete","off","matInput","","formControlName","MaKhachHang"],["type","text","autocomplete","off","matInput","","formControlName","KhachHang"],["type","text","autocomplete","off","matInput","","formControlName","DiaChi"],["type","text","autocomplete","off","matInput","","formControlName","MaGCS"],["type","text","autocomplete","off","matInput","","formControlName","ChuTaiKhoan"],["type","text","autocomplete","off","matInput","","formControlName","SoTaiKhoan"],["type","text","autocomplete","off","matInput","","formControlName","NganHang"],["type","text","autocomplete","off","matInput","","formControlName","Nam"],["type","text","autocomplete","off","matInput","","formControlName","Thang"],["type","text","autocomplete","off","matInput","","formControlName","SanLuong"],["type","text","autocomplete","off","matInput","","formControlName","DonGia"],["type","text","autocomplete","off","matInput","","formControlName","TruocThue"],["type","text","autocomplete","off","matInput","","formControlName","Thue"],["type","text","autocomplete","off","matInput","","formControlName","TongTien"],["type","text","autocomplete","off","matInput","","formControlName","KyHieuHoaDon"],["type","text","autocomplete","off","matInput","","formControlName","SoHoaDon"],["type","text","autocomplete","off","matInput","","formControlName","NgayHoaDon"],["formControlName","TrangThai"],[3,"value",4,"ngFor","ngForOf"],[1,"modal-footer"],["id","closeModal","mat-raised-button","","color","primary","data-dismiss","modal",3,"click"],["mat-raised-button","","color","warn",3,"click",4,"ngIf"],["id","back-btn","mat-raised-button","","color","primary",3,"click"],[3,"api","data"],[1,"table","table-hover"],[1,"thead-inverse"],[4,"Device"],["color","primary",3,"click"],[4,"ngFor","ngForOf","ngForTrackBy"],[3,"click"],[3,"click",4,"Device"],["color","warn",3,"click",4,"ngIf"],["color","warn",3,"click"],[3,"value"],["mat-raised-button","","color","warn",3,"click"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0)(1,"button",1),t.NdJ("click",function(){return i.reset()}),t.TgZ(2,"mat-icon"),t._uU(3,"control_point"),t.qZA()(),t.YNc(4,W,3,1,"button",2),t.YNc(5,X,1,1,"app-search-api",3),t.TgZ(6,"app-search-table",4),t.NdJ("filter",function(s){return i.search(s)}),t.qZA(),t.TgZ(7,"div",5),t.YNc(8,yt,37,14,"table",6),t.TgZ(9,"mat-paginator",7),t.NdJ("page",function(s){return i.changePage(s)}),t.qZA()()(),t._UZ(10,"button",8),t.TgZ(11,"div",9)(12,"div",10)(13,"div",11)(14,"div",12)(15,"div",13)(16,"form",14),t._UZ(17,"input",15),t.TgZ(18,"mat-form-field")(19,"mat-label"),t._uU(20,"Email"),t.qZA(),t._UZ(21,"input",16)(22,"span",17),t.qZA(),t.TgZ(23,"mat-form-field")(24,"mat-label"),t._uU(25,"M\xe3 kh\xe1ch h\xe0ng"),t.qZA(),t._UZ(26,"input",18)(27,"span",17),t.qZA(),t.TgZ(28,"mat-form-field")(29,"mat-label"),t._uU(30,"Kh\xe1ch h\xe0ng"),t.qZA(),t._UZ(31,"input",19)(32,"span",17),t.qZA(),t.TgZ(33,"mat-form-field")(34,"mat-label"),t._uU(35,"\u0110\u1ecba ch\u1ec9"),t.qZA(),t._UZ(36,"input",20)(37,"span",17),t.qZA(),t.TgZ(38,"mat-form-field")(39,"mat-label"),t._uU(40,"M\xe3 G C S"),t.qZA(),t._UZ(41,"input",21)(42,"span",17),t.qZA(),t.TgZ(43,"mat-form-field")(44,"mat-label"),t._uU(45,"Ch\u1ee7 t\xe0i kho\u1ea3n"),t.qZA(),t._UZ(46,"input",22)(47,"span",17),t.qZA(),t.TgZ(48,"mat-form-field")(49,"mat-label"),t._uU(50,"S\u1ed1 t\xe0i kho\u1ea3n"),t.qZA(),t._UZ(51,"input",23)(52,"span",17),t.qZA(),t.TgZ(53,"mat-form-field")(54,"mat-label"),t._uU(55,"Ng\xe2n h\xe0ng"),t.qZA(),t._UZ(56,"input",24)(57,"span",17),t.qZA(),t.TgZ(58,"mat-form-field")(59,"mat-label"),t._uU(60,"N\u0103m"),t.qZA(),t._UZ(61,"input",25)(62,"span",17),t.qZA(),t.TgZ(63,"mat-form-field")(64,"mat-label"),t._uU(65,"Th\xe1ng"),t.qZA(),t._UZ(66,"input",26)(67,"span",17),t.qZA(),t.TgZ(68,"mat-form-field")(69,"mat-label"),t._uU(70,"S\u1ea3n l\u01b0\u1ee3ng"),t.qZA(),t._UZ(71,"input",27)(72,"span",17),t.qZA(),t.TgZ(73,"mat-form-field")(74,"mat-label"),t._uU(75,"\u0110\u01a1n gi\xe1"),t.qZA(),t._UZ(76,"input",28)(77,"span",17),t.qZA(),t.TgZ(78,"mat-form-field")(79,"mat-label"),t._uU(80,"Tr\u01b0\u1edbc thu\u1ebf"),t.qZA(),t._UZ(81,"input",29)(82,"span",17),t.qZA(),t.TgZ(83,"mat-form-field")(84,"mat-label"),t._uU(85,"Thu\u1ebf"),t.qZA(),t._UZ(86,"input",30)(87,"span",17),t.qZA(),t.TgZ(88,"mat-form-field")(89,"mat-label"),t._uU(90,"T\u1ed5ng ti\u1ec1n"),t.qZA(),t._UZ(91,"input",31)(92,"span",17),t.qZA(),t.TgZ(93,"mat-form-field")(94,"mat-label"),t._uU(95,"K\xfd hi\u1ec7u h\xf3a \u0111\u01a1n"),t.qZA(),t._UZ(96,"input",32)(97,"span",17),t.qZA(),t.TgZ(98,"mat-form-field")(99,"mat-label"),t._uU(100,"S\u1ed1 h\xf3a \u0111\u01a1n"),t.qZA(),t._UZ(101,"input",33)(102,"span",17),t.qZA(),t.TgZ(103,"mat-form-field")(104,"mat-label"),t._uU(105,"Ng\xe0y h\xf3a \u0111\u01a1n"),t.qZA(),t._UZ(106,"input",34)(107,"span",17),t.qZA(),t.TgZ(108,"mat-form-field")(109,"mat-label"),t._uU(110,"Tr\u1ea1ng th\xe1i"),t.qZA(),t.TgZ(111,"mat-select",35),t.YNc(112,Ct,2,2,"mat-option",36),t.ALo(113,"catalog"),t.qZA()()()()(),t.TgZ(114,"div",37)(115,"button",38),t.NdJ("click",function(){return i.closeModal()}),t.TgZ(116,"mat-icon"),t._uU(117,"close"),t.qZA()(),t.YNc(118,Et,3,1,"button",39),t.qZA()()()()),2&e&&(t.xp6(4),t.Q6J("ngIf",i.filter.length>0),t.xp6(1),t.Q6J("ngIf",i.checkPer(10)),t.xp6(1),t.Q6J("db",i.db)("api",i.api),t.xp6(2),t.Q6J("ngIf",i.items.length+i.filter.length>0),t.xp6(1),t.Q6J("length",i.items.length)("pageSize",10)("pageSizeOptions",t.DdM(14,vt)),t.xp6(7),t.Q6J("formGroup",i.main),t.xp6(96),t.Q6J("ngForOf",t.lcZ(113,12,"Trangthai")),t.xp6(3),t.Q6J("@slideIn",void 0),t.xp6(3),t.Q6J("ngIf",i.checkPer(2)&&i.main.valid))},directives:[b.lW,y.Hw,u.O5,E.W,v.D,q.HP,u.sg,U.NW,a._Y,a.JL,a.sg,a.Fj,a.JJ,a.u,Z.KE,Z.hX,J.Nt,a.Q7,Z.R9,M.gD,w.ey],pipes:[u.JJ,V.pW],styles:[""]}),n})();var A=p(40520);class It{constructor(r,e,i,o){this.loader=r,this.url=e,this.http=i,this.plus=o}uploadFile(r,e,i){let o=new FormData;const s=new A.WM({"ngsw-bypass":""});return o.append("file",r),console.log("formData",o),new A.LE,this.http.post("https://up-log.herokuapp.com/upload",o,{headers:s})}upload(){return new Promise((e,i)=>{this.loader.file.then(o=>{this.uploadFile(o,this.url,"test").subscribe(s=>{console.log(s),e({default:s.url})},s=>{i("Ch\u1ee9c n\u0103ng b\u1ecb l\u1ed7i.\nVui l\xf2ng th\u1eed l\u1ea1i sau \xedt ph\xfat!"),console.log(o)})})})}abort(){console.log("abort")}}var L=p(83385),S=p(80574),H=p(15228),F=p(99826),O=p(39181),Y=function(n,r,e,i){return new(e||(e=Promise))(function(s,c){function m(d){try{f(i.next(d))}catch(T){c(T)}}function l(d){try{f(i.throw(d))}catch(T){c(T)}}function f(d){d.done?s(d.value):function o(s){return s instanceof e?s:new e(function(c){c(s)})}(d.value).then(m,l)}f((i=i.apply(n,r||[])).next())})};const kt=["myEditor"];function Nt(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"button",18),t.NdJ("click",function(){return t.CHM(e),t.oxw().checkImportData()}),t._uU(1,"Xem tr\u01b0\u1edbc"),t.qZA()}}function Jt(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"button",19),t.NdJ("click",function(){return t.CHM(e),t.oxw().reload()}),t._uU(1,"L\xe0m l\u1ea1i "),t.qZA()}}function qt(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"div",20)(1,"div",21)(2,"button",22),t.NdJ("click",function(){return t.CHM(e),t.oxw().pre()}),t._UZ(3,"i",23),t.qZA(),t.TgZ(4,"button",24),t.NdJ("click",function(){return t.CHM(e),t.oxw().next()}),t._UZ(5,"i",25),t.qZA()(),t.TgZ(6,"div",26)(7,"h5",27),t._uU(8),t.qZA(),t._UZ(9,"div",28),t.qZA(),t._UZ(10,"hr"),t.qZA()}if(2&n){const e=t.oxw();t.Q6J("@slideIn",void 0),t.xp6(8),t.AsE("N\u1ed8I DUNG EMAIL S\u1ed0 ",e.i+1,": ",e.dataJson[e.i].email,""),t.xp6(1),t.Q6J("innerHTML",e.dataJson[e.i].message,t.oJD)}}function Ut(n,r){if(1&n&&(t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA()()),2&n){const e=r.$implicit;t.xp6(2),t.hij(" ",e.email," "),t.xp6(2),t.hij(" ",e.err," ")}}function Mt(n,r){if(1&n&&(t.TgZ(0,"div",29)(1,"h6"),t._uU(2,"DANH S\xc1CH D\u1eee LI\u1ec6U KH\xd4NG H\u1ee2P L\u1ec6"),t.qZA(),t.TgZ(3,"table",30),t.YNc(4,Ut,5,2,"tr",31),t.qZA()()),2&n){const e=t.oxw();t.Q6J("@slideIn",void 0),t.xp6(4),t.Q6J("ngForOf",e.errData)}}const wt=function(n,r){return{"bg-success":n,"bg-danger":r}};function Bt(n,r){if(1&n&&(t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td",35),t._uU(4),t.qZA(),t.TgZ(5,"td",35),t._uU(6),t.qZA(),t.TgZ(7,"td",36),t._uU(8),t.qZA()()),2&n){const e=r.$implicit,i=r.index;t.xp6(2),t.Oqu(i+1),t.xp6(2),t.Oqu(e.fullName),t.xp6(2),t.Oqu(e.email),t.xp6(1),t.Q6J("ngClass",t.WLB(5,wt,e.status,3===e.status)),t.xp6(1),t.hij(" ",1===e.status?"\u0110\xe3 g\u1eedi":"Ch\u01b0a g\u1eedi"," ")}}function Ft(n,r){if(1&n&&(t.TgZ(0,"div",32)(1,"h5"),t._uU(2,"DANH S\xc1CH EMAIL \u0110\u01af\u1ee2C TH\xd4NG B\xc1O"),t.qZA(),t.TgZ(3,"table",33)(4,"thead")(5,"tr")(6,"th"),t._uU(7,"STT"),t.qZA(),t.TgZ(8,"th"),t._uU(9,"H\u1ecd v\xe0 t\xean"),t.qZA(),t.TgZ(10,"th"),t._uU(11,"Email"),t.qZA(),t.TgZ(12,"th",34),t._uU(13,"Tr\u1ea1ng th\xe1i"),t.qZA()()(),t.TgZ(14,"tbody"),t.YNc(15,Bt,9,8,"tr",31),t.qZA()()()),2&n){const e=t.oxw();t.Q6J("@slideIn",void 0),t.xp6(15),t.Q6J("ngForOf",e.dataJson)}}function St(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"button",37),t.NdJ("click",function(){return t.CHM(e),t.oxw().sendMail()}),t._uU(1,"G\u1eedi mail"),t.qZA()}}let Ht=(()=>{class n{constructor(e,i,o,s){this.plus=e,this.fb=i,this.router=o,this.httpClient=s,this.Editor=L,this.user=this.plus.user.getValue(),this.from=this.plus.user.getValue().unit,this.localName="moneyMail",this.dataImport=[],this.dataJson=[],this.errData=[],this.resent=[],this.tienLuong=[],this.send="",this.i=0,this.doc="",this.htmlContent=sessionStorage.getItem("htmlContentMain")||"",this.main=this.fb.group({email:[,a.kI.email],title:[`Th\xf4ng b\xe1o ti\u1ec1n l\u01b0\u01a1ng chuy\u1ec3n kho\u1ea3n ng\xe0y ${this.plus.dateFormat(Date.now())}`,[a.kI.required,a.kI.minLength(3)]]}),this.checkBody=this.fb.group({email:["",[a.kI.required,a.kI.email]],from:["\u0110i\u1ec7n l\u1ef1c Xu\xe2n L\u1ed9c",[a.kI.required,a.kI.minLength(10)]],title:["",[a.kI.required,a.kI.minLength(3)]],message:["",[a.kI.required,a.kI.minLength(200)]],reciver:["",[a.kI.required,a.kI.minLength(3)]],index:[,a.kI.max(1e3)]}),this.tienluong=this.fb.group({keyWord:[,[]],_id:[,[]],HoTen:[,[a.kI.required]],ThucLanh:[,[a.kI.required]],NgayNhanLuong:[,[a.kI.required]],MucHtnv:[,],SoNguoiGiamTru:[,],ThueTamDong:[,]})}ngOnInit(){this.init()}init(){if((JSON.parse(localStorage.getItem(this.localName))||[]).filter(i=>{0===i.status&&this.resent.push(i)}),0==this.from.length){const i=this.plus.user.getValue().unit;i?this.from=i:this.plus.alertToasrt({err:"B\u1ea1n ch\u01b0a khai b\xe1o \u0111\u01a1n v\u1ecb t\u1ea1i m\u1ee5c T\xe0i Kho\u1ea3n"}),console.log(i)}this.resent.length>0?(console.log(this.resent),confirm("B\u1ea5m OK \u0111\u1ec3 g\u1eedi mail tr\u01b0\u1edbc ch\u01b0a ho\xe0n th\xe0nh.\nB\u1ea5m Cancel \u0111\u1ec3 x\xf3a phi\xean l\xe0m vi\u1ec7c tr\u01b0\u1edbc?")?this.dataJson=this.resent:(localStorage.removeItem(this.localName),this.reset())):(this.reset(),localStorage.removeItem(this.localName))}onReady(e){e.ui.getEditableElement().parentElement.insertBefore(e.ui.view.toolbar.element,e.ui.getEditableElement()),e.plugins.get("FileRepository").createUploadAdapter=i=>(console.log(btoa(i.file)),new It(i,"/upload",this.httpClient,this.plus))}saveArticle(){this.dataJson.length>0&&(this.plus.alertToasrt({war:"B\u1ea1n c\u1ea7n ch\u1ecdn l\u1ea1i danh s\xe1ch nh\u1eadn email sau khi hi\u1ec7u ch\u1ec9nh n\u1ed9i dung!"}),this.reset()),this.htmlContent=this.getArticleContent(),sessionStorage.setItem("htmlContentMain",this.htmlContent)}getArticleContent(){return this.myEditor&&this.myEditor.editorInstance?this.myEditor.editorInstance.getData():""}readXlsx(e){this.dataJson=[],this.dataImport=[];let i=e.target;const o=new FileReader;o.onload=s=>{const m=S.ij(s.target.result,{type:"binary"});this.dataImport=S.P6.sheet_to_json(m.Sheets[m.SheetNames[0]],{header:1})},o.readAsBinaryString(i.files[0]),i=null}checkImportData(){this.dataImport.length>400&&this.plus.alertError("Vui l\xf2ng ch\u1ecdn danh s\xe1ch d\u01b0\u1edbi 400 email!");const e=this.dataImport[0],i=e.length;this.dataImport.splice(0,1);const o=this.plus.dateHtmlToXls(Date.now()),s=e.indexOf("M\u1ee9c HTNV"),c=e.indexOf("Thu\u1ebf TNCN"),m=e.indexOf("Th\u1ef1c l\xe3nh");console.log(s,c),this.dataImport.forEach((l,f)=>{if("x"==l[1]){let d="<ul>";for(let D=6;D<i;D++)d+=l[D]?`<li>${e[D]}: ${this.plus.numberWithCommas(l[D])}.</li>`:"";let T={_id:+l[0],HoTen:l[3],ThucLanh:l[m],NgayNhanLuong:o,MucHtnv:l[s],SoNguoiGiamTru:0,ThueTamDong:l[c],dateModify:Date.now()+f};this.tienLuong.push(T);let I={from:this.from,status:0,reciver:l[3],err:"",index:f,email:l[4],fullName:l[2]+": "+l[3],title:`${this.main.get("title").value}`,message:`<p>K\xednh g\u1eedi ${l[2]}: ${l[3]}.</p>\n          <p>\u0110i\u1ec7n l\u1ef1c Xu\xe2n L\u1ed9c th\xf4ng b\xe1o ti\u1ec1n l\u01b0\u01a1ng chuy\u1ec3n kho\u1ea3n chi ti\u1ebft nh\u01b0 sau:</p>\n          ${d}\n          </ul><p>S\u1ed1 ti\u1ec1n th\u1ef1c l\xe3nh tr\xean \u0111\u01b0\u1ee3c chuy\u1ec3n kho\u1ea3n qua t\xe0i kho\u1ea3n s\u1ed1 ${l[5]} c\u1ee7a ${l[2]} ${l[3]}.\n\n          M\u1ecdi \xfd ki\u1ebfn th\u1eafc m\u1eafc, vui l\xf2ng li\xean h\u1ec7 ph\xf2ng Ph\xf2ng T\u1ed5ng H\u1ee3p \u0111\u1ec3 \u0111\u01b0\u1ee3c gi\u1ea3i \u0111\xe1p.</p>\n          ${this.htmlContent}\n        Tr\xe2n tr\u1ecdng.\n           `};if(console.log(I),this.checkBody.patchValue(I),this.checkBody.valid)this.dataJson.push(I),this.plus.pushLocalStorage(this.localName,I);else{const D=this.plus.getErrValidateForm(this.checkBody);I.err=D,console.log(D),this.errData.push(I)}}})}sendDefault(){this.plus.sendMail({from:this.from,status:0,err:"",email:"thucspc@gmail.com",title:`B\xe1o c\xe1o th\u1ef1c hi\u1ec7n g\u1eedi ${this.checkBody.value.title}`,index:0,message:`\n      <p> B\xe1o c\xe1o th\u1ef1c hi\u1ec7n g\u1eedi email: ${this.dataJson.length}</p>\n      <p>Tr\xe2n tr\u1ecdng.</p>\n      `},"mail/bao-cao").subscribe(i=>{console.log("bodydefault")})}sendMail(){return Y(this,void 0,void 0,function*(){this.plus.httpPost("tien-luong/importmail",this.tienLuong,!0).subscribe(o=>{console.log(o)});const e=this.dataJson.length,i=confirm("Th\u1ef1c hi\u1ec7n th\xf4ng b\xe1o cho "+e+" CBCNV?");if(e>400)this.plus.alertToasrt({war:"Vui l\xf2ng l\u1eadp danh s\xe1ch d\u01b0\u1edbi 400 email"});else if(0===this.errData.length&&e>0&&i){this.sendDefault();let o=0;const s=this.dataJson.length;for(;o<s;){yield this.plus.sleep(5e3),this.i=o;const c=this.dataJson[o];this.plus.sendMail(c,"mail/money").subscribe(m=>{m.email&&(this.dataJson.filter((l,f)=>{l.index===m.index&&(this.dataJson[f].status=1)}),console.log(o,m.email,c.reciver),localStorage.setItem(this.localName,JSON.stringify(this.dataJson)))},m=>{this.dataJson[o].status=0,localStorage.setItem(this.localName,JSON.stringify(this.dataJson)),this.plus.alertToasrt({err:` Ch\u01b0a g\u1eedi email \u0111\u1ebfn ${c.reciver}`})}),o++}}else this.plus.alertToasrt({war:"\u0110\xe3 h\u1ee7y thao t\xe1c!"}),window.location.reload()})}pre(){this.i>0?this.i--:this.i=0}next(){this.i<this.dataJson.length-1?this.i++:this.i=1}view(e){console.log(e),this.mailModal=e,document.getElementById("email").click()}reset(){this.dataJson=[],this.errData=[],sessionStorage.removeItem("htmlContentMain")}reload(){return Y(this,void 0,void 0,function*(){return yield this.router.navigate([""]),this.router.navigate(["email/tienluong"])})}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(_.T),t.Y36(a.qu),t.Y36(F.F0),t.Y36(A.eN))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-money"]],viewQuery:function(e,i){if(1&e&&t.Gf(kt,5),2&e){let o;t.iGM(o=t.CRH())&&(i.myEditor=o.first)}},decls:26,vars:10,consts:[[1,"container"],[1,"text-center","my-3","text-primary"],[1,"modal-body"],[1,"form-group",3,"formGroup"],["for",""],["type","text","required","","placeholder","Nh\u1eadp n\u1ed9i dung ti\xeau \u0111\u1ec1","formControlName","title",1,"form-control"],[3,"editor","data","ready","change"],["myEditor",""],["target","_blank","href","https://github.com/thuctd/FileStore/raw/master/templates/MauTienLuong.xlsx",1,"badge","badge-warning"],["for","file-upload",1,"custom-file-upload","mx-5"],[1,"fa","fa-cloud-upload"],["hidden","","id","file-upload","type","file","multiple","false",3,"change"],["type","button","class","btn btn-outline-primary mx-3",3,"click",4,"ngIf"],["type","button","class","btn btn-outline-danger mx-3",3,"click",4,"ngIf"],["class","card border-primary my-3",4,"ngIf"],["class","alert-danger my-4 justify-content-center",4,"ngIf"],["class","dataOk",4,"ngIf"],["mat-raised-button","","color","accent",3,"click",4,"ngIf"],["type","button",1,"btn","btn-outline-primary","mx-3",3,"click"],["type","button",1,"btn","btn-outline-danger","mx-3",3,"click"],[1,"card","border-primary","my-3"],[1,"button"],["type","button",1,"btn","btn-danger","float-left",3,"click"],["aria-hidden","true",1,"fa","fa-arrow-left"],["type","button",1,"btn","btn-danger","float-right",3,"click"],["aria-hidden","true",1,"fa","fa-arrow-right"],[1,"card-body"],[1,"text-center","rounded","font-weigth-bold","bg-warning","py-2"],[3,"innerHTML"],[1,"alert-danger","my-4","justify-content-center"],[1,"table","table-hover","table-invert","table-bordered"],[4,"ngFor","ngForOf"],[1,"dataOk"],[1,"table","table-hover"],[1,"text-center"],["scope","row"],[1,"text-center",3,"ngClass"],["mat-raised-button","","color","accent",3,"click"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0)(1,"h5",1),t._uU(2,"TH\xd4NG B\xc1O TI\u1ec0N L\u01af\u01a0NG B\u1eb0NG EMAIL"),t.qZA(),t.TgZ(3,"div")(4,"div",2)(5,"form",3)(6,"label",4),t._uU(7,"Ti\xeau \u0111\u1ec1"),t.qZA(),t._UZ(8,"input",5),t.qZA()(),t.TgZ(9,"h5",4),t._uU(10,"N\u1ed9i dung th\xf4ng b\xe1o kh\xe1c"),t.qZA(),t.TgZ(11,"ckeditor",6,7),t.NdJ("ready",function(s){return i.onReady(s)})("change",function(){return i.saveArticle()}),t.qZA(),t.TgZ(13,"a",8),t._uU(14,"File m\u1eabu"),t.qZA(),t.TgZ(15,"label",9),t._UZ(16,"i",10),t._uU(17," Ch\u1ecdn file "),t.qZA(),t.TgZ(18,"input",11),t.NdJ("change",function(s){return i.readXlsx(s)}),t.qZA(),t.YNc(19,Nt,2,0,"button",12),t.YNc(20,Jt,2,0,"button",13),t.YNc(21,qt,11,4,"div",14),t.YNc(22,Mt,5,2,"div",15),t.YNc(23,Ft,16,2,"div",16),t.YNc(24,St,2,0,"button",17),t._UZ(25,"hr"),t.qZA()()),2&e&&(t.Q6J("@slideIn",void 0),t.xp6(5),t.Q6J("formGroup",i.main),t.xp6(6),t.s9C("data",i.htmlContent),t.Q6J("editor",i.Editor),t.xp6(8),t.Q6J("ngIf",i.dataImport.length>0&&0===i.dataJson.length),t.xp6(1),t.Q6J("ngIf",i.dataJson.length>0),t.xp6(1),t.Q6J("ngIf",i.dataJson.length>0&&0==i.errData.length),t.xp6(1),t.Q6J("ngIf",i.errData.length>0),t.xp6(1),t.Q6J("ngIf",i.dataJson.length>0&&0===i.errData.length),t.xp6(1),t.Q6J("ngIf",0===i.errData.length&&i.dataJson.length>0))},directives:[a._Y,a.JL,a.sg,a.Fj,a.Q7,a.JJ,a.u,O.u,u.O5,u.sg,u.mk,b.lW],styles:[""],data:{animation:[H.Ym]}}),n})();const Ot=["Email","MaKhachHang","KhachHang","DiaChi","MaGCS","ChuTaiKhoan","SoTaiKhoan","NganHang","Nam","Thang","SanLuong","DonGia","TruocThue","Thue","TongTien"];var Lt=p(31409),Yt=p(51511),Q=function(n,r,e,i){return new(e||(e=Promise))(function(s,c){function m(d){try{f(i.next(d))}catch(T){c(T)}}function l(d){try{f(i.throw(d))}catch(T){c(T)}}function f(d){d.done?s(d.value):function o(s){return s instanceof e?s:new e(function(c){c(s)})}(d.value).then(m,l)}f((i=i.apply(n,r||[])).next())})};function Qt(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"div",8)(1,"form",9)(2,"mat-form-field")(3,"mat-label"),t._uU(4,"Ti\xeau \u0111\u1ec1"),t.qZA(),t._UZ(5,"textarea",10),t.qZA()(),t.TgZ(6,"app-drop-files",11),t.NdJ("files",function(o){return t.CHM(e),t.oxw().selectedFile(o)}),t.qZA(),t.TgZ(7,"a",12)(8,"mat-icon"),t._uU(9,"description"),t.qZA(),t._uU(10," File m\u1eabu"),t.qZA()()}if(2&n){const e=t.oxw();t.xp6(1),t.Q6J("formGroup",e.checkBody),t.xp6(6),t.MGl("href","https://github.com/thuctd/FileStore/raw/master/templates/",e.api,".xlsx",t.LSH)}}function $t(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"button",13),t.NdJ("click",function(){return t.CHM(e),t.oxw().reload()}),t._uU(1,"L\xe0m l\u1ea1i "),t.qZA()}}function Pt(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"div",14)(1,"div",15)(2,"button",16),t.NdJ("click",function(){return t.CHM(e),t.oxw().pre()}),t._UZ(3,"i",17),t.qZA(),t.TgZ(4,"button",18),t.NdJ("click",function(){return t.CHM(e),t.oxw().next()}),t._UZ(5,"i",19),t.qZA()(),t.TgZ(6,"div",20)(7,"h5",21),t._uU(8),t.qZA(),t._UZ(9,"div",22),t.qZA(),t._UZ(10,"hr"),t.qZA()}if(2&n){const e=t.oxw();t.xp6(6),t.Q6J("@slideIn",void 0),t.xp6(2),t.AsE("N\u1ed8I DUNG EMAIL S\u1ed0 ",e.i+1,": ",e.dataJson[e.i].email,""),t.xp6(1),t.Q6J("innerHTML",e.dataJson[e.i].message,t.oJD)}}function Kt(n,r){if(1&n&&(t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA()()),2&n){const e=r.$implicit;t.xp6(2),t.hij(" D\xf2ng ",e.index," "),t.xp6(2),t.hij(" ",e.email," "),t.xp6(2),t.hij(" ",e.err," ")}}function Gt(n,r){if(1&n&&(t.TgZ(0,"div",23)(1,"h6"),t._uU(2,"DANH S\xc1CH D\u1eee LI\u1ec6U KH\xd4NG H\u1ee2P L\u1ec6"),t.qZA(),t.TgZ(3,"table",24),t.YNc(4,Kt,7,3,"tr",25),t.qZA()()),2&n){const e=t.oxw();t.Q6J("@slideIn",void 0),t.xp6(4),t.Q6J("ngForOf",e.errData)}}const jt=function(n,r){return{"bg-success":n,"bg-danger":r}};function Vt(n,r){if(1&n&&(t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td",29),t._uU(4),t.qZA(),t.TgZ(5,"td",29),t._uU(6),t.qZA(),t.TgZ(7,"td",30),t._uU(8),t.qZA()()),2&n){const e=r.$implicit,i=r.index;t.xp6(2),t.Oqu(i+1),t.xp6(2),t.Oqu(e.company),t.xp6(2),t.Oqu(e.email),t.xp6(1),t.Q6J("ngClass",t.WLB(5,jt,e.status,3===e.status)),t.xp6(1),t.hij(" ",1===e.status?"\u0110\xe3 g\u1eedi":"Ch\u01b0a g\u1eedi"," ")}}function Rt(n,r){if(1&n&&(t.TgZ(0,"div",26)(1,"h5"),t._uU(2,"DANH S\xc1CH EMAIL \u0110\u01af\u1ee2C TH\xd4NG B\xc1O"),t.qZA(),t.TgZ(3,"table",27)(4,"thead")(5,"tr")(6,"th"),t._uU(7,"STT"),t.qZA(),t.TgZ(8,"th"),t._uU(9,"H\u1ecd v\xe0 t\xean"),t.qZA(),t.TgZ(10,"th"),t._uU(11,"Email"),t.qZA(),t.TgZ(12,"th",28),t._uU(13,"Tr\u1ea1ng th\xe1i"),t.qZA()()(),t.TgZ(14,"tbody"),t.YNc(15,Vt,9,8,"tr",25),t.qZA()()()),2&n){const e=t.oxw();t.Q6J("@slideIn",void 0),t.xp6(15),t.Q6J("ngForOf",e.dataJson)}}function Wt(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"button",31),t.NdJ("click",function(){return t.CHM(e),t.oxw().sendMail()}),t._uU(1,"G\u1eedi mail"),t.qZA()}}let Xt=(()=>{class n{constructor(e,i,o,s){this.plus=e,this.fb=i,this.router=o,this.excelSV=s,this.user=this.plus.user.getValue(),this.from=this.plus.user.getValue().unit,this.api="dien-mat-troi",this.title="\u0110i\u1ec7n m\u1eb7t tr\u1eddi",this.header=Ot,this.errData=[],this.dataJson=[],this.dataApi=[],this.resent=[],this.i=0,this.checkBody=this.fb.group({email:["",[a.kI.required,a.kI.email]],from:["\u0110i\u1ec7n l\u1ef1c Xu\xe2n L\u1ed9c",[a.kI.required,a.kI.minLength(10)]],title:["Th\xf4ng b\xe1o chi ti\u1ebft ti\u1ec1n \u0111i\u1ec7n m\u1eb7t tr\u1eddi tr\xean m\xe1i nh\xe0",[a.kI.required,a.kI.minLength(3)]],message:["",[a.kI.required,a.kI.minLength(1010)]],company:["",[a.kI.required,a.kI.minLength(10)]],index:[,a.kI.max(1e3)]}),this.excelBody=this.fb.group({Email:[,[a.kI.required,a.kI.email]],MaKhachHang:[,[a.kI.required]],KhachHang:[,[a.kI.required]],DiaChi:[,[a.kI.required]],MaGCS:[,[a.kI.required]],ChuTaiKhoan:[,[a.kI.required]],SoTaiKhoan:[,[a.kI.required]],NganHang:[,[a.kI.required]],Nam:[,[a.kI.required]],Thang:[,[a.kI.required]],SanLuong:[,[a.kI.required,a.kI.pattern("^[0-9]*$")]],DonGia:[,[a.kI.required,a.kI.pattern("^[0-9]*$")]],TruocThue:[,[a.kI.required,a.kI.pattern("^[0-9]*$")]],Thue:[,[a.kI.required,a.kI.pattern("^[0-9]*$")]],TongTien:[,[a.kI.required,a.kI.pattern("^[0-9]*$")]],KyHieuHoaDon:[,[]],SoHoaDon:[,[]],NgayHoaDon:[,[]]})}ngOnInit(){this.init(),this.plus.setTiTle(this.title)}init(){if((JSON.parse(localStorage.getItem(this.api))||[]).filter(i=>{0===i.status&&this.resent.push(i)}),0==this.from.length){const i=this.plus.user.getValue().unit;i?this.from=i:this.plus.alertToasrt({err:"B\u1ea1n ch\u01b0a khai b\xe1o \u0111\u01a1n v\u1ecb t\u1ea1i m\u1ee5c T\xe0i Kho\u1ea3n"}),console.log(i)}if(this.resent.length>0){console.log(this.resent);const i=confirm("G\u1eedi l\u1ea1i c\xe1c email ch\u01b0a ho\xe0n th\xe0nh?");i?this.dataJson=this.resent:localStorage.removeItem(this.api),i?this.dataJson=this.resent:(localStorage.removeItem(this.api),this.reset())}else this.reset(),localStorage.removeItem(this.api)}selectedFile(e){this.reset(),this.excelSV.read(e[0]).then(i=>{const o=i[0];console.log(o);const s=o[0];o.forEach((l,f)=>{if("x"==l[1]||"X"==l[1]){let d={Email:l[2],MaKhachHang:l[3],KhachHang:l[4],DiaChi:l[5],MaGCS:l[6],ChuTaiKhoan:l[7],SoTaiKhoan:l[8],NganHang:l[9],Nam:l[10],Thang:l[11],SanLuong:l[12],DonGia:l[13],TruocThue:l[14],Thue:l[15],TongTien:l[16]};if(this.excelBody.patchValue(d),this.excelBody.invalid){const D=this.plus.getErrValidateForm(this.excelBody);this.errData.push({index:f-1,err:D,email:d.Email})}else this.dataApi.push(d);let T="<ul>";for(let D=3;D<=16;D++)T+=D<12?`<li>${s[D]}: ${l[D]}.</li>`:D>11?`<li>${s[D]}: ${this.plus.numberWithCommas(l[D])}.</li>`:"";let I={from:this.from,status:0,err:"",email:l[2],title:`${this.checkBody.get("title").value}`,company:l[4],index:f,message:`<p>K\xednh g\u1eedi kh\xe1ch h\xe0ng: ${l[4]}.</p>\n          <p>\u0110i\u1ec7n l\u1ef1c Xu\xe2n L\u1ed9c k\xednh g\u1eedi \u0111\u1ebfn qu\xfd kh\xe1ch h\xe0ng n\u1ed9i dung thanh to\xe1n ti\u1ec1n \u0111i\u1ec7n m\u1eb7t tr\u1eddi tr\xean m\xe1i nh\xe0 v\u1edbi n\u1ed9i dung nh\u01b0 sau:</p>\n          ${T}</ul>\n          <p>M\u1ecdi \xfd ki\u1ebfn th\u1eafc m\u1eafc, vui l\xf2ng li\xean h\u1ec7 \u0110i\u1ec7n l\u1ef1c Xu\xe2n L\u1ed9c qua s\u1ed1 \u0111i\u1ec7n tho\u1ea1i Mr. \u0110\u1ea1t - <a href="tel:0937232239">0937232239 </a> ho\u1eb7c Mrs. Ph\u01b0\u1edbc Anh - <a href="tel:0583223344" >0583223344 </a> \u0111\u1ec3 \u0111\u01b0\u1ee3c gi\u1ea3i \u0111\xe1p.</p>\n          <p>Ph\u1ea3n h\u1ed3i h\xf3a \u0111\u01a1n qu\xfd kh\xe1ch vui l\xf2ng g\u1eedi email v\u1ec1 c\u1ea3 02 \u0111\u1ecba ch\u1ec9: <a href="mailto:dienlucxuanloc.nlmt@gmail.com;tckt.dlxl.pcdn@gmail.com">dienlucxuanloc.nlmt@gmail.com</a> v\xe0 <a href="mailto:dienlucxuanloc.nlmt@gmail.com;tckt.dlxl.pcdn@gmail.com">tckt.dlxl.pcdn@gmail.com</a> </p>\n          Tr\xe2n tr\u1ecdng.`};if(this.checkBody.patchValue(I),this.checkBody.invalid){const D=this.plus.getErrValidateForm(this.checkBody);I.err=D,console.log(D),this.errData.push(I)}else console.log(I),this.dataJson.push(I),this.plus.pushLocalStorage(this.api,I)}this.errData.length>0&&localStorage.setItem(this.api,JSON.stringify([]))}),0==this.dataJson.length&&this.plus.alertWarning("B\u1ea1n ch\u01b0a ch\u1ecdn g\u1eedi trong file excel")})}sendDefault(){const e=this.dataJson.map(o=>o.company),i={from:this.from,status:0,err:"",email:"thucspc@gmail.com",title:`B\xe1o c\xe1o th\u1ef1c hi\u1ec7n g\u1eedi ${this.checkBody.value.title}`,index:0,message:` <p> K\xednh g\u1eedi \xf4ng: Tr\u1ea7n \u0110\u1ea1i Th\u1ee9c.</p>\n      <p>  ${this.plus.user.getValue().fullName} (${this.plus.user.getValue()._id}) th\u1ef1c hi\u1ec7n g\u1eedi th\xf4ng b\xe1o ti\u1ec1n \u0111i\u1ec7n m\u1eb7t tr\u1eddi cho ${this.dataJson.length} kh\xe1ch h\xe0ng:</p>\n      <ul>\n      <li> ${e.join(".</li><li>")}.</li>\n      </ul>\n      <p>Tr\xe2n tr\u1ecdng.</p>`};this.plus.sendMail(i,"mail/bao-cao").subscribe(o=>{console.log("bodydefault")})}sendMail(){return Q(this,void 0,void 0,function*(){const e=this.dataJson.length,i=confirm("Th\u1ef1c hi\u1ec7n g\u1eedi "+e+" email?");if(e>200)this.plus.alertToasrt({war:"Vui l\xf2ng l\u1eadp danh s\xe1ch d\u01b0\u1edbi 200 email"});else if(0===this.errData.length&&e>0&&i){this.sendDefault(),this.plus.logger(this.api,this.plus.user.getValue()._id+" send mail"+e,"POTS",!0);let o=0;const s=this.dataJson.length;for(;o<s;){yield this.plus.sleep(5e3),this.i=o;const c=this.dataJson[o],m=this.dataApi[o];this.plus.httpPost("mail/dien-mat-troi",c).subscribe(l=>{this.plus.logger(this.api,this.plus.user.getValue()._id+JSON.stringify(l),"Send Mail",!0);const f=l.index;console.log("Mail sent: ",f,l.email),f>=0&&l.email?(this.dataJson.filter((d,T)=>{d.index===l.index&&(this.dataJson[T].status=1)}),console.log(o,l.email),localStorage.setItem(this.api,JSON.stringify(this.dataJson)),this.plus.httpPost("dmt",m,!0).subscribe(d=>{console.log(d)})):this.plus.alertToasrt(l)},l=>{this.dataJson[o].status=0,localStorage.setItem(this.api,JSON.stringify(this.dataJson)),this.plus.alertToasrt({err:` Ch\u01b0a g\u1eedi email \u0111\u1ebfn ${c.reciver}`}),this.plus.logger(this.api,this.plus.user.getValue()._id+` Ch\u01b0a g\u1eedi email \u0111\u1ebfn ${c.reciver}`,"Post",!1)}),o++}}else this.plus.alertToasrt({war:"\u0110\xe3 h\u1ee7y thao t\xe1c!"}),this.reload()})}pre(){this.i>0?this.i--:this.i=0}next(){this.i<this.dataJson.length-1?this.i++:this.i=1}reset(){this.dataJson=[],this.errData=[],sessionStorage.removeItem("htmlContentMain")}reload(){return Q(this,void 0,void 0,function*(){return yield this.router.navigate([""]),this.router.navigate(["email/dien-mat-troi"])})}test(e){console.log(e)}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(_.T),t.Y36(a.qu),t.Y36(F.F0),t.Y36(Lt.x))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-dienmattroi"]],decls:10,vars:7,consts:[[1,"container"],[1,"text-center","my-3","text-primary"],["class","modal-body",4,"ngIf"],["type","button","class","btn btn-outline-danger mx-3",3,"click",4,"ngIf"],["class","card border-primary my-3",4,"ngIf"],["class","alert-danger my-4 justify-content-center",4,"ngIf"],["class","dataOk",4,"ngIf"],["type","button","class","btn btn-primary mx-3","data-toggle","modal","data-target","#modelId",3,"click",4,"ngIf"],[1,"modal-body"],[1,"form-group",3,"formGroup"],["matInput","","required","","placeholder","Nh\u1eadp n\u1ed9i dung ti\xeau \u0111\u1ec1","formControlName","title"],[3,"files"],["target","_blank",1,"badge","badge-warning",3,"href"],["type","button",1,"btn","btn-outline-danger","mx-3",3,"click"],[1,"card","border-primary","my-3"],[1,"button"],["type","button",1,"btn","btn-danger","float-left",3,"click"],["aria-hidden","true",1,"fa","fa-arrow-left"],["type","button",1,"btn","btn-danger","float-right",3,"click"],["aria-hidden","true",1,"fa","fa-arrow-right"],[1,"card-body"],[1,"text-center","rounded","font-weigth-bold","bg-warning","py-2"],[3,"innerHTML"],[1,"alert-danger","my-4","justify-content-center"],[1,"table","table-hover","table-invert","table-bordered"],[4,"ngFor","ngForOf"],[1,"dataOk"],[1,"table","table-hover"],[1,"text-center"],["scope","row"],[1,"text-center",3,"ngClass"],["type","button","data-toggle","modal","data-target","#modelId",1,"btn","btn-primary","mx-3",3,"click"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0)(1,"h5",1),t._uU(2,"TH\xd4NG B\xc1O TI\u1ec0N \u0110I\u1ec6N M\u1eb6T TR\u1edcI"),t.qZA(),t.YNc(3,Qt,11,2,"div",2),t.YNc(4,$t,2,0,"button",3),t.YNc(5,Pt,11,4,"div",4),t.YNc(6,Gt,5,2,"div",5),t.YNc(7,Rt,16,2,"div",6),t.YNc(8,Wt,2,0,"button",7),t._UZ(9,"hr"),t.qZA()),2&e&&(t.Q6J("@slideIn",void 0),t.xp6(3),t.Q6J("ngIf",0==i.dataJson.length),t.xp6(1),t.Q6J("ngIf",i.dataJson.length>0),t.xp6(1),t.Q6J("ngIf",i.dataJson.length>0&&0==i.errData.length),t.xp6(1),t.Q6J("ngIf",i.errData.length>0),t.xp6(1),t.Q6J("ngIf",i.dataJson.length>0&&0===i.errData.length),t.xp6(1),t.Q6J("ngIf",0===i.errData.length&&i.dataJson.length>0))},directives:[u.O5,a._Y,a.JL,a.sg,Z.KE,Z.hX,J.Nt,a.Fj,a.Q7,a.JJ,a.u,Yt.k,y.Hw,u.sg,u.mk],styles:[""],data:{animation:[H.Ym]}}),n})();class zt{constructor(r,e,i,o){this.loader=r,this.url=e,this.http=i,this.plus=o}uploadFile(r,e,i){let o=new FormData;const s=new A.WM({"ngsw-bypass":""});return o.append("file",r),console.log("formData",o),new A.LE,this.http.post("https://up-log.herokuapp.com/upload",o,{headers:s})}upload(){return new Promise((e,i)=>{this.loader.file.then(o=>{this.uploadFile(o,this.url,"test").subscribe(s=>{console.log(s),e({default:s.url})},s=>{i("L\u1ed7i k\u1ebft n\u1ed1i kho l\u01b0u tr\u1eef.\nVui l\xf2ng th\u1eed l\u1ea1i sau \xedt ph\xfat!"),console.log(o)})})})}abort(){console.log("abort")}}function te(n,r){if(1&n&&(t.TgZ(0,"div",8)(1,"div",9),t._uU(2),t.qZA()()),2&n){const e=t.oxw();t.xp6(1),t.Udp("width",e.uploadProgress+"%"),t.xp6(1),t.hij("",e.uploadProgress,"%")}}function ee(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"div",0)(1,"div",1)(2,"span",2),t._uU(3,"\u0110\u01b0\u1eddng d\u1eabn file t\u1ea3i l\xean:"),t.qZA()(),t._UZ(4,"input",10),t.TgZ(5,"div",11)(6,"button",12),t.NdJ("click",function(){return t.CHM(e),t.oxw().copyInputMessage("linkcopy")}),t._UZ(7,"i",13),t.qZA()()()}if(2&n){const e=t.oxw();t.xp6(4),t.s9C("value",e.linkUpload)}}let ne=(()=>{class n{constructor(e,i){this.plus=e,this.httpClient=i,this.apiUpload="https://api.cloudinary.com/v1_1/dienluc/image/upload",this.uploadProgress=0,this.place="Ch\u1ecdn file",this.linkUpload=""}ngOnInit(){}uploadDrive(e){const i=e.target.files[0].size||0;if(console.log(i),i>0?this.plus.load():this.plus.loaded(),i>10485760)return this.plus.alertToasrt({war:"Dung l\u01b0\u1ee3ng file qu\xe1 10Mb"}),void this.plus.loaded();const o=new FormData;o.append("file",e.target.files[0]);for(let s=0;s<e.target.files.length;s++)o.append("file",e.target.files[s]),o.append("api_key","942981119615178"),o.append("cloud_name","dienluc"),o.append("upload_preset","lgnigzh2"),new A.WM({"ngsw-bypass":""}),this.httpClient.post(this.apiUpload,o,{reportProgress:!0,observe:"events"}).subscribe(l=>{console.log(l),l.type===A.dt.UploadProgress?this.uploadProgress=Math.round(l.loaded/l.total*100):l.type===A.dt.Response&&(this.place="\u0110\xe3 upload xong!",this.linkUpload=l.body.url,this.plus.copyToClipboard(l.body.url),this.plus.loaded())},l=>{this.plus.loaded(),this.plus.alertToasrt({err:"L\u1ed7i upload file! \nVui l\xf2ng th\u1eed l\u1ea1i!"})})}get(){this.httpClient.get("https://942981119615178:fvO34914PdLgXjdv1Az5jg2mVno@api.cloudinary.com/v1_1/dienluc/resources/image").subscribe(e=>{})}copyInputMessage(e){this.plus.copyInputMessage(e)}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(_.T),t.Y36(A.eN))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-cloudinary"]],decls:10,vars:2,consts:[[1,"input-group","mb-3"],[1,"input-group-prepend"],[1,"input-group-text"],[1,"custom-file"],["type","file","id","inputGroupFile01",1,"custom-file-input",3,"change"],["for","inputGroupFile01",1,"custom-file-label"],["class","progress",4,"ngIf"],["class","input-group mb-3",4,"ngIf"],[1,"progress"],["role","progressbar","aria-valuenow","0","aria-valuemin","0","aria-valuemax","100",1,"progress-bar","bg-primary"],["type","text","id","linkcopy",1,"form-control",3,"value"],[1,"input-group-append"],["type","button",1,"btn","btn-outline-primary","btn-sm",3,"click"],[1,"fa","fa-copy"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"span",2),t._uU(3,"PDF/IMG"),t.qZA()(),t.TgZ(4,"div",3)(5,"input",4),t.NdJ("change",function(s){return i.uploadDrive(s)}),t.qZA(),t.TgZ(6,"label",5),t._uU(7,"Ch\u1ecdn file upload"),t.qZA()()(),t.YNc(8,te,3,3,"div",6),t.YNc(9,ee,8,1,"div",7)),2&e&&(t.xp6(8),t.Q6J("ngIf",i.uploadProgress>0&&i.uploadProgress<100),t.xp6(1),t.Q6J("ngIf",i.linkUpload))},directives:[u.O5],styles:[""]}),n})();var $=function(n,r,e,i){return new(e||(e=Promise))(function(s,c){function m(d){try{f(i.next(d))}catch(T){c(T)}}function l(d){try{f(i.throw(d))}catch(T){c(T)}}function f(d){d.done?s(d.value):function o(s){return s instanceof e?s:new e(function(c){c(s)})}(d.value).then(m,l)}f((i=i.apply(n,r||[])).next())})};const ie=["myEditor"];function oe(n,r){if(1&n&&(t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA()()),2&n){const e=r.$implicit;t.xp6(2),t.hij(" ",e.receiver," "),t.xp6(2),t.hij(" ",e.email," "),t.xp6(2),t.hij(" ",e.err," ")}}function ae(n,r){if(1&n&&(t.TgZ(0,"div")(1,"h4",17),t._uU(2,"DANH S\xc1CH D\u1eee LI\u1ec6U KH\xd4NG H\u1ee2P L\u1ec6"),t.qZA(),t.TgZ(3,"table",18)(4,"tr",19)(5,"th"),t._uU(6,"Kh\xe1ch h\xe0ng "),t.qZA(),t.TgZ(7,"th"),t._uU(8," Email "),t.qZA(),t.TgZ(9,"th"),t._uU(10," N\u1ed9i dung l\u1ed7i "),t.qZA()(),t.YNc(11,oe,7,3,"tr",20),t.qZA()()),2&n){const e=t.oxw();t.xp6(11),t.Q6J("ngForOf",e.errData)}}function re(n,r){1&n&&(t.TgZ(0,"label",21),t._UZ(1,"i",22),t._uU(2,"Danh s\xe1ch g\u1eedi email "),t.qZA())}function se(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"button",23),t.NdJ("click",function(){return t.CHM(e),t.oxw().checkImportData()}),t._uU(1,"Ki\u1ec3m tra "),t.qZA()}}function le(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"button",23),t.NdJ("click",function(){return t.CHM(e),t.oxw().reload()}),t._uU(1,"L\xe0m l\u1ea1i "),t.qZA()}}const ue=function(n,r){return{"bg-success":n,"bg-danger":r}};function ce(n,r){if(1&n&&(t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td",28),t._uU(4),t.qZA(),t.TgZ(5,"td",28),t._uU(6),t.qZA(),t.TgZ(7,"td",29),t._uU(8),t.qZA()()),2&n){const e=r.$implicit,i=r.index;t.Q6J("@slideIn",void 0),t.xp6(2),t.Oqu(i+1),t.xp6(2),t.Oqu(e.receiver),t.xp6(2),t.Oqu(e.email),t.xp6(1),t.Q6J("ngClass",t.WLB(6,ue,e.status,3===e.status)),t.xp6(1),t.hij(" ",1===e.status?"\u0110\xe3 g\u1eedi":"Ch\u01b0a g\u1eedi","")}}function pe(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"button",30),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).sendMail()}),t._uU(1,"G\u1eedi mail"),t.qZA()}}function de(n,r){if(1&n&&(t.TgZ(0,"div",24)(1,"h5"),t._uU(2,"DANH S\xc1CH EMAIL \u0110\u01af\u1ee2C TH\xd4NG B\xc1O"),t.qZA(),t.TgZ(3,"table",25)(4,"thead")(5,"tr")(6,"th"),t._uU(7,"STT"),t.qZA(),t.TgZ(8,"th"),t._uU(9,"Ng\u01b0\u1eddi nh\u1eadn"),t.qZA(),t.TgZ(10,"th"),t._uU(11,"Email"),t.qZA(),t.TgZ(12,"th",26),t._uU(13,"Tr\u1ea1ng th\xe1i"),t.qZA()()(),t.TgZ(14,"tbody"),t.YNc(15,ce,9,9,"tr",20),t.qZA()(),t.YNc(16,pe,2,0,"button",27),t.qZA()),2&n){const e=t.oxw();t.xp6(15),t.Q6J("ngForOf",e.dataJson),t.xp6(1),t.Q6J("ngIf",0===e.errData.length&&e.dataJson.length>0)}}function he(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"button",38),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).pre()}),t._UZ(1,"i",39),t.qZA()}}function me(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"button",40),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).next()}),t._UZ(1,"i",41),t.qZA()}}function _e(n,r){if(1&n&&t._UZ(0,"div",42),2&n){const e=t.oxw(2);t.Q6J("innerHTML",e.dataJson[e.i].message,t.oJD)}}function ge(n,r){if(1&n&&(t.TgZ(0,"div",31)(1,"div",32),t.YNc(2,he,2,0,"button",33),t.YNc(3,me,2,0,"button",34),t.qZA(),t.TgZ(4,"div",35)(5,"h5",36),t._uU(6),t.qZA(),t.YNc(7,_e,1,1,"div",37),t.qZA(),t._UZ(8,"hr"),t.qZA()),2&n){const e=t.oxw();t.xp6(2),t.Q6J("ngIf",e.i>0&&e.dataJson.length>e.i),t.xp6(1),t.Q6J("ngIf",e.dataJson.length-1>e.i),t.xp6(3),t.hij("N\u1ed9i dung \u0111\u01b0\u1ee3c g\u1eedi \u0111\u1ebfn email ",e.dataJson[e.i].email," "),t.xp6(1),t.Q6J("ngIf",e.dataJson[e.i].message)}}let fe=(()=>{class n{constructor(e,i,o,s){this.plus=e,this.fb=i,this.httpClient=o,this.router=s,this.Editor=L,this.apiUpload="https://up-log.herokuapp.com/upload",this.collection="thong-bao",this.db=null,this.dbName="email",this.dbVer=1,this.selectedFile=null,this.dataImport=[],this.dataJson=[],this.errData=[],this.sent=[],this.resent=[],this.send="",this.htmlContent=sessionStorage.getItem("htmlContent")||"",this.uploadProgress=0,this.i=0,this.main=this.fb.group({email:[,a.kI.email],title:["Th\xf4ng b\xe1o ",[a.kI.minLength(3)]],message:["\u0110i\u1ec7n l\u1ef1c xin th\xf4ng b\xe1o nh\u01b0 sau:",a.kI.minLength(10)]}),this.account=this.fb.group({user:["",a.kI.minLength(3)],pass:["",a.kI.minLength(6)]}),this.checkBody=this.fb.group({from:["",[a.kI.required,a.kI.minLength(10)]],status:0,err:"",email:[,a.kI.email],receiver:["",[a.kI.required,a.kI.minLength(3)]],title:["",[a.kI.required,a.kI.minLength(3)]],message:["",[a.kI.required,a.kI.minLength(1020)]]}),this.uploadForm=this.fb.group({profile:[""]})}ngOnInit(){this.reset(),this.plus.IDB_InitDB(this.dbName).subscribe(e=>{this.db=e,this.init()}),this.plus.httpGetFull(this.apiUpload).subscribe(e=>{console.log(e)})}onReady(e){e.ui.getEditableElement().parentElement.insertBefore(e.ui.view.toolbar.element,e.ui.getEditableElement()),e.plugins.get("FileRepository").createUploadAdapter=i=>(console.log(btoa(i.file)),new zt(i,"/upload",this.httpClient,this.plus))}saveArticle(){this.dataJson.length>0&&(this.plus.alertToasrt({war:"B\u1ea1n c\u1ea7n ch\u1ecdn l\u1ea1i danh s\xe1ch nh\u1eadn email sau khi hi\u1ec7u ch\u1ec9nh n\u1ed9i dung!"}),this.reset()),this.htmlContent=this.getArticleContent(),sessionStorage.setItem("htmlContent",this.htmlContent)}getArticleContent(){return this.myEditor&&this.myEditor.editorInstance?this.myEditor.editorInstance.getData():""}init(){this.from=this.plus.user.getValue().unit,this.plus.IDB_DB_GetAll(this.db,this.collection).subscribe(e=>{console.log(e),e.filter(i=>{0==i.status&&(console.log(i),this.resent.push(i))}),this.resent.length>0?(console.log(this.resent),confirm("B\u1ea5m OK \u0111\u1ec3 g\u1eedi mail tr\u01b0\u1edbc ch\u01b0a ho\xe0n th\xe0nh.\nB\u1ea5m Cancel \u0111\u1ec3 x\xf3a phi\xean l\xe0m vi\u1ec7c tr\u01b0\u1edbc?")?this.dataJson=this.resent:this.plus.IDB_DB_ClearCollection(this.db,this.collection).subscribe(o=>{o&&console.log("clear")})):this.plus.IDB_DB_ClearCollection(this.db,this.collection).subscribe(i=>{i&&(console.log("clear"),this.htmlContent="",this.reset())})}),0===this.from.length&&(this.plus.alertToasrt({err:"B\u1ea1n ch\u01b0a khai b\xe1o \u0111\u01a1n v\u1ecb t\u1ea1i m\u1ee5c T\xe0i Kho\u1ea3n"}),this.router.navigateByUrl("/taikhoan"))}getFails(){}readXlsx(e){console.log(e),this.dataJson=[],this.dataImport=[];let i=e.target;const o=new FileReader;o.onload=s=>{const m=S.ij(s.target.result,{type:"binary"});this.dataImport=S.P6.sheet_to_json(m.Sheets[m.SheetNames[0]],{header:1}),0==this.dataImport.length&&this.plus.alertWarning("Danh s\xe1ch g\u1eedi tr\u1ed1ng")},o.readAsBinaryString(i.files[0]),i=null}reload(){return $(this,void 0,void 0,function*(){return yield this.router.navigate([""]),this.router.navigate(["email/thongbao"])})}checkImportData(){this.dataImport.length>200&&(this.reset(),this.plus.alertToasrt({err:"S\u1ed1 l\u01b0\u1ee3ng email v\u01b0\u1ee3t qu\xe1 gi\u1edbi h\u1ea1n\nVui l\xf2ng ch\u1ecdn d\u01b0\u1edbi 200 email cho m\u1ed7i l\u1ea7n g\u1eedi!"})),this.dataJson=[],this.dataImport.splice(0,1),this.dataImport.forEach(o=>{let s="";if("x"==o[1]||"X"==o[1]){void 0!==o[5]&&(s="\n"+o[5]+"\n");let m={from:this.from,status:0,err:"",receiver:o[3],email:o[4],title:`${this.main.get("title").value}`,message:`<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; K\xednh g\u1eedi ${o[2]}: ${o[3]}.</p>\n                       ${s} <br>\n                       ${this.htmlContent} <br>\n                      &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Tr\xe2n tr\u1ecdng.\n                      </hr>\n                      <table class="table">\n                      <td><img src="https://github.com/thuctd/FileStore/raw/master/NhanHieuDLuc-Doc-150x150.jpg"> </td>\n                      <td>\n                        <b>\u0110i\u1ec7n l\u1ef1c Xu\xe2n L\u1ed9c - C\xf4ng ty TNHH m\u1ed9t th\xe0nh vi\xean \u0110i\u1ec7n l\u1ef1c \u0110\u1ed3ng Nai.</b><br>\n                        <b>\u0110\u1ecba ch\u1ec9: S\u1ed1 94 H\xf9ng V\u01b0\u01a1ng - Th\u1ecb tr\u1ea5n Gia Ray - Huy\u1ec7n Xu\xe2n L\u1ed9c - T\u1ec9nh \u0110\u1ed3ng Nai.</b><br>\n                        <b>MST: 3600432744 - 004</b><br>\n                        <b>Li\xean h\u1ec7: <a href="tel:02512218242" title="02512218242">0251.2218.242 </a></b><br>\n                        <b>T\u1ed5ng \u0111\xe0i ch\u0103m s\xf3c kh\xe1ch h\xe0ng: <a href="tel:19001006">19001006</a> - <a href="tel:19009000">19009000</a></b><br>\n                      </td>\n                      </table>\n                      `};if(console.log(m.message.length),this.checkBody.patchValue(m),this.checkBody.valid)this.dataJson.push(m),m._id=m.email,console.log(m),this.plus.IDB_DB_Add(this.db,this.collection,m);else{if(this.checkBody.valid)return;{console.log("else if");const l=this.plus.getErrValidateForm(this.checkBody);console.log(l),m.err=l,this.errData.push(m)}}if(this.errData.length>0)return console.log(this.errData),this.plus.IDB_DB_ClearCollection(this.db,this.collection).subscribe(l=>{l&&this.plus.alertWarning("D\u1eef li\u1ec7u c\xf3 l\u1ed7i!")});this.plus.loaded()}})}sendDefault(){const e=this.dataJson.map(o=>o.receiver),i={from:this.from,status:0,err:"",email:"thucspc@gmail.com",title:`B\xe1o c\xe1o th\u1ef1c hi\u1ec7n g\u1eedi ${this.checkBody.value.title}`,index:0,message:` <p> K\xednh g\u1eedi \xf4ng: Tr\u1ea7n \u0110\u1ea1i Th\u1ee9c.</p>\n      <p>  ${this.plus.user.getValue().fullName} (${this.plus.user.getValue()._id}) th\u1ef1c hi\u1ec7n g\u1eedi th\xf4ng b\xe1o ti\u1ec1n \u0111i\u1ec7n m\u1eb7t tr\u1eddi cho ${this.dataJson.length} kh\xe1ch h\xe0ng:</p>\n      <ul>\n      <li> ${e.join(".</li><li>")}.</li>\n      </ul>\n      <p>Tr\xe2n tr\u1ecdng.</p>`};this.plus.sendMail(i,"mail/bao-cao").subscribe(o=>{console.log("bodydefault")})}sendMail(){return $(this,void 0,void 0,function*(){const e=confirm("Th\u1ef1c hi\u1ec7n th\xf4ng b\xe1o cho "+this.dataJson.length+" CBCNV?");if(0===this.errData.length&&this.dataJson.length>0&&e){this.sendDefault();let i=0;const o=this.dataJson.length;for(;i<o;){yield this.plus.sleep(5e3),this.i=i;const s=this.dataJson[i];this.plus.sendMail(s,"mail/thong-bao").subscribe(c=>{console.log(),c.email&&(this.dataJson.filter((m,l)=>{m.email===c.email&&(this.dataJson[l].status=1,this.plus.IDB_DB_DeleteOne(this.db,this.collection,m.email))}),console.log(i,c.email,s.reciver),localStorage.setItem("notify",JSON.stringify(this.dataJson)))},c=>{this.dataJson[i].status=0,localStorage.setItem("notify",JSON.stringify(this.dataJson)),this.plus.alertToasrt({err:` Ch\u01b0a g\u1eedi email \u0111\u1ebfn ${s.reciver}`})}),i++}}else this.plus.alertToasrt({war:"\u0110\xe3 h\u1ee7y thao t\xe1c!"}),window.location.reload()})}uploadDrive(e){this.plus.load(),console.log(e.target.files[0]);const i=e.target.files[0].size;if(console.log(i),i>52428800)return this.plus.alertToasrt({war:"Dung l\u01b0\u1ee3ng file qu\xe1 50Mb"}),void this.plus.loaded();const o=new FormData;o.append("file",e.target.files[0]);const s=new A.WM({"ngsw-bypass":""});this.httpClient.post(this.apiUpload,o,{reportProgress:!0,observe:"events",headers:s}).subscribe(c=>{c.type===A.dt.UploadProgress?this.uploadProgress=Math.round(c.loaded/c.total*100):c.type===A.dt.Response&&(this.linkUpload=c.body.url,this.plus.pushLocalStorage("link",c.body.url),this.plus.loaded())},c=>{this.plus.loaded(),this.plus.alertToasrt({err:"L\u1ed7i upload file! \nVui l\xf2ng th\u1eed l\u1ea1i!"})})}copyInputMessage(e){this.plus.copyInputMessage(e)}getBase64(e){const i=new FileReader;return i.readAsDataURL(e),i.onload=()=>{},i.onerror=o=>{console.log("Error: ",o)},i.result}pre(){this.i>0?this.i--:this.i=0}next(){this.i<this.dataJson.length-1?this.i++:this.i=0}reset(){this.dataJson=[],this.errData=[],this.linkUpload="",this.uploadProgress=0}logList(e){this.dataJson.splice(0,1),localStorage.setItem("sendmail",this.dataJson.toString())}sliceList(e){}export(e){this.plus.exportHTML(e)}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(_.T),t.Y36(a.qu),t.Y36(A.eN),t.Y36(F.F0))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-notify"]],viewQuery:function(e,i){if(1&e&&t.Gf(ie,5),2&e){let o;t.iGM(o=t.CRH())&&(i.myEditor=o.first)}},decls:26,vars:10,consts:[[1,"container","my-3"],[1,"text-center","text-primary"],[1,"import"],[1,"modal-body"],[1,"form-group",3,"formGroup"],["for",""],["type","text","required","","placeholder","Nh\u1eadp n\u1ed9i dung ti\xeau \u0111\u1ec1","formControlName","title",1,"form-control"],[3,"editor","data","ready","change"],["myEditor",""],[4,"ngIf"],[1,"list"],["target","_blank","href","https://github.com/thuctd/FileStore/raw/master/templates/MauThongBao.xlsx",1,"badge","badge-warning"],["for","file-import","class","custom-file-upload mx-5",4,"ngIf"],["hidden","","id","file-import","type","file","multiple","false",3,"change"],["type","button","class","btn btn-outline-primary mx-3",3,"click",4,"ngIf"],["class","dataOk",4,"ngIf"],["class","card border-primary rounded",4,"ngIf"],[1,"text-center","bg-warning","rounded-pill"],[1,"table","table-hover","table-invert","table-bordered","rounded-pill"],[1,"text-center","bg-danger"],[4,"ngFor","ngForOf"],["for","file-import",1,"custom-file-upload","mx-5"],[1,"fa","fa-address-book"],["type","button",1,"btn","btn-outline-primary","mx-3",3,"click"],[1,"dataOk"],[1,"table","table-hover"],[1,"text-center"],["type","button","class","btn btn-primary mx-3 text-center","data-toggle","modal","data-target","#modelId",3,"click",4,"ngIf"],["scope","row"],[1,"text-center",3,"ngClass"],["type","button","data-toggle","modal","data-target","#modelId",1,"btn","btn-primary","mx-3","text-center",3,"click"],[1,"card","border-primary","rounded"],[1,"button"],["type","button","class","btn btn-danger float-left",3,"click",4,"ngIf"],["type","button","class","btn btn-danger float-right",3,"click",4,"ngIf"],[1,"card-body"],[1,"text-center","rounded","font-weigth-bold","bg-warning","my-4"],[3,"innerHTML",4,"ngIf"],["type","button",1,"btn","btn-danger","float-left",3,"click"],["aria-hidden","true",1,"fa","fa-arrow-left"],["type","button",1,"btn","btn-danger","float-right",3,"click"],["aria-hidden","true",1,"fa","fa-arrow-right"],[3,"innerHTML"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0)(1,"h5",1),t._uU(2,"G\u1eecI TH\xd4NG B\xc1O B\u1eb0NG EMAIL"),t.qZA(),t.TgZ(3,"div",2)(4,"div",3)(5,"form",4)(6,"label",5),t._uU(7,"Ti\xeau \u0111\u1ec1"),t.qZA(),t._UZ(8,"input",6),t.qZA()(),t._UZ(9,"app-cloudinary"),t.TgZ(10,"h4",1),t._uU(11,"So\u1ea1n th\u1ea3o"),t.qZA(),t.TgZ(12,"ckeditor",7,8),t.NdJ("ready",function(s){return i.onReady(s)})("change",function(){return i.saveArticle()}),t.qZA(),t.YNc(14,ae,12,1,"div",9),t.TgZ(15,"div",10),t._UZ(16,"hr"),t.TgZ(17,"a",11),t._uU(18,"File m\u1eabu"),t.qZA(),t.YNc(19,re,3,0,"label",12),t.TgZ(20,"input",13),t.NdJ("change",function(s){return i.readXlsx(s)}),t.qZA(),t.YNc(21,se,2,0,"button",14),t.YNc(22,le,2,0,"button",14),t.qZA(),t.YNc(23,de,17,2,"div",15),t._UZ(24,"hr"),t.qZA(),t.YNc(25,ge,9,4,"div",16),t.qZA()),2&e&&(t.Q6J("@slideIn",void 0),t.xp6(5),t.Q6J("formGroup",i.main),t.xp6(7),t.s9C("data",i.htmlContent),t.Q6J("editor",i.Editor),t.xp6(2),t.Q6J("ngIf",i.errData.length>0),t.xp6(5),t.Q6J("ngIf",0===i.dataJson.length),t.xp6(2),t.Q6J("ngIf",i.dataImport.length>0&&0===i.dataJson.length&&0===i.errData.length),t.xp6(1),t.Q6J("ngIf",i.errData.length>0),t.xp6(1),t.Q6J("ngIf",i.dataJson.length>0&&0==i.errData.length),t.xp6(2),t.Q6J("ngIf",i.dataJson.length>0&&0===i.errData.length))},directives:[a._Y,a.JL,a.sg,a.Fj,a.Q7,a.JJ,a.u,ne,O.u,u.O5,u.sg,u.mk],styles:[""],data:{animation:[H.Ym,H.Mq]}}),n})(),Te=(()=>{class n{constructor(e){this.plus=e,this.db=null,this.verDB=1,this.dbName="email",this.api="email"}ngOnInit(){}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(_.T))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-email"]],decls:0,vars:0,template:function(e,i){},styles:[""]}),n})(),P=(()=>{class n{constructor(e){this.plus=e}canActivate(){return this.plus.checkPer("thong-bao")}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(_.T))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac}),n})(),K=(()=>{class n{constructor(e){this.plus=e}canActivate(){return this.plus.checkPer("tien-luong")}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(_.T))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac}),n})(),G=(()=>{class n{constructor(e){this.plus=e}canActivate(){return this.plus.checkPer("dien-mat-troi")}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(_.T))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac}),n})(),j=(()=>{class n{constructor(e){this.plus=e}canActivate(){return this.plus.checkPer("dmt")}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(_.T))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac}),n})();const be=[{path:"",component:Te},{path:"thong-bao",component:fe,canActivate:[P]},{path:"tien-luong",component:Ht,canActivate:[K]},{path:"dien-mat-troi",component:Xt,canActivate:[G]},{path:"thanh-toan",component:At,canActivate:[j]}];let De=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({providers:[P,K,G,j],imports:[[F.Bz.forChild(be)],F.Bz]}),n})();var Ze=p(48387);let xe=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[u.ez,De,a.u5,a.UX,O.d,Ze.D,g.ShareModule,x.qX,N.X,C.k,h.m]]}),n})()},51511:(B,k,p)=>{p.d(k,{k:()=>C});var h=p(5e3),N=p(15194);let C=(()=>{class x{constructor(){this.files=new h.vpe}ngOnInit(){}ngOnDestroy(){this.files.unsubscribe(),console.log("ngOnDestroy app-drop-files")}onDrop(a){this.files.emit(a),document.getElementById("dropZone").setAttribute("drop-active","false")}selectedFile(a){this.files.emit(a.target.files)}ondragover(){document.getElementById("dropZone").setAttribute("drop-active","true")}}return x.\u0275fac=function(a){return new(a||x)},x.\u0275cmp=h.Xpm({type:x,selectors:[["app-drop-files"]],inputs:{label:"label"},outputs:{files:"files"},decls:9,vars:1,consts:[[1,"row","justify-content-center","d-none-print"],["id","dropZone",3,"appDropZone","dragover"],["for","file-import"],["hidden","","id","file-import","type","file","multiple","false",3,"change"]],template:function(a,u){1&a&&(h.TgZ(0,"div",0)(1,"div",1),h.NdJ("appDropZone",function(_){return u.onDrop(_)})("dragover",function(){return u.ondragover()}),h.TgZ(2,"label",2),h._uU(3),h.TgZ(4,"span"),h._uU(5,"\u2794"),h.qZA(),h.TgZ(6,"a"),h._uU(7," Ch\u1ecdn file "),h.qZA()(),h.TgZ(8,"input",3),h.NdJ("change",function(_){return u.selectedFile(_)}),h.qZA()()()),2&a&&(h.xp6(3),h.hij(" K\xe9o th\u1ea3 file ",u.label," v\xe0o \u0111\xe2y ho\u1eb7c "))},directives:[N.i],styles:["label[_ngcontent-%COMP%]{width:100%;height:100%;text-align:center;line-height:170px;color:#00f;font-weight:bolder}#dropZone[_ngcontent-%COMP%]{top:20%;left:10%;width:80%;height:200px;border-radius:3%;border:2px dashed rgb(38,16,165)}#dropZone[drop-active=true][_ngcontent-%COMP%]{box-shadow:inset 0 0 0 2px #00c;border:2px dashed rgb(38,16,165);background-color:#c9eccb}"],changeDetection:0}),x})()},15194:(B,k,p)=>{p.d(k,{i:()=>N});var h=p(5e3);let N=(()=>{class C{constructor(){this.fileDrop=new h.vpe,this.preventBodyDrop=!0,this.active=!1}onDrop(g){g.preventDefault(),this.active=!1;const{dataTransfer:a}=g;if(a.items){const u=[];for(let t=0;t<a.items.length;t++)"file"===a.items[t].kind&&u.push(a.items[t].getAsFile());a.items.clear(),this.fileDrop.emit(u)}else{const u=a.files;a.clearData(),this.fileDrop.emit(Array.from(u))}}onDragOver(g){g.stopPropagation(),g.preventDefault(),this.active=!0}onDragLeave(g){this.active=!1}onBodyDragOver(g){this.preventBodyDrop&&(g.preventDefault(),g.stopPropagation())}onBodyDrop(g){this.preventBodyDrop&&g.preventDefault()}}return C.\u0275fac=function(g){return new(g||C)},C.\u0275dir=h.lG2({type:C,selectors:[["","appDropZone",""]],hostVars:2,hostBindings:function(g,a){1&g&&h.NdJ("drop",function(t){return a.onDrop(t)})("dragover",function(t){return a.onDragOver(t)})("dragleave",function(t){return a.onDragLeave(t)})("dragover",function(t){return a.onBodyDragOver(t)},!1,h.pYS)("drop",function(t){return a.onBodyDrop(t)},!1,h.pYS),2&g&&h.ekj("drop-zone-active",a.active)},inputs:{preventBodyDrop:"preventBodyDrop"},outputs:{fileDrop:"appDropZone"}}),C})()},31409:(B,k,p)=>{p.d(k,{x:()=>x});var h=p(80574),N=p(5e3),C=p(45230);let x=(()=>{class g{constructor(u){this.plus=u}toJsonArray(u,t=!0){return new Promise(_=>{let b={};if(this.plus.load(),null!=u&&"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"!=u.type&&"application/vnd.ms-excel"!=u.type)return this.plus.alertError("Kh\xf4ng ph\u1ea3i file excel");const y=new FileReader;y.readAsBinaryString(u),y.onloadend=E=>{const q=h.ij(E.target.result,{type:"binary",cellDates:!0,dateNF:"DD/MM/YYYY"}),U=q.SheetNames;for(let Z=0;Z<U.length;Z++){const J=U[Z],w=h.P6.sheet_to_json(q.Sheets[J],{header:1,raw:t});b[`${J}`]=this.convertJSon(w)}this.plus.loaded(),_(b)}})}read(u,t=2){return new Promise(_=>{let b=[];if(this.plus.load(),null!=u&&"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"!=u.type&&"application/vnd.ms-excel"!=u.type)return this.plus.alertError("Kh\xf4ng ph\u1ea3i file excel");const y=new FileReader;y.readAsBinaryString(u),y.onloadend=E=>{const q=h.ij(E.target.result,{type:"binary",cellDates:!0,dateNF:"DD/MM/YYYY"}),U=q.SheetNames;for(let Z=0;Z<t;Z++){const w=h.P6.sheet_to_json(q.Sheets[U[Z]],{header:1});b.push(w)}this.plus.loaded(),_(b)}})}convertJSon(u){const t=[];for(let _=1;_<u.length;_++){const b={};u[0].forEach((y,E)=>{b[`${y}`]=u[_][E]}),t.push(b)}return t}convertJSonByX(u){const t=[];for(let _=1;_<u.length;_++)if("x"==u[_][0]){const b={};u[0].forEach((y,E)=>{b[`${y}`]=u[_][E]}),t.push(b)}return t}readXlsxToMerge(u){return console.log(u),new Promise((t,_)=>{this.plus.load();let b={};if(null!=u&&"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"!=u.type&&"application/vnd.ms-excel"!=u.type)return this.plus.alertError("Kh\xf4ng ph\u1ea3i file excel");const y=new FileReader;y.readAsBinaryString(u),y.onloadend=E=>{const q=h.ij(E.target.result,{type:"binary",cellDates:!0,dateNF:"DD/MM/YYYY"}),U=q.SheetNames;for(let Z=0;Z<U.length;Z++){const J=U[Z];if("_Merge"==J)return this.plus.alertError("Vui l\xf2ng \u0111\u1ed5i t\xean sheet _Merge th\xe0nh t\xean kh\xe1c");const w=h.P6.sheet_to_json(q.Sheets[J],{header:1,raw:!0});b[`${0==Z?"_Merge":J}`]=this.convertJSonByX(w)}t(b),this.plus.loaded()}})}export(u,t=""){const _=h.P6.json_to_sheet(u,{skipHeader:!0,dateNF:"mm/dd/yyyy;@",cellDates:!0}),b=h.P6.book_new();h.P6.book_append_sheet(b,_,"ChuaImport"),h.NC(b,"4la-"+t+"-ChuaImport.xlsx")}exportTar(u,t=""){for(let v=0;v<u.length;v++)delete u[v].dateModify,delete u[v].canEdit,delete u[v].keyWord,delete u[v].__v,delete u[v]._id;let _=JSON.stringify(u),b="data:application/json;charset=utf-8,"+encodeURIComponent(_);console.log(b);let y=`4la-${t||""}`+Date.now()+".tar",E=document.createElement("a");E.setAttribute("href",b),E.setAttribute("download",y),E.click()}}return g.\u0275fac=function(u){return new(u||g)(N.LFG(C.T))},g.\u0275prov=N.Yz7({token:g,factory:g.\u0275fac,providedIn:"root"}),g})()},48387:(B,k,p)=>{p.d(k,{D:()=>a});var h=p(51372),N=p(69808),C=p(93075),x=p(5923),g=p(5e3);let a=(()=>{class u{}return u.\u0275fac=function(_){return new(_||u)},u.\u0275mod=g.oAB({type:u}),u.\u0275inj=g.cJS({imports:[[N.ez,C.u5,h.qX,x.X]]}),u})()},85913:(B,k,p)=>{p.d(k,{m:()=>g});var h=p(51372),N=p(93075),C=p(69808),x=p(5e3);let g=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=x.oAB({type:a}),a.\u0275inj=x.cJS({imports:[[C.ez,N.UX,h.qX]]}),a})()}}]);