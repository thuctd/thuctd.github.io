"use strict";(self.webpackChunk_4la=self.webpackChunk_4la||[]).push([[227],{85767:function(t,e,n){n.d(e,{u:function(){return c}});var r=n(12057),i=n(50166),o=n(24751),s=n(74788);let c=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=s.oAB({type:t}),t.\u0275inj=s.cJS({imports:[[r.ez,i.d,o.u5,o.UX]]}),t})()},41258:function(t,e,n){n.d(e,{K:function(){return o}});var r=n(74788),i=n(57922);let o=(()=>{class t{constructor(t){this.plus=t,this.excel=new r.vpe,this.output=[],this.table=""}ngOnInit(){}parseExcel(t){let e=t.target.value.trim(),n=[],r=[];const i=e.split("\n");for(let o=0;o<i.length;o++)n[o]=i[o].split("\t");return n.forEach(t=>{let e={};t.forEach((t,n)=>{e[n]=t}),r.push(e)}),this.output=r,this.table=this.exportTbale(r),localStorage.setItem("parser",JSON.stringify(r)),this.excel.emit(r),r}parseExcel2(t){let e=t.target.value.trim(),n=[],r=[];const i=e.split("\n");for(let o=0;o<i.length;o++)n[o]=i[o].split("\t");return n.forEach(t=>{const e=n[0];let i={};t.forEach((t,n)=>{i[this.plus.generateKey(e[n])]=t}),r.push(i)}),this.output=r,this.table=this.exportTbale(r),localStorage.setItem("parser",JSON.stringify(r)),this.excel.emit(r),r}exportTbale(t){let e="<th>STT</th>",n="";for(let r in t[0])t[0].hasOwnProperty(r)&&(e+="<th>"+this.plus.generateKey(t[0][r])+"</th>");return t.forEach((t,e)=>{n+=`<tr><td>${e+1}</td>`;for(const r in t)t.hasOwnProperty(r)&&(n+="<td>"+t[r]+"</td>");n+="</tr>"}),`\n    <table class="table table-bordered table-hover ">\n      <thead>\n        <tr class="text-center">\n         ${e}\n        </tr>\n      <thead>\n      <tbody style = "border: 1px solid black;">\n         ${n}\n      <tbody>\n    <table>\n    `}reset(t){return t.target.value=""}save(){const t=JSON.stringify(this.output);localStorage.setItem("parser",t)}}return t.\u0275fac=function(e){return new(e||t)(r.Y36(i.T))},t.\u0275cmp=r.Xpm({type:t,selectors:[["app-parse-excel-clipboard"]],outputs:{excel:"excel"},decls:7,vars:0,consts:[[1,"container"],[1,"form-group"],[1,"text-center","text-white","p-3","my-3","bg-info","rounded-pill","justify-content-center"],["placeholder","D\xe1n n\u1ed9i dung v\xe0o \u0111\xe2y","rows","2",1,"form-control",3,"click","change"],["input1",""]],template:function(t,e){1&t&&(r.TgZ(0,"div",0),r.TgZ(1,"div",1),r.TgZ(2,"h5",2),r._uU(3,"Chuy\u1ec3n \u0111\u1ed5i d\u1eef li\u1ec7u t\u1eeb clipboard Excel"),r.qZA(),r.TgZ(4,"textarea",3,4),r.NdJ("click",function(t){return e.reset(t)})("change",function(t){return e.parseExcel(t)}),r._uU(6,"  "),r.qZA(),r.qZA(),r.qZA())},styles:[""]}),t})()},89173:function(t,e,n){n.d(e,{o:function(){return o}});var r=n(12057),i=n(74788);let o=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=i.oAB({type:t}),t.\u0275inj=i.cJS({imports:[[r.ez]]}),t})()},1227:function(t,e,n){n.r(e),n.d(e,{UltisModule:function(){return it}});var r=n(24751),i=n(13397),o=n(48387),s=n(12057),c=n(5923),a=n(74788);let l=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=a.oAB({type:t}),t.\u0275inj=a.cJS({imports:[[s.ez,o.D,r.u5,i.qX,c.X]]}),t})();var u=n(89173),p=n(85767),d=n(15228),h=(n(45107),n(16738)),g=n.n(h),m=n(24347),f=n(84487),y=n(57922),Z=n(31409),b=n(9157),x=n(15194),v=n(64855),T=n(49356);function w(t,e){1&t&&(a.TgZ(0,"mat-icon",4),a._uU(1,"done"),a.qZA()),2&t&&a.Q6J("@slideX",void 0)}let A=(()=>{class t{constructor(t){this.plus=t,this.numSheet=1,this.raw=!0,this.xls=new a.vpe,this.docx=new a.vpe,this.ok=!1,this.sheetList=[],this.sheetSelect=[]}ngOnInit(){}ngOnDestroy(){this.xls.unsubscribe(),this.docx.unsubscribe(),console.log("ngOnDestroy app-read-xlsx")}readXlsx(t){this.plus.load();let e={};if(null!=t.target.files[0]&&"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"!=t.target.files[0].type&&"application/vnd.ms-excel"!=t.target.files[0].type)return this.plus.alertError("Kh\xf4ng ph\u1ea3i file excel");let n=t.target;if(!n)return this.plus.alertError("B\u1ea1n ch\u01b0a ch\u1ecdn file");const r=new FileReader;r.readAsBinaryString(n.files[0]),r.onloadend=t=>{const n=f.read(t.target.result,{type:"binary",cellDates:!0,dateNF:"DD/MM/YYYY"}),r=n.SheetNames;for(let i=0;i<r.length;i++){const t=r[i];if("_Merge"==t)return this.plus.alertError("Vui l\xf2ng \u0111\u1ed5i t\xean sheet _Merge th\xe0nh t\xean kh\xe1c");const o=f.utils.sheet_to_json(n.Sheets[t],{header:1,raw:this.raw});this.xls.emit(o),e[`${0==i?"_Merge":t}`]=this.convertJSon(o)}this.docx.emit(e),this.ok=!0,this.plus.loaded()}}convertJSon(t){const e=[];for(let n=1;n<t.length;n++)if("x"==t[n][0]){const r={};t[0].forEach((e,i)=>{r[`${e}`]=t[n][i]}),e.push(r)}return e}choose(t){const e=this.sheetSelect.indexOf(t);-1!==e?this.sheetSelect.splice(e,1):this.sheetSelect.push(t)}}return t.\u0275fac=function(e){return new(e||t)(a.Y36(y.T))},t.\u0275cmp=a.Xpm({type:t,selectors:[["app-read-xlsx"]],inputs:{numSheet:"numSheet",raw:"raw"},outputs:{xls:"xls",docx:"docx"},decls:5,vars:1,consts:[["hidden","","id","read-xlsx","type","file","multiple","false",3,"input"],["for","read-xlsx",1,"custom-file-upload","text-primary"],["aria-hidden","true",1,"fa","text-success","fa-file-excel-o","fa-2x"],["color","primary",4,"ngIf"],["color","primary"]],template:function(t,e){1&t&&(a.TgZ(0,"input",0),a.NdJ("input",function(t){return e.readXlsx(t)}),a.qZA(),a.TgZ(1,"label",1),a._uU(2," Ch\u1ecdn file excel "),a._UZ(3,"i",2),a.YNc(4,w,2,1,"mat-icon",3),a.qZA()),2&t&&(a.xp6(4),a.Q6J("ngIf",e.ok))},directives:[s.O5,T.Hw],styles:[""],data:{animation:[d.Mq]}}),t})();var q=n(73624),N=n(2895);function M(t,e){1&t&&(a.TgZ(0,"mat-icon",15),a._uU(1,"done"),a.qZA()),2&t&&a.Q6J("@slideX",void 0)}function k(t,e){1&t&&(a.TgZ(0,"mat-icon",15),a._uU(1,"done"),a.qZA()),2&t&&a.Q6J("@slideX",void 0)}function _(t,e){if(1&t&&(a.TgZ(0,"td"),a.TgZ(1,"label",16),a._uU(2,"Ch\u1ecdn file Word "),a._UZ(3,"i",17),a.YNc(4,k,2,1,"mat-icon",5),a.qZA(),a._UZ(5,"br"),a.TgZ(6,"a",18),a._uU(7,"M\u1eabu Word "),a.qZA(),a.qZA()),2&t){const t=a.oxw();a.xp6(4),a.Q6J("ngIf",t.wordFile)}}function U(t,e){if(1&t){const t=a.EpF();a.TgZ(0,"button",19),a.NdJ("click",function(){return a.CHM(t),a.oxw().generate()}),a.TgZ(1,"mat-icon"),a._uU(2,"file_download"),a.qZA(),a.qZA()}}function I(t,e){if(1&t){const t=a.EpF();a.TgZ(0,"button",20),a.NdJ("click",function(){return a.CHM(t),a.oxw().reload()}),a.TgZ(1,"mat-icon"),a._uU(2,"autorenew"),a.qZA(),a.qZA()}}let Y=(()=>{class t{constructor(t,e,n){this.plus=t,this.excel=e,this.docx=n,this.wordFile=null,this.fileName="",this.items={},this.ok=!1,this.options={parser:function(t){console.log(t);let e="";const n=/\b.\|.\blower/;n.test(t)&&(e="lower",t=t.toString().replace(n,""));const r=/\b.\|.\bupper/;r.test(t)&&(e="upper",t=t.toString().replace(r,""));const i=/\b.\|.\btitle/;i.test(t)&&(e="title",t=t.toString().replace(i,""));const o=/\b.\|.\bdd/;o.test(t)&&(e="dd",t=t.toString().replace(o,""));const s=/\b.\|.\btime/;s.test(t)&&(e="time",t=t.toString().replace(s,""));const c=/\b.\|.\bmm/;c.test(t)&&(e="mm",t=t.toString().replace(c,""));const a=/\b.\|.\byyyy/;a.test(t)&&(e="yyyy",t=t.toString().replace(a,""));const l=/\b.\|.\bdmy/;l.test(t)&&(e="dmy",t=t.toString().replace(l,""));const u=/\b.\|.\bnumber/;u.test(t)&&(e="number",t=t.toString().replace(u,""));const p=/\b.\|.\bvnd/;return p.test(t)&&(e="vnd",t=t.toString().replace(p,"")),{get:function(n){let r=null;if(r="."===t?n:n[t],null==r||!r)return"        ";if("object"==typeof r){const t=new Date(r),n=g()(t).add(1,"m").toDate();if(isNaN(n.getDate()))return r;switch(e.trim()){case"dd":r=g()(n).format("DD");break;case"mm":r=g()(n).format("MM");break;case"yyyy":r=g()(n).format("YYYY");break;case"time":r=`${g()(n).format("HH")} gi\u1edd ${g()(n).format("mm")} ph\xfat`;break;case"dmy":r=`ng\xe0y ${g()(n).format("DD")} th\xe1ng ${g()(n).format("MM")} n\u0103m ${g()(n).format("YYYY")}`;break;default:r=`${g()(n).format("DD/MM/YYYY")}`}return r}switch(e.trim()){case"upper":r=r.toUpperCase();break;case"lower":r=r.toLowerCase();break;case"number":r=new Intl.NumberFormat("it-IT").format(r);break;case"title":r=r.substring(0,1).toUpperCase()+r.substring(1);break;case"vnd":let t=(0,m.Z)(parseInt(`${r}`))+" \u0111\u1ed3ng";r=t.substring(0,1).toUpperCase()+t.substring(1);break;default:r=`${r}`}return`${r}`}}},paragraphLoop:!0,linebreaks:!0}}ngOnInit(){this.link&&this.docx.loadFileUrl(this.link).then(t=>{this.wordFile=t}),this.merge=JSON.parse(localStorage.getItem("merge"))}selectedFile(t){console.log(t),this.items=t}onDrop(t){for(let e=0;e<t.length;e++)"application/vnd.openxmlformats-officedocument.wordprocessingml.document"==t[e].type?(console.log("if docx"),this.readFile(t[e],!0)):"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"==t[e].type?(console.log("else if xlsx"),this.readXlsxToMerge(t[e]).then(t=>{console.log(t),this.items=t,this.ok=!0})):(console.log("else"),this.plus.alertError("Ch\u1ec9 \u0111\u01b0\u1ee3c ch\u1ecdn file c\xf3 \u0111\u1ecbnh d\u1ea1ng *.docx ho\u1eb7c *.xlsx!"));document.getElementById("dropZone").setAttribute("drop-active","false")}readFile(t,e=!1){if(e){this.fileName=t.name;const e=new FileReader;e.readAsArrayBuffer(t),e.onloadend=()=>this.wordFile=e.result}else{if(!t.target.files[0])return this.plus.alertWarning("B\u1ea1n ch\u01b0a ch\u1ecdn file");if("application/vnd.openxmlformats-officedocument.wordprocessingml.document"!=t.target.files[0].type)return this.plus.alertError("Kh\xf4ng \u0111\xfang \u0111\u1ecbnh d\u1ea1ng *.docx (Word 2003 tr\u1edf l\xean)");{this.fileName=t.target.files[0].name;const e=new FileReader;e.readAsArrayBuffer(t.target.files[0]),e.onloadend=()=>this.wordFile=e.result}}}generate(){return function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function s(t){try{a(r.next(t))}catch(e){o(e)}}function c(t){try{a(r.throw(t))}catch(e){o(e)}}function a(t){t.done?i(t.value):function(t){return t instanceof n?t:new n(function(e){e(t)})}(t.value).then(s,c)}a((r=r.apply(t,e||[])).next())})}(this,void 0,void 0,function*(){this.merge?this.docx.generateMerge(this.items,this.wordFile,this.fileName):this.docx.generateStepFile(this.items,this.wordFile,this.fileName),this.plus.reload("tienich/merge")})}reload(){this.plus.reload("/tienich/merge")}reset(){this.wordFile=null,this.fileName="",this.items={}}readXlsxToMerge(t){return new Promise((e,n)=>{this.plus.load();let r={};if(null!=t&&"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"!=t.type&&"application/vnd.ms-excel"!=t.type)return this.plus.alertError("Kh\xf4ng ph\u1ea3i file excel");const i=new FileReader;i.readAsBinaryString(t),i.onloadend=t=>{const n=f.read(t.target.result,{type:"binary",cellDates:!0,dateNF:"DD/MM/YYYY"}),i=n.SheetNames;for(let e=0;e<i.length;e++){const t=i[e];if("_Merge"==t)return this.plus.alertError("Vui l\xf2ng \u0111\u1ed5i t\xean sheet _Merge th\xe0nh t\xean kh\xe1c");const o=f.utils.sheet_to_json(n.Sheets[t],{header:1,raw:!0});r[`${0==e?"_Merge":t}`]=this.excel.convertJSonByX(o)}e(r),this.plus.loaded()}})}ondragover(){document.getElementById("dropZone").setAttribute("drop-active","true")}changeMerge(){localStorage.setItem("merge",JSON.stringify(this.merge))}}return t.\u0275fac=function(e){return new(e||t)(a.Y36(y.T),a.Y36(Z.x),a.Y36(b.E))},t.\u0275cmp=a.Xpm({type:t,selectors:[["app-docxtemplate"]],inputs:{link:"link"},decls:26,vars:6,consts:[[1,"container","my-5"],["hidden","","id","file-word","type","file","multiple","false",3,"change"],["id","dropZone",1,"table",3,"appDropZone","dragover"],["matTooltip","L\u01b0u \xfd: Kh\xf4ng thay \u0111\u1ed5i th\u1ee9 t\u1ef1 t\xean c\xe1c sheet v\xe0 ti\xeau \u0111\u1ec3 c\u1ed9t kh\xf4ng c\xf3 d\u1ea5u!"],[3,"raw","docx"],["color","primary",4,"ngIf"],["href","https://thuctd.github.io/docx/template/DataFile.xlsx",1,"badge","badge-warning"],[4,"ngIf"],[1,"text-center"],["colspan","4"],[1,"row"],[1,"col-4"],["color","warn",3,"ngModel","change","ngModelChange"],["mat-raised-button","","color","accent",3,"click",4,"ngIf"],["mat-raised-button","","color","primary",3,"click",4,"ngIf"],["color","primary"],["for","file-word",1,"custom-file-upload","text-primary"],["aria-hidden","true",1,"text-primary","fa","fa-file-word-o","fa-2x"],["href","https://thuctd.github.io/docx/template/Template.docx",1,"badge","badge-warning"],["mat-raised-button","","color","accent",3,"click"],["mat-raised-button","","color","primary",3,"click"]],template:function(t,e){1&t&&(a.TgZ(0,"div",0),a.TgZ(1,"input",1),a.NdJ("change",function(t){return e.readFile(t)}),a.qZA(),a.TgZ(2,"table",2),a.NdJ("appDropZone",function(t){return e.onDrop(t)})("dragover",function(){return e.ondragover()}),a.TgZ(3,"tr"),a.TgZ(4,"td"),a.TgZ(5,"label"),a._uU(6,"Ch\u1ecdn ho\u1eb7c th\u1ea3 2 file v\xe0o \u0111\xe2y"),a.qZA(),a.qZA(),a.TgZ(7,"td",3),a.TgZ(8,"app-read-xlsx",4),a.NdJ("docx",function(t){return e.selectedFile(t)}),a.qZA(),a.YNc(9,M,2,1,"mat-icon",5),a._UZ(10,"br"),a.TgZ(11,"a",6),a._uU(12,"M\u1eabu Excel "),a.qZA(),a.qZA(),a.YNc(13,_,8,1,"td",7),a._UZ(14,"td"),a.qZA(),a.TgZ(15,"tr",8),a.TgZ(16,"td",9),a.TgZ(17,"div",10),a.TgZ(18,"div",11),a.TgZ(19,"mat-slide-toggle",12),a.NdJ("change",function(){return e.changeMerge()})("ngModelChange",function(t){return e.merge=t}),a._uU(20," Tr\u1ed9n th\xe0nh 1 file "),a.qZA(),a._UZ(21,"br"),a.qZA(),a.TgZ(22,"div",11),a.YNc(23,U,3,0,"button",13),a.qZA(),a.qZA(),a.TgZ(24,"div",11),a.YNc(25,I,3,0,"button",14),a.qZA(),a.qZA(),a.qZA(),a.qZA(),a.qZA()),2&t&&(a.xp6(8),a.Q6J("raw",!0),a.xp6(1),a.Q6J("ngIf",e.ok),a.xp6(4),a.Q6J("ngIf",!e.link),a.xp6(6),a.Q6J("ngModel",e.merge),a.xp6(4),a.Q6J("ngIf",e.wordFile&&e.items),a.xp6(2),a.Q6J("ngIf",null!==e.wordFile||null!==e.items))},directives:[x.i,v.gM,A,s.O5,q.Rr,r.JJ,r.On,T.Hw,N.lW],styles:["#dropZone[_ngcontent-%COMP%]{position:absolute;top:20%;left:10%;width:80%;height:200px;border-radius:3%;border:2px dashed rgb(38,16,165)}#dropZone[drop-active=true][_ngcontent-%COMP%]{box-shadow:inset 0 0 0 2px #00c;border:2px dashed rgb(38,16,165);background-color:#c9eccb}"],data:{animation:[d.Mq]}}),t})(),J=(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=a.Xpm({type:t,selectors:[["app-merge-word"]],decls:1,vars:0,template:function(t,e){1&t&&a._UZ(0,"app-docxtemplate")},directives:[Y],styles:[""]}),t})();var C=n(15265);let S=(()=>{class t{constructor(t){this.plus=t}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)(a.Y36(y.T))},t.\u0275cmp=a.Xpm({type:t,selectors:[["app-ma-vat-tu"]],decls:2,vars:0,template:function(t,e){1&t&&(a.TgZ(0,"p"),a._uU(1,"ma-vat-tu works!"),a.qZA())},styles:[""]}),t})();function D(t,e){if(1&t){const t=a.EpF();a.TgZ(0,"div",7),a.TgZ(1,"div",8),a.TgZ(2,"span",9),a._uU(3,"T\xean file"),a.qZA(),a.qZA(),a._UZ(4,"input",10),a.TgZ(5,"div",11),a.TgZ(6,"button",12),a.NdJ("click",function(){return a.CHM(t),a.oxw().copyInputMessage("userinput")}),a._UZ(7,"i",13),a._uU(8,"Copy"),a.qZA(),a.qZA(),a.qZA()}if(2&t){const t=a.oxw();a.xp6(4),a.s9C("value",t.html)}}let E=(()=>{class t{constructor(t){this.plus=t,this.html=""}ngOnInit(){}createKey(t){const e=t.target.value.trim(),n=Date.now();this.html=this.plus.dateFormat(n,"yyyyMMDD")+"-XL-"+this.plus.generateKey(e)}copyInputMessage(t){this.plus.copyInputMessage(t)}getBarcode(t){this.xx=t}reset(t){return t.target.value=""}}return t.\u0275fac=function(e){return new(e||t)(a.Y36(y.T))},t.\u0275cmp=a.Xpm({type:t,selectors:[["app-generate-key"]],inputs:{qrResultString:"qrResultString"},decls:9,vars:2,consts:[[1,"container"],[1,"form-group"],[1,"text-center","text-white","p-3","my-3","bg-primary","rounded-pill","justify-content-center"],["placeholder","D\xe1n n\u1ed9i dung v\xe0o \u0111\xe2y","rows","2",1,"form-control",3,"click","change"],["input1",""],["class","input-group mb-3",4,"ngIf"],[1,"html",3,"innerHTML"],[1,"input-group","mb-3"],[1,"input-group-prepend"],[1,"input-group-text"],["type","text","readonly","","id","userinput",1,"form-control",3,"value"],[1,"input-group-append"],["type","button",1,"btn","btn-outline-primary","btn-sm",3,"click"],[1,"fa","fa-copy"]],template:function(t,e){1&t&&(a.TgZ(0,"div",0),a.TgZ(1,"div",1),a.TgZ(2,"h4",2),a._uU(3,"Chuy\u1ec3n \u0111\u1ed5i t\xean file v\u0103n b\u1ea3n chu\u1ea9n IT"),a.qZA(),a.TgZ(4,"textarea",3,4),a.NdJ("click",function(t){return e.reset(t)})("change",function(t){return e.createKey(t)}),a._uU(6,"  "),a.qZA(),a.qZA(),a.YNc(7,D,9,1,"div",5),a._UZ(8,"div",6),a.qZA()),2&t&&(a.xp6(7),a.Q6J("ngIf",e.html),a.xp6(1),a.Q6J("innerHTML",e.html,a.oJD))},directives:[s.O5],styles:[""]}),t})();var H=n(92340);function O(t,e){if(1&t&&(a.TgZ(0,"table",12),a.TgZ(1,"thead"),a.TgZ(2,"tr"),a.TgZ(3,"th"),a._uU(4,"S\u1ed1 k\xfd hi\u1ec7u "),a.qZA(),a.TgZ(5,"th"),a._uU(6,"Ng\xe0y VB"),a.qZA(),a.TgZ(7,"th"),a._uU(8,"Tr\xedch y\u1ebfu"),a.qZA(),a.qZA(),a.qZA(),a.TgZ(9,"tbody"),a.TgZ(10,"tr"),a.TgZ(11,"td",13),a._uU(12),a.qZA(),a.TgZ(13,"td"),a._uU(14),a.qZA(),a.TgZ(15,"td"),a._uU(16),a.qZA(),a.qZA(),a.qZA(),a.qZA()),2&t){const t=a.oxw();a.xp6(12),a.Oqu(t.id),a.xp6(2),a.Oqu(t.date),a.xp6(2),a.Oqu(t.body)}}function F(t,e){if(1&t){const t=a.EpF();a.TgZ(0,"div",14),a.TgZ(1,"div",15),a.TgZ(2,"span",16),a._uU(3,"T\xean file"),a.qZA(),a.qZA(),a.TgZ(4,"input",17),a.NdJ("click",function(){return a.CHM(t),a.oxw().copyInput("userinput")}),a.qZA(),a.qZA()}if(2&t){const t=a.oxw();a.xp6(4),a.s9C("value",t.fileName)}}let X=(()=>{class t{constructor(t,e){this.plus=t,this.fb=e,this.test=!H.N.production,this.testBody={_id:123,dateModify:123,status:456,canEdit:122},this.testData=[],this.input="Vui l\xf2ng copy n\u1ed9i dung v\xe0o ",this.arr=[17,24],this.output="",this.date="",this.id="",this.body="",this.show=!1,this.fileName=""}ngOnInit(){}onChange2(t){let e="",n="",r="",i="",o=t.target.value.trim();const s=o.search(/ : /gim);let c=o.slice(0,s).trim();switch(c){case"CTY TNHH MTV \u0110I\u1ec6N L\u1ef0C \u0110\u1ed2NG NAI":i=c.replace("CTY TNHH MTV \u0110I\u1ec6N L\u1ef0C \u0110\u1ed2NG NAI","C\xf4ng ty TNHH m\u1ed9t th\xe0nh vi\xean \u0110i\u1ec7n l\u1ef1c \u0110\u1ed3ng Nai");break;case"UBND huy\u1ec7n Xu\xe2n L\u1ed9c":i=c.replace("KD","UBND huy\u1ec7n Xu\xe2n L\u1ed9c")}n=o.slice(s+2,o.search(/\n/gim)).trim().replace("  "," ").replace("..",".").replace(/V\/v/gim,"").replace(/PH\xc1T \u0110\u1ed8NG PHONG TR\xc0O THI \u0110UA/gim,"Ph\xe1t \u0111\u1ed9ng phong tr\xe0o thi \u0111ua").replace(/V\u1ec1 vi\u1ec7c/,"");let a=o.search(/Ng\xe0y v\u0103n b\u1ea3n: /gim);r=o.slice(a+14,a+14+10).trim(),e=o.slice(o.search(/\t\d/gm),o.search(/\t\d*\t/gm)).trim();const l=`\tTh\u1ef1c hi\u1ec7n v\u0103n b\u1ea3n s\u1ed1 ${e} ng\xe0y ${r} c\u1ee7a ${i} v\u1ec1 vi\u1ec7c ${n}.`;return this.fileName=this.plus.dateFormat(r,"YYYYMMDD","DD/MM/YYYY")+"-"+this.plus.removeAccents2(e)+"-"+this.plus.generateKey(n),this.body=n,this.date=r,this.id=e,this.output=l}onChange(t){let e=this.input;console.log(e),e.replace(/V\/v/i,""),e.replace(/V\u1ec1 vi\u1ec7c/i,""),this.input=e;const n=/: V\u1ec1 vi\u1ec7c/gim,r=/\b : +V\/v/gim;let i=0,o=0;e.search(n)>0?(i=e.search(n),o=i+10):e.search(r)>0?(i=e.search(r),o=i+6):(i=e.search(/\: /gm),o=i+2);const s=e.search(/\n/gm),c=e.search(/\d{2}\/\d{2}\/\d{4}/gm),a=e.search(/\t(?=\d)/gm)+1;this.date=e.slice(c,c+10),this.id=e.slice(a,e.length),this.body=e.slice(o,s-1).replace(/PH\xc1T \u0110\u1ed8NG PHONG TR\xc0O THI \u0110UA/i,"Phong tr\xe0o thi \u0111ua");let l=`\t Th\u1ef1c hi\u1ec7n v\u0103n b\u1ea3n s\u1ed1 ${e.slice(a,e.length)} ng\xe0y ${e.slice(c,c+10)} c\u1ee7a ${e.slice(0,i-1)} v\u1ec1 vi\u1ec7c ${e.slice(o,s-1)}.`;if(i>0&&s>0&&c>0&&a>0){const t=l.replace(/CTY TNHH MTV \u0110I\u1ec6N L\u1ef0C \u0110\u1ed2NG NAI/i,"C\xf4ng ty TNHH m\u1ed9t th\xe0nh vi\xean \u0110i\u1ec7n l\u1ef1c \u0110\u1ed3ng Nai").replace(/PH\xc1T \u0110\u1ed8NG PHONG TR\xc0O THI \u0110UA/i,"Ph\xe1t \u0111\u1ed9ng phong tr\xe0o thi \u0111ua"),e=t.replace(/PH\xc1T \u0110\u1ed8NG Phong/g,"Ph\xe1t \u0111\u1ed9ng phong");return console.log(e),this.show=!0,this.output=t}this.output="B\u1ea1n vui l\xf2ng copy th\xf4ng tin tr\xean Eoffice 3.0"}parseOffice(t){t.target.value.trim()}createKey(t){const e=t.target.value.trim(),n=Date.now();this.fileName=this.plus.dateFormat(n,"yyyyMMDD","DD/MM/YYYY")+"-XL-"+this.plus.generateKey(e)}copyInput(t){this.plus.copyInputMessage(t)}reset(){this.input="",this.output="",this.date="",this.id="",this.body="",this.show=!1}post(){this.plus.httpPost("test",this.testBody).subscribe(t=>{console.log(t)},t=>this.plus.alertError)}put(){this.plus.httpPut("test",this.testBody).subscribe(t=>{console.log(t)},t=>this.plus.alertError)}delete(t){this.plus.httpDelete("test",t).subscribe(t=>{console.log(t)},t=>this.plus.alertError)}}return t.\u0275fac=function(e){return new(e||t)(a.Y36(y.T),a.Y36(r.qu))},t.\u0275cmp=a.Xpm({type:t,selectors:[["app-office3"]],decls:15,vars:4,consts:[[1,"container"],[1,"form-group"],["for",""],["placeholder","Copy th\xf4ng tin tr\xean Eoffice 3.0 t\u1eeb m\u1ee5c 'N\u01a1i g\u1eedi/Tr\xedch y\u1ebfu'\t\u0111\u1ebfn 'B\u1ed5 sung v\u0103n b\u1ea3n v\xe0o HSTL' v\xe0 d\xe1n v\xe0o \u0111\xe2y","rows","6",1,"form-control",3,"ngModel","click","ngModelChange","change"],["input1",""],[1,"text-center"],["type","button",1,"btn","btn-success","mx-5","my-3","px-4"],[1,"out1"],["placeholder","Xong b\u1ea5m v\xe0o \u0111\xe2y \u0111\u1ec3 copy n\u1ed9i dung","rows","4","id","output1","readonly","",1,"form-control",3,"value"],["type","button",1,"btn","btn-outline-primary",3,"click"],["class","table bordered",4,"ngIf"],["class","input-group mb-3",4,"ngIf"],[1,"table","bordered"],["scope","row"],[1,"input-group","mb-3"],[1,"input-group-prepend"],[1,"input-group-text"],["type","text","readonly","","id","userinput",1,"form-control",3,"value","click"]],template:function(t,e){1&t&&(a.TgZ(0,"div",0),a.TgZ(1,"div",1),a._UZ(2,"label",2),a.TgZ(3,"textarea",3,4),a.NdJ("click",function(){return e.reset()})("ngModelChange",function(t){return e.input=t})("change",function(t){return e.onChange2(t)}),a.qZA(),a.qZA(),a.TgZ(5,"div",5),a.TgZ(6,"button",6),a._uU(7,"OK"),a.qZA(),a.qZA(),a.TgZ(8,"div",7),a._UZ(9,"textarea",8),a.qZA(),a.TgZ(10,"button",9),a.NdJ("click",function(){return e.reset()}),a._uU(11,"Reset"),a.qZA(),a.YNc(12,O,17,3,"table",10),a.qZA(),a._UZ(13,"hr"),a.YNc(14,F,5,1,"div",11)),2&t&&(a.xp6(3),a.Q6J("ngModel",e.input),a.xp6(6),a.s9C("value",e.output),a.xp6(3),a.Q6J("ngIf",e.id),a.xp6(2),a.Q6J("ngIf",e.fileName))},directives:[r.Fj,r.JJ,r.On,s.O5],styles:[""]}),t})();var B=n(33982);let P=(()=>{class t{constructor(t){this.plus=t}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)(a.Y36(y.T))},t.\u0275cmp=a.Xpm({type:t,selectors:[["app-ultis"]],decls:0,vars:0,template:function(t,e){},styles:[""]}),t})();var $=n(41258),L=n(29726);class Q{constructor(t){this.loader=t}upload(){return this.loader.file.then(t=>new Promise((e,n)=>{var r=new FileReader;r.onloadend=t=>{e({default:r.result})},r.readAsDataURL(t)}))}readThis(t){return console.log(t),new Promise((e,n)=>{var r=new FileReader;r.onloadend=t=>{let e=r.result;return console.log(e),{default:"data:image/png;base64,"+e}},r.readAsDataURL(t)})}}var R=n(50166);const K=["myEditor"];let G=(()=>{class t{constructor(){this.htmlContent=new a.vpe,this.Editor=L}ngOnInit(){this.htmlContent.emit("Xin ch\xe0o")}onReady(t){t.ui.getEditableElement().parentElement.insertBefore(t.ui.view.toolbar.element,t.ui.getEditableElement()),t.plugins.get("FileRepository").createUploadAdapter=t=>(console.log(btoa(t.file)),new Q(t))}saveArticle(){let t=this.getArticleContent();localStorage.setItem("ckeditor-base64",t),this.htmlContent.emit(t)}getArticleContent(){return this.myEditor&&this.myEditor.editorInstance?this.myEditor.editorInstance.getData():""}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=a.Xpm({type:t,selectors:[["app-ck-editor-base64"]],viewQuery:function(t,e){if(1&t&&a.Gf(K,5),2&t){let t;a.iGM(t=a.CRH())&&(e.myEditor=t.first)}},inputs:{inHtml:"inHtml"},outputs:{htmlContent:"htmlContent"},decls:5,vars:2,consts:[[1,"container"],[1,"text-center","text-primary"],[3,"editor","data","ready","change"],["myEditor",""]],template:function(t,e){1&t&&(a.TgZ(0,"div",0),a.TgZ(1,"h4",1),a._uU(2,"So\u1ea1n th\u1ea3o code HTML"),a.qZA(),a.TgZ(3,"ckeditor",2,3),a.NdJ("ready",function(t){return e.onReady(t)})("change",function(){return e.saveArticle()}),a.qZA(),a.qZA()),2&t&&(a.xp6(3),a.s9C("data",e.inHtml),a.Q6J("editor",e.Editor))},directives:[R.u],styles:[""]}),t})(),V=(()=>{class t{constructor(){this.html="Xin ch\xe0o"}ngOnInit(){}getHtml(t){this.html=t}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=a.Xpm({type:t,selectors:[["app-html-content"]],decls:7,vars:3,consts:[[1,"container","my-3"],[3,"inHtml","htmlContent"],[1,"row"],[1,"review",3,"innerHTML"]],template:function(t,e){1&t&&(a.TgZ(0,"div",0),a.TgZ(1,"app-ck-editor-base64",1),a.NdJ("htmlContent",function(t){return e.getHtml(t)}),a.qZA(),a._UZ(2,"hr"),a.TgZ(3,"div",2),a.TgZ(4,"p"),a._uU(5),a.qZA(),a.qZA(),a._UZ(6,"div",3),a.qZA()),2&t&&(a.xp6(1),a.Q6J("inHtml",e.html),a.xp6(4),a.Oqu(e.html),a.xp6(1),a.Q6J("innerHTML",e.html,a.oJD))},directives:[G],styles:[""]}),t})();var j=n(1442);let z=(()=>{class t{constructor(t){this.plus=t}canActivate(){return this.plus.checkPer("merge")}}return t.\u0275fac=function(e){return new(e||t)(a.LFG(y.T))},t.\u0275prov=a.Yz7({token:t,factory:t.\u0275fac}),t})(),W=(()=>{class t{constructor(t){this.plus=t}canActivate(){return this.plus.checkPer("dieu-phoi")}}return t.\u0275fac=function(e){return new(e||t)(a.LFG(y.T))},t.\u0275prov=a.Yz7({token:t,factory:t.\u0275fac}),t})();const tt=[{path:"",component:P},{path:"office",component:X},{path:"ten-file",component:E},{path:"ma-vat-tu",component:S},{path:"barcode",component:C.O},{path:"barcode-generate",component:j.i},{path:"parse-excel",component:$.K},{path:"html",component:V},{path:"merge",component:J,canActivate:[z]}];let et=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=a.oAB({type:t}),t.\u0275inj=a.cJS({providers:[z,W],imports:[[B.Bz.forChild(tt)],B.Bz]}),t})();var nt=n(11596),rt=n(88817);let it=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=a.oAB({type:t}),t.\u0275inj=a.cJS({imports:[[s.ez,r.u5,et,i.qX,nt.k,p.u,u.o,l,c.X,rt.ShareModule]]}),t})()}}]);