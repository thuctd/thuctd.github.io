(self.webpackChunk_4la=self.webpackChunk_4la||[]).push([[28],{97534:function(t,e,s){"use strict";s.d(e,{F:function(){return o}});var n=s(61511),i=s(31572);let o=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=i.oAB({type:t}),t.\u0275inj=i.cJS({imports:[[n.ez]]}),t})()},69121:function(t,e,s){"use strict";s.d(e,{t:function(){return l}});var n=s(82393),i=s(31153),o=s(31572),r=s(15980),a=s(61511);function c(t,e){if(1&t){const t=o.EpF();o.TgZ(0,"button",0),o.NdJ("click",function(){return o.CHM(t),o.oxw().exportToJsonFile()}),o._uU(1,"Export Json"),o.qZA()}}let l=(()=>{class t{constructor(t){this.plus=t}ngOnInit(){}export(){const t=[];this.dataJson.forEach(e=>{delete e.dateModify,delete e.status,delete e.canEdit,delete e.keyWord,delete e.__v,t.push(e)});const e=i.utils.json_to_sheet(t),s=i.utils.book_new();i.utils.book_append_sheet(s,e,"Sheet1"),i.writeFile(s,"4la-"+Date.now()+".xlsx")}exportToJsonFile(){for(let i=0;i<this.dataJson.length;i++)delete this.dataJson[i].dateModify,delete this.dataJson[i].canEdit,delete this.dataJson[i].keyWord;let t=JSON.stringify(this.dataJson),e="data:application/json;charset=utf-8,"+encodeURIComponent(t),s="4la-"+Date.now()+".json",n=document.createElement("a");n.setAttribute("href",e),n.setAttribute("download",s),n.click()}check(){return this.plus.checkPer("admin",4)}}return t.\u0275fac=function(e){return new(e||t)(o.Y36(n.T))},t.\u0275cmp=o.Xpm({type:t,selectors:[["app-export-ecxel"]],inputs:{dataJson:"dataJson"},decls:3,vars:1,consts:[["mat-raised-button","","color","primary",3,"click"],["mat-raised-button","","color","primary",3,"click",4,"ngIf"]],template:function(t,e){1&t&&(o.TgZ(0,"button",0),o.NdJ("click",function(){return e.export()}),o._uU(1,"Export"),o.qZA(),o.YNc(2,c,2,0,"button",1)),2&t&&(o.xp6(2),o.Q6J("ngIf",e.check()))},directives:[r.lW,a.O5],styles:[""]}),t})()},78477:function(t,e,s){"use strict";s.d(e,{y:function(){return g}});var n=s(7171),i=s(82393),o=s(31153),r=s(31572),a=s(15980),c=s(61511);function l(t,e){1&t&&(r.TgZ(0,"label",11),r._uU(1," Ch\u1ecdn file "),r._UZ(2,"i",12),r.qZA())}function u(t,e){if(1&t&&(r.TgZ(0,"td",16),r._uU(1),r.qZA()),2&t){const t=r.oxw().$implicit;r.xp6(1),r.hij(" ",t.err||"","")}}function h(t,e){if(1&t&&(r.TgZ(0,"tr"),r.YNc(1,u,2,1,"td",15),r.qZA()),2&t){const t=e.$implicit;r.Q6J("@slideIn",void 0),r.xp6(1),r.Q6J("ngIf",t.err)}}function p(t,e){if(1&t&&(r.TgZ(0,"table",13),r.TgZ(1,"h4"),r._uU(2,"L\u1ed7i d\u1eef li\u1ec7u file import"),r.qZA(),r.TgZ(3,"tbody"),r.YNc(4,h,2,2,"tr",14),r.qZA(),r.qZA()),2&t){const t=r.oxw(2);r.xp6(4),r.Q6J("ngForOf",t.errorData.length>0?t.errorData:t.dataJson)}}function d(t,e){if(1&t){const t=r.EpF();r.TgZ(0,"button",17),r.NdJ("click",function(){return r.CHM(t),r.oxw(2).import()}),r._uU(1,"Import"),r.qZA()}}function f(t,e){if(1&t){const t=r.EpF();r.TgZ(0,"button",18),r.NdJ("click",function(){return r.CHM(t),r.oxw(2).reload()}),r._uU(1,"L\xe0m l\u1ea1i"),r.qZA()}}function m(t,e){if(1&t){const t=r.EpF();r.TgZ(0,"div",2),r.TgZ(1,"a",3),r._uU(2,"File import m\u1eabu"),r.qZA(),r.TgZ(3,"h4",4),r._uU(4,"Import t\u1eeb file excel"),r.qZA(),r.YNc(5,l,3,0,"label",5),r.TgZ(6,"input",6),r.NdJ("change",function(e){return r.CHM(t),r.oxw().readXlsx(e)}),r.qZA(),r.TgZ(7,"a",3),r._uU(8,"File import m\u1eabu"),r.qZA(),r.YNc(9,p,5,1,"table",7),r.TgZ(10,"div",8),r.YNc(11,d,2,0,"button",9),r.YNc(12,f,2,0,"button",10),r.qZA(),r.qZA()}if(2&t){const t=r.oxw();r.xp6(1),r.MGl("href","https://github.com/thuctd/FileStore/raw/master/templates/",t.api,".xlsx",r.LSH),r.xp6(4),r.Q6J("ngIf",0===t.dataJson.length),r.xp6(2),r.MGl("href","https://github.com/thuctd/FileStore/raw/master/templates/",t.api,".xlsx",r.LSH),r.xp6(2),r.Q6J("ngIf",t.errorData.length>0),r.xp6(2),r.Q6J("ngIf",t.checkPer(4)&&0==t.errorData.length&&t.dataJson.length>0),r.xp6(1),r.Q6J("ngIf",t.checkPer(1))}}let g=(()=>{class t{constructor(t){this.plus=t,this.dataImport=[],this.dataJson=[],this.errorData=[],this.show=!1}ngOnInit(){this.dataJson=[],this.dataImport=[]}readXlsx(t){this.plus.load();let e=t.target;const s=new FileReader;s.onload=t=>{const e=o.read(t.target.result,{type:"binary"});this.dataImport=o.utils.sheet_to_json(e.Sheets[e.SheetNames[0]],{header:1}),this.selectedFile(this.dataImport),this.plus.loaded()},s.readAsBinaryString(e.files[0]),e=null}selectedFile(t){console.log(t.length);for(let e=1;e<t.length;e++){const s={};t[0].forEach((n,i)=>{s[`${n}`]=t[e][i]}),this.form.patchValue(this.plus.Obj_clean(s));const n=s;this.form.valid?(n.dateModify=Date.now()+e,n.keyWord=this.plus.generateKeyWord(n),this.dataJson.push(n)):(n.err=`T\u1ea1i h\xe0ng ${e}: ${this.plus.getErrValidateForm(this.form)}`,this.errorData.push(s))}}import(){return t=this,void 0,s=function*(){if(this.dataJson.length>2e3)return void this.plus.alertWarning("Vui l\xf2ng import s\u1ed1 l\u01b0\u1ee3ng d\u01b0\u1edbi 2000 s\u1ea3n ph\u1ea9m/l\u1ea7n");console.log(this.dataJson);const t=this.dataJson.length;let e=0,s=!1;const n=this.dataJson;for(;e<t;){let t=n.slice(e,e+200);if(console.log(e,t),yield this.plus.httpImport(this.api,t).then(t=>{e+=200}).catch(t=>{console.log(t),s=!0}),yield this.plus.sleep(3e3).then(t=>{console.log("sleep",e)}),s)break}this.plus.FBS_PostByUser(this.api,this.plus.Arr_MaxValue(this.dataJson)),this.plus.FBS_PostByUser(this.api,this.plus.Arr_MaxValue(this.dataJson),!0),this.plus.alertSuccess("Import th\xe0nh c\xf4ng!"),this.plus.reload("taikhoan")},new((e=void 0)||(e=Promise))(function(n,i){function o(t){try{a(s.next(t))}catch(e){i(e)}}function r(t){try{a(s.throw(t))}catch(e){i(e)}}function a(t){var s;t.done?n(t.value):(s=t.value,s instanceof e?s:new e(function(t){t(s)})).then(o,r)}a((s=s.apply(t,[])).next())});var t,e,s}checkPer(t){return this.plus.checkPer(this.api,t)}reload(){return this.plus.reload(this.dbName+"/"+this.api)}}return t.\u0275fac=function(e){return new(e||t)(r.Y36(i.T))},t.\u0275cmp=r.Xpm({type:t,selectors:[["app-import-database"]],inputs:{form:"form",api:"api",dbName:"dbName"},decls:3,vars:1,consts:[["mat-raised-button","","href","","color","accent",3,"click"],["class","import",4,"ngIf"],[1,"import"],["target","_blank",1,"badge","badge-warning",3,"href"],[1,"text-center","text-white","py-2","my-3","bg-primary","rounded-pill","justify-content-center"],["for","file-import","class","custom-file-upload text-primary mx-5",4,"ngIf"],["hidden","","id","file-import","type","file","multiple","false",3,"change"],["class","table table-inverse table-responsive",4,"ngIf"],[1,"text-center","mx-3"],["class","text-center mx-3","mat-raised-button","","color","accent",3,"click",4,"ngIf"],["class","text-center mx-3","mat-raised-button","","color","primary",3,"click",4,"ngIf"],["for","file-import",1,"custom-file-upload","text-primary","mx-5"],["aria-hidden","true",1,"fa","fa-file-excel-o","fa-2x","text-success"],[1,"table","table-inverse","table-responsive"],[4,"ngFor","ngForOf"],["class","text-danger",4,"ngIf"],[1,"text-danger"],["mat-raised-button","","color","accent",1,"text-center","mx-3",3,"click"],["mat-raised-button","","color","primary",1,"text-center","mx-3",3,"click"]],template:function(t,e){1&t&&(r.TgZ(0,"button",0),r.NdJ("click",function(){return e.show=!e.show}),r._uU(1,"Import Excel"),r.qZA(),r.YNc(2,m,13,6,"div",1)),2&t&&(r.xp6(2),r.Q6J("ngIf",e.show))},directives:[a.lW,c.O5,c.sg],styles:[""],data:{animation:[n.Y]}}),t})()},43552:function(t,e,s){"use strict";s.d(e,{D:function(){return a}});var n=s(35845),i=s(61511),o=s(16073),r=s(31572);let a=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=r.oAB({type:t}),t.\u0275inj=r.cJS({imports:[[i.ez,o.u5,n.q]]}),t})()},89274:function(t,e,s){"use strict";s.d(e,{W:function(){return x}});var n=s(31572),i=s(16073),o=s(47701),r=s(79996),a=s(56998),c=s(47727),l=s(82393),u=s(29063),h=s(66283),p=s(26756),d=s(61511),f=s(15980),m=s(43691);function g(t,e){if(1&t){const t=n.EpF();n.TgZ(0,"button",4),n.NdJ("click",function(){return n.CHM(t),n.oxw().reset()}),n.TgZ(1,"mat-icon"),n._uU(2,"x"),n.qZA(),n.qZA()}}let x=(()=>{class t{constructor(t,e,s){this.plus=t,this.fb=e,this.http=s,this.data=new n.vpe,this.searchtxt=this.plus.search.getValue().what,this.searchForm=this.fb.group({what:["",[i.kI.required,i.kI.minLength(3),i.kI.maxLength(100)]]})}ngOnInit(){this.find()}find(){this.searchForm.valueChanges.pipe((0,o.b)(1e3)).subscribe(t=>{this.searchForm.valid?(this.plus.load(),t.what=this.plus.removeAccents(t.what),this.plus.search.next(t),this.httpPost(this.api+"/find",t).subscribe(t=>{t.data&&this.data.emit(this.plus.Crypt_DecryptRest(t)),this.plus.alertToasrt(t)},t=>this.reset())):this.plus.loaded()})}reset(){this.plus.loaded(),this.searchForm.reset()}httpPost(t,e){return console.log("%FIND -> "+t,"font-style: italic; color:green",e),this.http.post(this.plus.getApiUrl(t),e,this.plus.getHeader()).pipe((0,r.U)(s=>(this.plus.logger(t+"PUT",e),s)),(0,a.X)(1),(0,c.K)(s=>{throw this.plus.loaded(),this.plus.alertError("Kh\xf4ng c\xf3 ph\u1ea3n h\u1ed3i!"),this.plus.logger(t+"POST",e,!1),s}))}}return t.\u0275fac=function(e){return new(e||t)(n.Y36(l.T),n.Y36(i.qu),n.Y36(u.eN))},t.\u0275cmp=n.Xpm({type:t,selectors:[["app-search-api"]],inputs:{api:"api"},outputs:{data:"data"},decls:6,vars:2,consts:[[1,"form-group","search",3,"formGroup"],[1,"example-form-field"],["matInput","","type","text","formControlName","what"],["mat-button","","matSuffix","","mat-icon-button","",3,"click",4,"ngIf"],["mat-button","","matSuffix","","mat-icon-button","",3,"click"]],template:function(t,e){1&t&&(n.TgZ(0,"div",0),n.TgZ(1,"mat-form-field",1),n.TgZ(2,"mat-label"),n._uU(3,"T\xecm ki\u1ebfm n\xe2ng cao"),n.qZA(),n._UZ(4,"input",2),n.YNc(5,g,3,0,"button",3),n.qZA(),n.qZA()),2&t&&(n.Q6J("formGroup",e.searchForm),n.xp6(5),n.Q6J("ngIf",e.searchForm.dirty))},directives:[i.JL,i.sg,h.KE,h.hX,p.Nt,i.Fj,i.JJ,i.u,d.O5,f.lW,h.R9,m.Hw],styles:[".search[_ngcontent-%COMP%]{width:300px;transition:width .4s ease-in-out}"]}),t})()}}]);