"use strict";(self.webpackChunk_4la=self.webpackChunk_4la||[]).push([[396],{30396:function(t,i,n){n.r(i),n.d(i,{DlxlModule:function(){return di}});var e=n(5923),o=n(48387),a=n(85913),s=n(88817),c=n(12057),r=n(15228),l=n(24751),u=n(16738),h=n.n(u),p=n(74788),d=n(57922),g=n(48842),m=n(9157),f=n(33982),Z=n(2895),T=n(49356),b=n(25862),x=n(46833),k=n(46113),q=n(12895);function I(t,i){if(1&t){const t=p.EpF();p.TgZ(0,"button",6),p.NdJ("click",function(){return p.CHM(t),p.oxw().returnList()}),p._uU(1,"Tr\u1ea3 l\u1ea1i"),p.qZA()}}function A(t,i){if(1&t){const t=p.EpF();p.TgZ(0,"button",6),p.NdJ("click",function(){return p.CHM(t),p.oxw().save()}),p._uU(1,"L\u01b0u"),p.qZA()}}function N(t,i){if(1&t){const t=p.EpF();p.TgZ(0,"button",7),p.NdJ("click",function(){return p.CHM(t),p.oxw().exportWord()}),p._uU(1,"Xu\u1ea5t b\xe1o c\xe1o"),p.qZA()}}function _(t,i){1&t&&(p.TgZ(0,"th"),p._uU(1,"Ch\u1ee7 t\xe0i kho\u1ea3n"),p.qZA())}function D(t,i){1&t&&(p.TgZ(0,"th"),p._uU(1,"S\u1ed1 t\xe0i kho\u1ea3n"),p.qZA())}function J(t,i){1&t&&(p.TgZ(0,"th"),p._uU(1,"Ng\xe2n h\xe0ng"),p.qZA())}function v(t,i){1&t&&(p.TgZ(0,"th"),p._uU(1,"Tr\u01b0\u1edbc thu\u1ebf"),p.qZA())}function w(t,i){1&t&&(p.TgZ(0,"th"),p._uU(1,"Thu\u1ebf"),p.qZA())}function M(t,i){if(1&t){const t=p.EpF();p.TgZ(0,"td",13),p.NdJ("click",function(){p.CHM(t);const i=p.oxw().$implicit;return p.oxw(2).onEdit(i)}),p._uU(1),p.qZA()}if(2&t){const t=p.oxw().$implicit;p.xp6(1),p.Oqu(t.ChuTaiKhoan)}}function y(t,i){if(1&t){const t=p.EpF();p.TgZ(0,"td",13),p.NdJ("click",function(){p.CHM(t);const i=p.oxw().$implicit;return p.oxw(2).onEdit(i)}),p._uU(1),p.qZA()}if(2&t){const t=p.oxw().$implicit;p.xp6(1),p.Oqu(t.SoTaiKhoan)}}function U(t,i){if(1&t){const t=p.EpF();p.TgZ(0,"td",13),p.NdJ("click",function(){p.CHM(t);const i=p.oxw().$implicit;return p.oxw(2).onEdit(i)}),p._uU(1),p.qZA()}if(2&t){const t=p.oxw().$implicit;p.xp6(1),p.Oqu(t.NganHang)}}function H(t,i){if(1&t&&(p.TgZ(0,"td",15),p._uU(1),p.ALo(2,"number"),p.qZA()),2&t){const t=p.oxw().$implicit;p.xp6(1),p.Oqu(p.lcZ(2,1,t.TruocThue))}}function C(t,i){if(1&t&&(p.TgZ(0,"td",15),p._uU(1),p.ALo(2,"number"),p.qZA()),2&t){const t=p.oxw().$implicit;p.xp6(1),p.Oqu(p.lcZ(2,1,t.Thue))}}function B(t,i){if(1&t){const t=p.EpF();p.TgZ(0,"mat-icon",23),p.NdJ("click",function(){p.CHM(t);const i=p.oxw().$implicit;return p.oxw(2).onDelete(i)}),p._uU(1,"delete"),p.qZA()}}function Q(t,i){if(1&t){const t=p.EpF();p.TgZ(0,"tr"),p.TgZ(1,"td",13),p.NdJ("click",function(){const i=p.CHM(t).$implicit;return p.oxw(2).onEdit(i)}),p._uU(2),p.qZA(),p.TgZ(3,"td",13),p.NdJ("click",function(){const i=p.CHM(t).$implicit;return p.oxw(2).onEdit(i)}),p._uU(4),p.qZA(),p.YNc(5,M,2,1,"td",14),p.YNc(6,y,2,1,"td",14),p.YNc(7,U,2,1,"td",14),p.TgZ(8,"td",13),p.NdJ("click",function(){const i=p.CHM(t).$implicit;return p.oxw(2).onEdit(i)}),p._uU(9),p.ALo(10,"number"),p.qZA(),p.TgZ(11,"td",15),p._uU(12),p.ALo(13,"number"),p.qZA(),p.YNc(14,H,3,3,"td",16),p.YNc(15,C,3,3,"td",16),p.TgZ(16,"td",15),p._uU(17),p.ALo(18,"number"),p.qZA(),p.TgZ(19,"td",15),p.TgZ(20,"span",17),p.NdJ("blur",function(i){const n=p.CHM(t).index;return p.oxw(2).changeLabel(i,n)}),p._uU(21),p.qZA(),p.qZA(),p.TgZ(22,"td",15),p.TgZ(23,"span",17),p.NdJ("blur",function(i){const n=p.CHM(t).index;return p.oxw(2).changeSeri(i,n)}),p._uU(24),p.qZA(),p.qZA(),p.TgZ(25,"td",18),p.TgZ(26,"mat-form-field"),p.TgZ(27,"input",19),p.NdJ("focus",function(){return p.CHM(t),p.MAs(30).open()})("dateChange",function(i){const n=p.CHM(t).index;return p.oxw(2).changeDate(i,n)}),p.qZA(),p._UZ(28,"mat-datepicker-toggle",20),p._UZ(29,"mat-datepicker",null,21),p.qZA(),p.qZA(),p.TgZ(31,"td"),p.YNc(32,B,2,0,"mat-icon",22),p.qZA(),p.qZA()}if(2&t){const t=i.$implicit,n=p.MAs(30),e=p.oxw(2);p.xp6(2),p.Oqu(t.MaKhachHang),p.xp6(2),p.Oqu(t.KhachHang),p.xp6(1),p.Q6J("Device",3),p.xp6(1),p.Q6J("Device",3),p.xp6(1),p.Q6J("Device",3),p.xp6(2),p.Oqu(p.lcZ(10,18,t.SanLuong)),p.xp6(3),p.Oqu(p.lcZ(13,20,t.DonGia)),p.xp6(2),p.Q6J("Device",3),p.xp6(1),p.Q6J("Device",3),p.xp6(2),p.Oqu(p.lcZ(18,22,t.TongTien)),p.xp6(3),p.Q6J("contentEditable",!0),p.xp6(1),p.hij(" ",t.KyHieuHoaDon,""),p.xp6(2),p.Q6J("contentEditable",!0),p.xp6(1),p.hij(" ",t.SoHoaDon," "),p.xp6(3),p.Q6J("matDatepicker",n)("value",t.NgayHoaDon),p.xp6(1),p.Q6J("for",n),p.xp6(4),p.Q6J("ngIf",e.checkPer(4))}}function Y(t,i){if(1&t){const t=p.EpF();p.TgZ(0,"table",8),p.TgZ(1,"thead",9),p.TgZ(2,"tr"),p.TgZ(3,"th"),p._uU(4,"M\xe3 kh\xe1ch h\xe0ng"),p.qZA(),p.TgZ(5,"th"),p._uU(6,"Kh\xe1ch h\xe0ng"),p.qZA(),p.YNc(7,_,2,0,"th",10),p.YNc(8,D,2,0,"th",10),p.YNc(9,J,2,0,"th",10),p.TgZ(10,"th"),p._uU(11,"S\u1ea3n l\u01b0\u1ee3ng"),p.qZA(),p.TgZ(12,"th"),p._uU(13,"\u0110\u01a1n gi\xe1"),p.qZA(),p.YNc(14,v,2,0,"th",10),p.YNc(15,w,2,0,"th",10),p.TgZ(16,"th"),p._uU(17,"T\u1ed5ng ti\u1ec1n"),p.qZA(),p.TgZ(18,"th"),p._uU(19,"K\xfd hi\u1ec7u h\xf3a \u0111\u01a1n"),p.qZA(),p.TgZ(20,"th"),p._uU(21,"S\u1ed1 h\xf3a \u0111\u01a1n"),p.qZA(),p.TgZ(22,"th"),p._uU(23,"Ng\xe0y h\xf3a \u0111\u01a1n"),p.qZA(),p.TgZ(24,"th"),p.TgZ(25,"mat-icon",11),p.NdJ("click",function(){return p.CHM(t),p.oxw().reload()}),p._uU(26,"cached"),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.TgZ(27,"tbody"),p.YNc(28,Q,33,24,"tr",12),p.qZA(),p.qZA()}if(2&t){const t=p.oxw();p.Q6J("@slideIn",void 0),p.xp6(7),p.Q6J("Device",3),p.xp6(1),p.Q6J("Device",3),p.xp6(1),p.Q6J("Device",3),p.xp6(5),p.Q6J("Device",3),p.xp6(1),p.Q6J("Device",3),p.xp6(13),p.Q6J("ngForOf",t.items.DanhSach)}}let S=(()=>{class t{constructor(t,i,n,e,o){this.plus=t,this.fb=i,this.rtSv=n,this.docxSv=e,this.route=o,this.main=this.fb.group({Email:[,[l.kI.required]],MaKhachHang:[,[l.kI.required]],KhachHang:[,[l.kI.required]],DiaChi:[,[l.kI.required]],MaGCS:[,[l.kI.required]],ChuTaiKhoan:[,[l.kI.required]],SoTaiKhoan:[,[l.kI.required]],NganHang:[,[l.kI.required]],Nam:[,[l.kI.required,l.kI.pattern("^[0-9]*$")]],Thang:[,[l.kI.required,l.kI.pattern("^[0-9]*$")]],SanLuong:[,[l.kI.required,l.kI.pattern("^[0-9]*$")]],DonGia:[,[l.kI.required,l.kI.pattern("^[0-9]*$")]],TruocThue:[,[l.kI.required,l.kI.pattern("^[0-9]*$")]],Thue:[,[l.kI.required,l.kI.pattern("^[0-9]*$")]],TongTien:[,[l.kI.required,l.kI.pattern("^[0-9]*$")]],KyHieuHoaDon:[,[l.kI.required,l.kI.minLength(3)]],SoHoaDon:[,[l.kI.required,l.kI.minLength(3)]],NgayHoaDon:[,[l.kI.required]],TrangThai:[,],DaGuiMail:[0]}),this.title="Chi ti\u1ebft b\u1ea3ng k\xea",this.global=!0,this.dbName="dien-luc",this.api="dmt-input",this.db=null,this.userId=this.plus.userId,this.usr=this.plus.usr,this.selectedItem=null,this.filter=[],this.chart=[],this.errors=[],this.wordFile=null}ngOnInit(){this.plus.setTiTle(this.title),this.plus.IDB_InitDB(this.dbName).subscribe(t=>function(t,i,n,e){return new(n||(n=Promise))(function(o,a){function s(t){try{r(e.next(t))}catch(i){a(i)}}function c(t){try{r(e.throw(t))}catch(i){a(i)}}function r(t){t.done?o(t.value):function(t){return t instanceof n?t:new n(function(i){i(t)})}(t.value).then(s,c)}r((e=e.apply(t,i||[])).next())})}(this,void 0,void 0,function*(){this.db=t,this.getIDB(),this.plus.updateRealtime(this.db,this.api,this.global),this.plus.updateAPi.subscribe(t=>{t&&this.getIDB()})}))}getIDB(){const t=this.route.snapshot.paramMap.get("id");this.plus.httpGet(this.api+"/"+t).subscribe(t=>{const i=this.plus.Crypt_DecryptRest(t);console.log(this.items,t),this.items=i})}changeDate(t,i){console.log(t.value,i),this.items.DanhSach[i].NgayHoaDon=t.value}changeLabel(t,i){console.log(t.target.innerText,i),this.items.DanhSach[i].KyHieuHoaDon=t.target.innerText}changeSeri(t,i){console.log(t.target.innerText,i),this.items.DanhSach[i].SoHoaDon=t.target.innerText}ngOnDestroy(){console.log("Destroy",this.api),this.plus.subs.unsubscribe(),this.rtSv.leaveRoom(this.api)}save(){const t=this.items;delete t.__v,this.plus.httpPut(this.api,t,this.global).subscribe(t=>{t.status&&this.plus.updateAPi.next(!0)})}completeBill(){}exportWord(){this.docxSv.loadFileUrl("https://thuctd.github.io/templates/BangKe-PTC.docx").then(t=>{this.docxSv.generateOne(this.items,t,"PTC").then(t=>{console.log(t)})})}returnList(){const t=prompt("L\xed do tr\u1ea3 h\u1ed3 s\u01a1?");if(0==t.length)return this.plus.alertWarning("B\u1ea1n ph\u1ea3i nh\u1eadp l\xed do tr\u1ea3 h\u1ed3 s\u01a1");const i=this.items;i.LichSuCapNhat.push(`${h()().format("DD/MM/YYYY HH:MM")}: Tr\u1ea3 l\u1ea1i h\u1ed3 s\u01a1, ${t}`),i.TrangThai=2,delete i.__v,this.plus.httpPut(this.api,i,this.global).subscribe(t=>{console.log(t)})}report(){}complete(){}onEdit(t){this.selectedItem=t;const i=this.plus.dateToHtmlObj(t,[""]);this.main.patchValue(i),this.plus.clickBtn("openModal")}onDelete(t){!confirm("B\u1ea1n mu\u1ed1n x\xf3a?")||(this.plus.load(),this.plus.httpDisable(this.api,t,this.global).then(t=>{this.plus.updateAPi.next(!0)}))}search(t){this.filter=t}find(t){this.items=t}checkPer(t){return this.plus.checkPer(this.api,t)}reload(){return this.plus.reload(this.dbName+"/"+this.api)}goBack(){this.plus.goBack()}changePage(t){}trackByFn(t,i){return i}resetDB(){this.plus.resetDB(this.db,this.api)}}return t.\u0275fac=function(i){return new(i||t)(p.Y36(d.T),p.Y36(l.qu),p.Y36(g.i),p.Y36(m.E),p.Y36(f.gz))},t.\u0275cmp=p.Xpm({type:t,selectors:[["app-nlmt-detail"]],decls:9,vars:5,consts:[[1,"container-fluid"],["id","back-btn","mat-raised-button","","color","primary",3,"click"],["mat-raised-button","","color","warn",3,"click",4,"ngIf"],["mat-raised-button","","color","accent",3,"click",4,"ngIf"],[1,"row"],["class","table table-hover",4,"ngIf"],["mat-raised-button","","color","warn",3,"click"],["mat-raised-button","","color","accent",3,"click"],[1,"table","table-hover"],[1,"thead-inverse"],[4,"Device"],["color","primary",3,"click"],[4,"ngFor","ngForOf"],[1,"align-middle",3,"click"],["class","align-middle",3,"click",4,"Device"],[1,"align-middle"],["class","align-middle",4,"Device"],[3,"contentEditable","blur"],[1,"align-text-top"],["matInput","",3,"matDatepicker","value","focus","dateChange"],["matSuffix","",3,"for"],["picker",""],["color","warn",3,"click",4,"ngIf"],["color","warn",3,"click"]],template:function(t,i){1&t&&(p.TgZ(0,"div",0),p.TgZ(1,"button",1),p.NdJ("click",function(){return i.goBack()}),p.TgZ(2,"mat-icon"),p._uU(3,"undo"),p.qZA(),p.qZA(),p.YNc(4,I,2,0,"button",2),p.YNc(5,A,2,0,"button",2),p.YNc(6,N,2,0,"button",3),p.TgZ(7,"div",4),p.YNc(8,Y,29,7,"table",5),p.qZA(),p.qZA()),2&t&&(p.xp6(1),p.Q6J("@slideIn",void 0),p.xp6(3),p.Q6J("ngIf",1==(null==i.items?null:i.items.TrangThai)),p.xp6(1),p.Q6J("ngIf",1==(null==i.items?null:i.items.TrangThai)),p.xp6(1),p.Q6J("ngIf",1==(null==i.items?null:i.items.TrangThai)),p.xp6(2),p.Q6J("ngIf",1==(null==i.items?null:i.items.TrangThai)))},directives:[Z.lW,T.Hw,c.O5,b.HP,c.sg,x.KE,k.Nt,q.hl,q.nW,x.R9,q.Mq],pipes:[c.JJ],styles:["span[_ngcontent-%COMP%]{text-align:center;display:block;border-bottom:dotted 1px}mat-form-field[_ngcontent-%COMP%]{padding:0!important}.mat-form-field-infix[_ngcontent-%COMP%]{width:100px!important}"],data:{animation:[r.Ym]}}),t})();var E=n(46936),F=n(23487),O=n(68042),$=n(55352),K=n(97012),P=n(73888);function L(t,i){if(1&t){const t=p.EpF();p.TgZ(0,"app-search-api",11),p.NdJ("data",function(i){return p.CHM(t),p.oxw().find(i)}),p.qZA()}if(2&t){const t=p.oxw();p.Q6J("api",t.api)}}function G(t,i){1&t&&(p.TgZ(0,"th"),p._uU(1,"Tr\u1ea1ng th\xe1i"),p.qZA())}function z(t,i){1&t&&(p.TgZ(0,"th"),p._uU(1,"L\u1ecbch s\u1eed c\u1eadp nh\u1eadt"),p.qZA())}function W(t,i){1&t&&(p.TgZ(0,"th"),p._uU(1,"Th\xe0nh ti\u1ec1n sau thu\u1ebf"),p.qZA())}function V(t,i){if(1&t&&(p.TgZ(0,"td",17),p._uU(1),p.ALo(2,"enum"),p.qZA()),2&t){const t=p.oxw().$implicit;p.s9C("routerLink",t._id),p.xp6(1),p.Oqu(p.xi3(2,2,t.TrangThai,"DMTTrangThai"))}}function j(t,i){if(1&t&&(p.TgZ(0,"td",17),p._uU(1),p.qZA()),2&t){const t=p.oxw().$implicit;p.s9C("routerLink",t._id),p.xp6(1),p.Oqu(t.LichSuCapNhat)}}function X(t,i){if(1&t&&(p.TgZ(0,"td",17),p._uU(1),p.ALo(2,"number"),p.qZA()),2&t){const t=p.oxw().$implicit;p.s9C("routerLink",t._id),p.xp6(1),p.Oqu(p.lcZ(2,2,t.ThanhTienSauThue))}}function R(t,i){if(1&t){const t=p.EpF();p.TgZ(0,"mat-icon",20),p.NdJ("click",function(){p.CHM(t);const i=p.oxw().$implicit;return p.oxw(2).onDelete(i)}),p._uU(1,"delete"),p.qZA()}}function tt(t,i){if(1&t&&(p.TgZ(0,"tr"),p.TgZ(1,"td",17),p._uU(2),p.qZA(),p.YNc(3,V,3,5,"td",18),p.YNc(4,j,2,2,"td",18),p.TgZ(5,"td",17),p._uU(6),p.ALo(7,"number"),p.qZA(),p.YNc(8,X,3,4,"td",18),p.TgZ(9,"td"),p.YNc(10,R,2,0,"mat-icon",19),p.qZA(),p.qZA()),2&t){const t=i.$implicit,n=p.oxw(2);p.xp6(1),p.s9C("routerLink",t._id),p.xp6(1),p.Oqu(t.TenBangKe),p.xp6(1),p.Q6J("Device",2),p.xp6(1),p.Q6J("Device",2),p.xp6(1),p.s9C("routerLink",t._id),p.xp6(1),p.Oqu(p.lcZ(7,8,t.TongPhatLen)),p.xp6(2),p.Q6J("Device",2),p.xp6(2),p.Q6J("ngIf",n.checkPer(4))}}function it(t,i){if(1&t){const t=p.EpF();p.TgZ(0,"table",12),p.TgZ(1,"thead",13),p.TgZ(2,"tr"),p.TgZ(3,"th"),p._uU(4,"T\xean b\u1ea3ng k\xea"),p.qZA(),p.YNc(5,G,2,0,"th",14),p.YNc(6,z,2,0,"th",14),p.TgZ(7,"th"),p._uU(8,"T\u1ed5ng ph\xe1t l\xean"),p.qZA(),p.YNc(9,W,2,0,"th",14),p.TgZ(10,"th"),p.TgZ(11,"mat-icon",15),p.NdJ("click",function(){return p.CHM(t),p.oxw().reload()}),p._uU(12,"cached"),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.TgZ(13,"tbody"),p.YNc(14,tt,11,10,"tr",16),p.qZA(),p.qZA()}if(2&t){const t=p.oxw();p.Q6J("@slideIn",void 0),p.xp6(5),p.Q6J("Device",2),p.xp6(1),p.Q6J("Device",2),p.xp6(3),p.Q6J("Device",2),p.xp6(5),p.Q6J("ngForOf",t.filter.length>0?t.filter:t.items.slice(0,10))("ngForTrackBy",t.trackByFn)}}function nt(t,i){if(1&t&&p._UZ(0,"app-import-database",21),2&t){const t=p.oxw();p.Q6J("api",t.api)("global",t.global)("form",t.main)}}function et(t,i){if(1&t&&p._UZ(0,"app-export-ecxel",22),2&t){const t=p.oxw();p.Q6J("dataJson",t.items)}}function ot(t,i){if(1&t){const t=p.EpF();p.TgZ(0,"button",23),p.NdJ("click",function(){return p.CHM(t),p.oxw().resetDB()}),p._uU(1,"X\xf3a to\xe0n b\u1ed9 d\u1eef li\u1ec7u"),p.qZA()}}const at=function(){return[5,10,25,100]};let st=(()=>{class t{constructor(t,i,n){this.plus=t,this.fb=i,this.rtSv=n,this.main=this.fb.group({keyWord:[,[]],_id:[,[]],TenBangKe:[,[l.kI.required]],TrangThai:[,[l.kI.required]],LichSuCapNhat:[,[l.kI.required]],TongPhatLen:[,[l.kI.required,l.kI.pattern("^[0-9]*$")]],ThanhTienTruocThue:[,[l.kI.required,l.kI.pattern("^[0-9]*$")]],Thue:[,[l.kI.required,l.kI.pattern("^[0-9]*$")]],ThanhTienSauThue:[,[l.kI.required,l.kI.pattern("^[0-9]*$")]],DanhSach:[,[l.kI.required]]}),this.title="L\u1eadp b\u1ea3ng k\xea",this.global=!0,this.dbName="dien-luc",this.api="dmt-input",this.db=null,this.userId=this.plus.userId,this.usr=this.plus.usr,this.items=[],this.selectedItem=null,this.filter=[],this.chart=[],this.errors=[]}ngOnInit(){this.plus.setTiTle(this.title),this.plus.IDB_InitDB(this.dbName).subscribe(t=>function(t,i,n,e){return new(n||(n=Promise))(function(o,a){function s(t){try{r(e.next(t))}catch(i){a(i)}}function c(t){try{r(e.throw(t))}catch(i){a(i)}}function r(t){t.done?o(t.value):function(t){return t instanceof n?t:new n(function(i){i(t)})}(t.value).then(s,c)}r((e=e.apply(t,i||[])).next())})}(this,void 0,void 0,function*(){this.db=t,this.getIDB(),this.plus.updateRealtime(this.db,this.api,this.global),this.plus.updateAPi.subscribe(t=>{t&&this.getIDB()})}))}getIDB(){this.filter=[],this.plus.updateDB(this.db,this.api,this.global),this.plus.IDB_DB_GetAll(this.db,this.api).subscribe(t=>{this.items=t})}ngOnDestroy(){console.log("Destroy",this.api),this.plus.subs.unsubscribe(),this.rtSv.leaveRoom(this.api)}save(){if(this.main.invalid)return;const t=this.main.value,i=this.plus.datetoNumObj(this.main.value,[""]);if(console.log(i),null==t._id)delete t._id,this.plus.httpPost(this.api,i,this.global).subscribe(t=>{t.status&&(this.plus.clickBtn("closeModal"),this.plus.updateAPi.next(!0))});else{const n=this.plus.objVs(this.selectedItem,t);if(0===Object.keys(n).length)return this.plus.alertMatSnackBar("Kh\xf4ng c\xf3 n\u1ed9i dung n\xe0o thay \u0111\u1ed5i");this.plus.httpPut(this.api,i,this.global).subscribe(t=>{t.status&&(this.plus.updateAPi.next(!0),this.plus.clickBtn("closeModal"))})}}onEdit(t){this.selectedItem=t;const i=this.plus.dateToHtmlObj(t,[""]);this.main.patchValue(i),this.plus.clickBtn("openModal")}onDelete(t){!confirm("B\u1ea1n mu\u1ed1n x\xf3a?")||(this.plus.load(),this.plus.httpDisable(this.api,t,this.global).then(t=>{this.plus.updateAPi.next(!0)}))}chooseOpt(t,i,n,e=!1){this.main.controls[i].setValue(t[n]),e&&this.main.controls[i+"ID"].setValue(t._id)}closeModal(){this.main.reset()}search(t){this.filter=t}find(t){this.items=t}checkPer(t){return this.plus.checkPer(this.api,t)}patchForm(){this.main.reset({_id:" "})}reload(){return this.plus.reload(this.dbName+"/"+this.api)}goBack(){this.plus.goBack()}reset(){this.plus.loaded(),this.filter=[],this.getIDB(),this.main.reset({})}changePage(t){this.filter=this.items.slice(t.pageIndex*t.pageSize,(t.pageIndex+1)*t.pageSize)}ondragover(){document.getElementById("dropZone").setAttribute("drop-active","true")}trackByFn(t,i){return i}resetDB(){this.plus.resetDB(this.db,this.api)}}return t.\u0275fac=function(i){return new(i||t)(p.Y36(d.T),p.Y36(l.qu),p.Y36(g.i))},t.\u0275cmp=p.Xpm({type:t,selectors:[["app-nlmt-list"]],decls:15,vars:12,consts:[[1,"container"],["id","add-btn","color","accent","mat-raised-button","","routerLink","/dien-luc/dmt-input"],["id","back-btn","mat-raised-button","","color","primary",3,"click"],[3,"api","data",4,"ngIf"],[3,"db","api","filter"],[1,"row"],["class","table table-hover",4,"ngIf"],[3,"length","pageSize","pageSizeOptions","page"],[3,"api","global","form",4,"ngIf"],[3,"dataJson",4,"ngIf"],["mat-button","","color","warn",3,"click",4,"ngIf"],[3,"api","data"],[1,"table","table-hover"],[1,"thead-inverse"],[4,"Device"],["color","primary",3,"click"],[4,"ngFor","ngForOf","ngForTrackBy"],[3,"routerLink"],[3,"routerLink",4,"Device"],["color","warn",3,"click",4,"ngIf"],["color","warn",3,"click"],[3,"api","global","form"],[3,"dataJson"],["mat-button","","color","warn",3,"click"]],template:function(t,i){1&t&&(p.TgZ(0,"div",0),p.TgZ(1,"button",1),p.TgZ(2,"mat-icon"),p._uU(3,"control_point"),p.qZA(),p.qZA(),p.TgZ(4,"button",2),p.NdJ("click",function(){return i.goBack()}),p.TgZ(5,"mat-icon"),p._uU(6,"undo"),p.qZA(),p.qZA(),p.YNc(7,L,1,1,"app-search-api",3),p.TgZ(8,"app-search-table",4),p.NdJ("filter",function(t){return i.search(t)}),p.qZA(),p.TgZ(9,"div",5),p.YNc(10,it,15,6,"table",6),p.TgZ(11,"mat-paginator",7),p.NdJ("page",function(t){return i.changePage(t)}),p.qZA(),p.qZA(),p.YNc(12,nt,1,3,"app-import-database",8),p.YNc(13,et,1,1,"app-export-ecxel",9),p.qZA(),p.YNc(14,ot,2,0,"button",10)),2&t&&(p.xp6(4),p.Q6J("@slideIn",void 0),p.xp6(3),p.Q6J("ngIf",i.checkPer(10)),p.xp6(1),p.Q6J("db",i.db)("api",i.api),p.xp6(2),p.Q6J("ngIf",i.items.length+i.filter.length>0),p.xp6(1),p.Q6J("length",i.items.length)("pageSize",10)("pageSizeOptions",p.DdM(11,at)),p.xp6(1),p.Q6J("ngIf",i.checkPer(4)),p.xp6(1),p.Q6J("ngIf",i.checkPer(4)),p.xp6(1),p.Q6J("ngIf",i.checkPer(6)))},directives:[Z.lW,f.rH,T.Hw,c.O5,E.D,F.NW,O.W,b.HP,c.sg,$.y,K.t],pipes:[c.JJ,P.zZ],styles:[""],data:{animation:[r.Ym]}}),t})();var ct=n(31409),rt=n(7365),lt=n(51511),ut=n(89713),ht=function(t,i,n,e){return new(n||(n=Promise))(function(o,a){function s(t){try{r(e.next(t))}catch(i){a(i)}}function c(t){try{r(e.throw(t))}catch(i){a(i)}}function r(t){t.done?o(t.value):function(t){return t instanceof n?t:new n(function(i){i(t)})}(t.value).then(s,c)}r((e=e.apply(t,i||[])).next())})};function pt(t,i){if(1&t){const t=p.EpF();p.TgZ(0,"button",12),p.NdJ("click",function(){return p.CHM(t),p.oxw().reload()}),p.TgZ(1,"mat-icon"),p._uU(2,"undo"),p.qZA(),p.qZA()}2&t&&p.Q6J("@slideIn",void 0)}function dt(t,i){if(1&t){const t=p.EpF();p.TgZ(0,"section",13),p.TgZ(1,"form",14),p.TgZ(2,"mat-form-field",15),p.TgZ(3,"mat-label"),p._uU(4,"T\xean b\u1ea3ng k\xea"),p.qZA(),p._UZ(5,"input",16),p.qZA(),p.qZA(),p.TgZ(6,"app-month-year",17),p.NdJ("month",function(i){return p.CHM(t),p.oxw().getMonth(i)}),p.qZA(),p.qZA()}if(2&t){const t=p.oxw();p.xp6(1),p.Q6J("formGroup",t.main),p.xp6(5),p.Q6J("startDay",t.startDay)}}function gt(t,i){if(1&t){const t=p.EpF();p.TgZ(0,"app-drop-files",18),p.NdJ("files",function(i){return p.CHM(t),p.oxw().onDropFile(i)})("ondragover",function(){return p.CHM(t),p.oxw().ondragover()}),p.qZA()}2&t&&p.Q6J("label","")}function mt(t,i){if(1&t){const t=p.EpF();p.TgZ(0,"button",19),p.NdJ("click",function(){return p.CHM(t),p.oxw().sendMail()}),p._uU(1," G\u1eedi mail"),p.qZA()}}function ft(t,i){if(1&t){const t=p.EpF();p.TgZ(0,"button",20),p.NdJ("click",function(){return p.CHM(t),p.oxw().report()}),p._uU(1," Xu\u1ea5t file "),p.qZA()}}function Zt(t,i){if(1&t){const t=p.EpF();p.TgZ(0,"button",19),p.NdJ("click",function(){return p.CHM(t),p.oxw().complete()}),p._uU(1," G\u1eedi b\u1ea3ng k\xea "),p.qZA()}}function Tt(t,i){1&t&&(p.TgZ(0,"h5",21),p._uU(1,"L\u1ed7i d\u1eef li\u1ec7u"),p.qZA())}function bt(t,i){1&t&&(p.TgZ(0,"h5",22),p._uU(1,"B\u1ea2NG K\xca THANH TO\xc1N TI\u1ec0N \u0110I\u1ec6N M\u1eb6T TR\u1edcI "),p.qZA())}function xt(t,i){if(1&t){const t=p.EpF();p.TgZ(0,"mat-checkbox",27),p.NdJ("change",function(i){return p.CHM(t),p.oxw(2).checkAll(i)}),p.qZA()}}function kt(t,i){1&t&&(p.TgZ(0,"th"),p._uU(1,"L\u1ed7i"),p.qZA())}function qt(t,i){if(1&t){const t=p.EpF();p.TgZ(0,"mat-checkbox",31),p.NdJ("change",function(i){p.CHM(t);const n=p.oxw().$implicit;return p.oxw(2).checkItem(i,n)}),p.qZA()}if(2&t){const t=p.oxw().$implicit;p.Q6J("checked",1==t.DaGuiMail)("disabled",2==t.DaGuiMail)}}function It(t,i){if(1&t&&(p.TgZ(0,"td"),p._uU(1),p.qZA()),2&t){const t=p.oxw().$implicit;p.xp6(1),p.Oqu(t.err)}}const At=function(t,i){return{"bg-success text-center":t,"bg-danger":i}};function Nt(t,i){if(1&t&&(p.TgZ(0,"tr"),p.TgZ(1,"td"),p.YNc(2,qt,1,2,"mat-checkbox",28),p.qZA(),p.TgZ(3,"td",29),p._uU(4),p.qZA(),p.TgZ(5,"td"),p._uU(6),p.qZA(),p.TgZ(7,"td"),p._uU(8),p.qZA(),p.TgZ(9,"td",30),p._uU(10),p.qZA(),p.YNc(11,It,2,1,"td",25),p.qZA()),2&t){const t=i.$implicit,n=p.oxw(2);p.xp6(2),p.Q6J("ngIf",3==n.step),p.xp6(2),p.Oqu(t.MaKhachHang),p.xp6(2),p.Oqu(t.Email),p.xp6(2),p.Oqu(t.KhachHang),p.xp6(1),p.Q6J("ngClass",p.WLB(7,At,2==t.DaGuiMail,3==t.status)),p.xp6(1),p.Oqu(2==t.DaGuiMail?"\u0110\xe3 g\u1eedi":"Ch\u01b0a g\u1eedi"),p.xp6(1),p.Q6J("ngIf",2==n.step)}}function _t(t,i){if(1&t&&(p.TgZ(0,"table",23),p.TgZ(1,"thead"),p.TgZ(2,"tr"),p.TgZ(3,"th"),p.YNc(4,xt,1,0,"mat-checkbox",24),p.qZA(),p.TgZ(5,"th"),p._uU(6,"M\xe3 Kh\xe1ch h\xe0ng"),p.qZA(),p.TgZ(7,"th"),p._uU(8,"Email"),p.qZA(),p.TgZ(9,"th"),p._uU(10,"Kh\xe1ch h\xe0ng"),p.qZA(),p.TgZ(11,"th"),p._uU(12,"\u0110\xe3 g\u1eedi mail"),p.qZA(),p.YNc(13,kt,2,0,"th",25),p.qZA(),p.qZA(),p.TgZ(14,"tbody"),p.YNc(15,Nt,12,10,"tr",26),p.qZA(),p.qZA()),2&t){const t=p.oxw();p.xp6(4),p.Q6J("ngIf",3==t.step),p.xp6(9),p.Q6J("ngIf",2==t.step),p.xp6(2),p.Q6J("ngForOf",t.errors.length>0?t.errors:t.bangKe)}}function Dt(t,i){if(1&t){const t=p.EpF();p.TgZ(0,"mat-icon",41),p.NdJ("click",function(){p.CHM(t);const i=p.oxw().$implicit;return p.oxw(3).onDelete(i)}),p._uU(1,"delete"),p.qZA()}}const Jt=function(t){return{"bg-danger":t}};function vt(t,i){if(1&t){const t=p.EpF();p.TgZ(0,"tr"),p.TgZ(1,"td",38),p.NdJ("click",function(){const i=p.CHM(t).$implicit;return p.oxw(3).onEdit(i)}),p._uU(2),p.qZA(),p.TgZ(3,"td",39),p.NdJ("click",function(){const i=p.CHM(t).$implicit;return p.oxw(3).onEdit(i)}),p._uU(4),p.ALo(5,"enum"),p.qZA(),p.TgZ(6,"td",38),p.NdJ("click",function(){const i=p.CHM(t).$implicit;return p.oxw(3).onEdit(i)}),p._uU(7),p.qZA(),p.TgZ(8,"td",38),p.NdJ("click",function(){const i=p.CHM(t).$implicit;return p.oxw(3).onEdit(i)}),p._uU(9),p.ALo(10,"number"),p.qZA(),p.TgZ(11,"td",38),p.NdJ("click",function(){const i=p.CHM(t).$implicit;return p.oxw(3).onEdit(i)}),p._uU(12),p.ALo(13,"number"),p.qZA(),p.TgZ(14,"td"),p.YNc(15,Dt,2,0,"mat-icon",40),p.qZA(),p.qZA()}if(2&t){const t=i.$implicit,n=p.oxw(3);p.xp6(2),p.Oqu(t.TenBangKe),p.xp6(1),p.Q6J("ngClass",p.VKq(14,Jt,2==t.TrangThai)),p.xp6(1),p.Oqu(p.xi3(5,7,t.TrangThai,"DMTTrangThai")),p.xp6(3),p.Oqu(t.LichSuCapNhat),p.xp6(2),p.Oqu(p.lcZ(10,10,t.TongPhatLen)),p.xp6(3),p.Oqu(p.lcZ(13,12,t.ThanhTienSauThue)),p.xp6(3),p.Q6J("ngIf",n.checkPer(4)&&+t.TrangThai<3)}}function wt(t,i){if(1&t){const t=p.EpF();p.TgZ(0,"table",34),p.TgZ(1,"thead",35),p.TgZ(2,"tr"),p.TgZ(3,"th"),p._uU(4,"T\xean b\u1ea3ng k\xea"),p.qZA(),p.TgZ(5,"th"),p._uU(6,"Tr\u1ea1ng th\xe1i"),p.qZA(),p.TgZ(7,"th"),p._uU(8,"L\u1ecbch s\u1eed c\u1eadp nh\u1eadt"),p.qZA(),p.TgZ(9,"th"),p._uU(10,"T\u1ed5ng ph\xe1t l\xean"),p.qZA(),p.TgZ(11,"th"),p._uU(12,"Th\xe0nh ti\u1ec1n sau thu\u1ebf"),p.qZA(),p.TgZ(13,"th"),p.TgZ(14,"mat-icon",36),p.NdJ("click",function(){return p.CHM(t),p.oxw(2).reload()}),p._uU(15,"cached"),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.TgZ(16,"tbody"),p.YNc(17,vt,16,16,"tr",37),p.qZA(),p.qZA()}if(2&t){const t=p.oxw(2);p.Q6J("@slideIn",void 0),p.xp6(17),p.Q6J("ngForOf",t.filter.length>0?t.filter:t.items.slice(0,10))("ngForTrackBy",t.trackByFn)}}const Mt=function(){return[5,10,25,100]};function yt(t,i){if(1&t){const t=p.EpF();p.TgZ(0,"div",4),p.YNc(1,wt,18,3,"table",32),p.TgZ(2,"mat-paginator",33),p.NdJ("page",function(i){return p.CHM(t),p.oxw().changePage(i)}),p.qZA(),p.qZA()}if(2&t){const t=p.oxw();p.xp6(1),p.Q6J("ngIf",t.items.length+t.filter.length>0),p.xp6(1),p.Q6J("length",t.items.length)("pageSize",10)("pageSizeOptions",p.DdM(4,Mt))}}function Ut(t,i){if(1&t){const t=p.EpF();p.TgZ(0,"button",42),p.NdJ("click",function(){return p.CHM(t),p.oxw().resetDB()}),p._uU(1,"X\xf3a to\xe0n b\u1ed9 d\u1eef li\u1ec7u"),p.qZA()}}let Ht=(()=>{class t{constructor(t,i,n,e,o){this.plus=t,this.fb=i,this.rtSv=n,this.excelSv=e,this.docxSv=o,this.bangKeForm=this.fb.group({Email:[,[l.kI.required]],MaKhachHang:[,[l.kI.required]],KhachHang:[,[l.kI.required]],DiaChi:[,[l.kI.required]],MaGCS:[,[l.kI.required]],ChuTaiKhoan:[,[l.kI.required]],SoTaiKhoan:[,[l.kI.required]],NganHang:[,[l.kI.required]],Nam:[,[l.kI.required,l.kI.pattern("^[0-9]*$")]],Thang:[,[l.kI.required,l.kI.pattern("^[0-9]*$")]],SanLuong:[,[l.kI.required,l.kI.pattern("^[0-9]*$")]],DonGia:[,[l.kI.required,l.kI.pattern("^[0-9]*$")]],TruocThue:[,[l.kI.required,l.kI.pattern("^[0-9]*$")]],Thue:[,[l.kI.required,l.kI.pattern("^[0-9]*$")]],TongTien:[,[l.kI.required,l.kI.pattern("^[0-9]*$")]],KyHieuHoaDon:[,[]],SoHoaDon:[,[]],NgayHoaDon:[,[]],TrangThai:[,],DaGuiMail:[0]}),this.main=this.fb.group({_id:[,[]],TenBangKe:[,[l.kI.required]],TrangThai:[,[l.kI.required]],LichSuCapNhat:[,[l.kI.required]],TongPhatLen:[,[l.kI.required,l.kI.pattern("^[0-9]*$")]],ThanhTienTruocThue:[,[l.kI.required,l.kI.pattern("^[0-9]*$")]],Thue:[,[l.kI.required,l.kI.pattern("^[0-9]*$")]],ThanhTienSauThue:[,[l.kI.required,l.kI.pattern("^[0-9]*$")]],DanhSach:[]}),this.title="L\u1eadp b\u1ea3ng k\xea",this.global=!0,this.dbName="dien-luc",this.api="dmt-input",this.db=null,this.userId=this.plus.userId,this.usr=this.plus.usr,this.items=[],this.selectedItem=null,this.filter=[],this.chart=[],this.errors=[],this.dataInXls={},this.wordFile=null,this.startDay=new Date,this.bangKe=[],this.readFileDone=!1,this.step=0,this.TongPhatLen=0,this.ThanhTienTruocThue=0,this.Thue=0,this.ThanhTienSauThue=0}ngOnInit(){this.plus.setTiTle(this.title),this.getMonth(this.startDay),this.plus.IDB_InitDB(this.dbName).subscribe(t=>ht(this,void 0,void 0,function*(){this.db=t,this.getIDB(),this.plus.IDB_DB_CleanTrash(t,this.api),this.plus.updateRealtime(this.db,this.api,this.global),this.plus.updateAPi.subscribe(t=>{t&&this.getIDB()})}))}getIDB(){this.filter=[],this.plus.updateDB(this.db,this.api,this.global),this.plus.IDB_DB_GetAll(this.db,this.api).subscribe(t=>{this.items=t,this.plus.updateAPi.next(!1)})}ngOnDestroy(){console.log("Destroy",this.api),this.plus.subs.unsubscribe(),this.rtSv.leaveRoom(this.api)}save(){if(this.main.invalid)return;const t=this.main.value,i=this.plus.datetoNumObj(this.main.value,[""]);if(console.log(i),null==t._id)delete t._id,this.plus.httpPost(this.api,i,this.global).subscribe(t=>{t.status&&(this.plus.clickBtn("closeModal"),this.plus.updateAPi.next(!0))});else{const n=this.plus.objVs(this.selectedItem,t);if(0===Object.keys(n).length)return this.plus.alertMatSnackBar("Kh\xf4ng c\xf3 n\u1ed9i dung n\xe0o thay \u0111\u1ed5i");this.plus.httpPut(this.api,i,this.global).subscribe(t=>{t.status&&(this.plus.updateAPi.next(!0),this.plus.clickBtn("closeModal"))})}}convertToList(){const t=this.dataInXls.data;for(let i=0;i<t.length;i++){const n=t[i],e={MaKhachHang:n.MA_KHANG,MaGCS:n.MA_SOGCS,Nam:this.year,Thang:this.month,SanLuong:n.DIEN_TTHU,DonGia:n.DON_GIA,TruocThue:n.SO_TIEN,Thue:n.TIEN_GTGT,TongTien:n.TONG_TIEN,DaGuiMail:0};this.TongPhatLen+=n.DIEN_TTHU,this.ThanhTienTruocThue+=n.SO_TIEN,this.Thue+=n.TIEN_GTGT,this.ThanhTienSauThue+=n.TONG_TIEN,this.plus.IDB_DB_GetAllByIndexKey(this.db,"dmt-khach-hang","MaKhachHang",n.MA_KHANG).subscribe(i=>{const n=Object.assign(i[0],e);if(delete n.canEdit,delete n.dateModify,delete n.keyWord,delete n.status,delete n.sync,delete n.__v,delete n._id,this.bangKeForm.patchValue(n),this.bangKeForm.invalid){const t=this.plus.getErrValidateForm(this.bangKeForm);n.err=t,this.errors.push(n),this.step=2}else this.bangKe.push(n);t.length==this.bangKe.length&&(this.readFileDone=!0,console.log(this.bangKe),this.step=3)})}}onDropFile(t){this.reset();for(let i=0;i<t.length;i++)if(console.log(t[i].type),"application/vnd.openxmlformats-officedocument.wordprocessingml.document"==t[i].type){const n=new FileReader;n.readAsArrayBuffer(t[i]),n.onloadend=()=>this.wordFile=n.result}else"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"==t[i].type?this.excelSv.toJsonArray(t[i]).then(t=>{this.dataInXls=t,this.convertToList()}):this.plus.alertError("File kh\xf4ng h\u1ee3p l\u1ec7")}sendMail(){return ht(this,void 0,void 0,function*(){for(let t=0;t<this.bangKe.length;t++){const i=this.bangKe[t];if(1==i.DaGuiMail){let n={from:this.plus.user.value.unit,status:0,email:i.Email,title:`Th\xf4ng b\xe1o chi ti\u1ec1n \u0111i\u1ec7n NLMTMN th\xe1ng ${this.month} n\u0103m ${this.year}`,company:i.KhachHang,index:t,message:`<p>K\xednh g\u1eedi kh\xe1ch h\xe0ng: ${i.KhachHang}.</p>\n          <p>\u0110i\u1ec7n l\u1ef1c Xu\xe2n L\u1ed9c k\xednh g\u1eedi \u0111\u1ebfn qu\xfd kh\xe1ch h\xe0ng n\u1ed9i dung thanh to\xe1n ti\u1ec1n \u0111i\u1ec7n m\u1eb7t tr\u1eddi tr\xean m\xe1i nh\xe0 v\u1edbi n\u1ed9i dung nh\u01b0 sau:</p>\n          <ul> M\xe3 kh\xe1ch h\xe0ng: ${i.MaKhachHang}.</ul>\n          <ul> T\xean kh\xe1ch h\xe0ng: ${i.KhachHang}.</ul>\n          <ul> \u0110\u1ecba ch\u1ec9: ${i.DiaChi}.</ul>\n          <ul> M\xe3 ghi ch\u1ec9 s\u1ed1: ${i.MaGCS}.</ul>\n          <ul> T\xean t\xe0i kho\u1ea3n: ${i.ChuTaiKhoan}.</ul>\n          <ul> S\u1ed1 t\xe0i kho\u1ea3n: ${i.SoTaiKhoan}.</ul>\n          <ul> Ng\xe2n h\xe0ng: ${i.NganHang}.</ul>\n          <ul> N\u0103m: ${this.year}.</ul>\n          <ul> Th\xe1ng: ${this.month}.</ul>\n          <ul> \u0110i\u1ec7n ph\xe1t l\xean l\u01b0\u1edbi: ${this.plus.numberWithCommas(i.SanLuong)} kWh.</ul>\n          <ul> \u0110\u01a1n gi\xe1: ${this.plus.numberWithCommas(i.DonGia)} VND/kWh.</ul>\n          <ul> Th\xe0nh ti\u1ec1n ch\u01b0a thu\u1ebf VAT: ${this.plus.numberWithCommas(i.TruocThue)} VND.</ul>\n          <ul> Thu\u1ebf VAT: ${this.plus.numberWithCommas(i.Thue)} VND.</ul>\n          <ul> T\u1ed5ng ti\u1ec1n: ${this.plus.numberWithCommas(i.TongTien)} VND.</ul>\n          <p>M\u1ecdi \xfd ki\u1ebfn th\u1eafc m\u1eafc, vui l\xf2ng li\xean h\u1ec7 \u0110i\u1ec7n l\u1ef1c Xu\xe2n L\u1ed9c qua s\u1ed1 \u0111i\u1ec7n tho\u1ea1i Mr. \u0110\u1ea1t - <a href="tel:0937232239">0937232239 </a> ho\u1eb7c Mrs. Ph\u01b0\u1edbc Anh - <a href="tel:0583223344" >0583223344 </a> \u0111\u1ec3 \u0111\u01b0\u1ee3c gi\u1ea3i \u0111\xe1p.</p>\n          <p>Ph\u1ea3n h\u1ed3i h\xf3a \u0111\u01a1n qu\xfd kh\xe1ch vui l\xf2ng g\u1eedi email v\u1ec1 c\u1ea3 02 \u0111\u1ecba ch\u1ec9: <a href="mailto:dienlucxuanloc.nlmt@gmail.com;tckt.dlxl.pcdn@gmail.com">dienlucxuanloc.nlmt@gmail.com</a> v\xe0 <a href="mailto:dienlucxuanloc.nlmt@gmail.com;tckt.dlxl.pcdn@gmail.com">tckt.dlxl.pcdn@gmail.com</a> </p>\n          Tr\xe2n tr\u1ecdng.`};this.plus.load(),yield this.plus.sleep(5e3),this.plus.httpPost("mail/dien-mat-troi",n).subscribe(i=>{const n=i.index;console.log("Mail sent: ",n,i.email),n>=0&&i.email?(this.plus.loaded(),this.bangKe[t].DaGuiMail=2,localStorage.setItem(this.api,JSON.stringify(this.bangKe))):(this.bangKe[t].DaGuiMail=0,this.plus.alertToasrt(i))})}}})}report(){const t=this.main.value;t.DanhSach=this.bangKe,t.TongPhatLen=this.TongPhatLen,t.ThanhTienTruocThue=this.ThanhTienTruocThue,t.Thue=this.Thue,t.ThanhTienSauThue=this.ThanhTienSauThue,t.Nam=this.year,t.TrangThai=1,t.LichSuCapNhat=[`${h()().format("DD/MM/YYYY HH:MM")}: T\u1ea1o m\u1edbi b\u1ea3ng k\xea `],delete t._id,this.bodyComplete=t,this.docxSv.loadFileUrl("https://thuctd.github.io/templates/BangKe.docx").then(i=>{this.docxSv.generateOne(t,i,`BangKeThang${this.month}-${this.year}`).then(t=>{this.plus.alertSuccess()})})}complete(){this.plus.httpPost(this.api,this.bodyComplete,!0).subscribe(t=>{this.getIDB()})}checkItem(t,i){const n=this.bangKe.indexOf(i);this.bangKe[n].DaGuiMail=t.checked?1:0}checkAll(t){this.bangKe.forEach(t.checked?t=>{2!=t.DaGuiMail&&(t.DaGuiMail=1)}:t=>{2!=t.DaGuiMail&&(t.DaGuiMail=0)})}ondragover(){document.getElementById("dropZone").setAttribute("drop-active","true")}getMonth(t){this.month=h()(t).month()+1,this.year=h()(t).year()}onEdit(t){}onDelete(t){!confirm("B\u1ea1n mu\u1ed1n x\xf3a?")||(this.plus.load(),this.plus.httpDisable(this.api,t,this.global).then(t=>{this.plus.updateAPi.next(!0)}))}chooseOpt(t,i,n,e=!1){this.main.controls[i].setValue(t[n]),e&&this.main.controls[i+"ID"].setValue(t._id)}closeModal(){this.main.reset()}search(t){this.filter=t}find(t){this.items=t}checkPer(t){return this.plus.checkPer(this.api,t)}patchForm(){this.main.reset({})}reload(){return this.plus.reload(this.dbName+"/"+this.api)}reset(){this.plus.loaded(),this.filter=[],this.errors=[],this.items=[]}changePage(t){this.filter=this.items.slice(t.pageIndex*t.pageSize,(t.pageIndex+1)*t.pageSize)}trackByFn(t,i){return i}resetDB(){this.plus.resetDB(this.db,this.api)}}return t.\u0275fac=function(i){return new(i||t)(p.Y36(d.T),p.Y36(l.qu),p.Y36(g.i),p.Y36(ct.x),p.Y36(m.E))},t.\u0275cmp=p.Xpm({type:t,selectors:[["app-nlmt-input"]],decls:13,vars:11,consts:[[1,"container"],["id","back-btn","mat-raised-button","","color","primary",3,"click",4,"ngIf"],["class","py-3",4,"ngIf"],[3,"label","files","ondragover",4,"ngIf"],[1,"row"],["mat-raised-button","","color","warn",3,"click",4,"ngIf"],["mat-raised-button","","color","accent",3,"click",4,"ngIf"],["class","tit bg-warning",4,"ngIf"],["class","tit",4,"ngIf"],["class","table",4,"ngIf"],["class","row",4,"ngIf"],["mat-button","","color","warn",3,"click",4,"ngIf"],["id","back-btn","mat-raised-button","","color","primary",3,"click"],[1,"py-3"],[3,"formGroup"],["appearance","outline"],["required","","type","text","autocomplete","off","matInput","","formControlName","TenBangKe"],[3,"startDay","month"],[3,"label","files","ondragover"],["mat-raised-button","","color","warn",3,"click"],["mat-raised-button","","color","accent",3,"click"],[1,"tit","bg-warning"],[1,"tit"],[1,"table"],["color","warn",3,"checked","change",4,"ngIf"],[4,"ngIf"],[4,"ngFor","ngForOf"],["color","warn",3,"checked","change"],["color","primary",3,"checked","disabled","change",4,"ngIf"],["scope","row"],[3,"ngClass"],["color","primary",3,"checked","disabled","change"],["class","table table-hover",4,"ngIf"],[3,"length","pageSize","pageSizeOptions","page"],[1,"table","table-hover"],[1,"thead-inverse"],["color","primary",3,"click"],[4,"ngFor","ngForOf","ngForTrackBy"],[3,"click"],[3,"ngClass","click"],["color","warn",3,"click",4,"ngIf"],["color","warn",3,"click"],["mat-button","","color","warn",3,"click"]],template:function(t,i){1&t&&(p.TgZ(0,"div",0),p.YNc(1,pt,3,1,"button",1),p.YNc(2,dt,7,2,"section",2),p.YNc(3,gt,1,1,"app-drop-files",3),p.TgZ(4,"div",4),p.YNc(5,mt,2,0,"button",5),p.YNc(6,ft,2,0,"button",6),p.YNc(7,Zt,2,0,"button",5),p.qZA(),p.YNc(8,Tt,2,0,"h5",7),p.YNc(9,bt,2,0,"h5",8),p.YNc(10,_t,16,3,"table",9),p.YNc(11,yt,3,5,"div",10),p.qZA(),p.YNc(12,Ut,2,0,"button",11)),2&t&&(p.xp6(1),p.Q6J("ngIf",i.step>1),p.xp6(1),p.Q6J("ngIf",0==i.step),p.xp6(1),p.Q6J("ngIf",0==i.bangKe.length||!i.wordFile),p.xp6(2),p.Q6J("ngIf",i.bangKe.length>0),p.xp6(1),p.Q6J("ngIf",i.bangKe),p.xp6(1),p.Q6J("ngIf",i.bodyComplete),p.xp6(1),p.Q6J("ngIf",2==i.step),p.xp6(1),p.Q6J("ngIf",3==i.step),p.xp6(1),p.Q6J("ngIf",i.step>1),p.xp6(1),p.Q6J("ngIf",(null==i.items?null:i.items.length)>0),p.xp6(1),p.Q6J("ngIf",i.checkPer(6)))},directives:[c.O5,Z.lW,T.Hw,l._Y,l.JL,l.sg,x.KE,x.hX,k.Nt,l.Fj,l.Q7,l.JJ,l.u,rt.k,lt.k,c.sg,ut.oG,c.mk,F.NW],pipes:[P.zZ,c.JJ],styles:[""],data:{animation:[r.Ym]}}),t})();function Ct(t,i){if(1&t){const t=p.EpF();p.TgZ(0,"button",10),p.NdJ("click",function(){return p.CHM(t),p.oxw().reload()}),p.TgZ(1,"mat-icon"),p._uU(2,"undo"),p.qZA(),p.qZA()}2&t&&p.Q6J("@slideIn",void 0)}function Bt(t,i){if(1&t){const t=p.EpF();p.TgZ(0,"app-search-api",11),p.NdJ("data",function(i){return p.CHM(t),p.oxw().find(i)}),p.qZA()}if(2&t){const t=p.oxw();p.Q6J("api",t.api)}}function Qt(t,i){if(1&t){const t=p.EpF();p.TgZ(0,"mat-icon",18),p.NdJ("click",function(){p.CHM(t);const i=p.oxw().$implicit;return p.oxw(2).onDelete(i)}),p._uU(1,"delete"),p.qZA()}}function Yt(t,i){if(1&t){const t=p.EpF();p.TgZ(0,"tr"),p.TgZ(1,"td",16),p.NdJ("click",function(){const i=p.CHM(t).$implicit;return p.oxw(2).onEdit(i)}),p._uU(2),p.qZA(),p.TgZ(3,"td",16),p.NdJ("click",function(){const i=p.CHM(t).$implicit;return p.oxw(2).onEdit(i)}),p._uU(4),p.qZA(),p.TgZ(5,"td",16),p.NdJ("click",function(){const i=p.CHM(t).$implicit;return p.oxw(2).onEdit(i)}),p._uU(6),p.ALo(7,"date"),p.qZA(),p.TgZ(8,"td",16),p.NdJ("click",function(){const i=p.CHM(t).$implicit;return p.oxw(2).onEdit(i)}),p._uU(9),p.qZA(),p.TgZ(10,"td"),p.YNc(11,Qt,2,0,"mat-icon",17),p.qZA(),p.qZA()}if(2&t){const t=i.$implicit,n=p.oxw(2);p.xp6(2),p.Oqu(t.TaiKhoan),p.xp6(2),p.Oqu(t.NoiDung),p.xp6(2),p.Oqu(p.xi3(7,5,t.ThoiGian,"dd/MM/YYYY HH:mm")),p.xp6(3),p.Oqu(t.MaKhachHang),p.xp6(2),p.Q6J("ngIf",n.checkPer(4))}}function St(t,i){if(1&t){const t=p.EpF();p.TgZ(0,"table",12),p.TgZ(1,"thead",13),p.TgZ(2,"tr"),p.TgZ(3,"th"),p._uU(4,"T\xe0i kho\u1ea3n"),p.qZA(),p.TgZ(5,"th"),p._uU(6,"N\u1ed9i dung thay \u0111\u1ed5i"),p.qZA(),p.TgZ(7,"th"),p._uU(8,"Th\u1eddi gian"),p.qZA(),p.TgZ(9,"th"),p._uU(10,"M\xe3 kh\xe1ch h\xe0ng"),p.qZA(),p.TgZ(11,"th"),p.TgZ(12,"mat-icon",14),p.NdJ("click",function(){return p.CHM(t),p.oxw().reload()}),p._uU(13,"cached"),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.TgZ(14,"tbody"),p.YNc(15,Yt,12,8,"tr",15),p.qZA(),p.qZA()}if(2&t){const t=p.oxw();p.Q6J("@slideIn",void 0),p.xp6(15),p.Q6J("ngForOf",t.filter.length>0?t.filter:t.items.slice(0,10))("ngForTrackBy",t.trackByFn)}}function Et(t,i){if(1&t&&p._UZ(0,"app-export-ecxel",19),2&t){const t=p.oxw();p.Q6J("dataJson",t.items)}}function Ft(t,i){if(1&t){const t=p.EpF();p.TgZ(0,"button",20),p.NdJ("click",function(){return p.CHM(t),p.oxw().resetDB()}),p._uU(1,"X\xf3a to\xe0n b\u1ed9 d\u1eef li\u1ec7u"),p.qZA()}}const Ot=function(){return[5,10,25,100]};let $t=(()=>{class t{constructor(t,i,n){this.plus=t,this.fb=i,this.rtSv=n,this.title="L\u1ecbch s\u1eed c\u1eadp nh\u1eadt",this.dbName="dien-luc",this.api="dmt-history",this.db=null,this.items=[],this.selectedItem=null,this.filter=[],this.chart=[],this.main=this.fb.group({keyWord:[,[]],_id:[,[]],TaiKhoan:[,[l.kI.required]],NoiDung:[,[l.kI.required]],ThoiGian:[,[l.kI.required]],MaKhachHang:[,[l.kI.required]]})}ngOnInit(){this.plus.setTiTle(this.title),this.plus.IDB_InitDB(this.dbName).subscribe(t=>function(t,i,n,e){return new(n||(n=Promise))(function(o,a){function s(t){try{r(e.next(t))}catch(i){a(i)}}function c(t){try{r(e.throw(t))}catch(i){a(i)}}function r(t){t.done?o(t.value):function(t){return t instanceof n?t:new n(function(i){i(t)})}(t.value).then(s,c)}r((e=e.apply(t,i||[])).next())})}(this,void 0,void 0,function*(){this.db=t,this.getIDB(),this.plus.updateGlobalLocal(t,this.api),this.plus.updateAPi.subscribe(t=>{t&&this.getIDB()})}))}getIDB(){console.log("getIDB"),this.filter=[],this.plus.IDB_DB_GetAll(this.db,this.api).subscribe(t=>{this.items=t,this.plus.updateAPi.next(!1)})}ngOnDestroy(){console.log("Destroy",this.api),this.plus.subs.unsubscribe(),this.rtSv.leaveRoom(this.api)}save(){if(this.main.invalid)return;const t=this.main.value,i=this.plus.datetoNumObj(this.main.value,["ThoiGian"]);console.log(i),null==t._id?(delete t._id,this.plus.httpPost(this.api,i).subscribe(t=>{t.status&&this.plus.clickBtn("closeModal")})):this.plus.httpPut(this.api,i).subscribe(t=>{t.status&&this.plus.clickBtn("closeModal")})}onEdit(t){this.selectedItem=t;const i=this.plus.dateToHtmlObj(t,["ThoiGian"]);this.main.patchValue(i),this.plus.clickBtn("openModal")}onDelete(t){!confirm("B\u1ea1n mu\u1ed1n x\xf3a?")||(this.plus.load(),this.plus.httpDisable(this.api,t).then(t=>{console.log(t)}))}chooseOpt(t,i,n,e=!1){this.main.controls[i].setValue(t[n]),e&&this.main.controls[i+"ID"].setValue(t._id)}closeModal(){this.main.reset()}search(t){this.filter=t}find(t){this.items=t}checkPer(t){return this.plus.checkPer(this.api,t)}patchForm(){this.main.reset({_id:" "})}reload(){return this.plus.reload(this.dbName+"/"+this.api)}reset(){this.plus.loaded(),this.filter=[],this.getIDB(),this.main.reset({})}changePage(t){this.filter=this.items.slice(t.pageIndex*t.pageSize,(t.pageIndex+1)*t.pageSize)}trackByFn(t,i){return i}resetDB(){this.plus.resetDB(this.db,this.api)}}return t.\u0275fac=function(i){return new(i||t)(p.Y36(d.T),p.Y36(l.qu),p.Y36(g.i))},t.\u0275cmp=p.Xpm({type:t,selectors:[["app-nlmt-history"]],decls:12,vars:11,consts:[[1,"container"],["id","add-btn","color","accent","mat-raised-button","","data-toggle","modal","data-target","#modelId",3,"click"],["id","back-btn","mat-raised-button","","color","primary",3,"click",4,"ngIf"],[3,"api","data",4,"ngIf"],[3,"db","api","filter"],[1,"row"],["class","table table-hover",4,"ngIf"],[3,"length","pageSize","pageSizeOptions","page"],[3,"dataJson",4,"ngIf"],["mat-button","","color","warn",3,"click",4,"ngIf"],["id","back-btn","mat-raised-button","","color","primary",3,"click"],[3,"api","data"],[1,"table","table-hover"],[1,"thead-inverse"],["color","primary",3,"click"],[4,"ngFor","ngForOf","ngForTrackBy"],[3,"click"],["color","warn",3,"click",4,"ngIf"],["color","warn",3,"click"],[3,"dataJson"],["mat-button","","color","warn",3,"click"]],template:function(t,i){1&t&&(p.TgZ(0,"div",0),p.TgZ(1,"button",1),p.NdJ("click",function(){return i.reset()}),p.TgZ(2,"mat-icon"),p._uU(3,"control_point"),p.qZA(),p.qZA(),p.YNc(4,Ct,3,1,"button",2),p.YNc(5,Bt,1,1,"app-search-api",3),p.TgZ(6,"app-search-table",4),p.NdJ("filter",function(t){return i.search(t)}),p.qZA(),p.TgZ(7,"div",5),p.YNc(8,St,16,3,"table",6),p.TgZ(9,"mat-paginator",7),p.NdJ("page",function(t){return i.changePage(t)}),p.qZA(),p.qZA(),p.YNc(10,Et,1,1,"app-export-ecxel",8),p.qZA(),p.YNc(11,Ft,2,0,"button",9)),2&t&&(p.xp6(4),p.Q6J("ngIf",i.filter.length>0),p.xp6(1),p.Q6J("ngIf",i.checkPer(10)),p.xp6(1),p.Q6J("db",i.db)("api",i.api),p.xp6(2),p.Q6J("ngIf",i.items.length+i.filter.length>0),p.xp6(1),p.Q6J("length",i.items.length)("pageSize",10)("pageSizeOptions",p.DdM(10,Ot)),p.xp6(1),p.Q6J("ngIf",i.checkPer(4)),p.xp6(1),p.Q6J("ngIf",i.checkPer(5)))},directives:[Z.lW,T.Hw,c.O5,E.D,F.NW,O.W,c.sg,K.t],pipes:[c.uU],styles:[""],data:{animation:[r.Ym]}}),t})();function Kt(t,i){if(1&t){const t=p.EpF();p.TgZ(0,"button",31),p.NdJ("click",function(){return p.CHM(t),p.oxw().reload()}),p.TgZ(1,"mat-icon"),p._uU(2,"undo"),p.qZA(),p.qZA()}2&t&&p.Q6J("@slideIn",void 0)}function Pt(t,i){if(1&t){const t=p.EpF();p.TgZ(0,"app-search-api",32),p.NdJ("data",function(i){return p.CHM(t),p.oxw().find(i)}),p.qZA()}if(2&t){const t=p.oxw();p.Q6J("api",t.api)}}function Lt(t,i){1&t&&(p.TgZ(0,"th"),p._uU(1,"\u0110\u1ecba ch\u1ec9"),p.qZA())}function Gt(t,i){1&t&&(p.TgZ(0,"th"),p._uU(1,"M\xe3 G C S"),p.qZA())}function zt(t,i){1&t&&(p.TgZ(0,"th"),p._uU(1,"Ch\u1ee7 t\xe0i kho\u1ea3n"),p.qZA())}function Wt(t,i){1&t&&(p.TgZ(0,"th"),p._uU(1,"S\u1ed1 t\xe0i kho\u1ea3n"),p.qZA())}function Vt(t,i){1&t&&(p.TgZ(0,"th"),p._uU(1,"Ng\xe2n h\xe0ng"),p.qZA())}function jt(t,i){1&t&&(p.TgZ(0,"th"),p._uU(1,"Email"),p.qZA())}function Xt(t,i){if(1&t){const t=p.EpF();p.TgZ(0,"td",38),p.NdJ("click",function(){p.CHM(t);const i=p.oxw().$implicit;return p.oxw(2).onEdit(i)}),p._uU(1),p.qZA()}if(2&t){const t=p.oxw().$implicit;p.xp6(1),p.Oqu(t.DiaChi)}}function Rt(t,i){if(1&t){const t=p.EpF();p.TgZ(0,"td",38),p.NdJ("click",function(){p.CHM(t);const i=p.oxw().$implicit;return p.oxw(2).onEdit(i)}),p._uU(1),p.qZA()}if(2&t){const t=p.oxw().$implicit;p.xp6(1),p.Oqu(t.MaGCS)}}function ti(t,i){if(1&t){const t=p.EpF();p.TgZ(0,"td",38),p.NdJ("click",function(){p.CHM(t);const i=p.oxw().$implicit;return p.oxw(2).onEdit(i)}),p._uU(1),p.qZA()}if(2&t){const t=p.oxw().$implicit;p.xp6(1),p.Oqu(t.ChuTaiKhoan)}}function ii(t,i){if(1&t){const t=p.EpF();p.TgZ(0,"td",38),p.NdJ("click",function(){p.CHM(t);const i=p.oxw().$implicit;return p.oxw(2).onEdit(i)}),p._uU(1),p.qZA()}if(2&t){const t=p.oxw().$implicit;p.xp6(1),p.Oqu(t.SoTaiKhoan)}}function ni(t,i){if(1&t){const t=p.EpF();p.TgZ(0,"td",38),p.NdJ("click",function(){p.CHM(t);const i=p.oxw().$implicit;return p.oxw(2).onEdit(i)}),p._uU(1),p.qZA()}if(2&t){const t=p.oxw().$implicit;p.xp6(1),p.Oqu(t.NganHang)}}function ei(t,i){if(1&t){const t=p.EpF();p.TgZ(0,"td",38),p.NdJ("click",function(){p.CHM(t);const i=p.oxw().$implicit;return p.oxw(2).onEdit(i)}),p._uU(1),p.qZA()}if(2&t){const t=p.oxw().$implicit;p.xp6(1),p.Oqu(t.Email)}}function oi(t,i){if(1&t){const t=p.EpF();p.TgZ(0,"mat-icon",41),p.NdJ("click",function(){p.CHM(t);const i=p.oxw().$implicit;return p.oxw(2).onDelete(i)}),p._uU(1,"delete"),p.qZA()}}function ai(t,i){if(1&t){const t=p.EpF();p.TgZ(0,"tr"),p.TgZ(1,"td",38),p.NdJ("click",function(){const i=p.CHM(t).$implicit;return p.oxw(2).onEdit(i)}),p._uU(2),p.qZA(),p.TgZ(3,"td",38),p.NdJ("click",function(){const i=p.CHM(t).$implicit;return p.oxw(2).onEdit(i)}),p._uU(4),p.qZA(),p.YNc(5,Xt,2,1,"td",39),p.YNc(6,Rt,2,1,"td",39),p.YNc(7,ti,2,1,"td",39),p.YNc(8,ii,2,1,"td",39),p.YNc(9,ni,2,1,"td",39),p.YNc(10,ei,2,1,"td",39),p.TgZ(11,"td"),p.YNc(12,oi,2,0,"mat-icon",40),p.qZA(),p.qZA()}if(2&t){const t=i.$implicit,n=p.oxw(2);p.xp6(2),p.Oqu(t.MaKhachHang),p.xp6(2),p.Oqu(t.KhachHang),p.xp6(1),p.Q6J("Device",3),p.xp6(1),p.Q6J("Device",3),p.xp6(1),p.Q6J("Device",3),p.xp6(1),p.Q6J("Device",3),p.xp6(1),p.Q6J("Device",3),p.xp6(1),p.Q6J("Device",2),p.xp6(2),p.Q6J("ngIf",n.checkPer(4))}}function si(t,i){if(1&t){const t=p.EpF();p.TgZ(0,"table",33),p.TgZ(1,"thead",34),p.TgZ(2,"tr"),p.TgZ(3,"th"),p._uU(4,"M\xe3 kh\xe1ch h\xe0ng"),p.qZA(),p.TgZ(5,"th"),p._uU(6,"Kh\xe1ch h\xe0ng"),p.qZA(),p.YNc(7,Lt,2,0,"th",35),p.YNc(8,Gt,2,0,"th",35),p.YNc(9,zt,2,0,"th",35),p.YNc(10,Wt,2,0,"th",35),p.YNc(11,Vt,2,0,"th",35),p.YNc(12,jt,2,0,"th",35),p.TgZ(13,"th"),p.TgZ(14,"mat-icon",36),p.NdJ("click",function(){return p.CHM(t),p.oxw().reload()}),p._uU(15,"cached"),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.TgZ(16,"tbody"),p.YNc(17,ai,13,9,"tr",37),p.qZA(),p.qZA()}if(2&t){const t=p.oxw();p.Q6J("@slideIn",void 0),p.xp6(7),p.Q6J("Device",3),p.xp6(1),p.Q6J("Device",3),p.xp6(1),p.Q6J("Device",3),p.xp6(1),p.Q6J("Device",3),p.xp6(1),p.Q6J("Device",3),p.xp6(1),p.Q6J("Device",3),p.xp6(5),p.Q6J("ngForOf",t.filter.length>0?t.filter:t.items.slice(0,10))("ngForTrackBy",t.trackByFn)}}function ci(t,i){if(1&t&&p._UZ(0,"app-import-database",42),2&t){const t=p.oxw();p.Q6J("api",t.api)("global",!0)("form",t.main)}}function ri(t,i){if(1&t){const t=p.EpF();p.TgZ(0,"button",43),p.NdJ("click",function(){return p.CHM(t),p.oxw().resetDB()}),p._uU(1,"X\xf3a to\xe0n b\u1ed9 d\u1eef li\u1ec7u"),p.qZA()}}function li(t,i){if(1&t){const t=p.EpF();p.TgZ(0,"button",44),p.NdJ("click",function(){return p.CHM(t),p.oxw().save()}),p.TgZ(1,"mat-icon"),p._uU(2,"save"),p.qZA(),p.qZA()}2&t&&p.Q6J("@slideIn",void 0)}const ui=function(){return[5,10,25,100]},hi=[{path:"",component:(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(i){return new(i||t)},t.\u0275cmp=p.Xpm({type:t,selectors:[["app-dlxl"]],decls:2,vars:0,template:function(t,i){1&t&&(p.TgZ(0,"p"),p._uU(1,"dlxl works!"),p.qZA())},styles:[""]}),t})()},{path:"dmt-khach-hang",component:(()=>{class t{constructor(t,i,n){this.plus=t,this.fb=i,this.rtSv=n,this.main=this.fb.group({_id:[,[]],MaKhachHang:[,[l.kI.required,l.kI.minLength(5)]],KhachHang:[,[l.kI.required,l.kI.minLength(5)]],DiaChi:[,[l.kI.required,l.kI.minLength(5)]],MaGCS:[,[l.kI.required,l.kI.minLength(5)]],ChuTaiKhoan:[,[l.kI.required,l.kI.minLength(5)]],SoTaiKhoan:[,[l.kI.required,l.kI.minLength(5)]],NganHang:[,[l.kI.required,l.kI.minLength(5)]],Email:[,[l.kI.required,l.kI.email]]}),this.title="Kh\xe1ch h\xe0ng",this.dbName="dien-luc",this.global=!0,this.api="dmt-khach-hang",this.db=null,this.userId=this.plus.userId,this.usr=this.plus.usr,this.items=[],this.selectedItem=null,this.filter=[],this.chart=[]}ngOnInit(){this.plus.setTiTle(this.title),this.plus.IDB_InitDB(this.dbName).subscribe(t=>function(t,i,n,e){return new(n||(n=Promise))(function(o,a){function s(t){try{r(e.next(t))}catch(i){a(i)}}function c(t){try{r(e.throw(t))}catch(i){a(i)}}function r(t){t.done?o(t.value):function(t){return t instanceof n?t:new n(function(i){i(t)})}(t.value).then(s,c)}r((e=e.apply(t,i||[])).next())})}(this,void 0,void 0,function*(){this.db=t,this.getIDB(),this.plus.updateRealtime(this.db,this.api,this.global),this.plus.updateAPi.subscribe(t=>{t&&this.getIDB()})}))}getIDB(){this.filter=[],this.plus.updateDB(this.db,this.api,this.global),this.plus.IDB_DB_GetAll(this.db,this.api).subscribe(t=>{this.items=t,this.plus.updateAPi.next(!1)})}ngOnDestroy(){console.log("Destroy",this.api),this.plus.subs.unsubscribe(),this.rtSv.leaveRoom(this.api)}save(){if(this.main.invalid)return;const t=this.main.value;if(null==t._id)delete t._id,this.plus.httpPost(this.api,t,this.global).subscribe(t=>{t.status&&(this.plus.clickBtn("closeModal"),this.plus.updateAPi.next(!0))});else{const i=this.plus.objVs(this.selectedItem,t);if(0===Object.keys(i).length)return this.plus.alertMatSnackBar("Kh\xf4ng c\xf3 n\u1ed9i dung n\xe0o thay \u0111\u1ed5i");this.plus.httpPut(this.api,t,this.global).subscribe(t=>{t.status&&(this.plus.clickBtn("closeModal"),this.addHistory(i),this.plus.updateAPi.next(!0))})}}addHistory(t){const i=[];for(const e in t)i.push(this.selectedItem[e]+" => "+t[e]);const n={TaiKhoan:this.plus.user.value.fullName,NoiDung:i.join(", "),ThoiGian:Date.now(),MaKhachHang:this.selectedItem.MaKhachHang};0!=i.length&&this.plus.httpPost("dmt-history",n,!0).subscribe(t=>{})}onEdit(t){this.selectedItem=t,this.main.patchValue(t),this.plus.clickBtn("openModal")}onDelete(t){!confirm("B\u1ea1n mu\u1ed1n x\xf3a?")||(this.plus.load(),this.plus.httpDisable(this.api,t,!0).then(t=>{console.log(t)}))}chooseOpt(t,i,n,e=!1){this.main.controls[i].setValue(t[n]),e&&this.main.controls[i+"ID"].setValue(t._id)}closeModal(){this.main.reset()}search(t){this.filter=t}find(t){this.items=t}checkPer(t){return this.plus.checkPer(this.api,t)}reload(){return this.plus.reload(this.dbName+"/"+this.api)}reset(){this.plus.loaded(),this.filter=[],this.getIDB(),this.main.reset({})}changePage(t){this.filter=this.items.slice(t.pageIndex*t.pageSize,(t.pageIndex+1)*t.pageSize)}trackByFn(t,i){return i}resetDB(){this.plus.resetDB(this.db,this.api)}}return t.\u0275fac=function(i){return new(i||t)(p.Y36(d.T),p.Y36(l.qu),p.Y36(g.i))},t.\u0275cmp=p.Xpm({type:t,selectors:[["app-nlmt-kh"]],decls:66,vars:15,consts:[[1,"container"],["id","add-btn","color","accent","mat-raised-button","","data-toggle","modal","data-target","#modelId",3,"click"],["id","back-btn","mat-raised-button","","color","primary",3,"click",4,"ngIf"],[3,"api","data",4,"ngIf"],[3,"db","api","filter"],[1,"row"],["class","table table-hover",4,"ngIf"],[3,"length","pageSize","pageSizeOptions","page"],[3,"api","global","form",4,"ngIf"],["mat-button","","color","warn",3,"click",4,"ngIf"],[3,"dataJson"],["id","openModal","type","button","data-toggle","modal","data-target","#modelId",1,"d-none"],["id","modelId","data-backdrop","static","tabindex","-1","role","dialog","aria-labelledby","modelTitleId","aria-hidden","true",1,"modal","fade"],["role","document",1,"modal-dialog","modal-lg"],[1,"modal-content"],[1,"modal-body"],[1,"container-fluid"],[3,"formGroup"],["hidden","","formControlName","_id"],["required","","type","text","autocomplete","off","matInput","","formControlName","MaKhachHang"],["matSuffix",""],["required","","type","text","autocomplete","off","matInput","","formControlName","KhachHang"],["required","","type","text","autocomplete","off","matInput","","formControlName","DiaChi"],["required","","type","text","autocomplete","off","matInput","","formControlName","MaGCS"],["required","","type","text","autocomplete","off","matInput","","formControlName","ChuTaiKhoan"],["required","","type","text","autocomplete","off","matInput","","formControlName","SoTaiKhoan"],["required","","type","text","autocomplete","off","matInput","","formControlName","NganHang"],["required","","type","text","autocomplete","off","matInput","","formControlName","Email"],[1,"modal-footer"],["id","closeModal","mat-raised-button","","color","primary","data-dismiss","modal",3,"click"],["mat-raised-button","","color","warn",3,"click",4,"ngIf"],["id","back-btn","mat-raised-button","","color","primary",3,"click"],[3,"api","data"],[1,"table","table-hover"],[1,"thead-inverse"],[4,"Device"],["color","primary",3,"click"],[4,"ngFor","ngForOf","ngForTrackBy"],[3,"click"],[3,"click",4,"Device"],["color","warn",3,"click",4,"ngIf"],["color","warn",3,"click"],[3,"api","global","form"],["mat-button","","color","warn",3,"click"],["mat-raised-button","","color","warn",3,"click"]],template:function(t,i){1&t&&(p.TgZ(0,"div",0),p.TgZ(1,"button",1),p.NdJ("click",function(){return i.reset()}),p.TgZ(2,"mat-icon"),p._uU(3,"control_point"),p.qZA(),p.qZA(),p.YNc(4,Kt,3,1,"button",2),p.YNc(5,Pt,1,1,"app-search-api",3),p.TgZ(6,"app-search-table",4),p.NdJ("filter",function(t){return i.search(t)}),p.qZA(),p.TgZ(7,"div",5),p.YNc(8,si,18,9,"table",6),p.TgZ(9,"mat-paginator",7),p.NdJ("page",function(t){return i.changePage(t)}),p.qZA(),p.qZA(),p.YNc(10,ci,1,3,"app-import-database",8),p.qZA(),p.YNc(11,ri,2,0,"button",9),p._UZ(12,"app-export-ecxel",10),p._UZ(13,"button",11),p.TgZ(14,"div",12),p.TgZ(15,"div",13),p.TgZ(16,"div",14),p.TgZ(17,"div",15),p.TgZ(18,"div",16),p.TgZ(19,"form",17),p._UZ(20,"input",18),p.TgZ(21,"mat-form-field"),p.TgZ(22,"mat-label"),p._uU(23,"M\xe3 kh\xe1ch h\xe0ng"),p.qZA(),p._UZ(24,"input",19),p._UZ(25,"span",20),p.qZA(),p.TgZ(26,"mat-form-field"),p.TgZ(27,"mat-label"),p._uU(28,"Kh\xe1ch h\xe0ng"),p.qZA(),p._UZ(29,"input",21),p._UZ(30,"span",20),p.qZA(),p.TgZ(31,"mat-form-field"),p.TgZ(32,"mat-label"),p._uU(33,"\u0110\u1ecba ch\u1ec9"),p.qZA(),p._UZ(34,"input",22),p._UZ(35,"span",20),p.qZA(),p.TgZ(36,"mat-form-field"),p.TgZ(37,"mat-label"),p._uU(38,"M\xe3 Ghi ch\u1ec9 s\u1ed1"),p.qZA(),p._UZ(39,"input",23),p._UZ(40,"span",20),p.qZA(),p.TgZ(41,"mat-form-field"),p.TgZ(42,"mat-label"),p._uU(43,"Ch\u1ee7 t\xe0i kho\u1ea3n"),p.qZA(),p._UZ(44,"input",24),p._UZ(45,"span",20),p.qZA(),p.TgZ(46,"mat-form-field"),p.TgZ(47,"mat-label"),p._uU(48,"S\u1ed1 t\xe0i kho\u1ea3n"),p.qZA(),p._UZ(49,"input",25),p._UZ(50,"span",20),p.qZA(),p.TgZ(51,"mat-form-field"),p.TgZ(52,"mat-label"),p._uU(53,"Ng\xe2n h\xe0ng"),p.qZA(),p._UZ(54,"input",26),p._UZ(55,"span",20),p.qZA(),p.TgZ(56,"mat-form-field"),p.TgZ(57,"mat-label"),p._uU(58,"Email"),p.qZA(),p._UZ(59,"input",27),p._UZ(60,"span",20),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.TgZ(61,"div",28),p.TgZ(62,"button",29),p.NdJ("click",function(){return i.closeModal()}),p.TgZ(63,"mat-icon"),p._uU(64,"close"),p.qZA(),p.qZA(),p.YNc(65,li,3,1,"button",30),p.qZA(),p.qZA(),p.qZA(),p.qZA()),2&t&&(p.xp6(4),p.Q6J("ngIf",i.filter.length>0),p.xp6(1),p.Q6J("ngIf",i.checkPer(10)),p.xp6(1),p.Q6J("db",i.db)("api",i.api),p.xp6(2),p.Q6J("ngIf",i.items.length+i.filter.length>0),p.xp6(1),p.Q6J("length",i.items.length)("pageSize",10)("pageSizeOptions",p.DdM(14,ui)),p.xp6(1),p.Q6J("ngIf",i.checkPer(4)),p.xp6(1),p.Q6J("ngIf",i.checkPer(5)),p.xp6(1),p.Q6J("dataJson",i.items),p.xp6(7),p.Q6J("formGroup",i.main),p.xp6(43),p.Q6J("@slideIn",void 0),p.xp6(3),p.Q6J("ngIf",i.checkPer(2)&&i.main.valid))},directives:[Z.lW,T.Hw,c.O5,E.D,F.NW,K.t,l._Y,l.JL,l.sg,l.Fj,l.JJ,l.u,x.KE,x.hX,k.Nt,l.Q7,x.R9,O.W,b.HP,c.sg,$.y],styles:[""],data:{animation:[r.Ym]}}),t})()},{path:"dmt-history",component:$t},{path:"dmt-input",component:Ht},{path:"dmt-list",component:st},{path:"dmt-list/:id",component:S}];let pi=(()=>{class t{}return t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=p.oAB({type:t}),t.\u0275inj=p.cJS({imports:[[f.Bz.forChild(hi)],f.Bz]}),t})(),di=(()=>{class t{}return t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=p.oAB({type:t}),t.\u0275inj=p.cJS({imports:[[c.ez,pi,s.ShareModule,a.m,o.D,e.X]]}),t})()}}]);