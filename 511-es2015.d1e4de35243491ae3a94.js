"use strict";(self.webpackChunk_4la=self.webpackChunk_4la||[]).push([[511],{51511:function(e,t,r){r.d(t,{k:function(){return l}});var n=r(74788),o=r(88638),i=r(31409),s=r(15194);let l=(()=>{class e{constructor(e,t){this.plus=e,this.excel=t,this.files=new n.vpe}ngOnInit(){}ngOnDestroy(){this.files.unsubscribe(),console.log("ngOnDestroy app-drop-files")}onDrop(e){this.files.emit(e),document.getElementById("dropZone").setAttribute("drop-active","false")}selectedFile(e){this.files.emit(e.target.files)}ondragover(){document.getElementById("dropZone").setAttribute("drop-active","true")}}return e.\u0275fac=function(t){return new(t||e)(n.Y36(o.T),n.Y36(i.x))},e.\u0275cmp=n.Xpm({type:e,selectors:[["app-drop-files"]],outputs:{files:"files"},decls:10,vars:0,consts:[[1,"row","justify-content-center"],["id","dropZone",1,"col-6",3,"appDropZone","dragover"],["for","file-import"],["for","file-import",1,"custom-file-upload","text-primary","mx-5"],["hidden","","id","file-import","type","file","multiple","false",3,"change"]],template:function(e,t){1&e&&(n.TgZ(0,"div",0),n.TgZ(1,"div",1),n.NdJ("appDropZone",function(e){return t.onDrop(e)})("dragover",function(){return t.ondragover()}),n.TgZ(2,"label",2),n._uU(3," K\xe9o th\u1ea3 file v\xe0o \u0111\xe2y ho\u1eb7c "),n.TgZ(4,"span"),n._uU(5,"\u2794"),n.qZA(),n.TgZ(6,"a"),n._uU(7," Ch\u1ecdn file "),n.qZA(),n.qZA(),n._UZ(8,"label",3),n.TgZ(9,"input",4),n.NdJ("change",function(e){return t.selectedFile(e)}),n.qZA(),n.qZA(),n.qZA())},directives:[s.i],styles:["label[_ngcontent-%COMP%]{width:100%;height:100%;text-align:center;line-height:170px;color:#00f;font-weight:bolder}#dropZone[_ngcontent-%COMP%]{width:40%;height:15%;border:2px dashed rgb(38,16,165);border-radius:3%}#dropZone[drop-active=true][_ngcontent-%COMP%]{box-shadow:inset 0 0 0 2px #00c;border:solid blue}"]}),e})()},15194:function(e,t,r){r.d(t,{i:function(){return o}});var n=r(74788);let o=(()=>{class e{constructor(){this.fileDrop=new n.vpe,this.preventBodyDrop=!0,this.active=!1}onDrop(e){e.preventDefault(),this.active=!1;const{dataTransfer:t}=e;if(t.items){const e=[];for(let r=0;r<t.items.length;r++)"file"===t.items[r].kind&&e.push(t.items[r].getAsFile());t.items.clear(),this.fileDrop.emit(e)}else{const e=t.files;t.clearData(),this.fileDrop.emit(Array.from(e))}}onDragOver(e){e.stopPropagation(),e.preventDefault(),this.active=!0}onDragLeave(e){this.active=!1}onBodyDragOver(e){this.preventBodyDrop&&(e.preventDefault(),e.stopPropagation())}onBodyDrop(e){this.preventBodyDrop&&e.preventDefault()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=n.lG2({type:e,selectors:[["","appDropZone",""]],hostVars:2,hostBindings:function(e,t){1&e&&n.NdJ("drop",function(e){return t.onDrop(e)})("dragover",function(e){return t.onDragOver(e)})("dragleave",function(e){return t.onDragLeave(e)})("dragover",function(e){return t.onBodyDragOver(e)},!1,n.pYS)("drop",function(e){return t.onBodyDrop(e)},!1,n.pYS),2&e&&n.ekj("drop-zone-active",t.active)},inputs:{preventBodyDrop:"preventBodyDrop"},outputs:{fileDrop:"appDropZone"}}),e})()},31409:function(e,t,r){r.d(t,{x:function(){return s}});var n=r(84487),o=r(74788),i=r(88638);let s=(()=>{class e{constructor(e){this.plus=e}readXlsx(e,t=!0){return new Promise((r,o)=>{let i={};if(this.plus.load(),null!=e&&"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"!=e.type&&"application/vnd.ms-excel"!=e.type)return this.plus.alertError("Kh\xf4ng ph\u1ea3i file excel");const s=new FileReader;s.readAsBinaryString(e),s.onloadend=e=>{const o=n.read(e.target.result,{type:"binary",cellDates:!0,dateNF:"DD/MM/YYYY"}),s=o.SheetNames;for(let r=0;r<s.length;r++){const e=s[r],l=n.utils.sheet_to_json(o.Sheets[e],{header:1,raw:t});i[`${e}`]=this.convertJSon(l)}this.plus.loaded(),r(i)}})}convertJSon(e){const t=[];for(let r=1;r<e.length;r++){const n={};e[0].forEach((t,o)=>{n[`${t}`]=e[r][o]}),t.push(n)}return t}convertJSonByX(e){const t=[];for(let r=1;r<e.length;r++)if("x"==e[r][0]){const n={};e[0].forEach((t,o)=>{n[`${t}`]=e[r][o]}),t.push(n)}return t}readXlsxToMerge(e){return console.log(e),new Promise((t,r)=>{this.plus.load();let o={};if(null!=e&&"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"!=e.type&&"application/vnd.ms-excel"!=e.type)return this.plus.alertError("Kh\xf4ng ph\u1ea3i file excel");const i=new FileReader;i.readAsBinaryString(e),i.onloadend=e=>{const r=n.read(e.target.result,{type:"binary",cellDates:!0,dateNF:"DD/MM/YYYY"}),i=r.SheetNames;for(let t=0;t<i.length;t++){const e=i[t];if("_Merge"==e)return this.plus.alertError("Vui l\xf2ng \u0111\u1ed5i t\xean sheet _Merge th\xe0nh t\xean kh\xe1c");const s=n.utils.sheet_to_json(r.Sheets[e],{header:1,raw:!0});o[`${0==t?"_Merge":e}`]=this.convertJSon(s)}t(o),this.plus.loaded()}})}}return e.\u0275fac=function(t){return new(t||e)(o.LFG(i.T))},e.\u0275prov=o.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()}}]);