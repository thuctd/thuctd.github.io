"use strict";(self.webpackChunkdlxl=self.webpackChunkdlxl||[]).push([[592],{83886:(D,m,s)=>{s.d(m,{N:()=>l});var r=s(17721),n=s(36895),_=s(94650);let l=(()=>{class d{}return d.\u0275fac=function(f){return new(f||d)},d.\u0275mod=_.oAB({type:d}),d.\u0275inj=_.cJS({imports:[n.ez,r.q]}),d})()},97012:(D,m,s)=>{s.d(m,{t:()=>f});var r=s(15439),n=s.n(r),_=s(80574),l=s(94650),d=s(10875),E=s(4859);let f=(()=>{class u{constructor(o){this.authSV=o}ngOnInit(){}export(){const o=[];this.dataJson.forEach(e=>{delete e.status,delete e.sync,delete e.canEdit,delete e.keyWord,delete e.__v,o.push(e)});const c=_.P6.json_to_sheet(o,{dateNF:"dd.MM.yyyy",cellDates:!0,cellStyles:!0}),t=_.P6.book_new();_.P6.book_append_sheet(t,c,this.api),_.NC(t,n()(Date.now()).format("YYYYMMDDHHMM")+"-4la-"+this.api+".xlsx")}exportTar(){for(let a=0;a<this.dataJson.length;a++)delete this.dataJson[a].dateModify,delete this.dataJson[a].canEdit,delete this.dataJson[a].keyWord,delete this.dataJson[a].__v,delete this.dataJson[a]._id;let o=JSON.stringify(this.dataJson),c="data:application/json;charset=utf-8,"+encodeURIComponent(o),t=`4la-${this.api?this.api:""}`+Date.now()+".json",e=document.createElement("a");e.setAttribute("href",c),e.setAttribute("download",t),e.click()}check(){return this.authSV.checkPer("admin",4)}}return u.\u0275fac=function(o){return new(o||u)(l.Y36(d.c1))},u.\u0275cmp=l.Xpm({type:u,selectors:[["app-export-ecxel"]],inputs:{dataJson:"dataJson",api:"api"},decls:5,vars:0,consts:[[1,"d-print-none"],["mat-raised-button","","color","primary",3,"click"]],template:function(o,c){1&o&&(l.TgZ(0,"span",0)(1,"button",1),l.NdJ("click",function(){return c.export()}),l._uU(2,"Export Excel"),l.qZA(),l.TgZ(3,"button",1),l.NdJ("click",function(){return c.exportTar()}),l._uU(4,"Export BackupDB"),l.qZA()())},dependencies:[E.lW]}),u})()},36973:(D,m,s)=>{s.d(m,{D:()=>M});var r=s(15228),n=s(94650),_=s(80574),l=s(25555),d=s(94559),E=s(36895),f=s(97392);function u(o,c){1&o&&(n.TgZ(0,"mat-icon",4),n._uU(1,"done"),n.qZA()),2&o&&n.Q6J("@slideX",void 0)}let M=(()=>{class o{constructor(t,e){this.plus=t,this.loadSV=e,this.numSheet=1,this.raw=!0,this.xls=new n.vpe,this.docx=new n.vpe,this.json=new n.vpe,this.ok=!1,this.sheetList=[],this.sheetSelect=[]}ngOnInit(){}ngOnDestroy(){this.xls.unsubscribe(),this.docx.unsubscribe(),console.log("ngOnDestroy app-read-xlsx")}readXlsx(t){this.loadSV.load("readXlsx");let e={};if(null!=t.target.files[0]&&"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"!=t.target.files[0].type&&"application/vnd.ms-excel"!=t.target.files[0].type)return this.plus.alertError("Kh\xf4ng ph\u1ea3i file excel");let a=t.target;if(!a)return this.plus.alertError("B\u1ea1n ch\u01b0a ch\u1ecdn file");const i=new FileReader;i.readAsArrayBuffer(a.files[0]),i.onloadend=h=>{const g=_.ij(h.target.result,{type:"binary",cellDates:!0,dateNF:"DD/MM/YYYY"}),C=g.SheetNames;for(let x=0;x<C.length;x++){const O=C[x];if("_Merge"==O)return this.plus.alertError("Vui l\xf2ng \u0111\u1ed5i t\xean sheet _Merge th\xe0nh t\xean kh\xe1c");const P=_.P6.sheet_to_json(g.Sheets[O],{header:1,raw:this.raw});0==x&&this.json.emit(this.convertJSon2(P)),this.xls.emit(P),e[`${0==x?"_Merge":O}`]=this.convertJSon(P)}this.docx.emit(e),this.ok=!0,this.loadSV.loaded("readXlsx")}}convertJSon(t){const e=[];for(let a=1;a<t.length;a++)if("x"==t[a][0]||"TRUE"==t[a][0]){const i={};t[0].forEach((h,p)=>{i[`${h}`]=t[a][p]}),e.push(i)}return e}convertJSon2(t){const e=[];for(let a=1;a<t.length;a++){const i={};t[0].forEach((h,p)=>{t[a][p]&&(i[`${h}`]=t[a][p])}),e.push(i)}return e}choose(t){const e=this.sheetSelect.indexOf(t);-1!==e?this.sheetSelect.splice(e,1):this.sheetSelect.push(t)}}return o.\u0275fac=function(t){return new(t||o)(n.Y36(l.T),n.Y36(d.b))},o.\u0275cmp=n.Xpm({type:o,selectors:[["app-read-xlsx"]],inputs:{numSheet:"numSheet",raw:"raw"},outputs:{xls:"xls",docx:"docx",json:"json"},decls:5,vars:1,consts:[["hidden","","id","read-xlsx","type","file","multiple","false",3,"input"],["for","read-xlsx",1,"custom-file-upload","text-primary"],["aria-hidden","true",1,"fa","text-success","fa-file-excel-o","fa-2x"],["color","primary",4,"ngIf"],["color","primary"]],template:function(t,e){1&t&&(n.TgZ(0,"input",0),n.NdJ("input",function(i){return e.readXlsx(i)}),n.qZA(),n.TgZ(1,"label",1),n._uU(2," Ch\u1ecdn file excel "),n._UZ(3,"i",2),n.YNc(4,u,2,1,"mat-icon",3),n.qZA()),2&t&&(n.xp6(4),n.Q6J("ngIf",e.ok))},dependencies:[E.O5,f.Hw],data:{animation:[r.Mq]}}),o})()},46936:(D,m,s)=>{s.d(m,{D:()=>M});var r=s(94650),n=s(24006),_=s(50727),l=s(25555),d=s(94559),E=s(54654),f=s(284),u=s(59549);let M=(()=>{class o{constructor(t,e,a,i){this.plus=t,this.fb=e,this.loadSV=a,this.idbSV=i,this.filter=new r.vpe,this.keySearch="keyWord",this.subs=new _.w0,this.searchForm=this.fb.group({input:["",[n.kI.required,n.kI.minLength(4)]]}),this.keyWord=[]}ngOnInit(){this.search()}ngOnDestroy(){}search(){let t=this.searchForm.value;if(this.searchForm.valid){this.loadSV.load("search"),console.log(t);const e=[];this.idbSV.IDB_DB_GetAll(this.db,this.api).subscribe(a=>{console.log("IDB_DB_GetAll()",a.length);const i=this.plus.removeAccents(t.input);0==a.length&&this.plus.alertMatSnackBar("Kh\xf4ng c\xf2n k\u1ebft qu\u1ea3 ph\xf9 h\u1ee3p");for(let h=0;h<a.length;h++)this.plus.removeAccents(JSON.stringify(a[h])).includes(i)&&e.push(a[h]);this.filter.emit(e),0==e.length&&this.plus.alertMatSnackBar("Kh\xf4ng c\xf2n k\u1ebft qu\u1ea3 ph\xf9 h\u1ee3p"),this.loadSV.loaded("search")})}}clear(){this.searchForm.reset()}}return o.\u0275fac=function(t){return new(t||o)(r.Y36(l.T),r.Y36(n.qu),r.Y36(d.b),r.Y36(E.Y))},o.\u0275cmp=r.Xpm({type:o,selectors:[["app-search-table"]],inputs:{db:"db",api:"api",keySearch:"keySearch"},outputs:{filter:"filter"},decls:2,vars:1,consts:[[3,"formGroup"],["matInput","","id","search-api","formControlName","input","placeholder","T\xecm ki\u1ebfm (F2)",3,"keyup.enter"]],template:function(t,e){1&t&&(r.TgZ(0,"mat-form-field",0)(1,"input",1),r.NdJ("keyup.enter",function(){return e.search()}),r.qZA()()),2&t&&r.Q6J("formGroup",e.searchForm)},dependencies:[n.Fj,n.JJ,n.JL,n.sg,n.u,f.Nt,u.KE]}),o})()}}]);