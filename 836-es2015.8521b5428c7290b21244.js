"use strict";(self.webpackChunk_4la=self.webpackChunk_4la||[]).push([[836],{76836:function(t,i,e){e.r(i),e.d(i,{DlxlModule:function(){return Hi}});var n=e(5923),o=e(48387),a=e(85913),s=e(88817),l=e(12057),c=e(15228),r=e(24751),u=e(16738),h=e.n(u),p=e(74788),g=e(57922),d=e(48842),m=e(33982),f=e(46833),Z=e(46113),T=e(12895),b=e(61260),x=e(2895),q=e(49356),k=e(17935),A=e(73888);function I(t,i){if(1&t&&(p.TgZ(0,"mat-option",36),p._uU(1),p.qZA()),2&t){const t=i.$implicit;p.Q6J("value",t.GiaTri),p.xp6(1),p.hij("",t.NoiDung," ")}}function _(t,i){if(1&t){const t=p.EpF();p.TgZ(0,"button",37),p.NdJ("click",function(){return p.CHM(t),p.oxw().save()}),p.TgZ(1,"mat-icon"),p._uU(2,"save"),p.qZA(),p.qZA()}2&t&&p.Q6J("@slideIn",void 0)}let N=(()=>{class t{constructor(t,i,e,n){this.plus=t,this.fb=i,this.rtSv=e,this.route=n,this.main=this.fb.group({_id:[,[]],KyThanhToan:[,[r.kI.required]],Email:[,],MaKhachHang:[,[r.kI.required]],KhachHang:[,[r.kI.required]],DiaChi:[,[r.kI.required]],MaGCS:[,],ChuTaiKhoan:[,],SoTaiKhoan:[,],NganHang:[,],Nam:[,[r.kI.required,r.kI.pattern("^[0-9]*$")]],Thang:[,[r.kI.required,r.kI.pattern("^[0-9]*$")]],SanLuong:[,[r.kI.required,r.kI.pattern("^[0-9]*$")]],DonGia:[,[r.kI.required,r.kI.pattern("^[0-9]*$")]],TruocThue:[,[r.kI.required,r.kI.pattern("^[0-9]*$")]],Thue:[,[r.kI.required,r.kI.pattern("^[0-9]*$")]],TongTien:[,[r.kI.required,r.kI.pattern("^[0-9]*$")]],KyHieuHoaDon:[,[]],SoHoaDon:[,[]],NgayMuaHang:[,[]],NgayHoaDon:[,[]],ThueSuat:[,[r.kI.pattern("^[0-9]*$")]],TrangThaiThanhToan:[,[r.kI.required,r.kI.pattern("^[0-9]*$")]],TrangThaiHoSo:[,[r.kI.required]],DaGuiMail:[,[r.kI.pattern("^[0-9]*$")]],TenBangKe:[,[]]}),this.title="L\u1eadp b\u1ea3ng k\xea",this.global=!0,this.dbName="dien-luc",this.api="dmt-input",this.db=null,this.userId=this.plus.userId,this.usr=this.plus.usr,this.items=[],this.selectedItem=null,this.filter=[],this.chart=[],this.errors=[]}ngOnInit(){this.plus.setTiTle(this.title),this.plus.IDB_InitDB(this.dbName).subscribe(t=>this.db=t),this.getIDB()}getIDB(){const t=this.route.snapshot.paramMap.get("id");this.plus.httpGet(this.api+"/"+t).subscribe(i=>{const e=this.plus.Crypt_DecryptRest(i);this.main.patchValue(e),(null==e||null==e)&&this.plus.IDB_DB_GetAllByIndexKey(this.db,"dmt-input","MaKhachHang",t).subscribe(t=>{this.main.patchValue(t)})})}ngOnDestroy(){console.log("Destroy",this.api),this.plus.subs.unsubscribe(),this.rtSv.leaveRoom(this.api)}save(){if(this.main.invalid)return;const t=this.main.value;null==t._id?(delete t._id,this.plus.httpPost(this.api,t,this.global).subscribe(t=>{t.status&&(this.plus.clickBtn("closeModal"),this.plus.updateAPi.next(!0))})):this.plus.httpPut(this.api,t,this.global).subscribe(t=>{t.status&&(this.plus.updateAPi.next(!0),this.plus.clickBtn("closeModal"))})}onEdit(t){this.selectedItem=t;const i=this.plus.dateToHtmlObj(t,["NgayHoaDon"]);this.main.patchValue(i),this.plus.clickBtn("openModal")}onDelete(t){!confirm("B\u1ea1n mu\u1ed1n x\xf3a?")||(this.plus.load(),this.plus.httpDisable(this.api,t,this.global).then(t=>{this.plus.updateAPi.next(!0)}))}chooseOpt(t,i,e,n=!1){this.main.controls[i].setValue(t[e]),n&&this.main.controls[i+"ID"].setValue(t._id)}convertInputDay(t,i){const e=h()(t,"DD-MM-YYYY").toDate();this.main.controls[i].setValue(e)}closeModal(){this.plus.goBack()}search(t){this.filter=t}find(t){this.items=t}checkPer(t){return this.plus.checkPer(this.api,t)}reload(){return this.plus.reload(this.dbName+"/"+this.api)}reset(){this.plus.loaded(),this.filter=[],this.getIDB(),this.main.reset({})}changePage(t){this.filter=this.items.slice(t.pageIndex*t.pageSize,(t.pageIndex+1)*t.pageSize)}ondragover(){document.getElementById("dropZone").setAttribute("drop-active","true")}trackByFn(t,i){return i}resetDB(){this.plus.resetDB(this.db,this.api)}}return t.\u0275fac=function(i){return new(i||t)(p.Y36(g.T),p.Y36(r.qu),p.Y36(d.i),p.Y36(m.gz))},t.\u0275cmp=p.Xpm({type:t,selectors:[["app-nlmt-input-detail"]],decls:129,vars:8,consts:[[1,"container"],[3,"formGroup"],[1,"row"],["type","text","readonly","","autocomplete","off","matInput","","formControlName","KhachHang"],["matSuffix",""],["type","text","readonly","","autocomplete","off","matInput","","formControlName","DiaChi"],["type","text","readonly","","autocomplete","off","matInput","","formControlName","TenBangKe"],[1,"col-6"],["hidden","","formControlName","_id"],["required","","type","text","autocomplete","off","matInput","","formControlName","KyThanhToan"],["type","text","readonly","","autocomplete","off","matInput","","formControlName","Email"],["type","text","readonly","","autocomplete","off","matInput","","formControlName","MaKhachHang"],["type","text","readonly","","autocomplete","off","matInput","","formControlName","MaGCS"],["type","text","autocomplete","off","matInput","","formControlName","ChuTaiKhoan"],["type","text","autocomplete","off","matInput","","formControlName","SoTaiKhoan"],["type","text","autocomplete","off","matInput","","formControlName","NganHang"],["type","text","autocomplete","off","matInput","","formControlName","Nam"],["type","text","autocomplete","off","matInput","","formControlName","Thang"],["type","text","autocomplete","off","matInput","","formControlName","NgayMuaHang"],["numberFormat","","type","text","autocomplete","off","matInput","","formControlName","SanLuong"],["type","text","autocomplete","off","matInput","","formControlName","DonGia"],["type","text","autocomplete","off","matInput","","formControlName","TruocThue"],["type","text","autocomplete","off","matInput","","formControlName","Thue"],["type","text","autocomplete","off","matInput","","formControlName","TongTien"],["type","text","autocomplete","off","matInput","","formControlName","KyHieuHoaDon"],["type","text","autocomplete","off","matInput","","formControlName","SoHoaDon"],["matInput","","formControlName","NgayHoaDon","placeholder","DD/MM/YYYY","autocomplete","off",3,"matDatepicker","blur","focus"],["NgayHoaDonInput",""],["matSuffix","",3,"for"],["NgayHoaDon",""],["hidden",""],["type","text","autocomplete","off","matInput","","formControlName","ThueSuat"],["required","","formControlName","TrangThaiHoSo"],[3,"value",4,"ngFor","ngForOf"],["id","closeModal","mat-raised-button","","color","primary","data-dismiss","modal",3,"click"],["mat-raised-button","","color","warn",3,"click",4,"ngIf"],[3,"value"],["mat-raised-button","","color","warn",3,"click"]],template:function(t,i){if(1&t){const t=p.EpF();p.TgZ(0,"div",0),p.TgZ(1,"form",1),p.TgZ(2,"div",2),p.TgZ(3,"mat-form-field"),p.TgZ(4,"mat-label"),p._uU(5,"Kh\xe1ch h\xe0ng"),p.qZA(),p._UZ(6,"input",3),p._UZ(7,"span",4),p.qZA(),p.TgZ(8,"mat-form-field"),p.TgZ(9,"mat-label"),p._uU(10,"\u0110\u1ecba ch\u1ec9"),p.qZA(),p._UZ(11,"input",5),p._UZ(12,"span",4),p.qZA(),p.TgZ(13,"mat-form-field"),p.TgZ(14,"mat-label"),p._uU(15,"T\xean b\u1ea3ng k\xea"),p.qZA(),p._UZ(16,"input",6),p._UZ(17,"span",4),p.qZA(),p.TgZ(18,"div",7),p._UZ(19,"input",8),p.TgZ(20,"mat-form-field"),p.TgZ(21,"mat-label"),p._uU(22,"K\u1ef3 thanh to\xe1n"),p.qZA(),p._UZ(23,"input",9),p._UZ(24,"span",4),p.qZA(),p.TgZ(25,"mat-form-field"),p.TgZ(26,"mat-label"),p._uU(27,"Email"),p.qZA(),p._UZ(28,"input",10),p._UZ(29,"span",4),p.qZA(),p.TgZ(30,"mat-form-field"),p.TgZ(31,"mat-label"),p._uU(32,"M\xe3 kh\xe1ch h\xe0ng"),p.qZA(),p._UZ(33,"input",11),p._UZ(34,"span",4),p.qZA(),p.TgZ(35,"mat-form-field"),p.TgZ(36,"mat-label"),p._uU(37,"M\xe3 G C S"),p.qZA(),p._UZ(38,"input",12),p._UZ(39,"span",4),p.qZA(),p.TgZ(40,"mat-form-field"),p.TgZ(41,"mat-label"),p._uU(42,"Ch\u1ee7 t\xe0i kho\u1ea3n"),p.qZA(),p._UZ(43,"input",13),p._UZ(44,"span",4),p.qZA(),p.TgZ(45,"mat-form-field"),p.TgZ(46,"mat-label"),p._uU(47,"S\u1ed1 t\xe0i kho\u1ea3n"),p.qZA(),p._UZ(48,"input",14),p._UZ(49,"span",4),p.qZA(),p.TgZ(50,"mat-form-field"),p.TgZ(51,"mat-label"),p._uU(52,"Ng\xe2n h\xe0ng"),p.qZA(),p._UZ(53,"input",15),p._UZ(54,"span",4),p.qZA(),p.TgZ(55,"mat-form-field"),p.TgZ(56,"mat-label"),p._uU(57,"N\u0103m"),p.qZA(),p._UZ(58,"input",16),p._UZ(59,"span",4),p.qZA(),p.TgZ(60,"mat-form-field"),p.TgZ(61,"mat-label"),p._uU(62,"Th\xe1ng"),p.qZA(),p._UZ(63,"input",17),p._UZ(64,"span",4),p.qZA(),p.TgZ(65,"mat-form-field"),p.TgZ(66,"mat-label"),p._uU(67,"Ng\xe0y mua h\xe0ng"),p.qZA(),p._UZ(68,"input",18),p._UZ(69,"span",4),p.qZA(),p.qZA(),p.TgZ(70,"div",7),p.TgZ(71,"mat-form-field"),p.TgZ(72,"mat-label"),p._uU(73,"S\u1ea3n l\u01b0\u1ee3ng"),p.qZA(),p._UZ(74,"input",19),p._UZ(75,"span",4),p.qZA(),p.TgZ(76,"mat-form-field"),p.TgZ(77,"mat-label"),p._uU(78,"\u0110\u01a1n gi\xe1"),p.qZA(),p._UZ(79,"input",20),p._UZ(80,"span",4),p.qZA(),p.TgZ(81,"mat-form-field"),p.TgZ(82,"mat-label"),p._uU(83,"Tr\u01b0\u1edbc thu\u1ebf"),p.qZA(),p._UZ(84,"input",21),p._UZ(85,"span",4),p.qZA(),p.TgZ(86,"mat-form-field"),p.TgZ(87,"mat-label"),p._uU(88,"Thu\u1ebf"),p.qZA(),p._UZ(89,"input",22),p._UZ(90,"span",4),p.qZA(),p.TgZ(91,"mat-form-field"),p.TgZ(92,"mat-label"),p._uU(93,"T\u1ed5ng ti\u1ec1n"),p.qZA(),p._UZ(94,"input",23),p._UZ(95,"span",4),p.qZA(),p.TgZ(96,"mat-form-field"),p.TgZ(97,"mat-label"),p._uU(98,"K\xfd hi\u1ec7u h\xf3a \u0111\u01a1n"),p.qZA(),p._UZ(99,"input",24),p._UZ(100,"span",4),p.qZA(),p.TgZ(101,"mat-form-field"),p.TgZ(102,"mat-label"),p._uU(103,"S\u1ed1 h\xf3a \u0111\u01a1n"),p.qZA(),p._UZ(104,"input",25),p._UZ(105,"span",4),p.qZA(),p.TgZ(106,"mat-form-field"),p.TgZ(107,"mat-label"),p._uU(108,"Ng\xe0y h\xf3a \u0111\u01a1n"),p.qZA(),p.TgZ(109,"input",26,27),p.NdJ("blur",function(){p.CHM(t);const e=p.MAs(110);return i.convertInputDay(e.value,"NgayHoaDon")})("focus",function(){return p.CHM(t),p.MAs(113).open()}),p.qZA(),p._UZ(111,"mat-datepicker-toggle",28),p._UZ(112,"mat-datepicker",null,29),p.qZA(),p.TgZ(114,"mat-form-field",30),p.TgZ(115,"mat-label"),p._uU(116,"Thu\u1ebf su\u1ea5t"),p.qZA(),p._UZ(117,"input",31),p._UZ(118,"span",4),p.qZA(),p.TgZ(119,"mat-form-field"),p.TgZ(120,"mat-label"),p._uU(121,"Tr\u1ea1ng th\xe1i h\u1ed3 s\u01a1"),p.qZA(),p.TgZ(122,"mat-select",32),p.YNc(123,I,2,2,"mat-option",33),p.ALo(124,"catalog"),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.TgZ(125,"button",34),p.NdJ("click",function(){return i.closeModal()}),p.TgZ(126,"mat-icon"),p._uU(127,"close"),p.qZA(),p.qZA(),p.YNc(128,_,3,1,"button",35),p.qZA()}if(2&t){const t=p.MAs(113);p.xp6(1),p.Q6J("formGroup",i.main),p.xp6(108),p.Q6J("matDatepicker",t),p.xp6(2),p.Q6J("for",t),p.xp6(12),p.Q6J("ngForOf",p.lcZ(124,6,"DMTTrangThaiHoSo")),p.xp6(2),p.Q6J("@slideIn",void 0),p.xp6(3),p.Q6J("ngIf",i.checkPer(2)&&i.main.valid)}},directives:[r._Y,r.JL,r.sg,f.KE,f.hX,Z.Nt,r.Fj,r.JJ,r.u,f.R9,r.Q7,T.hl,T.nW,T.Mq,b.gD,l.sg,x.lW,q.Hw,l.O5,k.ey],pipes:[A.pW],styles:[""],data:{animation:[c.Ym]}}),t})();var D=e(9157),y=function(t,i,e,n){return new(e||(e=Promise))(function(o,a){function s(t){try{c(n.next(t))}catch(i){a(i)}}function l(t){try{c(n.throw(t))}catch(i){a(i)}}function c(t){t.done?o(t.value):function(t){return t instanceof e?t:new e(function(i){i(t)})}(t.value).then(s,l)}c((n=n.apply(t,i||[])).next())})};let v=(()=>{class t{constructor(t,i,e){this.fb=t,this.plus=i,this.rtSv=e,this.payForm=this.fb.group({_id:[,[]],TenBangKe:[,[r.kI.required]],TrangThai:[,[r.kI.required]],LichSuCapNhat:[,[r.kI.required]],TongPhatLen:[,[r.kI.required,r.kI.pattern("^[0-9]*$")]],ThanhTienTruocThue:[,[r.kI.required,r.kI.pattern("^[0-9]*$")]],Thue:[,[r.kI.required,r.kI.pattern("^[0-9]*$")]],ThanhTienSauThue:[,[r.kI.required,r.kI.pattern("^[0-9]*$")]],DanhSach:[]})}statusMail(t){console.log("statusMail()"),this.plus.httpPut("dmt-input",{_id:t._id,DaGuiMail:1,dateModify:Date.now()},!0).subscribe(t=>{console.log(t)})}updateNameBill(t,i){return y(this,void 0,void 0,function*(){const e=h()().format("x");console.log("updateNameBill()",+e);const n=t,o=Math.ceil(t.length/200),a=[];for(let t=0;t<n.length;t++)a.push(n[t]._id);for(let s=0;s<o;s++){const n={ids:a.slice(200*s,s+200),setData:{TenBangKe:i,dateModify:+e,TrangThaiHoSo:2},dateModify:+e};yield this.plus.httpPut("dmt-input/update",n,!0).toPromise().then(t=>{});const o=this.geneBodyPay(t,h()(+e,"x").toDate(),"G\u1eedi b\u1ea3ng k\xea");yield this.plus.httpPost("dmt-pay",o,!0).toPromise().then(t=>{}),this.plus.reload("dien-luc/dmt-input")}})}changeStatusList(t,i){return y(this,void 0,void 0,function*(){const e=h()().format("x");console.log("changeStatusList()",e);const n=t.DanhSach,o=Math.ceil(t.DanhSach.length/200),a=[];for(let t=0;t<n.length;t++)a.push(n[t]._id);for(let s=0;s<o;s++){const n={ids:a.slice(200*s,s+200),setData:{dateModify:+e,TrangThaiHoSo:i},dateModify:+e};yield this.plus.httpPut("dmt-input/update",n,!0).toPromise().then(t=>{}),t.TrangThai=i,delete t.__v,yield this.plus.httpPut("dmt-pay",t,!0).toPromise().then(t=>{}),this.plus.reload("dien-luc/dmt-pay")}})}geneBodyPay(t,i,e){const n={};n.TenBangKe=h()(i).format("YYMMDDHHmm"),n.KyThanhToan=h()(i).format("YYYY-M"),n.LichSuCapNhat=[e+": "+h()().format("HH:mm-DD/MM/YYYY")],n.TrangThai=2,n.TongPhatLen=0,n.ThanhTienTruocThue=0,n.Thue=0,n.ThanhTienSauThue=0;for(let o=0;o<t.length;o++){const i=t[o];n.DanhSach=t,n.TongPhatLen+=i.SanLuong,n.ThanhTienTruocThue+=i.TruocThue,n.Thue+=i.Thue,n.ThanhTienSauThue+=i.TongTien}return console.log(n),n}geneBodyMail(t,i,e){return{from:this.plus.user.value.unit,status:0,email:t.Email,title:`Th\xf4ng b\xe1o chi ti\u1ec1n \u0111i\u1ec7n NLMTMN th\xe1ng ${+i.getMonth()+1} n\u0103m ${i.getFullYear()}`,company:t.KhachHang,index:e,message:`<p>K\xednh g\u1eedi kh\xe1ch h\xe0ng: ${t.KhachHang}.</p>\n          <p>\u0110i\u1ec7n l\u1ef1c Xu\xe2n L\u1ed9c k\xednh g\u1eedi \u0111\u1ebfn qu\xfd kh\xe1ch h\xe0ng n\u1ed9i dung thanh to\xe1n ti\u1ec1n \u0111i\u1ec7n m\u1eb7t tr\u1eddi tr\xean m\xe1i nh\xe0 v\u1edbi n\u1ed9i dung nh\u01b0 sau:</p>\n          <ul> M\xe3 kh\xe1ch h\xe0ng: ${t.MaKhachHang}.</ul>\n          <ul> T\xean kh\xe1ch h\xe0ng: ${t.KhachHang}.</ul>\n          <ul> \u0110\u1ecba ch\u1ec9: ${t.DiaChi}.</ul>\n          <ul> M\xe3 ghi ch\u1ec9 s\u1ed1: ${t.MaGCS}.</ul>\n          <ul> T\xean t\xe0i kho\u1ea3n: ${t.ChuTaiKhoan}.</ul>\n          <ul> S\u1ed1 t\xe0i kho\u1ea3n: ${t.SoTaiKhoan}.</ul>\n          <ul> Ng\xe2n h\xe0ng: ${t.NganHang}.</ul>\n          <ul> N\u0103m: ${i.getFullYear()}.</ul>\n          <ul> Th\xe1ng: ${+i.getMonth()+1}.</ul>\n          <ul> \u0110i\u1ec7n ph\xe1t l\xean l\u01b0\u1edbi: ${this.plus.numberWithCommas(t.SanLuong)} kWh.</ul>\n          <ul> \u0110\u01a1n gi\xe1: ${this.plus.numberWithCommas(t.DonGia)} VND/kWh.</ul>\n          <ul> T\u1ec9 l\u1ec7 Thu\u1ebf: ${t.TiLeThue} %.</ul>\n          <ul> Th\xe0nh ti\u1ec1n ch\u01b0a thu\u1ebf VAT: ${this.plus.numberWithCommas(t.TruocThue)} VND.</ul>\n          <ul> Thu\u1ebf VAT: ${this.plus.numberWithCommas(t.Thue)} VND.</ul>\n          <ul> T\u1ed5ng ti\u1ec1n: ${this.plus.numberWithCommas(t.TongTien)} VND.</ul>\n          <p> M\u1ecdi \xfd ki\u1ebfn ph\u1ea3n h\u1ed3i vui l\xf2ng li\xean h\u1ec7 \u0110i\u1ec7n l\u1ef1c Xu\xe2n L\u1ed9c qua s\u1ed1 \u0111i\u1ec7n tho\u1ea1i Mr. \u0110\u1ea1t - <a href="tel:0937232239">0937232239 </a> ho\u1eb7c Mrs. Ph\u01b0\u1edbc Anh - <a href="tel:0583223344" >0583223344 </a> \u0111\u1ec3 \u0111\u01b0\u1ee3c gi\u1ea3i \u0111\xe1p.</p>\n          <p> Ph\u1ea3n h\u1ed3i h\xf3a \u0111\u01a1n qu\xfd kh\xe1ch vui l\xf2ng g\u1eedi email v\u1ec1 c\u1ea3 02 \u0111\u1ecba ch\u1ec9: <a href="mailto:dienlucxuanloc.nlmt@gmail.com;tckt.dlxl.pcdn@gmail.com">dienlucxuanloc.nlmt@gmail.com</a> v\xe0 <a href="mailto:dienlucxuanloc.nlmt@gmail.com;tckt.dlxl.pcdn@gmail.com">tckt.dlxl.pcdn@gmail.com</a> </p>\n          Tr\xe2n tr\u1ecdng.`}}}return t.\u0275fac=function(i){return new(i||t)(p.LFG(r.qu),p.LFG(g.T),p.LFG(d.i))},t.\u0275prov=p.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var U=e(25862);function J(t,i){if(1&t){const t=p.EpF();p.TgZ(0,"button",13),p.NdJ("click",function(){return p.CHM(t),p.oxw().approveList()}),p._uU(1,"Duy\u1ec7t"),p.qZA()}}function M(t,i){if(1&t){const t=p.EpF();p.TgZ(0,"button",14),p.NdJ("click",function(){return p.CHM(t),p.oxw().returnList()}),p._uU(1,"Tr\u1ea3 l\u1ea1i"),p.qZA()}}function H(t,i){if(1&t){const t=p.EpF();p.TgZ(0,"button",14),p.NdJ("click",function(){return p.CHM(t),p.oxw().exportWord()}),p._uU(1,"Xu\u1ea5t b\u1ea3ng k\xea"),p.qZA()}}function w(t,i){if(1&t){const t=p.EpF();p.TgZ(0,"button",14),p.NdJ("click",function(){return p.CHM(t),p.oxw().exportUNC()}),p._uU(1,"Xu\u1ea5t UNC"),p.qZA()}}function C(t,i){if(1&t){const t=p.EpF();p.TgZ(0,"button",13),p.NdJ("click",function(){return p.CHM(t),p.oxw().save()}),p._uU(1,"L\u01b0u"),p.qZA()}}function S(t,i){if(1&t){const t=p.EpF();p.TgZ(0,"button",13),p.NdJ("click",function(){return p.CHM(t),p.oxw().paidList()}),p._uU(1,"\u0110\xe3 thanh to\xe1n"),p.qZA()}}function B(t,i){if(1&t){const t=p.EpF();p.TgZ(0,"mat-icon",15),p.NdJ("click",function(){return p.CHM(t),p.oxw().searchText=""}),p._uU(1,"close"),p.qZA()}}function Y(t,i){1&t&&(p.TgZ(0,"th"),p._uU(1,"Ch\u1ee7 t\xe0i kho\u1ea3n"),p.qZA())}function Q(t,i){1&t&&(p.TgZ(0,"th"),p._uU(1,"S\u1ed1 t\xe0i kho\u1ea3n"),p.qZA())}function K(t,i){1&t&&(p.TgZ(0,"th"),p._uU(1,"Ng\xe2n h\xe0ng"),p.qZA())}function F(t,i){1&t&&(p.TgZ(0,"th"),p._uU(1,"Tr\u01b0\u1edbc thu\u1ebf"),p.qZA())}function O(t,i){1&t&&(p.TgZ(0,"th"),p._uU(1,"Thu\u1ebf"),p.qZA())}function $(t,i){if(1&t){const t=p.EpF();p.TgZ(0,"td",16),p.NdJ("click",function(){p.CHM(t);const i=p.oxw().$implicit;return p.oxw().onEdit(i)}),p._uU(1),p.qZA()}if(2&t){const t=p.oxw().$implicit;p.xp6(1),p.Oqu(t.ChuTaiKhoan)}}function E(t,i){if(1&t){const t=p.EpF();p.TgZ(0,"td",16),p.NdJ("click",function(){p.CHM(t);const i=p.oxw().$implicit;return p.oxw().onEdit(i)}),p._uU(1),p.qZA()}if(2&t){const t=p.oxw().$implicit;p.xp6(1),p.Oqu(t.SoTaiKhoan)}}function P(t,i){if(1&t){const t=p.EpF();p.TgZ(0,"td",16),p.NdJ("click",function(){p.CHM(t);const i=p.oxw().$implicit;return p.oxw().onEdit(i)}),p._uU(1),p.qZA()}if(2&t){const t=p.oxw().$implicit;p.xp6(1),p.Oqu(t.NganHang)}}function L(t,i){if(1&t&&(p.TgZ(0,"td",18),p._uU(1),p.ALo(2,"number"),p.qZA()),2&t){const t=p.oxw().$implicit;p.xp6(1),p.Oqu(p.lcZ(2,1,t.TruocThue))}}function G(t,i){if(1&t&&(p.TgZ(0,"td",18),p._uU(1),p.ALo(2,"number"),p.qZA()),2&t){const t=p.oxw().$implicit;p.xp6(1),p.Oqu(p.lcZ(2,1,t.Thue))}}function R(t,i){if(1&t){const t=p.EpF();p.TgZ(0,"mat-icon",26),p.NdJ("click",function(){p.CHM(t);const i=p.oxw().$implicit;return p.oxw().onDelete(i)}),p._uU(1,"delete"),p.qZA()}}function z(t,i){if(1&t){const t=p.EpF();p.TgZ(0,"tr"),p.TgZ(1,"td",16),p.NdJ("click",function(){const i=p.CHM(t).$implicit;return p.oxw().onEdit(i)}),p._uU(2),p.qZA(),p.TgZ(3,"td",16),p.NdJ("click",function(){const i=p.CHM(t).$implicit;return p.oxw().onEdit(i)}),p._uU(4),p.qZA(),p.YNc(5,$,2,1,"td",17),p.YNc(6,E,2,1,"td",17),p.YNc(7,P,2,1,"td",17),p.TgZ(8,"td",16),p.NdJ("click",function(){const i=p.CHM(t).$implicit;return p.oxw().onEdit(i)}),p._uU(9),p.ALo(10,"number"),p.qZA(),p.TgZ(11,"td",18),p._uU(12),p.ALo(13,"number"),p.qZA(),p.YNc(14,L,3,3,"td",19),p.YNc(15,G,3,3,"td",19),p.TgZ(16,"td",18),p._uU(17),p.ALo(18,"number"),p.qZA(),p.TgZ(19,"td",18),p.TgZ(20,"span",20),p.NdJ("blur",function(i){const e=p.CHM(t).$implicit;return p.oxw().changeLabel(i,e)}),p._uU(21),p.qZA(),p.qZA(),p.TgZ(22,"td",18),p.TgZ(23,"span",20),p.NdJ("blur",function(i){const e=p.CHM(t).$implicit;return p.oxw().changeSeri(i,e)}),p._uU(24),p.qZA(),p.qZA(),p.TgZ(25,"td",21),p.TgZ(26,"mat-form-field"),p.TgZ(27,"input",22),p.NdJ("focus",function(){return p.CHM(t),p.MAs(30).open()})("dateChange",function(i){const e=p.CHM(t).$implicit;return p.oxw().changeDate(i,e)}),p.qZA(),p._UZ(28,"mat-datepicker-toggle",23),p._UZ(29,"mat-datepicker",null,24),p.qZA(),p.qZA(),p.TgZ(31,"td"),p.YNc(32,R,2,0,"mat-icon",25),p.qZA(),p.qZA()}if(2&t){const t=i.$implicit,e=p.MAs(30),n=p.oxw();p.xp6(2),p.Oqu(t.MaKhachHang),p.xp6(2),p.Oqu(t.KhachHang),p.xp6(1),p.Q6J("Device",3),p.xp6(1),p.Q6J("Device",3),p.xp6(1),p.Q6J("Device",3),p.xp6(2),p.Oqu(p.lcZ(10,18,t.SanLuong)),p.xp6(3),p.Oqu(p.lcZ(13,20,t.DonGia)),p.xp6(2),p.Q6J("Device",3),p.xp6(1),p.Q6J("Device",3),p.xp6(2),p.Oqu(p.lcZ(18,22,t.TongTien)),p.xp6(3),p.Q6J("contentEditable",!0),p.xp6(1),p.hij(" ",t.KyHieuHoaDon,""),p.xp6(2),p.Q6J("contentEditable",!0),p.xp6(1),p.hij(" ",t.SoHoaDon," "),p.xp6(3),p.Q6J("matDatepicker",e)("value",t.NgayHoaDon),p.xp6(1),p.Q6J("for",e),p.xp6(4),p.Q6J("ngIf",n.checkPer(4)&&t.TrangThai<2)}}let V=(()=>{class t{constructor(t,i,e,n,o,a){this.plus=t,this.fb=i,this.rtSv=e,this.docxSv=n,this.route=o,this.nlmtSv=a,this.main=this.fb.group({Email:[,[r.kI.required]],MaKhachHang:[,[r.kI.required]],KhachHang:[,[r.kI.required]],DiaChi:[,[r.kI.required]],MaGCS:[,[r.kI.required]],ChuTaiKhoan:[,[r.kI.required]],SoTaiKhoan:[,[r.kI.required]],NganHang:[,[r.kI.required]],Nam:[,[r.kI.required,r.kI.pattern("^[0-9]*$")]],Thang:[,[r.kI.required,r.kI.pattern("^[0-9]*$")]],SanLuong:[,[r.kI.required,r.kI.pattern("^[0-9]*$")]],DonGia:[,[r.kI.required,r.kI.pattern("^[0-9]*$")]],TruocThue:[,[r.kI.required,r.kI.pattern("^[0-9]*$")]],Thue:[,[r.kI.required,r.kI.pattern("^[0-9]*$")]],TongTien:[,[r.kI.required,r.kI.pattern("^[0-9]*$")]],KyHieuHoaDon:[,[r.kI.required,r.kI.minLength(3)]],SoHoaDon:[,[r.kI.required,r.kI.minLength(3)]],NgayHoaDon:[,[r.kI.required]],TrangThai:[,],DaGuiMail:[0]}),this.title="Chi ti\u1ebft b\u1ea3ng k\xea",this.global=!0,this.dbName="dien-luc",this.api="dmt-pay",this.db=null,this.userId=this.plus.userId,this.usr=this.plus.usr,this.selectedItem=null,this.filter=[],this.chart=[],this.errors=[],this.searchText=""}ngOnInit(){this.plus.setTiTle(this.title),this.plus.IDB_InitDB(this.dbName).subscribe(t=>function(t,i,e,n){return new(e||(e=Promise))(function(o,a){function s(t){try{c(n.next(t))}catch(i){a(i)}}function l(t){try{c(n.throw(t))}catch(i){a(i)}}function c(t){t.done?o(t.value):function(t){return t instanceof e?t:new e(function(i){i(t)})}(t.value).then(s,l)}c((n=n.apply(t,i||[])).next())})}(this,void 0,void 0,function*(){this.getIDB(),this.db=t,this.plus.updateRealtime(this.db,this.api,this.global),this.plus.IDB_DB_CleanTrash(t,this.api),this.plus.updateAPi.subscribe(t=>{t&&this.getIDB()})}))}getIDB(){const t=this.route.snapshot.paramMap.get("id");this.plus.httpGet(this.api+"/"+t).subscribe(i=>{let e=this.plus.Crypt_DecryptRest(i);this.items=e,(null==e||null==e)&&this.plus.IDB_DB_GetAllByIndexKey(this.db,"dmt-pay","_id",t).subscribe(t=>{console.log("getIDB d\u1ef1 ph\xf2ng",this.items),e=t})})}changeDate(t,i){const e=this.items.DanhSach.indexOf(i);this.items.DanhSach[e].NgayHoaDon=t.value}changeLabel(t,i){const e=this.items.DanhSach.indexOf(i);this.items.DanhSach[e].KyHieuHoaDon=t.target.innerText}changeSeri(t,i){const e=this.items.DanhSach.indexOf(i);this.items.DanhSach[e].SoHoaDon=t.target.innerText}ngOnDestroy(){console.log("Destroy",this.api),this.plus.subs.unsubscribe(),this.rtSv.leaveRoom(this.api)}save(){const t=this.items;delete t.__v,this.plus.httpPut(this.api,t,this.global).subscribe(t=>{t.status&&this.plus.updateAPi.next(!0)})}completeBill(){}exportWord(){this.docxSv.loadFileUrl("https://thuctd.github.io/templates/BangKe-PTC.docx").then(t=>{this.docxSv.generateOne(this.items,t,"PTC").then(t=>{console.log(t)})})}exportUNC(){this.docxSv.loadFileUrl("https://thuctd.github.io/templates/4la-UNC-HDBank.docx").then(t=>{this.docxSv.generateOne(this.items,t,"PTC").then(t=>{console.log(t)})})}returnList(){const t=prompt("L\xed do tr\u1ea3 h\u1ed3 s\u01a1?");if(0==t.length)return this.plus.alertWarning("B\u1ea1n ph\u1ea3i nh\u1eadp l\xed do tr\u1ea3 h\u1ed3 s\u01a1");const i=this.items;i.LichSuCapNhat.push(`Tr\u1ea3 l\u1ea1i h\u1ed3 s\u01a1 v\u1edbi l\xed do ${t}: ${h()().format("DD/MM/YYYY HH:mm")}`),this.nlmtSv.changeStatusList(i,0)}approveList(){const t=this.items;t.LichSuCapNhat.push(`H\u1ed3 s\u01a1 \u0111\xe3 \u0111\u01b0\u1ee3c ch\u1ea5p nh\u1eadn: ${h()().format("DD/MM/YYYY HH:mm")}`),this.nlmtSv.changeStatusList(t,3)}paidList(){const t=this.items;t.LichSuCapNhat.push(`H\u1ed3 s\u01a1 \u0111\xe3 thanh to\xe1n ${h()().format("DD/MM/YYYY HH:mm")}`),this.nlmtSv.changeStatusList(t,4)}report(){}complete(){}onEdit(t){this.selectedItem=t;const i=this.plus.dateToHtmlObj(t,[""]);this.main.patchValue(i),this.plus.clickBtn("openModal")}onDelete(t){!confirm("B\u1ea1n mu\u1ed1n x\xf3a?")||(this.plus.load(),this.plus.httpDisable(this.api,t,this.global).then(t=>{this.plus.updateAPi.next(!0)}))}search(t){this.filter=t}find(t){this.items=t}checkPer(t){return this.plus.checkPer(this.api,t)}reload(){return this.plus.reload(this.dbName+"/"+this.api)}goBack(){this.plus.goBack()}changePage(t){}trackByFn(t,i){return i}resetDB(){this.plus.resetDB(this.db,this.api)}}return t.\u0275fac=function(i){return new(i||t)(p.Y36(g.T),p.Y36(r.qu),p.Y36(d.i),p.Y36(D.E),p.Y36(m.gz),p.Y36(v))},t.\u0275cmp=p.Xpm({type:t,selectors:[["app-nlmt-detail"]],decls:46,vars:20,consts:[[1,"container-fluid"],["id","back-btn","mat-raised-button","","color","primary",3,"click"],["mat-raised-button","","color","warn",3,"click",4,"ngIf"],["mat-raised-button","","color","primary",3,"click",4,"ngIf"],[1,"row"],["matSuffix","","color","warn",3,"click",4,"ngIf"],["matInput","","id","search-api","placeholder","T\xecm ki\u1ebfm nhanh (F2)","value","value",3,"ngModel","ngModelChange"],[1,"tit","text-center"],[1,"table","table-hover"],[1,"thead-inverse"],[4,"Device"],["color","primary",3,"click"],[4,"ngFor","ngForOf"],["mat-raised-button","","color","warn",3,"click"],["mat-raised-button","","color","primary",3,"click"],["matSuffix","","color","warn",3,"click"],[1,"align-middle",3,"click"],["class","align-middle",3,"click",4,"Device"],[1,"align-middle"],["class","align-middle",4,"Device"],[3,"contentEditable","blur"],[1,"align-text-top"],["matInput","",3,"matDatepicker","value","focus","dateChange"],["matSuffix","",3,"for"],["picker",""],["color","warn",3,"click",4,"ngIf"],["color","warn",3,"click"]],template:function(t,i){1&t&&(p.TgZ(0,"div",0),p.TgZ(1,"button",1),p.NdJ("click",function(){return i.goBack()}),p.TgZ(2,"mat-icon"),p._uU(3,"undo"),p.qZA(),p.qZA(),p.YNc(4,J,2,0,"button",2),p.YNc(5,M,2,0,"button",3),p.YNc(6,H,2,0,"button",3),p.YNc(7,w,2,0,"button",3),p.YNc(8,C,2,0,"button",2),p.YNc(9,S,2,0,"button",2),p.TgZ(10,"div",4),p.TgZ(11,"mat-form-field"),p.YNc(12,B,2,0,"mat-icon",5),p.TgZ(13,"input",6),p.NdJ("ngModelChange",function(t){return i.searchText=t}),p.qZA(),p.qZA(),p.TgZ(14,"h5",7),p._uU(15),p.qZA(),p.TgZ(16,"table",8),p.TgZ(17,"thead",9),p.TgZ(18,"tr"),p.TgZ(19,"th"),p._uU(20,"M\xe3 kh\xe1ch h\xe0ng"),p.qZA(),p.TgZ(21,"th"),p._uU(22,"Kh\xe1ch h\xe0ng"),p.qZA(),p.YNc(23,Y,2,0,"th",10),p.YNc(24,Q,2,0,"th",10),p.YNc(25,K,2,0,"th",10),p.TgZ(26,"th"),p._uU(27,"S\u1ea3n l\u01b0\u1ee3ng"),p.qZA(),p.TgZ(28,"th"),p._uU(29,"\u0110\u01a1n gi\xe1"),p.qZA(),p.YNc(30,F,2,0,"th",10),p.YNc(31,O,2,0,"th",10),p.TgZ(32,"th"),p._uU(33,"T\u1ed5ng ti\u1ec1n"),p.qZA(),p.TgZ(34,"th"),p._uU(35,"K\xfd hi\u1ec7u h\xf3a \u0111\u01a1n"),p.qZA(),p.TgZ(36,"th"),p._uU(37,"S\u1ed1 h\xf3a \u0111\u01a1n"),p.qZA(),p.TgZ(38,"th"),p._uU(39,"Ng\xe0y h\xf3a \u0111\u01a1n"),p.qZA(),p.TgZ(40,"th"),p.TgZ(41,"mat-icon",11),p.NdJ("click",function(){return i.reload()}),p._uU(42,"cached"),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.TgZ(43,"tbody"),p.YNc(44,z,33,24,"tr",12),p.ALo(45,"filter"),p.qZA(),p.qZA(),p.qZA(),p.qZA()),2&t&&(p.xp6(1),p.Q6J("@slideIn",void 0),p.xp6(3),p.Q6J("ngIf",(null==i.items?null:i.items.TrangThai)>1&&(null==i.items?null:i.items.TrangThai)<3),p.xp6(1),p.Q6J("ngIf",(null==i.items?null:i.items.TrangThai)>1&&(null==i.items?null:i.items.TrangThai)<3),p.xp6(1),p.Q6J("ngIf",(null==i.items?null:i.items.TrangThai)>1&&(null==i.items?null:i.items.TrangThai)<3),p.xp6(1),p.Q6J("ngIf",(null==i.items?null:i.items.TrangThai)>1&&(null==i.items?null:i.items.TrangThai)<3),p.xp6(1),p.Q6J("ngIf",(null==i.items?null:i.items.TrangThai)>1),p.xp6(1),p.Q6J("ngIf",3==(null==i.items?null:i.items.TrangThai)),p.xp6(3),p.Q6J("ngIf",i.searchText.length>0),p.xp6(1),p.Q6J("ngModel",i.searchText),p.xp6(2),p.hij("B\u1ea2NG K\xca THANH TO\xc1N TI\u1ec0N \u0110I\u1ec6N M\u1eb6T TR\u1edcI S\u1ed0 ",null==i.items?null:i.items.TenBangKe,""),p.xp6(1),p.Q6J("@slideIn",void 0),p.xp6(7),p.Q6J("Device",3),p.xp6(1),p.Q6J("Device",3),p.xp6(1),p.Q6J("Device",3),p.xp6(5),p.Q6J("Device",3),p.xp6(1),p.Q6J("Device",3),p.xp6(13),p.Q6J("ngForOf",p.xi3(45,17,null==i.items?null:i.items.DanhSach,i.searchText)))},directives:[x.lW,q.Hw,l.O5,f.KE,Z.Nt,r.Fj,r.JJ,r.On,U.HP,l.sg,f.R9,T.hl,T.nW,T.Mq],pipes:[A.Cf,l.JJ],styles:["span[_ngcontent-%COMP%]{text-align:center;display:block;border-bottom:dotted 1px}mat-form-field[_ngcontent-%COMP%]{padding:0!important}.mat-form-field-infix[_ngcontent-%COMP%]{width:100px!important}"],data:{animation:[c.Ym]}}),t})();var W=e(7365),X=e(23487),j=e(68042),tt=e(55352),it=e(97012);function et(t,i){if(1&t){const t=p.EpF();p.TgZ(0,"app-search-api",12),p.NdJ("data",function(i){return p.CHM(t),p.oxw().find(i)}),p.qZA()}if(2&t){const t=p.oxw();p.Q6J("api",t.api)}}function nt(t,i){1&t&&(p.TgZ(0,"th"),p._uU(1,"Tr\u1ea1ng th\xe1i"),p.qZA())}function ot(t,i){1&t&&(p.TgZ(0,"th"),p._uU(1,"L\u1ecbch s\u1eed c\u1eadp nh\u1eadt"),p.qZA())}function at(t,i){1&t&&(p.TgZ(0,"th"),p._uU(1,"Th\xe0nh ti\u1ec1n sau thu\u1ebf"),p.qZA())}function st(t,i){if(1&t&&(p.TgZ(0,"td",18),p._uU(1),p.ALo(2,"enum"),p.qZA()),2&t){const t=p.oxw().$implicit;p.s9C("routerLink",t._id),p.xp6(1),p.Oqu(p.xi3(2,2,t.TrangThai,"DMTTrangThaiHoSo"))}}function lt(t,i){if(1&t&&(p.TgZ(0,"td",18),p._uU(1),p.qZA()),2&t){const t=p.oxw().$implicit;p.s9C("routerLink",t._id),p.xp6(1),p.Oqu(t.LichSuCapNhat)}}function ct(t,i){if(1&t&&(p.TgZ(0,"td",20),p._uU(1),p.ALo(2,"numberPipe"),p.qZA()),2&t){const t=p.oxw().$implicit;p.s9C("routerLink",t._id),p.xp6(1),p.Oqu(p.lcZ(2,2,t.ThanhTienSauThue))}}function rt(t,i){if(1&t){const t=p.EpF();p.TgZ(0,"mat-icon",23),p.NdJ("click",function(){p.CHM(t);const i=p.oxw().$implicit;return p.oxw(2).onDelete(i)}),p._uU(1,"delete"),p.qZA()}}function ut(t,i){if(1&t&&(p.TgZ(0,"tr"),p.TgZ(1,"td",18),p._uU(2),p.qZA(),p.YNc(3,st,3,5,"td",19),p.YNc(4,lt,2,2,"td",19),p.TgZ(5,"td",20),p._uU(6),p.ALo(7,"numberPipe"),p.qZA(),p.YNc(8,ct,3,4,"td",21),p.TgZ(9,"td"),p.YNc(10,rt,2,0,"mat-icon",22),p.qZA(),p.qZA()),2&t){const t=i.$implicit,e=p.oxw(2);p.xp6(1),p.s9C("routerLink",t._id),p.xp6(1),p.Oqu(t.TenBangKe),p.xp6(1),p.Q6J("Device",2),p.xp6(1),p.Q6J("Device",2),p.xp6(1),p.s9C("routerLink",t._id),p.xp6(1),p.Oqu(p.lcZ(7,8,t.TongPhatLen)),p.xp6(2),p.Q6J("Device",2),p.xp6(2),p.Q6J("ngIf",e.checkPer(4)&&t.TrangThai<1)}}function ht(t,i){if(1&t){const t=p.EpF();p.TgZ(0,"table",13),p.TgZ(1,"thead",14),p.TgZ(2,"tr"),p.TgZ(3,"th"),p._uU(4,"T\xean b\u1ea3ng k\xea"),p.qZA(),p.YNc(5,nt,2,0,"th",15),p.YNc(6,ot,2,0,"th",15),p.TgZ(7,"th"),p._uU(8,"T\u1ed5ng ph\xe1t l\xean"),p.qZA(),p.YNc(9,at,2,0,"th",15),p.TgZ(10,"th"),p.TgZ(11,"mat-icon",16),p.NdJ("click",function(){return p.CHM(t),p.oxw().reload()}),p._uU(12,"cached"),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.TgZ(13,"tbody"),p.YNc(14,ut,11,10,"tr",17),p.qZA(),p.qZA()}if(2&t){const t=p.oxw();p.Q6J("@slideIn",void 0),p.xp6(5),p.Q6J("Device",2),p.xp6(1),p.Q6J("Device",2),p.xp6(3),p.Q6J("Device",2),p.xp6(5),p.Q6J("ngForOf",t.filter.length>0?t.filter:t.items.slice(0,10))("ngForTrackBy",t.trackByFn)}}function pt(t,i){if(1&t&&p._UZ(0,"app-import-database",24),2&t){const t=p.oxw();p.Q6J("api",t.api)("global",t.global)("form",t.main)}}function gt(t,i){if(1&t&&p._UZ(0,"app-export-ecxel",25),2&t){const t=p.oxw();p.Q6J("dataJson",t.items)}}function dt(t,i){if(1&t){const t=p.EpF();p.TgZ(0,"button",26),p.NdJ("click",function(){return p.CHM(t),p.oxw().resetDB()}),p._uU(1,"X\xf3a to\xe0n b\u1ed9 d\u1eef li\u1ec7u"),p.qZA()}}const mt=function(){return[5,10,25,100]};let ft=(()=>{class t{constructor(t,i,e){this.plus=t,this.fb=i,this.rtSv=e,this.main=this.fb.group({keyWord:[,[]],_id:[,[]],TenBangKe:[,[r.kI.required]],TrangThai:[,[r.kI.required]],LichSuCapNhat:[,[r.kI.required]],TongPhatLen:[,[r.kI.required,r.kI.pattern("^[0-9]*$")]],ThanhTienTruocThue:[,[r.kI.required,r.kI.pattern("^[0-9]*$")]],Thue:[,[r.kI.required,r.kI.pattern("^[0-9]*$")]],ThanhTienSauThue:[,[r.kI.required,r.kI.pattern("^[0-9]*$")]],DanhSach:[,[r.kI.required]]}),this.title="L\u1eadp b\u1ea3ng k\xea",this.global=!0,this.dbName="dien-luc",this.api="dmt-pay",this.db=null,this.userId=this.plus.userId,this.usr=this.plus.usr,this.items=[],this.selectedItem=null,this.filter=[],this.chart=[],this.errors=[],this.startDay=new Date}ngOnInit(){this.plus.setTiTle(this.title),this.plus.IDB_InitDB(this.dbName).subscribe(t=>function(t,i,e,n){return new(e||(e=Promise))(function(o,a){function s(t){try{c(n.next(t))}catch(i){a(i)}}function l(t){try{c(n.throw(t))}catch(i){a(i)}}function c(t){t.done?o(t.value):function(t){return t instanceof e?t:new e(function(i){i(t)})}(t.value).then(s,l)}c((n=n.apply(t,i||[])).next())})}(this,void 0,void 0,function*(){this.db=t,this.plus.updateRealtime(this.db,this.api,this.global),this.getMonth(this.startDay),this.plus.IDB_DB_CleanTrash(t,this.api),this.plus.updateAPi.subscribe(t=>{t&&this.getIDB()})}))}getIDB(){console.log("getIDB() "),this.filter=[],this.items=[],this.plus.IDB_DB_GetAllByIndexKey(this.db,this.api,"KyThanhToan",`${this.year}-${this.month}`).subscribe(t=>{this.items=t})}ngOnDestroy(){console.log("Destroy",this.api),this.plus.subs.unsubscribe(),this.rtSv.leaveRoom(this.api)}getMonth(t){this.startDay=t,this.month=h()(t).month()+1,this.year=h()(t).year(),console.log(`GetMOnth:  ${this.year}${this.month}`),this.getIDB()}save(){if(this.main.invalid)return;const t=this.main.value,i=this.plus.datetoNumObj(this.main.value,[""]);if(console.log(i),null==t._id)delete t._id,this.plus.httpPost(this.api,i,this.global).subscribe(t=>{t.status&&(this.plus.clickBtn("closeModal"),this.plus.updateAPi.next(!0))});else{const e=this.plus.objVs(this.selectedItem,t);if(0===Object.keys(e).length)return this.plus.alertMatSnackBar("Kh\xf4ng c\xf3 n\u1ed9i dung n\xe0o thay \u0111\u1ed5i");this.plus.httpPut(this.api,i,this.global).subscribe(t=>{t.status&&(this.plus.updateAPi.next(!0),this.plus.clickBtn("closeModal"))})}}onEdit(t){this.selectedItem=t;const i=this.plus.dateToHtmlObj(t,[""]);this.main.patchValue(i),this.plus.clickBtn("openModal")}onDelete(t){!confirm("B\u1ea1n mu\u1ed1n x\xf3a?")||(this.plus.load(),this.plus.httpDisable(this.api,t,this.global).then(t=>{this.plus.updateAPi.next(!0)}))}chooseOpt(t,i,e,n=!1){this.main.controls[i].setValue(t[e]),n&&this.main.controls[i+"ID"].setValue(t._id)}closeModal(){this.main.reset()}search(t){this.filter=t}find(t){this.items=t}checkPer(t){return this.plus.checkPer(this.api,t)}patchForm(){this.main.reset({_id:" "})}reload(){return this.plus.reload(this.dbName+"/"+this.api)}goBack(){this.plus.goBack()}reset(){this.plus.loaded(),this.filter=[],this.getIDB(),this.main.reset({})}changePage(t){this.filter=this.items.slice(t.pageIndex*t.pageSize,(t.pageIndex+1)*t.pageSize)}ondragover(){document.getElementById("dropZone").setAttribute("drop-active","true")}trackByFn(t,i){return i}resetDB(){this.plus.resetDB(this.db,this.api)}}return t.\u0275fac=function(i){return new(i||t)(p.Y36(g.T),p.Y36(r.qu),p.Y36(d.i))},t.\u0275cmp=p.Xpm({type:t,selectors:[["app-nlmt-list"]],decls:16,vars:11,consts:[[1,"container"],["id","add-btn","color","accent","mat-raised-button","","routerLink","/dien-luc/dmt-input"],["id","back-btn","mat-raised-button","","color","primary",3,"click"],[3,"api","data",4,"ngIf"],[1,"py-3"],[3,"startDay","month"],[1,"row"],["class","table table-hover",4,"ngIf"],[3,"length","pageSize","pageSizeOptions","page"],[3,"api","global","form",4,"ngIf"],[3,"dataJson",4,"ngIf"],["mat-button","","color","warn",3,"click",4,"ngIf"],[3,"api","data"],[1,"table","table-hover"],[1,"thead-inverse"],[4,"Device"],["color","primary",3,"click"],[4,"ngFor","ngForOf","ngForTrackBy"],[3,"routerLink"],[3,"routerLink",4,"Device"],[1,"text-right",3,"routerLink"],["class","text-right",3,"routerLink",4,"Device"],["color","warn",3,"click",4,"ngIf"],["color","warn",3,"click"],[3,"api","global","form"],[3,"dataJson"],["mat-button","","color","warn",3,"click"]],template:function(t,i){1&t&&(p.TgZ(0,"div",0),p.TgZ(1,"button",1),p.TgZ(2,"mat-icon"),p._uU(3,"control_point"),p.qZA(),p.qZA(),p.TgZ(4,"button",2),p.NdJ("click",function(){return i.goBack()}),p.TgZ(5,"mat-icon"),p._uU(6,"undo"),p.qZA(),p.qZA(),p.YNc(7,et,1,1,"app-search-api",3),p.TgZ(8,"section",4),p.TgZ(9,"app-month-year",5),p.NdJ("month",function(t){return i.getMonth(t)}),p.qZA(),p.qZA(),p.TgZ(10,"div",6),p.YNc(11,ht,15,6,"table",7),p.TgZ(12,"mat-paginator",8),p.NdJ("page",function(t){return i.changePage(t)}),p.qZA(),p.qZA(),p.YNc(13,pt,1,3,"app-import-database",9),p.YNc(14,gt,1,1,"app-export-ecxel",10),p.qZA(),p.YNc(15,dt,2,0,"button",11)),2&t&&(p.xp6(4),p.Q6J("@slideIn",void 0),p.xp6(3),p.Q6J("ngIf",i.checkPer(10)),p.xp6(2),p.Q6J("startDay",i.startDay),p.xp6(2),p.Q6J("ngIf",i.items.length+i.filter.length>0),p.xp6(1),p.Q6J("length",i.items.length)("pageSize",10)("pageSizeOptions",p.DdM(10,mt)),p.xp6(1),p.Q6J("ngIf",i.checkPer(4)),p.xp6(1),p.Q6J("ngIf",i.checkPer(4)),p.xp6(1),p.Q6J("ngIf",i.checkPer(6)))},directives:[x.lW,m.rH,q.Hw,l.O5,W.k,X.NW,j.W,U.HP,l.sg,tt.y,it.t],pipes:[A._2,A.zZ],styles:[""],data:{animation:[c.Ym]}}),t})();var Zt=e(31409),Tt=e(89713),bt=e(51511),xt=function(t,i,e,n){return new(e||(e=Promise))(function(o,a){function s(t){try{c(n.next(t))}catch(i){a(i)}}function l(t){try{c(n.throw(t))}catch(i){a(i)}}function c(t){t.done?o(t.value):function(t){return t instanceof e?t:new e(function(i){i(t)})}(t.value).then(s,l)}c((n=n.apply(t,i||[])).next())})};function qt(t,i){if(1&t){const t=p.EpF();p.TgZ(0,"button",24),p.NdJ("click",function(){return p.CHM(t),p.oxw().reload()}),p.TgZ(1,"mat-icon"),p._uU(2,"undo"),p.qZA(),p.qZA()}2&t&&p.Q6J("@slideIn",void 0)}function kt(t,i){if(1&t){const t=p.EpF();p.TgZ(0,"section",25),p.TgZ(1,"app-month-year",26),p.NdJ("month",function(i){return p.CHM(t),p.oxw().getMonth(i)}),p.qZA(),p.qZA()}if(2&t){const t=p.oxw();p.xp6(1),p.Q6J("startDay",t.startDay)}}function At(t,i){if(1&t){const t=p.EpF();p.TgZ(0,"button",27),p.NdJ("click",function(){return p.CHM(t),p.oxw().saveList()}),p._uU(1," L\u01b0u "),p.qZA()}2&t&&p.Q6J("@slideX",void 0)}function It(t,i){if(1&t){const t=p.EpF();p.TgZ(0,"button",27),p.NdJ("click",function(){return p.CHM(t),p.oxw().sendMail()}),p._uU(1," G\u1eedi mail"),p.qZA()}2&t&&p.Q6J("@slideX",void 0)}function _t(t,i){if(1&t){const t=p.EpF();p.TgZ(0,"button",28),p.NdJ("click",function(){return p.CHM(t),p.oxw().report()}),p._uU(1),p.qZA()}if(2&t){const t=p.oxw();p.Q6J("@slideX",void 0),p.xp6(1),p.hij(" B\u1ea3ng k\xea c\xf3 H\u0110 (",t.itemsReport.length,") ")}}function Nt(t,i){if(1&t){const t=p.EpF();p.TgZ(0,"button",27),p.NdJ("click",function(){return p.CHM(t),p.oxw().complete()}),p._uU(1),p.qZA()}if(2&t){const t=p.oxw();p.Q6J("@slideX",void 0),p.xp6(1),p.hij(" G\u1eedi b\u1ea3ng k\xea (",t.itemsReport.length,")")}}function Dt(t,i){if(1&t){const t=p.EpF();p.TgZ(0,"button",28),p.NdJ("click",function(){return p.CHM(t),p.oxw().reportNoBill()}),p._uU(1),p.qZA()}if(2&t){const t=p.oxw();p.Q6J("@slideX",void 0),p.xp6(1),p.hij(" B\u1ea3ng k\xea kh\xf4ng H\u0110 (",t.itemsReportNoBill.length,") ")}}function yt(t,i){if(1&t){const t=p.EpF();p.TgZ(0,"button",27),p.NdJ("click",function(){return p.CHM(t),p.oxw().completeNoBill()}),p._uU(1),p.qZA()}if(2&t){const t=p.oxw();p.Q6J("@slideX",void 0),p.xp6(1),p.hij(" G\u1eedi b\u1ea3ng k\xea (",t.itemsReportNoBill.length,")")}}function vt(t,i){if(1&t){const t=p.EpF();p.TgZ(0,"button",29),p.NdJ("click",function(){return p.CHM(t),p.oxw().showUnpaid()}),p._uU(1," Ch\u01b0a l\u1eadp BK "),p.qZA()}2&t&&p.Q6J("@slideX",void 0)}function Ut(t,i){1&t&&(p.TgZ(0,"h5",30),p._uU(1,"L\u1ed7i d\u1eef li\u1ec7u"),p.qZA())}function Jt(t,i){if(1&t&&(p.TgZ(0,"h5",31),p._uU(1),p.qZA()),2&t){const t=p.oxw();p.xp6(1),p.hij("DANH S\xc1CH THANH TO\xc1N TI\u1ec0N \u0110I\u1ec6N M\u1eb6T TR\u1edcI ",t.bangKe.length," KH")}}function Mt(t,i){1&t&&(p.TgZ(0,"th"),p._uU(1,"L\u1ed7i"),p.qZA())}function Ht(t,i){if(1&t&&(p.TgZ(0,"td",37),p._uU(1),p.qZA()),2&t){const t=p.oxw().$implicit;p.xp6(1),p.Oqu(t.err)}}function wt(t,i){if(1&t&&(p.TgZ(0,"tr"),p.TgZ(1,"td"),p._uU(2),p.qZA(),p.TgZ(3,"td",34),p.TgZ(4,"a",35),p._uU(5),p.qZA(),p.qZA(),p.TgZ(6,"td"),p._uU(7),p.qZA(),p.TgZ(8,"td"),p._uU(9),p.qZA(),p.TgZ(10,"td",7),p._uU(11),p.ALo(12,"numberPipe"),p.qZA(),p.TgZ(13,"td",7),p._uU(14),p.ALo(15,"numberPipe"),p.qZA(),p.YNc(16,Ht,2,1,"td",36),p.qZA()),2&t){const t=i.$implicit,e=i.index,n=p.oxw(2);p.xp6(2),p.Oqu(e+1),p.xp6(2),p.s9C("routerLink",t._id),p.xp6(1),p.Oqu(t.MaKhachHang),p.xp6(2),p.Oqu(t.Email),p.xp6(2),p.Oqu(t.KhachHang),p.xp6(2),p.Oqu(p.lcZ(12,8,t.SanLuong)),p.xp6(3),p.Oqu(p.lcZ(15,10,t.TongTien)),p.xp6(2),p.Q6J("ngIf",2==n.step)}}function Ct(t,i){if(1&t&&(p.TgZ(0,"table",32),p.TgZ(1,"thead"),p.TgZ(2,"tr"),p.TgZ(3,"th"),p._uU(4,"TT"),p.qZA(),p.TgZ(5,"th"),p._uU(6,"M\xe3 Kh\xe1ch h\xe0ng"),p.qZA(),p.TgZ(7,"th"),p._uU(8,"Email"),p.qZA(),p.TgZ(9,"th"),p._uU(10,"Kh\xe1ch h\xe0ng"),p.qZA(),p.TgZ(11,"th"),p._uU(12,"S\u1ea3n l\u01b0\u1ee3ng"),p.qZA(),p.TgZ(13,"th"),p._uU(14,"T\u1ed5ng ti\u1ec1n"),p.qZA(),p.YNc(15,Mt,2,0,"th",12),p.qZA(),p.qZA(),p.TgZ(16,"tbody"),p.YNc(17,wt,17,12,"tr",33),p.qZA(),p.qZA()),2&t){const t=p.oxw();p.xp6(15),p.Q6J("ngIf",2==t.step),p.xp6(2),p.Q6J("ngForOf",t.errors.length>0?t.errors:t.bangKe)}}function St(t,i){if(1&t){const t=p.EpF();p.TgZ(0,"mat-icon",40),p.NdJ("click",function(){return p.CHM(t),p.oxw(2).searchText=""}),p._uU(1,"close"),p.qZA()}}function Bt(t,i){if(1&t){const t=p.EpF();p.TgZ(0,"mat-form-field"),p.YNc(1,St,2,0,"mat-icon",38),p.TgZ(2,"input",39),p.NdJ("ngModelChange",function(i){return p.CHM(t),p.oxw().searchText=i}),p.qZA(),p.qZA()}if(2&t){const t=p.oxw();p.xp6(1),p.Q6J("ngIf",t.searchText.length>0),p.xp6(1),p.Q6J("ngModel",t.searchText)}}function Yt(t,i){1&t&&(p.TgZ(0,"th"),p._uU(1,"G\u1eedi mail"),p.qZA())}function Qt(t,i){1&t&&(p.TgZ(0,"th"),p._uU(1,"B\u1ea3ng k\xea"),p.qZA())}function Kt(t,i){1&t&&(p.TgZ(0,"th"),p._uU(1,"Tr\u1ea1ng th\xe1i h\u1ed3 s\u01a1"),p.qZA())}const Ft=function(t){return{"bg-success text-center":t}};function Ot(t,i){if(1&t&&(p.TgZ(0,"td",48),p._uU(1),p.ALo(2,"enum"),p.qZA()),2&t){const t=p.oxw().$implicit;p.Q6J("ngClass",p.VKq(5,Ft,1==t.DaGuiMail)),p.xp6(1),p.Oqu(p.xi3(2,2,t.DaGuiMail,"TrangThaiEmail"))}}function $t(t,i){if(1&t&&(p.TgZ(0,"td"),p._uU(1),p.qZA()),2&t){const t=p.oxw().$implicit;p.xp6(1),p.Oqu(t.TenBangKe)}}function Et(t,i){if(1&t){const t=p.EpF();p.TgZ(0,"mat-icon",51),p.NdJ("click",function(){p.CHM(t);const i=p.oxw().$implicit;return p.oxw(2).onDelete(i)}),p._uU(1,"delete"),p.qZA()}}const Pt=function(t){return{"text-info":t}},Lt=function(t,i,e,n){return{"bg-danger text-center":t,"bg-info text-center":i,"bg-primary text-center":e,"bg-success text-center":n}};function Gt(t,i){if(1&t){const t=p.EpF();p.TgZ(0,"tr"),p.TgZ(1,"td"),p.TgZ(2,"mat-checkbox",47),p.NdJ("change",function(i){const e=p.CHM(t).$implicit;return p.oxw(2).checkItem(i,e)}),p.qZA(),p.qZA(),p.TgZ(3,"td"),p._uU(4),p.qZA(),p.TgZ(5,"td"),p.TgZ(6,"a",35),p._uU(7),p.qZA(),p.qZA(),p.TgZ(8,"td",48),p._uU(9),p.qZA(),p.TgZ(10,"td"),p._uU(11),p.ALo(12,"number"),p.qZA(),p.TgZ(13,"td"),p._uU(14),p.ALo(15,"number"),p.qZA(),p.YNc(16,Ot,3,7,"td",49),p.YNc(17,$t,2,1,"td",44),p.TgZ(18,"td",48),p._uU(19),p.ALo(20,"enum"),p.qZA(),p.TgZ(21,"td"),p.YNc(22,Et,2,0,"mat-icon",50),p.qZA(),p.qZA()}if(2&t){const t=i.$implicit,e=i.index,n=p.oxw(2);p.xp6(2),p.Q6J("checked",1==t.TrangThaiHoSo)("disabled",t.TrangThaiHoSo>1),p.xp6(2),p.Oqu(e+1),p.xp6(2),p.s9C("routerLink",t._id),p.xp6(1),p.Oqu(t.MaKhachHang),p.xp6(1),p.Q6J("ngClass",p.VKq(21,Pt,0==t.CoHoaDon)),p.xp6(1),p.Oqu(t.KhachHang),p.xp6(2),p.Oqu(p.lcZ(12,14,t.SanLuong)),p.xp6(3),p.Oqu(p.lcZ(15,16,t.TongTien)),p.xp6(2),p.Q6J("Device",3),p.xp6(1),p.Q6J("Device",3),p.xp6(1),p.Q6J("ngClass",p.l5B(23,Lt,0==t.TrangThaiHoSo,1==t.TrangThaiHoSo,3==t.TrangThaiHoSo,4==t.TrangThaiHoSo)),p.xp6(1),p.Oqu(p.xi3(20,18,t.TrangThaiHoSo,"DMTTrangThaiHoSo")),p.xp6(3),p.Q6J("ngIf",n.checkPer(2)&&t.TrangThaiHoSo<2||n.checkPer(7))}}function Rt(t,i){if(1&t){const t=p.EpF();p.TgZ(0,"table",41),p.TgZ(1,"thead",42),p.TgZ(2,"tr"),p.TgZ(3,"th"),p.TgZ(4,"mat-checkbox",43),p.NdJ("change",function(i){return p.CHM(t),p.oxw().checkAll(i)}),p.qZA(),p.qZA(),p.TgZ(5,"th"),p._uU(6,"TT"),p.qZA(),p.TgZ(7,"th"),p._uU(8,"M\xe3 kh\xe1ch h\xe0ng"),p.qZA(),p.TgZ(9,"th"),p._uU(10,"Kh\xe1ch h\xe0ng"),p.qZA(),p.TgZ(11,"th"),p._uU(12,"S\u1ea3n l\u01b0\u1ee3ng"),p.qZA(),p.TgZ(13,"th"),p._uU(14,"T\u1ed5ng ti\u1ec1n"),p.qZA(),p.YNc(15,Yt,2,0,"th",44),p.YNc(16,Qt,2,0,"th",44),p.YNc(17,Kt,2,0,"th",44),p.TgZ(18,"th"),p.TgZ(19,"mat-icon",45),p.NdJ("click",function(){return p.CHM(t),p.oxw().reload()}),p._uU(20,"cached"),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.TgZ(21,"tbody"),p.YNc(22,Gt,23,28,"tr",46),p.ALo(23,"filter"),p.qZA(),p._UZ(24,"tfoot"),p.qZA()}if(2&t){const t=p.oxw();p.Q6J("@slideIn",void 0),p.xp6(4),p.Q6J("checked",t.all),p.xp6(11),p.Q6J("Device",3),p.xp6(1),p.Q6J("Device",3),p.xp6(1),p.Q6J("Device",3),p.xp6(5),p.Q6J("ngForOf",p.xi3(23,7,t.filter.length>0?t.filter:t.items,t.searchText))("ngForTrackBy",t.trackByFn)}}const zt=function(){return[20,50,100,500]};function Vt(t,i){if(1&t){const t=p.EpF();p.TgZ(0,"mat-paginator",52),p.NdJ("page",function(i){return p.CHM(t),p.oxw().changePage(i)}),p.qZA()}if(2&t){const t=p.oxw();p.Q6J("length",t.items.length)("pageSize",500)("pageSizeOptions",p.DdM(3,zt))}}function Wt(t,i){if(1&t){const t=p.EpF();p.TgZ(0,"button",53),p.NdJ("click",function(){return p.CHM(t),p.oxw().resetDB()}),p._uU(1,"X\xf3a to\xe0n b\u1ed9 d\u1eef li\u1ec7u"),p.qZA()}}function Xt(t,i){if(1&t){const t=p.EpF();p.TgZ(0,"app-drop-files",54),p.NdJ("files",function(i){return p.CHM(t),p.oxw().onDropFile(i)})("ondragover",function(){return p.CHM(t),p.oxw().ondragover()}),p.qZA()}2&t&&p.Q6J("label","")}let jt=(()=>{class t{constructor(t,i,e,n,o,a){this.plus=t,this.fb=i,this.rtSv=e,this.excelSv=n,this.docxSv=o,this.nlmtSv=a,this.importForm=this.fb.group({keyWord:[,[]],_id:[,[]],TONG_TIEN:[,[r.kI.required,r.kI.pattern("^[0-9]*$")]],MA_DVIQLY:[,[]],TKHOAN_KHANG:[,[]],MA_NHANG:[,[]],TEN_NHANG:[,[]],MA_SOGCS:[,[r.kI.required]],TYLE_THUE:[,[]],DIEN_TTHU:[,[r.kI.required,r.kI.pattern("^[0-9]*$")]],SO_TIEN:[,[r.kI.required,r.kI.pattern("^[0-9]*$")]],DCHI_KHANG:[,[]],MA_KHANG:[,[r.kI.required]],TIEN_GTGT:[,[r.kI.required,r.kI.pattern("^[0-9]*$")]],TEN_KHANG:[,[r.kI.required]],NGAY_GCS:[,[]],DON_GIA:[,[r.kI.required,r.kI.pattern("^[0-9]*$")]]}),this.bangKeForm=this.fb.group({Email:[],MaKhachHang:[,[r.kI.required]],KhachHang:[,[r.kI.required]],DiaChi:[,[r.kI.required]],MaGCS:[,[r.kI.required]],ChuTaiKhoan:[,[r.kI.required]],SoTaiKhoan:[,[r.kI.required]],NganHang:[,[r.kI.required]],Nam:[,[r.kI.required,r.kI.pattern("^[0-9]*$")]],Thang:[,[r.kI.required,r.kI.pattern("^[0-9]*$")]],SanLuong:[,[r.kI.required,r.kI.pattern("^[0-9]*$")]],DonGia:[,[r.kI.required,r.kI.pattern("^[0-9]*$")]],TruocThue:[,[r.kI.required,r.kI.pattern("^[0-9]*$")]],Thue:[,[r.kI.required,r.kI.pattern("^[0-9]*$")]],TongTien:[,[r.kI.required,r.kI.pattern("^[0-9]*$")]],KyHieuHoaDon:[,[]],SoHoaDon:[,[]],NgayHoaDon:[,[]],TrangThai:[,],DaGuiMail:[0],NgayMuaHang:[,[]]}),this.searchText="",this.title="L\u1eadp b\u1ea3ng k\xea",this.global=!0,this.dbName="dien-luc",this.api="dmt-input",this.db=null,this.userId=this.plus.userId,this.usr=this.plus.usr,this.items=[],this.selectedItem=null,this.filter=[],this.chart=[],this.errors=[],this.dataInXls={},this.wordFile=null,this.startDay=new Date,this.bangKe=[],this.readFileDone=!1,this.step=0,this.TongPhatLen=0,this.ThanhTienTruocThue=0,this.Thue=0,this.ThanhTienSauThue=0,this.itemsReport=[],this.itemsReportNoBill=[],this.all=!1}ngOnInit(){this.plus.setTiTle(this.title),this.plus.IDB_InitDB(this.dbName).subscribe(t=>xt(this,void 0,void 0,function*(){this.db=t,this.plus.updateRealtime(this.db,this.api,this.global),this.getMonth(this.startDay),this.plus.IDB_DB_CleanTrash(t,this.api),this.plus.updateAPi.subscribe(t=>{t&&this.getIDB()})}))}getIDB(){this.filter=[],this.items=[],this.plus.IDB_DB_GetAllByIndexKey(this.db,this.api,"KyThanhToan",`${this.year}-${this.month}`).subscribe(t=>{this.items=t})}ngOnDestroy(){console.log("Destroy",this.api),this.plus.subs.unsubscribe(),this.rtSv.leaveRoom(this.api)}saveList(){const t=this.bangKe;console.log(t),this.plus.httpPost(this.api+"/import",t,this.global).subscribe(t=>{this.reload()})}convertToList(){console.log("convertToList()");const t=this.dataInXls.data,i=Date.now();for(let e=0;e<t.length;e++){const n=t[e];if(this.importForm.patchValue(n),this.importForm.invalid)this.plus.alertError("Ki\u1ec3m tra l\u1ea1i d\u1eef li\u1ec7u file import");else{const o={MaKhachHang:n.MA_KHANG,MaGCS:n.MA_SOGCS,Nam:this.year,Thang:this.month,SanLuong:n.DIEN_TTHU,DonGia:n.DON_GIA,TruocThue:n.SO_TIEN,NgayMuaHang:n.NGAY_GCS,TiLeThue:n.TYLE_THUE,Thue:n.TIEN_GTGT,TongTien:n.TONG_TIEN,KyThanhToan:`${this.year}-`+this.month,DaGuiMail:0,TrangThaiThanhToan:0,TrangThaiHoSo:-1,dateModify:i+e};this.plus.IDB_DB_GetAllByIndexKey(this.db,"dmt-khach-hang","MaKhachHang",n.MA_KHANG).subscribe(i=>{const e=i[0];if(0==i.length)return this.plus.alertMatSnackBar(`B\u1ea1n ch\u01b0a c\xf3 d\u1eef li\u1ec7u kh\xe1ch h\xe0ng ${n.MA_KHANG}`,5e3);console.log(e,o);const a=Object.assign(e,o);if(delete a.__v,delete a._id,this.bangKeForm.patchValue(a),this.bangKeForm.invalid){console.log("bangKeForm.invalid");const t=this.plus.getErrValidateForm(this.bangKeForm);a.err=t,this.errors.push(a),this.step=2}else{console.log("bangKeForm.valid");for(let t=0;t<this.items.length;t++){const i=this.items[t];i.MaKhachHang==a.MaKhachHang&&(console.log("if (el.MaKhachHang == body.MaKhachHang)"),a.err=`${i.MaKhachHang} \u0111\xe3 t\u1ed3n t\u1ea1i!`,this.errors.push(a))}console.log("else {  this.bangKe.push(body)"),this.bangKe.push(a)}t.length==this.bangKe.length&&(this.readFileDone=!0,this.step=this.errors.length>0?2:3,console.log(this.bangKe))})}}}onDropFile(t){console.log("onDropFile()"),this.reset();for(let i=0;i<t.length;i++)if("application/vnd.openxmlformats-officedocument.wordprocessingml.document"==t[i].type){const e=new FileReader;e.readAsArrayBuffer(t[i]),e.onloadend=()=>this.wordFile=e.result}else"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"==t[i].type?this.excelSv.toJsonArray(t[i]).then(t=>{this.dataInXls=t,this.convertToList()}):this.plus.alertError("File kh\xf4ng h\u1ee3p l\u1ec7")}sendMail(){return xt(this,void 0,void 0,function*(){console.info("sendMail()");for(let t=0;t<this.itemsReport.length;t++){const i=this.itemsReport[t],e=this.items.indexOf(i);if(0==i.DaGuiMail&&i.Email.length>5){let t=this.nlmtSv.geneBodyMail(this.itemsReport[0],this.startDay,1);this.plus.load(),this.plus.httpPost("mail/dien-mat-troi",t).subscribe(t=>{const n=t.index;console.log("Mail sent: ",n,t.email),n>=0&&t.email?(this.plus.loaded(),this.items[e].DaGuiMail=1,this.nlmtSv.statusMail(i)):(this.items[e].DaGuiMail=0,this.plus.alertToasrt(t))}),yield this.plus.sleep(5e3)}}this.getIDB()})}report(){const t=this.nlmtSv.geneBodyPay(this.itemsReport,this.startDay);this.docxSv.loadFileUrl("https://thuctd.github.io/templates/BangKe.docx").then(i=>{this.docxSv.generateOne(t,i,`BangKeThang${this.month}-${this.year}`).then(t=>{})})}reportNoBill(){const t=this.nlmtSv.geneBodyPay(this.itemsReportNoBill,this.startDay);this.docxSv.loadFileUrl("https://thuctd.github.io/templates/BangKeNoBill.docx").then(i=>{this.docxSv.generateOne(t,i,`BangKeThang${this.month}-${this.year}`).then(t=>{})})}complete(){const t=h()(this.startDay).format("YYMMDDHHmm");this.nlmtSv.updateNameBill(this.itemsReport,t)}completeNoBill(){const t=h()(this.startDay).format("YYMMDDHHmm");this.nlmtSv.updateNameBill(this.itemsReportNoBill,t)}showUnpaid(){this.items=this.items.filter(t=>t.TrangThaiHoSo<1)}checkItem(t,i){const e=this.itemsReport.indexOf(i),n=this.itemsReportNoBill.indexOf(i);t.checked?(this.isHasBill(i),i.TrangThaiHoSo=1):(this.all=!1,i.TrangThaiHoSo=-1,e>0?this.itemsReport.splice(e,1):this.itemsReportNoBill.splice(n,1))}checkAll(t){if(t.checked){this.all=!0;for(let t=0;t<this.items.length;t++){const i=this.items[t];-1==i.TrangThaiHoSo&&(this.items[t].TrangThaiHoSo=1,this.isHasBill(i))}}else{this.all=!1,this.itemsReport=[],this.itemsReportNoBill=[];for(let t=0;t<this.items.length;t++)1==this.items[t].TrangThaiHoSo&&(this.items[t].TrangThaiHoSo=-1)}}isHasBill(t){0==t.CoHoaDon?this.itemsReportNoBill.push(t):this.itemsReport.push(t)}ondragover(){document.getElementById("dropZone").setAttribute("drop-active","true")}getMonth(t){this.startDay=t,this.itemsReport=[],this.month=h()(t).month()+1,this.year=h()(t).year(),console.log(`GetMOnth:  ${this.year}${this.month}`),this.getIDB()}onEdit(t){}onDelete(t){if(confirm("B\u1ea1n mu\u1ed1n x\xf3a?")){if(1==t.TrangThaiHoSo)return this.plus.alertWarning("B\u1ea1n kh\xf4ng th\u1ec3 x\xf3a khi \u0111\xe3 g\u1eedi b\u1ea3ng k\xea");this.plus.load(),this.plus.httpDisable(this.api,t,this.global).then(t=>{this.plus.updateAPi.next(!0)})}}search(t){this.items=t}find(t){this.items=t}checkPer(t){return this.plus.checkPer(this.api,t)}reload(){return this.plus.reload(this.dbName+"/"+this.api)}reset(){console.log("reset()"),this.plus.loaded(),this.filter=[],this.errors=[],this.plus.clickBtn("closeImportButton")}changePage(t){this.filter=this.items.slice(t.pageIndex*t.pageSize,(t.pageIndex+1)*t.pageSize)}trackByFn(t,i){return i}resetDB(){this.plus.resetDB(this.db,this.api),this.reload()}}return t.\u0275fac=function(i){return new(i||t)(p.Y36(g.T),p.Y36(r.qu),p.Y36(d.i),p.Y36(Zt.x),p.Y36(D.E),p.Y36(v))},t.\u0275cmp=p.Xpm({type:t,selectors:[["app-nlmt-input"]],decls:32,vars:17,consts:[[1,"container-fluid"],["id","back-btn","mat-raised-button","","color","primary",3,"click",4,"ngIf"],["class","py-3",4,"ngIf"],[1,"row"],["color","accent","mat-raised-button","","data-toggle","modal","data-target","#modalImport"],["mat-raised-button","","color","warn",3,"click",4,"ngIf"],["mat-raised-button","","color","accent",3,"click",4,"ngIf"],[1,"text-right"],["class","pull-right","mat-raised-button","","color","warn",3,"click",4,"ngIf"],["class","tit bg-warning",4,"ngIf"],["class","tit",4,"ngIf"],["class","table",4,"ngIf"],[4,"ngIf"],["class","table table-hover",4,"ngIf"],[3,"length","pageSize","pageSizeOptions","page",4,"ngIf"],["mat-button","","color","warn",3,"click",4,"ngIf"],["id","modalImport","tabindex","-1","role","dialog","aria-labelledby","modelTitleId","aria-hidden","true",1,"modal","fade"],["role","document",1,"modal-dialog"],[1,"modal-content"],["type","button","id","closeImportButton","data-dismiss","modal","aria-label","Close",1,"close","text-danger"],["aria-hidden","true"],[1,"modal-body"],[1,"drop"],[3,"label","files","ondragover",4,"ngIf"],["id","back-btn","mat-raised-button","","color","primary",3,"click"],[1,"py-3"],[3,"startDay","month"],["mat-raised-button","","color","warn",3,"click"],["mat-raised-button","","color","accent",3,"click"],["mat-raised-button","","color","warn",1,"pull-right",3,"click"],[1,"tit","bg-warning"],[1,"tit"],[1,"table"],[4,"ngFor","ngForOf"],["scope","row"],[3,"routerLink"],["class","bg-danger",4,"ngIf"],[1,"bg-danger"],["matSuffix","","color","warn",3,"click",4,"ngIf"],["matInput","","id","search-api","placeholder","T\xecm ki\u1ebfm nhanh (F2)","value","value",3,"ngModel","ngModelChange"],["matSuffix","","color","warn",3,"click"],[1,"table","table-hover"],[1,"thead-inverse"],["color","warn",3,"checked","change"],[4,"Device"],["color","primary",3,"click"],[4,"ngFor","ngForOf","ngForTrackBy"],["color","primary",3,"checked","disabled","change"],[3,"ngClass"],[3,"ngClass",4,"Device"],["color","warn",3,"click",4,"ngIf"],["color","warn",3,"click"],[3,"length","pageSize","pageSizeOptions","page"],["mat-button","","color","warn",3,"click"],[3,"label","files","ondragover"]],template:function(t,i){1&t&&(p.TgZ(0,"div",0),p.YNc(1,qt,3,1,"button",1),p.YNc(2,kt,2,1,"section",2),p.TgZ(3,"div",3),p.TgZ(4,"button",4),p.TgZ(5,"mat-icon"),p._uU(6,"control_point"),p.qZA(),p.qZA(),p.YNc(7,At,2,1,"button",5),p.YNc(8,It,2,1,"button",5),p.YNc(9,_t,2,2,"button",6),p.YNc(10,Nt,2,2,"button",5),p.YNc(11,Dt,2,2,"button",6),p.YNc(12,yt,2,2,"button",5),p.TgZ(13,"span",7),p.YNc(14,vt,2,1,"button",8),p.qZA(),p.qZA(),p.YNc(15,Ut,2,0,"h5",9),p.YNc(16,Jt,2,1,"h5",10),p.YNc(17,Ct,18,2,"table",11),p.TgZ(18,"div",3),p.YNc(19,Bt,3,2,"mat-form-field",12),p.YNc(20,Rt,25,10,"table",13),p.YNc(21,Vt,1,4,"mat-paginator",14),p.qZA(),p.YNc(22,Wt,2,0,"button",15),p.qZA(),p.TgZ(23,"div",16),p.TgZ(24,"div",17),p.TgZ(25,"div",18),p.TgZ(26,"button",19),p.TgZ(27,"span",20),p._uU(28,"\xd7"),p.qZA(),p.qZA(),p.TgZ(29,"div",21),p.TgZ(30,"div",22),p.YNc(31,Xt,1,1,"app-drop-files",23),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA()),2&t&&(p.xp6(1),p.Q6J("ngIf",i.step>1),p.xp6(1),p.Q6J("ngIf",0==i.step),p.xp6(5),p.Q6J("ngIf",i.bangKe.length>0&&0==i.errors.length),p.xp6(1),p.Q6J("ngIf",i.itemsReport.length>0),p.xp6(1),p.Q6J("ngIf",i.itemsReport.length>0),p.xp6(1),p.Q6J("ngIf",i.itemsReport.length>0),p.xp6(1),p.Q6J("ngIf",i.itemsReportNoBill.length>0),p.xp6(1),p.Q6J("ngIf",i.itemsReportNoBill.length>0),p.xp6(2),p.Q6J("ngIf",i.items.length>0),p.xp6(1),p.Q6J("ngIf",2==i.step),p.xp6(1),p.Q6J("ngIf",1==i.step),p.xp6(1),p.Q6J("ngIf",i.step>1),p.xp6(2),p.Q6J("ngIf",i.items.length+i.filter.length>0&&0==i.errors.length),p.xp6(1),p.Q6J("ngIf",i.items.length+i.filter.length>0&&0==i.errors.length),p.xp6(1),p.Q6J("ngIf",i.items.length+i.filter.length>0),p.xp6(1),p.Q6J("ngIf",i.checkPer(6)),p.xp6(9),p.Q6J("ngIf",0==i.bangKe.length||!i.wordFile))},directives:[l.O5,x.lW,q.Hw,W.k,l.sg,m.yS,f.KE,Z.Nt,r.Fj,r.JJ,r.On,f.R9,Tt.oG,U.HP,l.mk,X.NW,bt.k],pipes:[A._2,A.Cf,l.JJ,A.zZ],styles:[""],data:{animation:[c.Ym,c.Mq]}}),t})();var ti=e(46936);function ii(t,i){if(1&t){const t=p.EpF();p.TgZ(0,"button",10),p.NdJ("click",function(){return p.CHM(t),p.oxw().reload()}),p.TgZ(1,"mat-icon"),p._uU(2,"undo"),p.qZA(),p.qZA()}2&t&&p.Q6J("@slideIn",void 0)}function ei(t,i){if(1&t){const t=p.EpF();p.TgZ(0,"app-search-api",11),p.NdJ("data",function(i){return p.CHM(t),p.oxw().find(i)}),p.qZA()}if(2&t){const t=p.oxw();p.Q6J("api",t.api)}}function ni(t,i){if(1&t){const t=p.EpF();p.TgZ(0,"mat-icon",18),p.NdJ("click",function(){p.CHM(t);const i=p.oxw().$implicit;return p.oxw(2).onDelete(i)}),p._uU(1,"delete"),p.qZA()}}function oi(t,i){if(1&t){const t=p.EpF();p.TgZ(0,"tr"),p.TgZ(1,"td",16),p.NdJ("click",function(){const i=p.CHM(t).$implicit;return p.oxw(2).onEdit(i)}),p._uU(2),p.qZA(),p.TgZ(3,"td",16),p.NdJ("click",function(){const i=p.CHM(t).$implicit;return p.oxw(2).onEdit(i)}),p._uU(4),p.qZA(),p.TgZ(5,"td",16),p.NdJ("click",function(){const i=p.CHM(t).$implicit;return p.oxw(2).onEdit(i)}),p._uU(6),p.ALo(7,"date"),p.qZA(),p.TgZ(8,"td",16),p.NdJ("click",function(){const i=p.CHM(t).$implicit;return p.oxw(2).onEdit(i)}),p._uU(9),p.qZA(),p.TgZ(10,"td"),p.YNc(11,ni,2,0,"mat-icon",17),p.qZA(),p.qZA()}if(2&t){const t=i.$implicit,e=p.oxw(2);p.xp6(2),p.Oqu(t.TaiKhoan),p.xp6(2),p.Oqu(t.NoiDung),p.xp6(2),p.Oqu(p.xi3(7,5,t.ThoiGian,"dd/MM/YYYY HH:mm")),p.xp6(3),p.Oqu(t.MaKhachHang),p.xp6(2),p.Q6J("ngIf",e.checkPer(4))}}function ai(t,i){if(1&t){const t=p.EpF();p.TgZ(0,"table",12),p.TgZ(1,"thead",13),p.TgZ(2,"tr"),p.TgZ(3,"th"),p._uU(4,"T\xe0i kho\u1ea3n"),p.qZA(),p.TgZ(5,"th"),p._uU(6,"N\u1ed9i dung thay \u0111\u1ed5i"),p.qZA(),p.TgZ(7,"th"),p._uU(8,"Th\u1eddi gian"),p.qZA(),p.TgZ(9,"th"),p._uU(10,"M\xe3 kh\xe1ch h\xe0ng"),p.qZA(),p.TgZ(11,"th"),p.TgZ(12,"mat-icon",14),p.NdJ("click",function(){return p.CHM(t),p.oxw().reload()}),p._uU(13,"cached"),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.TgZ(14,"tbody"),p.YNc(15,oi,12,8,"tr",15),p.qZA(),p.qZA()}if(2&t){const t=p.oxw();p.Q6J("@slideIn",void 0),p.xp6(15),p.Q6J("ngForOf",t.filter.length>0?t.filter:t.items.slice(0,10))("ngForTrackBy",t.trackByFn)}}function si(t,i){if(1&t&&p._UZ(0,"app-export-ecxel",19),2&t){const t=p.oxw();p.Q6J("dataJson",t.items)}}function li(t,i){if(1&t){const t=p.EpF();p.TgZ(0,"button",20),p.NdJ("click",function(){return p.CHM(t),p.oxw().resetDB()}),p._uU(1,"X\xf3a to\xe0n b\u1ed9 d\u1eef li\u1ec7u"),p.qZA()}}const ci=function(){return[5,10,25,100]};let ri=(()=>{class t{constructor(t,i,e){this.plus=t,this.fb=i,this.rtSv=e,this.title="L\u1ecbch s\u1eed c\u1eadp nh\u1eadt",this.dbName="dien-luc",this.api="dmt-history",this.db=null,this.items=[],this.selectedItem=null,this.filter=[],this.chart=[],this.main=this.fb.group({keyWord:[,[]],_id:[,[]],TaiKhoan:[,[r.kI.required]],NoiDung:[,[r.kI.required]],ThoiGian:[,[r.kI.required]],MaKhachHang:[,[r.kI.required]]})}ngOnInit(){this.plus.setTiTle(this.title),this.plus.IDB_InitDB(this.dbName).subscribe(t=>function(t,i,e,n){return new(e||(e=Promise))(function(o,a){function s(t){try{c(n.next(t))}catch(i){a(i)}}function l(t){try{c(n.throw(t))}catch(i){a(i)}}function c(t){t.done?o(t.value):function(t){return t instanceof e?t:new e(function(i){i(t)})}(t.value).then(s,l)}c((n=n.apply(t,i||[])).next())})}(this,void 0,void 0,function*(){this.db=t,this.getIDB(),this.plus.updateGlobalLocal(t,this.api),this.plus.updateAPi.subscribe(t=>{t&&this.getIDB()})}))}getIDB(){console.log("getIDB"),this.filter=[],this.plus.IDB_DB_GetAll(this.db,this.api).subscribe(t=>{this.items=t,this.plus.updateAPi.next(!1)})}ngOnDestroy(){console.log("Destroy",this.api),this.plus.subs.unsubscribe(),this.rtSv.leaveRoom(this.api)}save(){if(this.main.invalid)return;const t=this.main.value,i=this.plus.datetoNumObj(this.main.value,["ThoiGian"]);console.log(i),null==t._id?(delete t._id,this.plus.httpPost(this.api,i).subscribe(t=>{t.status&&this.plus.clickBtn("closeModal")})):this.plus.httpPut(this.api,i).subscribe(t=>{t.status&&this.plus.clickBtn("closeModal")})}onEdit(t){this.selectedItem=t;const i=this.plus.dateToHtmlObj(t,["ThoiGian"]);this.main.patchValue(i),this.plus.clickBtn("openModal")}onDelete(t){!confirm("B\u1ea1n mu\u1ed1n x\xf3a?")||(this.plus.load(),this.plus.httpDisable(this.api,t).then(t=>{console.log(t)}))}chooseOpt(t,i,e,n=!1){this.main.controls[i].setValue(t[e]),n&&this.main.controls[i+"ID"].setValue(t._id)}closeModal(){this.main.reset()}search(t){this.filter=t}find(t){this.items=t}checkPer(t){return this.plus.checkPer(this.api,t)}patchForm(){this.main.reset({_id:" "})}reload(){return this.plus.reload(this.dbName+"/"+this.api)}reset(){this.plus.loaded(),this.filter=[],this.getIDB(),this.main.reset({})}changePage(t){this.filter=this.items.slice(t.pageIndex*t.pageSize,(t.pageIndex+1)*t.pageSize)}trackByFn(t,i){return i}resetDB(){this.plus.resetDB(this.db,this.api)}}return t.\u0275fac=function(i){return new(i||t)(p.Y36(g.T),p.Y36(r.qu),p.Y36(d.i))},t.\u0275cmp=p.Xpm({type:t,selectors:[["app-nlmt-history"]],decls:12,vars:11,consts:[[1,"container"],["id","add-btn","color","accent","mat-raised-button","","data-toggle","modal","data-target","#modelId",3,"click"],["id","back-btn","mat-raised-button","","color","primary",3,"click",4,"ngIf"],[3,"api","data",4,"ngIf"],[3,"db","api","filter"],[1,"row"],["class","table table-hover",4,"ngIf"],[3,"length","pageSize","pageSizeOptions","page"],[3,"dataJson",4,"ngIf"],["mat-button","","color","warn",3,"click",4,"ngIf"],["id","back-btn","mat-raised-button","","color","primary",3,"click"],[3,"api","data"],[1,"table","table-hover"],[1,"thead-inverse"],["color","primary",3,"click"],[4,"ngFor","ngForOf","ngForTrackBy"],[3,"click"],["color","warn",3,"click",4,"ngIf"],["color","warn",3,"click"],[3,"dataJson"],["mat-button","","color","warn",3,"click"]],template:function(t,i){1&t&&(p.TgZ(0,"div",0),p.TgZ(1,"button",1),p.NdJ("click",function(){return i.reset()}),p.TgZ(2,"mat-icon"),p._uU(3,"control_point"),p.qZA(),p.qZA(),p.YNc(4,ii,3,1,"button",2),p.YNc(5,ei,1,1,"app-search-api",3),p.TgZ(6,"app-search-table",4),p.NdJ("filter",function(t){return i.search(t)}),p.qZA(),p.TgZ(7,"div",5),p.YNc(8,ai,16,3,"table",6),p.TgZ(9,"mat-paginator",7),p.NdJ("page",function(t){return i.changePage(t)}),p.qZA(),p.qZA(),p.YNc(10,si,1,1,"app-export-ecxel",8),p.qZA(),p.YNc(11,li,2,0,"button",9)),2&t&&(p.xp6(4),p.Q6J("ngIf",i.filter.length>0),p.xp6(1),p.Q6J("ngIf",i.checkPer(10)),p.xp6(1),p.Q6J("db",i.db)("api",i.api),p.xp6(2),p.Q6J("ngIf",i.items.length+i.filter.length>0),p.xp6(1),p.Q6J("length",i.items.length)("pageSize",10)("pageSizeOptions",p.DdM(10,ci)),p.xp6(1),p.Q6J("ngIf",i.checkPer(4)),p.xp6(1),p.Q6J("ngIf",i.checkPer(5)))},directives:[x.lW,q.Hw,l.O5,ti.D,X.NW,j.W,l.sg,it.t],pipes:[l.uU],styles:[""],data:{animation:[c.Ym]}}),t})();function ui(t,i){if(1&t){const t=p.EpF();p.TgZ(0,"button",33),p.NdJ("click",function(){return p.CHM(t),p.oxw().reload()}),p.TgZ(1,"mat-icon"),p._uU(2,"undo"),p.qZA(),p.qZA()}2&t&&p.Q6J("@slideIn",void 0)}function hi(t,i){if(1&t){const t=p.EpF();p.TgZ(0,"app-search-api",34),p.NdJ("data",function(i){return p.CHM(t),p.oxw().find(i)}),p.qZA()}if(2&t){const t=p.oxw();p.Q6J("api",t.api)}}function pi(t,i){1&t&&(p.TgZ(0,"th"),p._uU(1,"\u0110\u1ecba ch\u1ec9"),p.qZA())}function gi(t,i){1&t&&(p.TgZ(0,"th"),p._uU(1,"M\xe3 G C S"),p.qZA())}function di(t,i){1&t&&(p.TgZ(0,"th"),p._uU(1,"Ch\u1ee7 t\xe0i kho\u1ea3n"),p.qZA())}function mi(t,i){1&t&&(p.TgZ(0,"th"),p._uU(1,"S\u1ed1 t\xe0i kho\u1ea3n"),p.qZA())}function fi(t,i){1&t&&(p.TgZ(0,"th"),p._uU(1,"Ng\xe2n h\xe0ng"),p.qZA())}function Zi(t,i){1&t&&(p.TgZ(0,"th"),p._uU(1,"Email"),p.qZA())}function Ti(t,i){if(1&t){const t=p.EpF();p.TgZ(0,"td",40),p.NdJ("click",function(){p.CHM(t);const i=p.oxw().$implicit;return p.oxw(2).onEdit(i)}),p._uU(1),p.qZA()}if(2&t){const t=p.oxw().$implicit;p.xp6(1),p.Oqu(t.DiaChi)}}function bi(t,i){if(1&t){const t=p.EpF();p.TgZ(0,"td",40),p.NdJ("click",function(){p.CHM(t);const i=p.oxw().$implicit;return p.oxw(2).onEdit(i)}),p._uU(1),p.qZA()}if(2&t){const t=p.oxw().$implicit;p.xp6(1),p.Oqu(t.MaGCS)}}function xi(t,i){if(1&t){const t=p.EpF();p.TgZ(0,"td",40),p.NdJ("click",function(){p.CHM(t);const i=p.oxw().$implicit;return p.oxw(2).onEdit(i)}),p._uU(1),p.qZA()}if(2&t){const t=p.oxw().$implicit;p.xp6(1),p.Oqu(t.ChuTaiKhoan)}}function qi(t,i){if(1&t){const t=p.EpF();p.TgZ(0,"td",40),p.NdJ("click",function(){p.CHM(t);const i=p.oxw().$implicit;return p.oxw(2).onEdit(i)}),p._uU(1),p.qZA()}if(2&t){const t=p.oxw().$implicit;p.xp6(1),p.Oqu(t.SoTaiKhoan)}}function ki(t,i){if(1&t){const t=p.EpF();p.TgZ(0,"td",40),p.NdJ("click",function(){p.CHM(t);const i=p.oxw().$implicit;return p.oxw(2).onEdit(i)}),p._uU(1),p.qZA()}if(2&t){const t=p.oxw().$implicit;p.xp6(1),p.Oqu(t.NganHang)}}function Ai(t,i){if(1&t){const t=p.EpF();p.TgZ(0,"td",40),p.NdJ("click",function(){p.CHM(t);const i=p.oxw().$implicit;return p.oxw(2).onEdit(i)}),p._uU(1),p.qZA()}if(2&t){const t=p.oxw().$implicit;p.xp6(1),p.Oqu(t.Email)}}function Ii(t,i){if(1&t){const t=p.EpF();p.TgZ(0,"mat-icon",43),p.NdJ("click",function(){p.CHM(t);const i=p.oxw().$implicit;return p.oxw(2).onDelete(i)}),p._uU(1,"delete"),p.qZA()}}function _i(t,i){if(1&t){const t=p.EpF();p.TgZ(0,"tr"),p.TgZ(1,"td",40),p.NdJ("click",function(){const i=p.CHM(t).$implicit;return p.oxw(2).onEdit(i)}),p._uU(2),p.qZA(),p.TgZ(3,"td",40),p.NdJ("click",function(){const i=p.CHM(t).$implicit;return p.oxw(2).onEdit(i)}),p._uU(4),p.qZA(),p.YNc(5,Ti,2,1,"td",41),p.YNc(6,bi,2,1,"td",41),p.YNc(7,xi,2,1,"td",41),p.YNc(8,qi,2,1,"td",41),p.YNc(9,ki,2,1,"td",41),p.YNc(10,Ai,2,1,"td",41),p.TgZ(11,"td"),p.YNc(12,Ii,2,0,"mat-icon",42),p.qZA(),p.qZA()}if(2&t){const t=i.$implicit,e=p.oxw(2);p.xp6(2),p.Oqu(t.MaKhachHang),p.xp6(2),p.Oqu(t.KhachHang),p.xp6(1),p.Q6J("Device",3),p.xp6(1),p.Q6J("Device",3),p.xp6(1),p.Q6J("Device",3),p.xp6(1),p.Q6J("Device",3),p.xp6(1),p.Q6J("Device",3),p.xp6(1),p.Q6J("Device",2),p.xp6(2),p.Q6J("ngIf",e.checkPer(4))}}function Ni(t,i){if(1&t){const t=p.EpF();p.TgZ(0,"table",35),p.TgZ(1,"thead",36),p.TgZ(2,"tr"),p.TgZ(3,"th"),p._uU(4,"M\xe3 kh\xe1ch h\xe0ng"),p.qZA(),p.TgZ(5,"th"),p._uU(6,"Kh\xe1ch h\xe0ng"),p.qZA(),p.YNc(7,pi,2,0,"th",37),p.YNc(8,gi,2,0,"th",37),p.YNc(9,di,2,0,"th",37),p.YNc(10,mi,2,0,"th",37),p.YNc(11,fi,2,0,"th",37),p.YNc(12,Zi,2,0,"th",37),p.TgZ(13,"th"),p.TgZ(14,"mat-icon",38),p.NdJ("click",function(){return p.CHM(t),p.oxw().reload()}),p._uU(15,"cached"),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.TgZ(16,"tbody"),p.YNc(17,_i,13,9,"tr",39),p.qZA(),p.qZA()}if(2&t){const t=p.oxw();p.Q6J("@slideIn",void 0),p.xp6(7),p.Q6J("Device",3),p.xp6(1),p.Q6J("Device",3),p.xp6(1),p.Q6J("Device",3),p.xp6(1),p.Q6J("Device",3),p.xp6(1),p.Q6J("Device",3),p.xp6(1),p.Q6J("Device",3),p.xp6(5),p.Q6J("ngForOf",t.filter.length>0?t.filter:t.items.slice(0,10))("ngForTrackBy",t.trackByFn)}}function Di(t,i){if(1&t&&p._UZ(0,"app-import-database",44),2&t){const t=p.oxw();p.Q6J("api",t.api)("global",t.global)("form",t.main)}}function yi(t,i){if(1&t){const t=p.EpF();p.TgZ(0,"button",45),p.NdJ("click",function(){return p.CHM(t),p.oxw().resetDB()}),p._uU(1,"X\xf3a to\xe0n b\u1ed9 d\u1eef li\u1ec7u"),p.qZA()}}function vi(t,i){if(1&t){const t=p.EpF();p.TgZ(0,"button",46),p.NdJ("click",function(){return p.CHM(t),p.oxw().save()}),p.TgZ(1,"mat-icon"),p._uU(2,"save"),p.qZA(),p.qZA()}2&t&&p.Q6J("@slideIn",void 0)}const Ui=function(){return[5,10,25,100]},Ji=[{path:"",component:(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(i){return new(i||t)},t.\u0275cmp=p.Xpm({type:t,selectors:[["app-dlxl"]],decls:2,vars:0,template:function(t,i){1&t&&(p.TgZ(0,"p"),p._uU(1,"dlxl works!"),p.qZA())},styles:[""]}),t})()},{path:"dmt-khach-hang",component:(()=>{class t{constructor(t,i,e){this.plus=t,this.fb=i,this.rtSv=e,this.main=this.fb.group({_id:[,[]],MaKhachHang:[,[r.kI.required,r.kI.minLength(5)]],KhachHang:[,[r.kI.required,r.kI.minLength(5)]],DiaChi:[,[r.kI.required,r.kI.minLength(5)]],MaGCS:[,],ChuTaiKhoan:[,],SoTaiKhoan:[,],NganHang:[,],Email:[,],CoHoaDon:[,[r.kI.required]],CCCD:[,[]]}),this.title="Kh\xe1ch h\xe0ng",this.dbName="dien-luc",this.global=!0,this.api="dmt-khach-hang",this.db=null,this.userId=this.plus.userId,this.usr=this.plus.usr,this.items=[],this.selectedItem=null,this.filter=[],this.chart=[]}ngOnInit(){this.plus.setTiTle(this.title),this.plus.IDB_InitDB(this.dbName).subscribe(t=>function(t,i,e,n){return new(e||(e=Promise))(function(o,a){function s(t){try{c(n.next(t))}catch(i){a(i)}}function l(t){try{c(n.throw(t))}catch(i){a(i)}}function c(t){t.done?o(t.value):function(t){return t instanceof e?t:new e(function(i){i(t)})}(t.value).then(s,l)}c((n=n.apply(t,i||[])).next())})}(this,void 0,void 0,function*(){this.db=t,this.plus.updateRealtime(this.db,this.api,this.global),this.plus.IDB_DB_CleanTrash(t,this.api),this.plus.updateAPi.subscribe(t=>{t&&this.getIDB()})}))}getIDB(){this.filter=[],this.plus.IDB_DB_GetAll(this.db,this.api).subscribe(t=>{this.items=t})}ngOnDestroy(){console.log("Destroy",this.api),this.plus.subs.unsubscribe(),this.rtSv.leaveRoom(this.api)}save(){if(this.main.invalid)return;const t=this.main.value;if(null==t._id)delete t._id,this.plus.httpPost(this.api,t,this.global).subscribe(t=>{t.status&&(this.plus.clickBtn("closeModal"),this.plus.updateAPi.next(!0))});else{const i=this.plus.objVs(this.selectedItem,t);if(0===Object.keys(i).length)return this.plus.alertMatSnackBar("Kh\xf4ng c\xf3 n\u1ed9i dung n\xe0o thay \u0111\u1ed5i");this.plus.httpPut(this.api,t,this.global).subscribe(t=>{t.status&&(this.plus.clickBtn("closeModal"),this.addHistory(i),this.plus.updateAPi.next(!0))})}}addHistory(t){const i=[];for(const n in t)i.push(this.selectedItem[n]+" => "+t[n]);const e={TaiKhoan:this.plus.user.value.fullName,NoiDung:i.join(", "),ThoiGian:Date.now(),MaKhachHang:this.selectedItem.MaKhachHang};0!=i.length&&this.plus.httpPost("dmt-history",e,!0).subscribe(t=>{})}onEdit(t){this.selectedItem=t,this.main.patchValue(t),this.plus.clickBtn("openModal")}onDelete(t){!confirm("B\u1ea1n mu\u1ed1n x\xf3a?")||(this.plus.load(),this.plus.httpDisable(this.api,t,!0).then(t=>{console.log(t)}))}chooseOpt(t,i,e,n=!1){this.main.controls[i].setValue(t[e]),n&&this.main.controls[i+"ID"].setValue(t._id)}closeModal(){this.main.reset()}search(t){this.filter=t}find(t){this.items=t}checkPer(t){return this.plus.checkPer(this.api,t)}reload(){return this.plus.reload(this.dbName+"/"+this.api)}reset(){this.plus.loaded(),this.filter=[],this.getIDB(),this.main.reset({})}changePage(t){this.filter=this.items.slice(t.pageIndex*t.pageSize,(t.pageIndex+1)*t.pageSize)}trackByFn(t,i){return i}resetDB(){this.plus.resetDB(this.db,this.api)}}return t.\u0275fac=function(i){return new(i||t)(p.Y36(g.T),p.Y36(r.qu),p.Y36(d.i))},t.\u0275cmp=p.Xpm({type:t,selectors:[["app-nlmt-kh"]],decls:76,vars:15,consts:[[1,"container"],["id","add-btn","color","accent","mat-raised-button","","data-toggle","modal","data-target","#modelId",3,"click"],["id","back-btn","mat-raised-button","","color","primary",3,"click",4,"ngIf"],[3,"api","data",4,"ngIf"],[3,"db","api","filter"],[1,"row"],["class","table table-hover",4,"ngIf"],[3,"length","pageSize","pageSizeOptions","page"],[3,"api","global","form",4,"ngIf"],["mat-button","","color","warn",3,"click",4,"ngIf"],[3,"dataJson"],["id","openModal","type","button","data-toggle","modal","data-target","#modelId",1,"d-none"],["id","modelId","data-backdrop","static","tabindex","-1","role","dialog","aria-labelledby","modelTitleId","aria-hidden","true",1,"modal","fade"],["role","document",1,"modal-dialog","modal-lg"],[1,"modal-content"],[1,"modal-body"],[1,"container-fluid"],[3,"formGroup"],["hidden","","formControlName","_id"],["required","","type","text","autocomplete","off","matInput","","formControlName","MaKhachHang"],["matSuffix",""],["required","","type","text","autocomplete","off","matInput","","formControlName","KhachHang"],["required","","type","text","autocomplete","off","matInput","","formControlName","DiaChi"],["type","text","autocomplete","off","matInput","","formControlName","MaGCS"],["type","text","autocomplete","off","matInput","","formControlName","ChuTaiKhoan"],["type","text","autocomplete","off","matInput","","formControlName","SoTaiKhoan"],["type","text","autocomplete","off","matInput","","formControlName","NganHang"],["type","text","autocomplete","off","matInput","","formControlName","Email"],["type","text","autocomplete","off","matInput","","formControlName","CoHoaDon"],["type","text","autocomplete","off","matInput","","formControlName","CCCD"],[1,"modal-footer"],["id","closeModal","mat-raised-button","","color","primary","data-dismiss","modal",3,"click"],["mat-raised-button","","color","warn",3,"click",4,"ngIf"],["id","back-btn","mat-raised-button","","color","primary",3,"click"],[3,"api","data"],[1,"table","table-hover"],[1,"thead-inverse"],[4,"Device"],["color","primary",3,"click"],[4,"ngFor","ngForOf","ngForTrackBy"],[3,"click"],[3,"click",4,"Device"],["color","warn",3,"click",4,"ngIf"],["color","warn",3,"click"],[3,"api","global","form"],["mat-button","","color","warn",3,"click"],["mat-raised-button","","color","warn",3,"click"]],template:function(t,i){1&t&&(p.TgZ(0,"div",0),p.TgZ(1,"button",1),p.NdJ("click",function(){return i.reset()}),p.TgZ(2,"mat-icon"),p._uU(3,"control_point"),p.qZA(),p.qZA(),p.YNc(4,ui,3,1,"button",2),p.YNc(5,hi,1,1,"app-search-api",3),p.TgZ(6,"app-search-table",4),p.NdJ("filter",function(t){return i.search(t)}),p.qZA(),p.TgZ(7,"div",5),p.YNc(8,Ni,18,9,"table",6),p.TgZ(9,"mat-paginator",7),p.NdJ("page",function(t){return i.changePage(t)}),p.qZA(),p.qZA(),p.YNc(10,Di,1,3,"app-import-database",8),p.qZA(),p.YNc(11,yi,2,0,"button",9),p._UZ(12,"app-export-ecxel",10),p._UZ(13,"button",11),p.TgZ(14,"div",12),p.TgZ(15,"div",13),p.TgZ(16,"div",14),p.TgZ(17,"div",15),p.TgZ(18,"div",16),p.TgZ(19,"form",17),p._UZ(20,"input",18),p.TgZ(21,"mat-form-field"),p.TgZ(22,"mat-label"),p._uU(23,"M\xe3 kh\xe1ch h\xe0ng"),p.qZA(),p._UZ(24,"input",19),p._UZ(25,"span",20),p.qZA(),p.TgZ(26,"mat-form-field"),p.TgZ(27,"mat-label"),p._uU(28,"Kh\xe1ch h\xe0ng"),p.qZA(),p._UZ(29,"input",21),p._UZ(30,"span",20),p.qZA(),p.TgZ(31,"mat-form-field"),p.TgZ(32,"mat-label"),p._uU(33,"\u0110\u1ecba ch\u1ec9"),p.qZA(),p._UZ(34,"input",22),p._UZ(35,"span",20),p.qZA(),p.TgZ(36,"mat-form-field"),p.TgZ(37,"mat-label"),p._uU(38,"M\xe3 Ghi ch\u1ec9 s\u1ed1"),p.qZA(),p._UZ(39,"input",23),p._UZ(40,"span",20),p.qZA(),p.TgZ(41,"mat-form-field"),p.TgZ(42,"mat-label"),p._uU(43,"Ch\u1ee7 t\xe0i kho\u1ea3n"),p.qZA(),p._UZ(44,"input",24),p._UZ(45,"span",20),p.qZA(),p.TgZ(46,"mat-form-field"),p.TgZ(47,"mat-label"),p._uU(48,"S\u1ed1 t\xe0i kho\u1ea3n"),p.qZA(),p._UZ(49,"input",25),p._UZ(50,"span",20),p.qZA(),p.TgZ(51,"mat-form-field"),p.TgZ(52,"mat-label"),p._uU(53,"Ng\xe2n h\xe0ng"),p.qZA(),p._UZ(54,"input",26),p._UZ(55,"span",20),p.qZA(),p.TgZ(56,"mat-form-field"),p.TgZ(57,"mat-label"),p._uU(58,"Email"),p.qZA(),p._UZ(59,"input",27),p._UZ(60,"span",20),p.qZA(),p.TgZ(61,"mat-form-field"),p.TgZ(62,"mat-label"),p._uU(63,"C\xf3 h\xf3a \u0111\u01a1n"),p.qZA(),p._UZ(64,"input",28),p._UZ(65,"span",20),p.qZA(),p.TgZ(66,"mat-form-field"),p.TgZ(67,"mat-label"),p._uU(68,"C C C D"),p.qZA(),p._UZ(69,"input",29),p._UZ(70,"span",20),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.TgZ(71,"div",30),p.TgZ(72,"button",31),p.NdJ("click",function(){return i.closeModal()}),p.TgZ(73,"mat-icon"),p._uU(74,"close"),p.qZA(),p.qZA(),p.YNc(75,vi,3,1,"button",32),p.qZA(),p.qZA(),p.qZA(),p.qZA()),2&t&&(p.xp6(4),p.Q6J("ngIf",i.filter.length>0),p.xp6(1),p.Q6J("ngIf",i.checkPer(10)),p.xp6(1),p.Q6J("db",i.db)("api",i.api),p.xp6(2),p.Q6J("ngIf",i.items.length+i.filter.length>0),p.xp6(1),p.Q6J("length",i.items.length)("pageSize",10)("pageSizeOptions",p.DdM(14,Ui)),p.xp6(1),p.Q6J("ngIf",i.checkPer(4)),p.xp6(1),p.Q6J("ngIf",i.checkPer(5)),p.xp6(1),p.Q6J("dataJson",i.items),p.xp6(7),p.Q6J("formGroup",i.main),p.xp6(53),p.Q6J("@slideIn",void 0),p.xp6(3),p.Q6J("ngIf",i.checkPer(2)&&i.main.valid))},directives:[x.lW,q.Hw,l.O5,ti.D,X.NW,it.t,r._Y,r.JL,r.sg,r.Fj,r.JJ,r.u,f.KE,f.hX,Z.Nt,r.Q7,f.R9,j.W,U.HP,l.sg,tt.y],styles:[""],data:{animation:[c.Ym]}}),t})()},{path:"dmt-history",component:ri},{path:"dmt-input",component:jt},{path:"dmt-input/:id",component:N},{path:"dmt-pay",component:ft},{path:"dmt-pay/:id",component:V}];let Mi=(()=>{class t{}return t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=p.oAB({type:t}),t.\u0275inj=p.cJS({imports:[[m.Bz.forChild(Ji)],m.Bz]}),t})(),Hi=(()=>{class t{}return t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=p.oAB({type:t}),t.\u0275inj=p.cJS({imports:[[l.ez,Mi,s.ShareModule,a.m,o.D,n.X]]}),t})()}}]);