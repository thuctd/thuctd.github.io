"use strict";(self.webpackChunkdlxl=self.webpackChunkdlxl||[]).push([[555],{58687:(J,$,C)=>{C.d($,{X:()=>w});var A=C(15861),m=C(12157),j=C(15439),d=C.n(j),L=C(94650),k=C(25555),S=C(94559),G=C(10875);let w=(()=>{class K{constructor(f,y,O){this.plus=f,this.loadSV=y,this.authSV=O,this.user=null,this.user=JSON.parse(localStorage.getItem("USERCMIS"))}getBaoCaoDMT(f){var y=this;return(0,A.Z)(function*(){return y.loadSV.load("getBaoCaoDMT"),m.Z.post("https://cmis-api.evnspc.vn/serviceBCaoThang/getBaocaoTongHopDienMTMN",f,{headers:{path:"/serviceBCaoThang/getBaocaoTongHopDienMTMN",authority:"cmis-api.evnspc.vn",authorization:"Bearer "+y.user.ACCESS_TOKEN}}).then(F=>(localStorage.setItem(f.BIEU,JSON.stringify(F.data)),y.loadSV.loaded("getBaoCaoDMT"),F.data)).catch(F=>(localStorage.removeItem("USERCMIS"),y.plus.alertMatSnackBar("Phie\u0302n \u0111a\u0306ng nha\u0323\u0302p he\u0302\u0301t ha\u0323n. Vui lo\u0300ng \u0111a\u0306ng nha\u0323\u0302p la\u0323i"),y.authSV.reload("/cmis4"),y.loadSV.clear(),console.log(F),[]))})()}getB11(f){let y=d()(f,"DD/MM/YYYY").format("MM"),O=d()(f,"DD/MM/YYYY").format("YYYY");return m.Z.post("https://cmis-api.evnspc.vn/serviceBCaoThang/getBaocaoTongHopDienMTMN",{MA_DVIQLY:this.user.SUBDIVISIONID,THANG:y,NAM:O,LUY_KE:0,TCHAT_MTAM:0,NGAY_COD:-1,TU_NGAY_GCS:f,DEN_NGAY_GCS:f,BIEU:"BIEU11",QUYET_TOAN:1},{headers:{path:"/serviceBCaoThang/getBaocaoTongHopDienMTMN",authority:"cmis-api.evnspc.vn",authorization:"Bearer "+this.user.ACCESS_TOKEN}}).then(W=>W.data).catch(W=>(localStorage.removeItem("USERCMIS"),this.plus.alertMatSnackBar("Phie\u0302n \u0111a\u0306ng nha\u0323\u0302p he\u0302\u0301t ha\u0323n. Vui lo\u0300ng \u0111a\u0306ng nha\u0323\u0302p la\u0323i"),this.authSV.reload("/cmis4"),this.loadSV.clear(),console.log(W),[]))}}return K.\u0275fac=function(f){return new(f||K)(L.LFG(k.T),L.LFG(S.b),L.LFG(G.c1))},K.\u0275prov=L.Yz7({token:K,factory:K.\u0275fac,providedIn:"root"}),K})()},85033:(J,$,C)=>{C.d($,{j:()=>te});var A=C(15861),m=C(24006),j=C(15439),d=C.n(j),L=C(94327),k=C.n(L),S=C(64313),w=C(25650),K=C.n(w),I=C(49808),f=C(10875),y=C(94650),O=C(25555),V=C(52075),Y=C(9157),F=C(54654),Z=C(94559),W=C(70511),X=C(23887),q=C(38376),ee=C(1768);let te=(()=>{class U{constructor(a,e,l,t,o,n,r,i,h,g,s){this.fb=a,this.plus=e,this.storageSV=l,this.authSV=t,this.docxSV=o,this.idbSV=n,this.loadSV=r,this.httpSV=i,this.cryptSV=h,this.emailSV=g,this.cmis4SV=s,this.global=!0,this.dbName="dien-luc",this.db=null,this.chunkSize=500,this.workbook=new S.Workbook,this.payForm=this.fb.group({_id:[,[]],TenBangKe:[,[m.kI.required]],TrangThai:[,[m.kI.required]],LichSuCapNhat:[,[m.kI.required]],TongPhatLen:[,[m.kI.required,m.kI.pattern(this.plus.regex_integer())]],ThanhTienTruocThue:[,[m.kI.required,m.kI.pattern(this.plus.regex_integer())]],Thue:[,[m.kI.required,m.kI.pattern(this.plus.regex_integer())]],ThanhTienSauThue:[,[m.kI.required,m.kI.pattern(this.plus.regex_integer())]],DanhSach:[]}),this.inputForm=this.fb.group({Email:[""],MaKhachHang:["",[m.kI.required]],KhachHang:["",[m.kI.required]],DiaChi:["",[m.kI.required]],MaGCS:[""],ChuTaiKhoan:[],SoTaiKhoan:[],NganHang:["",[m.kI.required]],Nam:[0,[m.kI.required,m.kI.pattern("^[0-9]*$")]],Thang:[0,[m.kI.required,m.kI.pattern("^[0-9]*$")]],SanLuong:[0,[m.kI.required,m.kI.pattern(this.plus.regex_integer())]],DonGia:[0,[m.kI.required,m.kI.pattern(this.plus.regex_integer())]],TruocThue:[0,[m.kI.required,m.kI.pattern(this.plus.regex_integer())]],Thue:[0,[m.kI.required,m.kI.pattern(this.plus.regex_integer())]],TongTien:[0,[m.kI.required,m.kI.pattern(this.plus.regex_integer())]],KyHieuHoaDon:["",[]],SoHoaDon:["",[]],CCCD:["",[]],NgayHoaDon:["",[]],TrangThai:[""],DaGuiMail:[0],NgayMuaHang:["",[]]}),this.importForm=this.fb.group({keyWord:["",[]],_id:["",[]],TONG_TIEN:["",[m.kI.required,m.kI.pattern("^-?[0-9]d*$")]],MA_DVIQLY:["",[]],TKHOAN_KHANG:["",[]],MA_NHANG:["",[]],TEN_NHANG:["",[]],MA_SOGCS:["",[m.kI.required]],TYLE_THUE:["",[]],DIEN_TTHU:["",[m.kI.required,m.kI.pattern("^-?[0-9]d*$")]],SO_TIEN:["",[m.kI.required,m.kI.pattern("^-?[0-9]d*$")]],DCHI_KHANG:["",[]],MA_KHANG:["",[m.kI.required,m.kI.minLength(10)]],TIEN_GTGT:["",[m.kI.required,m.kI.pattern("^-?[0-9]d*$")]],TEN_KHANG:["",[m.kI.required]],NGAY_GCS:["",[]],DON_GIA:["",[m.kI.required,m.kI.pattern("^[0-9]*$")]]})}init(){var a=this;return(0,A.Z)(function*(){a.getSetup()})()}getSetup(){var a=this;return(0,A.Z)(function*(){let e=yield a.authSV._getOpt(f.HB.USER);a.authSV.FBS_getById("setup",e._id).subscribe(l=>{console.log(l),a.setup=l,a.authSV._setOpt(f.HB.NLMTSETUP,"dmtset")})})()}detroy(){this.httpSV.unsubcribe(),window[this.user.unit+"-dmt-input"]=void 0,window[this.user.unit+"-dmt-khach-hang"]=void 0,window[this.user.unit+"-dmt-pay"]=void 0}huycapnhatQToanSLuongMTAM(a){var e=this;return(0,A.Z)(function*(){const l=yield e.getDsachKhangQToanDienMTAM(a);if(!l.NGAY_QTOAN||!("NGAY_QTOAN"in l))return e.plus.alertError("Kho\u0302ng ti\u0300m tha\u0302\u0301y nga\u0300y quye\u0302\u0301t toa\u0301n");console.log(l);let n=JSON.parse(localStorage.getItem("USERCMIS"))||null;return e.cmis4SV.cmis4Request("https://cmis-api.evnspc.vn/serviceTTienCNo/huycapnhatQToanSLuongMTAM","/serviceTTienCNo/huycapnhatQToanSLuongMTAM",{MA_DVIQLY:n.SUBDIVISIONID,MA_KHANG:l.MA_KHANG,USER:n.USERNAME,NGAY_QTOAN:l.NGAY_QTOAN,SO_TIEN:l.SO_TIEN,MA_CNANG:"531",LST_KHQT:[l]}).then(i=>{e.plus.alertSuccess("Hu\u0309y tha\u0300nh co\u0302ng")})})()}getDsachKhangQToanDienMTAM(a){var e=this;return(0,A.Z)(function*(){let n={MA_DVIQLY:(JSON.parse(localStorage.getItem("USERCMIS"))||null).SUBDIVISIONID,MA_KHANG:a.MaKhachHang,NAM:a.Nam,QUYET_TOAN:1};return e.cmis4SV.cmis4Request("https://cmis-api.evnspc.vn/serviceBCaoThang/getDsachKhangQToanDienMTAM","/serviceBCaoThang/getDsachKhangQToanDienMTAM",n).then(r=>{for(let i=0;i<r.length;i++){const h=r[i];if(h.NAM==a.Nam&&h.MA_KHANG==a.MaKhachHang&&h.THANG==a.Thang&&h.SO_TIEN+h.TIEN_GTGT==a.TongTien)return console.log(h),h}})})()}moHoaDon(a){var e=this;return(0,A.Z)(function*(){for(let l=0;l<a.DanhSach.length;l++){const t=a.DanhSach[l];let o=`https://spcevn-my.sharepoint.com/personal/anhnhp_dn_evnspc_vn/Documents/HoaDon/${t.Nam}/${t.Thang<10?"0"+t.Thang:t.Thang}/${t.MaKhachHang}.pdf`;yield e.plus.sleep(300),window.open(o,"_blank")}})()}updateTax(a){return this.httpSV.put("dmt-input",{_id:a._id,NgayHoaDon:a.NgayHoaDon,KyHieuHoaDon:a.KyHieuHoaDon,SoHoaDon:a.SoHoaDon,KyKeKhai:a.KyKeKhai},"")}updateTaxs(a){return this.httpSV.put("dmt-input/multi",a,"")}sendMailBank(a){var e=this;return(0,A.Z)(function*(){return new Promise((l,t)=>{let o=e.authSV.userDir;e.export_ThanhToanPTC(a,!1).then(n=>{e.storageSV.uploadFile(n,"BangKe",o._id).then(r=>{let i=e.geneBodyMailBank(`${r}`,`BangKe-PTC-${a.DanhSach[0].TenBangKe}.xlsx`);e.emailSV.send("dmt",i).subscribe(h=>{console.log(h),h.email==i.email?e.authSV._toastSuccess("\u0110\xe3 g\u1eedi mail th\xe0nh c\xf4ng"):e.authSV._toastErr("G\u1eedi kh\xf4ng th\xe0nh c\xf4ng"),e.loadSV.loaded("email"),l(!0)})})})})})()}onDeleteInput(a){let e=a;return e.status=0,e.dateModify=Date.now(),this.httpSV.disable("dmt-input",e,"")}statusMail(a){console.log("statusMail()"),Date.now()}sendMail(a){var e=this;return(0,A.Z)(function*(){let l=[];for(let t=0;t<a.length;t++){const o=a[t];if(!o.Email)return;let n=e.geneBodyMail(o,t);console.log(n),e.emailSV.send("dmt",n).subscribe(r=>{const i=r.index;if(console.log("Mail sent: ",i,r.email),i>=0&&r.email){let h={_id:o._id,DaGuiMail:1};l.push(h),e.httpSV.put("dmt-input",h,"").subscribe(g=>{console.log(g)})}else e.plus.alertToasrt(r)}),yield e.plus.sleep(4e3)}window.location.reload()})()}updateDayPay(a,e){const l=Date.now(),t=a;t.dateModify=l,t.LichSuCapNhat.push("C\u1eadp nh\u1eadt th\xe1ng thanh to\xe1n "+e),this.authSV.FBS_update(`dmt/${this.user.unit}/pay`,t._id,t);let o=t.DanhSach,n=[];for(let r=0;r<o.length;r++)n.push({_id:o[r]._id,dateModify:l+r,NgayThanhToan:e,TrangThaiHoSo:4});this.httpSV.put("dmt-input/multi",n,""),this.authSV.reload()}sendList(a,e){this.loadSV.load("sendList");const l=Date.now();console.log("sendList()",+l);let t=a,o=[];for(let h=0;h<t.length;h++){const g=t[h];let s={_id:g._id,TenBangKe:e,TrangThaiHoSo:2,NhatKy:this.themNhatKy(g,2)};o.push(s)}const n=this.geneBodyPay(a,e,"G\u1eedi b\u1ea3ng k\xea");n.TenBangKe=e,this.xuatDNTT(n);let r=(0,I.n)(this.httpSV.post("dmt-pay",n,"")),i=(0,I.n)(this.httpSV.put("dmt-input/multi",o,""));return Promise.all([r,i])}changeStatusList(a,e){var l=this;return(0,A.Z)(function*(){console.log("changeStatusList()");const t=Date.now(),o=a.DanhSach;let n="";switch(e){case 0:n="S\u1eeda l\u1ea1i";break;case 1:n="\u0110\u1ee7 \u0110K";break;case 2:n="PKD \u0111\xe3 l\u1eadp b\u1ea3ng k\xea";break;case 3:n="\u0110\xe3 duy\u1ec7t thanh to\xe1n";break;case 4:n="\u0110\xe3 thanh to\xe1n"}let r=[];for(let g=0;g<o.length;g++){let s={_id:o[g]._id,TrangThaiHoSo:e,NgayThanhToan:4==e?d()(t).format("MM/YYYY"):"",dateModify:t+g,NhatKy:l.themNhatKy(o[g],e)};0==e&&(s.TenBangKe=""),r.push(s)}a.TrangThai=e,a.dateModify=t,delete a.__v;let i=(0,I.n)(l.httpSV.put("dmt-pay",a,"")),h=(0,I.n)(l.httpSV.put("dmt-input/multi",r,""));return Promise.all([i,h]).then(g=>{})})()}changeStatusMultiList(a){console.log(a);const e=Date.now();let l=[],t=[];for(let r=0;r<a.length;r++){const i=a[r];let h=i.LichSuCapNhat;h.push("H\u1ed3 s\u01a1 \u0111\xe3 thanh to\xe1n: "+d()().format("HH:mm DD/MM/YYYY"));let g={_id:i._id,LichSuCapNhat:h,TrangThai:4,KyThanhToan:d()().format("MM/YYYY")};l.push(g);const s=i.DanhSach;for(let u=0;u<s.length;u++){const _=s[u];let c={_id:_._id,TrangThaiHoSo:4,NgayThanhToan:d()(e).format("MM/YYYY"),dateModify:e+r,NhatKy:this.themNhatKy(_,4)};t.push(c)}}let o=(0,I.n)(this.httpSV.put("dmt-pay/multi",l,"")),n=(0,I.n)(this.httpSV.put("dmt-input/multi",t,""));return Promise.all([o,n])}themNhatKy(a,e){let l=Array.isArray(a.NhatKy)?a.NhatKy:[],t=d()().format("HH:mm DD/MM/YYYY");switch(e){case 0:l.push(`${t}: S\u1eeda l\u1ea1i`);break;case 1:l.push(`${t}: \u0110\u1ee7 \u0110K`);break;case 2:l.push(`${t}: PKD \u0111\xe3 l\u1eadp b\u1ea3ng k\xea`);break;case 3:l.push(`${t}: \u0110\xe3 duy\u1ec7t thanh to\xe1n`);break;case 4:l.push(`${t}: \u0110\xe3 thanh to\xe1n`)}return l}duDieuKien(a){var e=this;return(0,A.Z)(function*(){const l=Date.now();let t=[],o=[];console.log("updateQualified()",l);for(let n=0;n<a.length;n++){const r=a[n];let h={updateOne:{filter:{_id:r._id},update:{TrangThaiHoSo:1}}};t.push({_id:r._id,TrangThaiHoSo:1,DieuKienThanhToan:1,dateModify:l+n}),o.push(h)}e.httpSV.put("dmt-input/multi",t,"").subscribe(n=>{})})()}ChuaDuDieuKien(a){var e=this;return(0,A.Z)(function*(){const l=Date.now();let t=[];console.log("updateQualified()",l);for(let o=0;o<a.length;o++)t.push({_id:a[o]._id,TrangThaiHoSo:-1,DieuKienThanhToan:0});e.httpSV.put("dmt-input/multi",t,"").subscribe(o=>{})})()}xuatUNC(a,e){this.loadSV.load("xuatUNC"),this.docxSV.loadFileUrl(`https://thuctd.github.io/templates/UNC/${e}.docx`).then(l=>{let t=this.setup.TaiKhoan.filter(n=>n.MaNganHang==e);this.docxSV.generateOne({ChuTaiKhoan:t[0].ChuTaiKhoan,ChiNhanh:t[0].ChiNhanh,SoTaiKhoan:t[0].SoTaiKhoan,ThuocTinh:t[0].ThuocTinh,GiamDoc:this.setup.GiamDoc,TruongPTC:this.setup.TruongPhong,DiaChi:this.setup.DiaChi,TenBangKe:a.TenBangKe,ThanhTienSauThue:a.ThanhTienSauThue},l,"").then(n=>{console.log(n),this.plus.alertSuccess(),this.loadSV.loaded("xuatUNC")})})}xuatDNTT(a){this.loadSV.load("xuatDNTT"),this.docxSV.loadFileUrl("https://thuctd.github.io/templates/4la-TTr-DeNghiThanhToan.docx").then(e=>{let l={ChuTaiKhoan:"",ChiNhanh:"",SoTaiKhoan:"bankSetup[0].SoTaiKhoan",ThuocTinh:"bankSetup[0].ThuocTinh",GiamDoc:this.setup.GiamDoc,TruongPTC:this.setup.TruongPhong,DiaChi:this.setup.DiaChi,TenBangKe:a.TenBangKe,ThanhTienSauThue:a.ThanhTienSauThue,Ngay:d()().format("DD/MM/YYYY")};this.docxSV.generateOne(l,e,a.TenBangKe).then(t=>{console.log(t),this.plus.alertSuccess(),this.loadSV.loaded("xuatDNTT")})})}layChiSo(a,e){if(e.Thang>0)return this.idbSV.IDB_DB_GetAllByIndexKey(a,"dmt-chi-so","KyThanhToan","=",`${e.Thang}${e.Nam}${e.MaKhachHang}`).then(t=>t)}xuatBangKeChiSo(a,e){var l=this;return(0,A.Z)(function*(){let t=[],o=[];for(let i=0;i<e.length;i++){const h=e[i];let g=yield l.layChiSo(a,h);if(console.log(g),0==g.length)return l.plus.alertWarning(`Ch\u01b0a c\xf3 th\xf4ng tin ch\u1ec9 s\u1ed1 KH ${h.MaKhachHang}. Vui l\xf2ng import tr\u01b0\u1edbc khi l\u1eadp b\u1ea3ng k\xea`);for(let s=0;s<g.length;s++){const u=g[s];1==u.BCS?t.push(u):3==u.BCS&&o.push(u)}}let n=[...new Set(t)],r=[...new Set(o)];t.length>0&&l.export_ChiSo1Bieu(n),o.length>0&&l.export_ChiSo3Bieu(r)})()}xuatCongNo(a,e){var l=this;return(0,A.Z)(function*(){l.loadSV.load("xuatCongNo");let t=yield l.docxSV.loadFileUrl("https://thuctd.github.io/templates/BBCongNo.docx"),o=l.setup,n=[];for(let h=0;h<a.length;h++){const g=a[h];let s=n.findIndex(_=>_._id==g.MaKhachHang),u={MaGCS:g.MaGCS,MaKH:g.MaKhachHang,ThangNam:g.Thang+"/"+g.Nam,SanLuong:g.SanLuong,TongTien:g.TongTien};if(s<0){let _=yield l.idbSV.IDB_DB_GetAllByIndexKey(e,"dmt-khach-hang","MaKhachHang","=",g.MaKhachHang);n.push({_id:g.MaKhachHang,TenDonVi:o.TenDonVi,DiaChi:o.DiaChi,GiamDoc:o.GiamDoc,TenKH:g.KhachHang,DiaChiKH:g.DiaChi,DaiDien:_[0].DaiDien,ChucVu:_[0].ChucVu,TongTien:g.TongTien,Nam:g.Nam,table:[u]})}else n[s].TongTien+=g.TongTien,n[s].table.push(u)}let r=new(K()),i=r.folder("");for(let h=0;h<n.length;h++){const g=n[h];let s=`${h+1}-`+g._id+"-"+g.TenKH+".docx",u=yield l.docxSV.generateOnePromise(g,t,s);i.file(s,u)}r.generateAsync({type:"blob"}).then(h=>{h&&(console.log(h),k()(h,"CongNo.zip"),l.loadSV.loaded("xuatCongNo"))})})()}geneBodyPay(a,e,l){console.log("geneBodyPay()");const t={};t.TenBangKe=e,t.KyThanhToan=a[0].Thang+"/"+a[0].Nam,t.LichSuCapNhat=[l+": "+d()().format("HH:mm-DD/MM/YYYY")],t.TrangThai=2,t.TongPhatLen=0,t.ThanhTienTruocThue=0,t.Thue=0,t.Nam=a[0].Nam,t.Thang=a[0].Thang,t.ThanhTienSauThue=0;for(let o=0;o<a.length;o++){const n=a[o];a[o].TenBangKe=e,t.DanhSach=a,t.TongPhatLen+=n.SanLuong,t.ThanhTienTruocThue+=n.TruocThue,t.Thue+=n.Thue,t.ThanhTienSauThue+=n.TongTien}return t}geneBodyMail(a,e){let l=this.setup,t=this.user;return{from:l.TenDonVi,unit:t.unit,status:0,email:a.Email,title:`Th\xf4ng b\xe1o n\u1ed9i dung thanh to\xe1n ti\u1ec1n \u0111i\u1ec7n NLMTMN th\xe1ng ${a.Thang} n\u0103m ${a.Nam}`,company:a.KhachHang,index:e,message:`<p>K\xednh g\u1eedi kh\xe1ch h\xe0ng: ${a.KhachHang}.</p>\n          <p> ${l.TenDonVi} k\xednh g\u1eedi \u0111\u1ebfn qu\xfd kh\xe1ch h\xe0ng n\u1ed9i dung thanh to\xe1n ti\u1ec1n \u0111i\u1ec7n m\u1eb7t tr\u1eddi tr\xean m\xe1i nh\xe0 v\u1edbi n\u1ed9i dung nh\u01b0 sau:</p>\n          <ul> M\xe3 kh\xe1ch h\xe0ng: ${a.MaKhachHang}.</ul>\n          <ul> T\xean kh\xe1ch h\xe0ng: ${a.KhachHang}.</ul>\n          <ul> \u0110\u1ecba ch\u1ec9: ${a.DiaChi}.</ul>\n          <ul> M\xe3 ghi ch\u1ec9 s\u1ed1: ${a.MaGCS}.</ul>\n          <ul> T\xean t\xe0i kho\u1ea3n: ${a.ChuTaiKhoan}.</ul>\n          <ul> S\u1ed1 t\xe0i kho\u1ea3n: ${a.SoTaiKhoan}.</ul>\n          <ul> Ng\xe2n h\xe0ng: ${a.NganHang}.</ul>\n          <ul> N\u0103m: ${a.Nam}.</ul>\n          <ul> Th\xe1ng: ${a.Thang}.</ul>\n          <ul> \u0110i\u1ec7n ph\xe1t l\xean l\u01b0\u1edbi: ${this.plus.numberWithCommas(a.SanLuong)} kWh.</ul>\n          <ul> \u0110\u01a1n gi\xe1: ${this.plus.numberWithCommas(a.DonGia)} VND/kWh.</ul>\n          <ul> T\u1ec9 l\u1ec7 Thu\u1ebf: ${a.TiLeThue} %.</ul>\n          <ul> Th\xe0nh ti\u1ec1n ch\u01b0a thu\u1ebf VAT: ${this.plus.numberWithCommas(a.TruocThue)} VND.</ul>\n          <ul> Thu\u1ebf VAT: ${this.plus.numberWithCommas(a.Thue)} VND.</ul>\n          <ul> T\u1ed5ng ti\u1ec1n: ${this.plus.numberWithCommas(a.TongTien)} VND.</ul>\n          <p> M\u1ecdi \xfd ki\u1ebfn ph\u1ea3n h\u1ed3i vui l\xf2ng li\xean h\u1ec7 \u0110\u1ed9i qu\u1ea3n l\xfd \u0111i\u1ec7n Xu\xe2n L\u1ed9c qua s\u1ed1 \u0111i\u1ec7n tho\u1ea1i ${t.fullName} - <a href="tel:${t.phoneNumber}" >${t.phoneNumber}</a> \u0111\u1ec3 \u0111\u01b0\u1ee3c gi\u1ea3i \u0111\xe1p.</p>\n          <p> Ph\u1ea3n h\u1ed3i h\xf3a \u0111\u01a1n qu\xfd kh\xe1ch vui l\xf2ng g\u1eedi email v\u1ec1 c\u1ea3 02 \u0111\u1ecba ch\u1ec9: <a href="mailto:dienlucxuanloc.nlmt@gmail.com;tckt.dlxl.pcdn@gmail.com">dienlucxuanloc.nlmt@gmail.com</a> v\xe0 <a href="mailto:dienlucxuanloc.nlmt@gmail.com;tckt.dlxl.pcdn@gmail.com">tckt.dlxl.pcdn@gmail.com</a> </p>\n          Tr\xe2n tr\u1ecdng.`}}geneBodyMailBank(a,e){let l=this.setup,t=this.setup.TaiKhoan.filter(n=>1==n.TrangThai);return{from:l.TenDonVi,email:t[0].Email,link:a,fileName:e,index:0,title:`G\u1eedi b\u1ea3ng k\xea thanh to\xe1n ti\u1ec1n \u0111i\u1ec7n NLMTMN (${e})`,message:`<p>K\xednh g\u1eedi ng\xe2n h\xe0ng ${t[0].TenNganHang} - ${t[0].ChiNhanh}.</p>\n            <p>${l.TenDonVi} g\u1eedi b\u1ea3ng k\xea thanh to\xe1n ti\u1ec1n \u0111i\u1ec7n m\u1eb7t tr\u1eddi theo n\u1ed9i dung file k\xe8m theo ho\u1eb7c <a href="${a}">click t\u1ea1i \u0111\xe2y</a></p>\n            Tr\xe2n tr\u1ecdng.`}}convertFileToBase64(a){return new Promise((e,l)=>{const t=new FileReader;t.readAsDataURL(a),t.onload=()=>e(t.result),t.onerror=o=>l(o)})}exportTax(a,e,l=""){let t=new S.Workbook,o=t.addWorksheet("KeKhaiThue",{pageSetup:{paperSize:9,orientation:"landscape",scale:80}});o.properties.outlineLevelCol=2,o.properties.defaultRowHeight=15,o.pageSetup.printTitlesRow="11:12",o.pageSetup.margins={left:.5,right:.3,top:.3,bottom:.7,header:.3,footer:.3},o.headerFooter.oddFooter="&P / &N ",o.autoFilter="A13:K13";for(let N=1;N<12;N++)o.getColumn(N).style={font:{name:"Times New Roman"}};let n=o.getColumn(1),r=o.getColumn(2),i=o.getColumn(3),h=o.getColumn(4),g=o.getColumn(5),s=o.getColumn(6),u=o.getColumn(7),_=o.getColumn(8),c=o.getColumn(9),T=o.getColumn(10),R=o.getColumn(11);n.width=6,r.width=9,i.width=9,h.width=15,g.width=25,s.width=15,u.width=30,_.width=13,c.width=6,T.width=13,R.width=15,_.numFmt="#,##0",c.numFmt="#,##0",T.numFmt="#,##0";let H=o.getCell("J1");H.value="M\xe2\u0303u s\xf4\u0301: 01-2/GTGT",H.border={top:{style:"thin"},left:{style:"thin"},right:{style:"thin"}},H.alignment={vertical:"middle",horizontal:"center"};let x=o.getCell("J2");x.value="(Ban ha\u0300nh ke\u0300m theo th\xf4ng t\u01b0 s\xf4\u0301 119/2014/TT-BTC nga\u0300y 25/08/2014 cu\u0309a B\xf4\u0323 ta\u0300i chi\u0301nh)",x.alignment={vertical:"middle",horizontal:"center",wrapText:!0},x.border={bottom:{style:"thin"},left:{style:"thin"},right:{style:"thin"}},o.getRow(2).height=50,o.getCell("B4").value="B\u1ea2NG K\xca H\xd3A \u0110\u01a0N, CH\u1ee8NG T\u1eea H\xc0NG H\xd3A, D\u1ecaCH V\u1ee4 MUA V\xc0O (Ki\u1ec3m so\xe1t s\u1ed1 li\u1ec7u)",o.getCell("B5").value="K\xe8m theo t\u1edd k\xea khai thu\u1ebf GTGT theo m\u1eabu s\u1ed1 01/GTGT",o.getCell("B6").value="T\u1eeb ng\xe0y "+d()(e).startOf("month").format("DD/MM/YYYY")+" \u0111\u1ebfn ng\xe0y "+d()(e).endOf("month").format("DD/MM/YYYY"),o.getCell("B8").value="Ng\u01b0\u1eddi n\u1ed9p thu\u1ebf : "+this.setup.TenDonVi,o.getCell("B9").value="M\xe3 s\u1ed1 thu\u1ebf : "+this.setup.MaSoThue,o.getCell("B11").value="H\xf3a \u0111\u01a1n ch\u1ee9ng t\u1eeb b\xe1n",o.getCell("B12").value="K\xfd hi\u1ec7u h\xf3a \u0111\u01a1n",o.getCell("C12").value="S\u1ed1 h\xf3a \u0111\u01a1n",o.getCell("D12").value="Ng\xe0y, th\xe1ng, n\u0103m ph\xe1t h\xe0nh",o.getCell("A11").value="TT",o.getCell("E11").value="T\xean ng\u01b0\u1eddi b\xe1n",this.exceljs_writeRow(o,["T\xean ng\u01b0\u1eddi b\xe1n","M\xe3 s\u1ed1 thu\u1ebf ng\u01b0\u1eddi b\xe1n","M\u1eb7t h\xe0ng"," Doanh s\u1ed1 mua ch\u01b0a c\xf3 thu\u1ebf","Thu\u1ebf su\u1ea5t (%)","Thu\u1ebfGTGT","Ghi ch\xfa"],11,5);for(let N=1;N<12;N++)o.getCell(13,N).value="["+N+"]";let p=[];for(let N=0;N<a.length;N++){const v=a[N];let B=p.findIndex(Q=>Q.SoHoaDon==v.SoHoaDon&&Q.NgayHoaDon==v.NgayHoaDon&&Q.MaKhachHang==v.MaKhachHang);B>-1?(console.log("Dup",B),p[B].TruocThue+=v.TruocThue,p[B].Thue+=v.Thue):p.push(v)}console.log([],p);for(let N=0;N<p.length;N++){const v=p[N],B=[];B[1]=N+1,B[2]=v.KyHieuHoaDon,B[3]=v.SoHoaDon,B[4]=v.NgayHoaDon,B[5]=v.KhachHang,B[6]=v.MST,B[7]=v.MatHang,B[8]=v.TruocThue,B[9]=v.TiLeThue+"%",B[10]=v.Thue,B[11]=-1==v.TrangThaiHoSo?"Ch\u01b0a \u0111\u1ee7 \u0110K":"",o.addRow(B),o.getRow(N+14).height=70}const M=p.length+14;let E=this.plus.sumByKey(p,"TruocThue"),b=this.plus.sumByKey(p,"Thue");o.getCell(M,1).value="T\u1ed5ng c\u1ed9ng",o.getCell(M,8).value=E,o.getCell(M,10).value=b,o.getRow(M).height=30,o.getCell(M+2,1).value="T\u1ed5ng doanh thu d\u1ecbch v\u1ee5 h\xe0ng h\xf3a mua v\xe0o: ",o.getCell(M+3,1).value="T\u1ed5ng thu\u1ebf GTGT c\u1ee7a d\u1ecbch v\u1ee5 h\xe0ng h\xf3a mua v\xe0o:",o.getCell(M+2,9).value="Xu\xe2n L\u1ed9c, ng\xe0y "+d()().format("DD")+" th\xe1ng "+d()().format("MM")+" n\u0103m "+d()().format("YYYY"),o.getCell(M+3,9).value="GI\xc1M \u0110\u1ed0C",o.getCell(M+10,9).value=this.setup.GiamDoc,o.getCell(M+2,6).value=E,o.getCell(M+3,6).value=b,o.getCell(M+2,6).numFmt="#,##0",o.getCell(M+3,6).numFmt="#,##0",o.getCell(M+2,9).font={italic:!0,size:12,name:"Times New Roman"},this.exceljs_style(o,1,11,M,M,"font",{bold:!0}),this.exceljs_style(o,1,11,11,12,"font",{bold:!0,name:"Times New Roman"}),this.exceljs_style(o,1,11,4,9,"font",{bold:!0,name:"Times New Roman",size:14}),this.exceljs_style(o,1,11,11,M,"border",{bottom:{style:"thin"},left:{style:"thin"},right:{style:"thin"},top:{style:"thin"}}),this.exceljs_style(o,1,11,11,M,"alignment",{vertical:"middle",wrapText:!0}),this.exceljs_style(o,1,11,11,13,"alignment",{horizontal:"center",vertical:"middle",wrapText:!0}),this.exceljs_style(o,1,11,4,6,"alignment",{horizontal:"center",wrapText:!0}),this.exceljs_style(o,1,6,M+2,M+3,"font",{bold:!0}),this.exceljs_style(o,6,3,M+2,M+3,"numFmt","#,##0"),this.exceljs_style(o,8,11,M+3,M+10,"alignment",{horizontal:"center",vertical:"middle",wrapText:!1}),this.exceljs_style(o,8,11,M+3,M+10,"font",{bold:!0,size:14,name:"Times New Roman"}),n.alignment={vertical:"middle",horizontal:"center",wrapText:!0},c.alignment={vertical:"middle",horizontal:"center"},o.mergeCells("J1:K1"),o.mergeCells("J2:K2"),o.mergeCells("B4:K4"),o.mergeCells("B5:K5"),o.mergeCells("B6:K6"),o.mergeCells("B11:D11"),o.mergeCells("A11:A12"),o.mergeCells("K11:K12"),o.mergeCells("E11:E12"),o.mergeCells("F11:F12"),o.mergeCells("G11:G12"),o.mergeCells("H11:H12"),o.mergeCells("I11:I12"),o.mergeCells("J11:J12"),o.mergeCells(`A${M}:G${p.length+14}`),o.mergeCells(`A${M+2}:E${M+2}`),o.mergeCells(`A${M+3}:E${M+3}`),t.xlsx.writeBuffer().then(N=>{let v=new Blob([N],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});k().saveAs(v,`KeKhaiThue-${l}.xlsx`)})}exportTax2(a,e){let l=new S.Workbook,t=l.addWorksheet("KeKhaiThue",{pageSetup:{paperSize:9,orientation:"landscape",scale:80}});t.properties.outlineLevelCol=2,t.properties.defaultRowHeight=15,t.pageSetup.printTitlesRow="11:12",t.pageSetup.margins={left:.5,right:.3,top:.3,bottom:.7,header:.3,footer:.3},t.headerFooter.oddFooter="&P / &N ",t.autoFilter="A13:O13";for(let D=1;D<12;D++)t.getColumn(D).style={font:{name:"Times New Roman"}};let o=t.getColumn(1),n=t.getColumn(2),r=t.getColumn(3),i=t.getColumn(4),h=t.getColumn(5),g=t.getColumn(6),s=t.getColumn(7),u=t.getColumn(8),_=t.getColumn(9),c=t.getColumn(10),T=t.getColumn(11);o.width=6,n.width=9,r.width=9,i.width=15,h.width=25,g.width=15,s.width=30,u.width=13,_.width=6,c.width=13,T.width=15,u.numFmt="#,##0",_.numFmt="#,##0",c.numFmt="#,##0";let R=t.getCell("J1");R.value="M\xe2\u0303u s\xf4\u0301: 01-2/GTGT",R.border={top:{style:"thin"},left:{style:"thin"},right:{style:"thin"}},R.alignment={vertical:"middle",horizontal:"center"};let H=t.getCell("J2");H.value="(Ban ha\u0300nh ke\u0300m theo th\xf4ng t\u01b0 s\xf4\u0301 119/2014/TT-BTC nga\u0300y 25/08/2014 cu\u0309a B\xf4\u0323 ta\u0300i chi\u0301nh)",H.alignment={vertical:"middle",horizontal:"center",wrapText:!0},H.border={bottom:{style:"thin"},left:{style:"thin"},right:{style:"thin"}},t.getRow(2).height=50,t.getCell("B4").value="B\u1ea2NG K\xca H\xd3A \u0110\u01a0N, CH\u1ee8NG T\u1eea H\xc0NG H\xd3A, D\u1ecaCH V\u1ee4 MUA V\xc0O (Ki\u1ec3m so\xe1t s\u1ed1 li\u1ec7u)",t.getCell("B5").value="K\xe8m theo t\u1edd k\xea khai thu\u1ebf GTGT theo m\u1eabu s\u1ed1 01/GTGT",t.getCell("B6").value="T\u1eeb ng\xe0y "+d()(e).startOf("month").format("DD/MM/YYYY")+" \u0111\u1ebfn ng\xe0y "+d()(e).endOf("month").format("DD/MM/YYYY"),t.getCell("B8").value="Ng\u01b0\u1eddi n\u1ed9p thu\u1ebf : "+this.setup.TenDonVi,t.getCell("B9").value="M\xe3 s\u1ed1 thu\u1ebf : "+this.setup.MaSoThue,t.getCell("B11").value="H\xf3a \u0111\u01a1n ch\u1ee9ng t\u1eeb b\xe1n",t.getCell("B12").value="K\xfd hi\u1ec7u h\xf3a \u0111\u01a1n",t.getCell("C12").value="S\u1ed1 h\xf3a \u0111\u01a1n",t.getCell("D12").value="Ng\xe0y, th\xe1ng, n\u0103m ph\xe1t h\xe0nh",t.getCell("A11").value="TT",t.getCell("E11").value="T\xean ng\u01b0\u1eddi b\xe1n",this.exceljs_writeRow(t,["T\xean ng\u01b0\u1eddi b\xe1n","M\xe3 s\u1ed1 thu\u1ebf ng\u01b0\u1eddi b\xe1n","M\u1eb7t h\xe0ng"," Doanh s\u1ed1 mua ch\u01b0a c\xf3 thu\u1ebf","Thu\u1ebf su\u1ea5t (%)","Thu\u1ebfGTGT","Ghi ch\xfa"],11,5);for(let D=1;D<12;D++)t.getCell(13,D).value="["+D+"]";let P=[];for(let D=0;D<a.length;D++){const N=a[D];let v=P.findIndex(B=>B.SoHoaDon==N.SoHoaDon&&B.NgayHoaDon==N.NgayHoaDon&&B.MaKhachHang==N.MaKhachHang);v>-1?(console.log("Dup",v),P[v].TruocThue+=N.TruocThue,P[v].Thue+=N.Thue):P.push(N)}console.log([],P);for(let D=0;D<P.length;D++){const N=P[D],v=[];v[1]=D+1,v[2]=N.KyHieuHoaDon,v[3]=N.SoHoaDon,v[4]=N.NgayHoaDon,v[5]=N.KhachHang,v[6]=N.MST,v[7]=N.MatHang,v[8]=N.TruocThue,v[9]=N.TiLeThue+"%",v[10]=N.Thue,t.addRow(v),t.getRow(D+14).height=70}const p=P.length+14;let M=this.plus.sumByKey(P,"TruocThue"),E=this.plus.sumByKey(P,"Thue");t.getCell(p,1).value="T\u1ed5ng c\u1ed9ng",t.getCell(p,8).value=M,t.getCell(p,10).value=E,t.getRow(p).height=30,t.getCell(p+2,1).value="T\u1ed5ng doanh thu d\u1ecbch v\u1ee5 h\xe0ng h\xf3a mua v\xe0o: ",t.getCell(p+3,1).value="T\u1ed5ng thu\u1ebf GTGT c\u1ee7a d\u1ecbch v\u1ee5 h\xe0ng h\xf3a mua v\xe0o:",t.getCell(p+2,9).value="Xu\xe2n L\u1ed9c, ng\xe0y "+d()().format("DD")+" th\xe1ng "+d()().format("MM")+" n\u0103m "+d()().format("YYYY"),t.getCell(p+3,9).value="\u0110\u1ed8I TR\u01af\u1edeNG",t.getCell(p+10,9).value=this.setup.GiamDoc,t.getCell(p+2,6).value=M,t.getCell(p+3,6).value=E,t.getCell(p+2,6).numFmt="#,##0",t.getCell(p+3,6).numFmt="#,##0",t.getCell(p+2,9).font={italic:!0,size:12,name:"Times New Roman"},this.exceljs_style(t,1,11,p,p,"font",{bold:!0}),this.exceljs_style(t,1,11,11,12,"font",{bold:!0,name:"Times New Roman"}),this.exceljs_style(t,1,11,4,9,"font",{bold:!0,name:"Times New Roman",size:14}),this.exceljs_style(t,1,11,11,p,"border",{bottom:{style:"thin"},left:{style:"thin"},right:{style:"thin"},top:{style:"thin"}}),this.exceljs_style(t,1,11,11,p,"alignment",{vertical:"middle",wrapText:!0}),this.exceljs_style(t,1,11,11,13,"alignment",{horizontal:"center",vertical:"middle",wrapText:!0}),this.exceljs_style(t,1,11,4,6,"alignment",{horizontal:"center",wrapText:!0}),this.exceljs_style(t,1,6,p+2,p+3,"font",{bold:!0}),this.exceljs_style(t,6,3,p+2,p+3,"numFmt","#,##0"),this.exceljs_style(t,8,11,p+3,p+10,"alignment",{horizontal:"center",vertical:"middle",wrapText:!1}),this.exceljs_style(t,8,11,p+3,p+10,"font",{bold:!0,size:14,name:"Times New Roman"}),o.alignment={vertical:"middle",horizontal:"center",wrapText:!0},_.alignment={vertical:"middle",horizontal:"center"},t.mergeCells("J1:K1"),t.mergeCells("J2:K2"),t.mergeCells("B4:K4"),t.mergeCells("B5:K5"),t.mergeCells("B6:K6"),t.mergeCells("B11:D11"),t.mergeCells("A11:A12"),t.mergeCells("K11:K12"),t.mergeCells("E11:E12"),t.mergeCells("F11:F12"),t.mergeCells("G11:G12"),t.mergeCells("H11:H12"),t.mergeCells("I11:I12"),t.mergeCells("J11:J12"),t.mergeCells(`A${p}:G${P.length+14}`),t.mergeCells(`A${p+2}:E${p+2}`),t.mergeCells(`A${p+3}:E${p+3}`),l.xlsx.writeBuffer().then(D=>{let N=new Blob([D],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});k().saveAs(N,"KeKhaiThue.xlsx")})}export_BangKeTon(a,e){let l=new S.Workbook,t=l.addWorksheet("BangKeTon",{pageSetup:{paperSize:9,orientation:"landscape",scale:80}});t.properties.outlineLevelCol=2,t.pageSetup.printTitlesRow="6:6",t.pageSetup.margins={left:.5,right:.3,top:.3,bottom:.7,header:.3,footer:.3},t.headerFooter.oddFooter="&P / &N ",t.autoFilter="A6:K6";for(let E=1;E<13;E++)t.getColumn(E).style={font:{name:"Times New Roman",size:12}};let o=t.getColumn(1),n=t.getColumn(2),r=t.getColumn(3),i=t.getColumn(4),h=t.getColumn(5),g=t.getColumn(6),s=t.getColumn(7),u=t.getColumn(8),_=t.getColumn(9),c=t.getColumn(10),T=t.getColumn(11),R=t.getColumn(12);o.width=6,n.width=15,r.width=20,i.width=30,h.width=12,g.width=6,s.width=6,u.width=13,_.width=10,c.width=15,T.width=15,R.width=15,u.numFmt="#,##0",_.numFmt="#,##0",c.numFmt="#,##0",T.numFmt="#,##0",R.numFmt="#,##0",t.getCell("A1").value=this.setup.TenDonVi.toUpperCase(),t.getCell("A2").value=this.setup.PhongBan.toUpperCase(),t.getCell("A3").value="_________________",t.mergeCells("A1:C1"),t.mergeCells("A2:C2"),t.mergeCells("A3:C3"),this.exceljs_style(t,1,3,1,3,"alignment",this._center()),this.exceljs_style(t,1,1,2,2,"font",this._bold()),t.getCell("A5").value=e?`B\u1ea2NG T\u1ed4NG H\u1ee2P S\u1ea2N L\u01af\u1ee2NG \u0110I\u1ec6N GIAO NH\u1eacN V\xc0 CHI PH\xcd MUA \u0110I\u1ec6N M\u1eb6T TR\u1edcI M\xc1I NH\xc0 \u0110\u1ee6 \u0110I\u1ec0U KI\u1ec6N THANH TO\xc1N\nNH\u01afNG CH\u01afA L\u1eacP B\u1ea2NG K\xca G\u1eecI PH\xd2NG T\u1ed4NG H\u1ee2P\nTH\xc1NG ${a[0].Thang}/${a[0].Nam}`:`B\u1ea2NG T\u1ed4NG H\u1ee2P S\u1ea2N L\u01af\u1ee2NG \u0110I\u1ec6N GIAO NH\u1eacN V\xc0 CHI PH\xcd MUA \u0110I\u1ec6N M\u1eb6T TR\u1edcI M\xc1I NH\xc0 CH\u01afA \u0110\u1ee6 \u0110I\u1ec0U KI\u1ec6N THANH TO\xc1N\nTH\xc1NG ${a[0].Thang}/${a[0].Nam}`,this.exceljs_style(t,1,12,5,5,"alignment",this._center(!0)),this.exceljs_style(t,1,12,5,6,"font",this._bold()),t.mergeCells("A5:L5"),t.getRow(5).height=60,this.exceljs_writeRow(t,["TT","M\xe3 kh\xe1ch h\xe0ng","T\xean kh\xe1ch h\xe0ng","\u0110\u1ecba ch\u1ec9","M\xe3 GCS","N\u0103m","Th\xe1ng","\u0110i\u1ec7n n\u0103ng ph\xe1t l\xean l\u01b0\u1edbi","\u0110\u01a1n gi\xe1 (VN\u0110/kwh)","Th\xe0nh ti\u1ec1n (ch\u01b0a thu\u1ebf GTGT)","Thu\u1ebf GTGT (10%)","T\u1ed5ng ti\u1ec1n"],6,1);for(let E=0;E<a.length;E++){const b=a[E],D=[];D[1]=E+1,D[2]=b.MaKhachHang,D[3]=b.KhachHang,D[4]=b.DiaChi,D[5]=b.MaGCS,D[6]=b.Nam,D[7]=b.Thang,D[8]=b.SanLuong,D[9]=b.DonGia,D[10]=b.TruocThue,D[11]=b.Thue,D[12]=b.TongTien,t.addRow(D)}const x=a.length+6;let z=this.plus.sumByKey(a,"SanLuong"),P=this.plus.sumByKey(a,"TruocThue"),p=this.plus.sumByKey(a,"Thue"),M=this.plus.sumByKey(a,"TongTien");t.getCell(x+1,1).value="T\u1ed4NG C\u1ed8NG",t.getRow(x+1).height=40,t.getCell(x+1,8).value=z,t.getCell(x+1,10).value=P,t.getCell(x+1,11).value=p,t.getCell(x+1,12).value=M,this.exceljs_style(t,1,12,6,x+1,"border",this._border()),this.exceljs_style(t,1,12,6,6,"border",this._border()),this.exceljs_style(t,1,12,6,x+1,"alignment",this._center(!0)),this.exceljs_style(t,1,12,x+1,x+1,"font",this._bold()),this.exceljs_style(t,8,12,6,x+1,"alignment",this._center(!0,"right")),t.getCell(x+2,11).value="Xu\xe2n L\u1ed9c, ng\xe0y "+d()().format("DD")+" th\xe1ng "+d()().format("MM")+" n\u0103m "+d()().format("YYYY"),t.getCell(x+2,11).font={italic:!0,size:12,name:"Times New Roman"},t.getCell(x+3,3).value="NG\u01af\u1edcI L\u1eacP",t.getCell(x+3,7).value="TT. T\u1ed4 KINH DOANH",t.getCell(x+3,11).value="\u0110\u1ed8I TR\u01af\u1edeNG",t.getCell(x+11,3).value=this.user.fullName,t.getCell(x+11,7).value=this.setup.TruongPhong,t.getCell(x+11,11).value=this.setup.GiamDoc,this.exceljs_style(t,1,12,x+2,x+11,"alignment",this._center()),this.exceljs_style(t,1,12,x+3,x+11,"font",this._bold(14)),t.mergeCells(`A${x+1}:G${x+1}`),l.xlsx.writeBuffer().then(E=>{let b=new Blob([E],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});k().saveAs(b,`BangKeTon ${e?"DuDK":"KhongDuDK"} ${a[0].Thang}-${a[0].Nam}.xlsx`)})}export_BangKeChiPhi(a){var e=this;return(0,A.Z)(function*(){let l=e.workbook.addWorksheet("BangKeTT",{pageSetup:{paperSize:9,orientation:"landscape",scale:70}});l.pageSetup.printTitlesRow="6:7",l.pageSetup.margins={left:.2,right:.2,top:.4,bottom:.7,header:.3,footer:.3},l.headerFooter.oddFooter="&P / &N ",l.autoFilter="A7:O7";const t={width:[5,10,18,25,6,15,15,23,6,6,10,8,14,12,14],format:["","","","","","","","","","","#,##0","#,##0","#,##0","#,##0","#,##0"],alignment:["center","center","left","left","center","left","center","left","right","right","right","right","right","right","right"]};for(let s=0;s<t.width.length;s++){let u=l.getColumn(s+1);u.style={font:{name:"Times New Roman",size:12}},u.numFmt=t.format[s],u.width=t.width[s]}l.getCell("A1").value="C\xd4NG TY \u0110I\u1ec6N L\u1ef0C \u0110\u1ed2NG NAI",l.getCell("A2").value=e.setup.TenDonVi.toUpperCase(),l.getCell("A3").value="_________________",l.getCell("A4").value="S\u1ed1:      /DMT",l.mergeCells("A1:C1"),l.mergeCells("A2:C2"),l.mergeCells("A3:C3"),l.mergeCells("A4:C4"),l.getRow(1).height=40,e.exceljs_style(l,1,3,1,4,"alignment",e._center(!0)),e.exceljs_style(l,1,1,2,2,"font",e._bold(13)),l.getCell("A5").value="B\u1ea2NG K\xca THANH TO\xc1N TI\u1ec0N \u0110I\u1ec6N M\u1eb6T TR\u1edcI TR\xcaN M\xc1I NH\xc0",l.mergeCells("A5:O5"),l.getRow(5).height=40,e.exceljs_writeRow(l,["TT","M\xe3 kh\xe1ch h\xe0ng","T\xean kh\xe1ch h\xe0ng","\u0110\u1ecba ch\u1ec9","M\xe3 GCS","Ng\u01b0\u1eddi Th\u1ee5 H\u01b0\u1edfng","","","N\u0103m","Th\xe1ng","\u0110i\u1ec7n n\u0103ng ph\xe1t l\xean l\u01b0\u1edbi","\u0110\u01a1n gi\xe1 VN\u0110/kwh","Th\xe0nh ti\u1ec1n (ch\u01b0a thu\u1ebf GTGT)","Thu\u1ebf GTGT","T\u1ed5ng ti\u1ec1n"],6,1),l.getCell(7,6).value="T\xean TK",l.getCell(7,7).value="S\u1ed1 TK",l.getCell(7,8).value="Ng\xe2n h\xe0ng",l.mergeCells("F6:H6"),l.mergeCells("A6:A7"),l.mergeCells("B6:B7"),l.mergeCells("C6:C7"),l.mergeCells("D6:D7"),l.mergeCells("E6:E7"),l.mergeCells("I6:I7"),l.mergeCells("J6:J7"),l.mergeCells("K6:K7"),l.mergeCells("L6:L7"),l.mergeCells("M6:M7"),l.mergeCells("N6:N7"),l.mergeCells("O6:O7"),e.exceljs_style(l,1,15,5,7,"alignment",e._center(!0)),e.exceljs_style(l,1,15,5,7,"font",e._bold());for(let s=0;s<a.length;s++){const u=a[s],_=[];_[1]=s+1,_[2]=u.MaKhachHang,_[3]=u.KhachHang,_[4]=u.DiaChi,_[5]=u.MaGCS,_[6]=u.ChuTaiKhoan,_[7]=u.SoTaiKhoan,_[8]=u.NganHang,_[9]=u.Nam,_[10]=u.Thang,_[11]=u.SanLuong,_[12]=u.DonGia,_[13]=u.TruocThue,_[14]=u.Thue,_[15]=u.TongTien,l.addRow(_)}const n=a.length+7;let r=e.plus.sumByKey(a,"SanLuong"),i=e.plus.sumByKey(a,"TruocThue"),h=e.plus.sumByKey(a,"Thue"),g=e.plus.sumByKey(a,"TongTien");l.getCell(n+1,1).value="T\u1ed4NG C\u1ed8NG",l.getRow(n+1).height=40,l.getCell(n+1,11).value=r,l.getCell(n+1,13).value=i,l.getCell(n+1,14).value=h,l.getCell(n+1,15).value=g,l.mergeCells(`A${n+1}:J${n+1}`),e.exceljs_style(l,1,15,6,n+1,"border",e._border()),e.exceljs_style(l,1,15,6,6,"border",e._border()),e.exceljs_style(l,1,15,6,n+1,"alignment",e._center(!0)),e.exceljs_style(l,1,15,n+1,n+1,"font",e._bold()),e.exceljs_style(l,11,15,10,n+1,"alignment",e._center(!0,"right")),e.workbook.xlsx.writeBuffer().then(s=>{let u=new Blob([s],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});k().saveAs(u,`BangKeChiPhi-${d()().format("DD-MM-YYYY")}.xlsx`)}),e.workbook=new S.Workbook})()}export_ThanhToanKD(a){var e=this;return(0,A.Z)(function*(){let l=e.workbook.addWorksheet("BangKeTT",{pageSetup:{paperSize:9,orientation:"landscape",scale:70}});l.pageSetup.printTitlesRow="6:7",l.pageSetup.margins={left:.2,right:.2,top:.4,bottom:.7,header:.3,footer:.3},l.headerFooter.oddFooter="&P / &N ",l.autoFilter="A7:O7";const t={width:[5,10,18,25,6,15,15,23,6,6,10,8,14,12,14],format:["","","","","","","","","","","#,##0","#,##0","#,##0","#,##0","#,##0"],alignment:["center","center","left","left","center","left","center","left","right","right","right","right","right","right","right"]};for(let r=0;r<t.width.length;r++){let i=l.getColumn(r+1);i.style={font:{name:"Times New Roman",size:12}},i.numFmt=t.format[r],i.width=t.width[r]}l.getCell("A1").value="C\xd4NG TY \u0110I\u1ec6N L\u1ef0C \u0110\u1ed2NG NAI",l.getCell("A2").value=e.setup.TenDonVi.toUpperCase(),l.getCell("A3").value="_________________",l.getCell("A4").value=`S\u1ed1: ${a.TenBangKe}/DMT-KD`,l.mergeCells("A1:C1"),l.mergeCells("A2:C2"),l.mergeCells("A3:C3"),l.mergeCells("A4:C4"),l.getRow(1).height=40,e.exceljs_style(l,1,3,1,4,"alignment",e._center(!0)),e.exceljs_style(l,1,1,2,2,"font",e._bold(13)),l.getCell("A5").value="B\u1ea2NG K\xca THANH TO\xc1N TI\u1ec0N \u0110I\u1ec6N M\u1eb6T TR\u1edcI TR\xcaN M\xc1I NH\xc0",l.mergeCells("A5:O5"),l.getRow(5).height=40,e.exceljs_writeRow(l,["TT","M\xe3 kh\xe1ch h\xe0ng","T\xean kh\xe1ch h\xe0ng","\u0110\u1ecba ch\u1ec9","M\xe3 GCS","Ng\u01b0\u1eddi Th\u1ee5 H\u01b0\u1edfng","","","N\u0103m","Th\xe1ng","\u0110i\u1ec7n n\u0103ng ph\xe1t l\xean l\u01b0\u1edbi","\u0110\u01a1n gi\xe1 VN\u0110/kwh","Th\xe0nh ti\u1ec1n (ch\u01b0a thu\u1ebf GTGT)","Thu\u1ebf GTGT","T\u1ed5ng ti\u1ec1n"],6,1),l.getCell(7,6).value="T\xean TK",l.getCell(7,7).value="S\u1ed1 TK",l.getCell(7,8).value="Ng\xe2n h\xe0ng",l.mergeCells("F6:H6"),l.mergeCells("A6:A7"),l.mergeCells("B6:B7"),l.mergeCells("C6:C7"),l.mergeCells("D6:D7"),l.mergeCells("E6:E7"),l.mergeCells("I6:I7"),l.mergeCells("J6:J7"),l.mergeCells("K6:K7"),l.mergeCells("L6:L7"),l.mergeCells("M6:M7"),l.mergeCells("N6:N7"),l.mergeCells("O6:O7"),e.exceljs_style(l,1,15,5,7,"alignment",e._center(!0)),e.exceljs_style(l,1,15,5,7,"font",e._bold());for(let r=0;r<a.DanhSach.length;r++){const i=a.DanhSach[r],h=[];h[1]=r+1,h[2]=i.MaKhachHang,h[3]=i.KhachHang,h[4]=i.DiaChi,h[5]=i.MaGCS,h[6]=i.ChuTaiKhoan,h[7]=i.SoTaiKhoan,h[8]=i.NganHang,h[9]=i.Nam,h[10]=i.Thang,h[11]=i.SanLuong,h[12]=i.DonGia,h[13]=i.TruocThue,h[14]=i.Thue,h[15]=i.TongTien,l.addRow(h)}const n=a.DanhSach.length+7;l.getCell(n+1,1).value="T\u1ed4NG C\u1ed8NG",l.getRow(n+1).height=40,l.getCell(n+1,11).value=a.TongPhatLen,l.getCell(n+1,13).value=a.ThanhTienTruocThue,l.getCell(n+1,14).value=a.Thue,l.getCell(n+1,15).value=a.ThanhTienSauThue,l.mergeCells(`A${n+1}:J${n+1}`),e.exceljs_style(l,1,15,6,n+1,"border",e._border()),e.exceljs_style(l,1,15,6,6,"border",e._border()),e.exceljs_style(l,1,15,6,n+1,"alignment",e._center(!0)),e.exceljs_style(l,1,15,n+1,n+1,"font",e._bold()),e.exceljs_style(l,11,15,10,n+1,"alignment",e._center(!0,"right")),l.getCell(n+2,14).value="Xu\xe2n L\u1ed9c, ng\xe0y "+d()().format("DD")+" th\xe1ng "+d()().format("MM")+" n\u0103m "+d()().format("YYYY"),l.getCell(n+2,14).font={italic:!0,size:13,name:"Times New Roman"},l.getRow(n+2).height=30,l.getCell(n+3,3).value="NG\u01af\u1edcI L\u1eacP",l.getCell(n+3,9).value="TT. T\u1ed4 KINH DOANH",l.getCell(n+3,14).value="\u0110\u1ed8I TR\u01af\u1edeNG",l.getCell(n+10,3).value=e.user.fullName||"",l.getCell(n+10,9).value=e.setup.TruongPhong,l.getCell(n+10,14).value=e.setup.GiamDoc,e.exceljs_style(l,1,15,n+2,n+10,"alignment",e._center()),e.exceljs_style(l,1,15,n+3,n+10,"font",e._bold(13)),e.export_BangKeMuaHang(a),yield e.xuatBangKeChiSo(e.db,a.DanhSach).then(r=>{e.workbook.xlsx.writeBuffer().then(i=>{let h=new Blob([i],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});k().saveAs(h,`BangKeThanhToan-PKD-${a.DanhSach[0].Thang}-${a.DanhSach[0].Nam}-${localStorage.nameBill}.xlsx`)})}),e.workbook=new S.Workbook})()}export_ThanhToanPTC(a,e=!0){return new Promise((l,t)=>{let o=new S.Workbook,n=o.addWorksheet("BangKeTT",{pageSetup:{paperSize:9,orientation:"landscape",scale:70}});n.pageSetup.printTitlesRow="6:7",n.pageSetup.margins={left:.2,right:.2,top:.4,bottom:.7,header:.3,footer:.3},n.headerFooter.oddFooter="&P / &N ",n.autoFilter="A7:O7",n.views=[{activeCell:"A1",zoomScale:85}];const r={width:[5,10,20,25,6,15,15,23,6,6,10,8,14,12,14],format:["","","#,##0","","","","","","","","#,##0","#,##0","#,##0","#,##0","#,##0"],alignment:["center","center","left","left","center","left","center","left","right","right","right","right","right","right","right"]};for(let c=0;c<r.width.length;c++){let T=n.getColumn(c+1);T.style={font:{name:"Times New Roman",size:12}},T.numFmt=r.format[c],T.width=r.width[c]}n.getCell("A1").value="C\xd4NG TY \u0110I\u1ec6N L\u1ef0C \u0110\u1ed2NG NAI\n"+this.setup.TenDonVi.toUpperCase(),n.getCell("A2").value="_________________",n.getCell("A3").value=`S\u1ed1: ${a.TenBangKe}/DMT-TH`,n.getCell("A4").value="",n.mergeCells("A1:D1"),n.mergeCells("A2:D2"),n.mergeCells("A3:D3"),n.getRow(1).height=60,this.exceljs_style(n,1,3,1,3,"alignment",this._center(!0)),this.exceljs_style(n,1,1,2,2,"font",this._bold(13)),n.getCell("A4").value="B\u1ea2NG K\xca THANH TO\xc1N TI\u1ec0N \u0110I\u1ec6N M\u1eb6T TR\u1edcI TR\xcaN M\xc1I NH\xc0",n.mergeCells("A4:O4"),n.getRow(4).height=40,this.exceljs_style(n,1,15,4,4,"alignment",this._center(!0)),this.exceljs_style(n,1,15,4,4,"font",this._bold());let i=this.setup.TaiKhoan.filter(c=>1==c.TrangThai);n.getCell("A5").value=`S\u1ed1 t\xe0i kho\u1ea3n \u0111\u01a1n v\u1ecb: ${i[0].SoTaiKhoan} (Ph\xed trong)`,this.exceljs_writeRow(n,["TT","M\xe3 kh\xe1ch h\xe0ng","T\xean kh\xe1ch h\xe0ng","\u0110\u1ecba ch\u1ec9","M\xe3 GCS","Ng\u01b0\u1eddi Th\u1ee5 H\u01b0\u1edfng","","","N\u0103m","Th\xe1ng","\u0110i\u1ec7n n\u0103ng ph\xe1t l\xean l\u01b0\u1edbi","\u0110\u01a1n gi\xe1 VN\u0110/kwh","Th\xe0nh ti\u1ec1n (ch\u01b0a thu\u1ebf GTGT)","Thu\u1ebf GTGT","T\u1ed5ng ti\u1ec1n"],6,1),n.getCell(7,6).value="T\xean TK",n.getCell(7,7).value="S\u1ed1 TK",n.getCell(7,8).value="Ng\xe2n h\xe0ng",n.mergeCells("F6:H6"),n.mergeCells("A6:A7"),n.mergeCells("B6:B7"),n.mergeCells("C6:C7"),n.mergeCells("D6:D7"),n.mergeCells("E6:E7"),n.mergeCells("I6:I7"),n.mergeCells("J6:J7"),n.mergeCells("K6:K7"),n.mergeCells("L6:L7"),n.mergeCells("M6:M7"),n.mergeCells("N6:N7"),n.mergeCells("O6:O7"),this.exceljs_style(n,1,15,6,7,"alignment",this._center(!0)),this.exceljs_style(n,1,15,6,7,"font",this._bold());let g={};for(let c=0;c<a.DanhSach.length;c++){const T=a.DanhSach[c];let R=`${T.Thang}/${T.Nam}`;g[R]>0?g[R]+=T.TruocThue:g[R]=T.TruocThue;const H=[];H[1]=c+1,H[2]=T.MaKhachHang,H[3]=T.KhachHang,H[4]=T.DiaChi,H[5]=T.MaGCS,H[6]=T.ChuTaiKhoan,H[7]=T.SoTaiKhoan,H[8]=T.NganHang,H[9]=T.Nam,H[10]=T.Thang,H[11]=T.SanLuong,H[12]=T.DonGia,H[13]=T.TruocThue,H[14]=T.Thue,H[15]=T.TongTien,n.addRow(H)}const s=a.DanhSach.length+7;n.getCell(s+1,1).value="T\u1ed4NG C\u1ed8NG",n.getRow(s+1).height=40,n.getCell(s+1,11).value=a.TongPhatLen,n.getCell(s+1,13).value=a.ThanhTienTruocThue,n.getCell(s+1,14).value=a.Thue,n.getCell(s+1,15).value=a.ThanhTienSauThue,n.mergeCells(`A${s+1}:J${s+1}`),this.exceljs_style(n,1,15,6,s+1,"border",this._border()),this.exceljs_style(n,1,15,6,6,"border",this._border()),this.exceljs_style(n,1,15,6,s+1,"alignment",this._center(!0)),this.exceljs_style(n,1,15,s+1,s+1,"font",this._bold()),this.exceljs_style(n,11,15,10,s+1,"alignment",this._center(!0,"right")),n.getCell(s+2,14).value="Xu\xe2n L\u1ed9c, ng\xe0y "+d()().format("DD")+" th\xe1ng "+d()().format("MM")+" n\u0103m "+d()().format("YYYY"),n.getCell(s+2,14).font={italic:!0,size:13,name:"Times New Roman"},n.getRow(s+2).height=30,n.getCell(s+3,3).value="NG\u01af\u1edcI L\u1eacP",n.getCell(s+3,7).value="TT T\u1ed4 T\u1ed4NG H\u1ee2P PH\u1ee4 TR\xc1CH TCKT",n.getCell(s+3,14).value="\u0110\u1ed8I TR\u01af\u1edeNG",n.getCell(s+10,3).value=this.user.fullName||"",n.getCell(s+10,7).value=this.setup.TruongPhong,n.getCell(s+10,14).value=this.setup.GiamDoc,this.exceljs_style(n,1,15,s+2,s+25,"alignment",this._center()),this.exceljs_style(n,1,15,s+3,s+25,"font",this._bold(13)),n.getCell(s+13,7).value=`X\xc1C NH\u1eacN C\u1ee6A NG\xc2N H\xc0NG \u0110\xc3 HO\xc0N T\u1ea4T CHUY\u1ec2N TI\u1ec0N NG\xc0Y       /${d()().format("MM/YYYY")}`;let u=0;for(const[c,T]of Object.entries(g))u++,n.getCell(s+13+u,2).value=`${c}`,n.getCell(s+13+u,3).value=+T;let _=`BangKe-PTC-${a.TenBangKe}.xlsx`;o.xlsx.writeBuffer().then(c=>{let T=new Blob([c],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});e&&k().saveAs(T,_);const R=new File([T],_);this.storageSV.uploadFile(R,`BangKe/${this.user._id}`,this.user._id),l(R)})})}export_BangKeMuaHang(a){let e=this.workbook.addWorksheet("BangKeMuaHang",{pageSetup:{paperSize:9,orientation:"landscape",scale:85}});e.pageSetup.printTitlesRow="11:12",e.pageSetup.margins={left:.3,right:.3,top:.4,bottom:.7,header:.3,footer:.3},e.headerFooter.oddFooter="&P / &N ",e.autoFilter="A12:I12";const l={width:[12,15,25,35,19,10,8,9,15],format:["","","","","","#,##0","#,##0","#,##0","#,##0"],alignment:["","","","right","right","right","right","right"]};for(let n=0;n<l.width.length;n++){let r=e.getColumn(n+1);r.style={font:{name:"Times New Roman",size:12}},r.numFmt=l.format[n],r.width=l.width[n]}e.getCell("A1").value="M\u1eabu s\u1ed1: 01/TNDN\n(Ban h\xe0nh k\xe8m theo Th\xf4ng t\u01b0 s\u1ed1 78/2014/TT-BCT c\u1ee7a B\u1ed9 T\xe0i ch\xednh)",this.exceljs_style(e,1,1,1,2,"alignment",this._center(!0)),e.mergeCells("A1:B2"),e.getRow(1).height=40,e.getRow(2).height=40,e.getCell("A3").value="B\u1ea2NG K\xca MUA H\xc0NG H\xd3A, D\u1ecaCH V\u1ee4 MUA V\xc0O KH\xd4NG C\xd3 H\xd3A \u0110\u01a0N",e.getCell("A4").value="Ng\xe0y "+d()().format("DD")+" th\xe1ng "+d()().format("MM")+" n\u0103m "+d()().format("YYYY"),e.mergeCells("A3:I3"),e.mergeCells("A4:I4"),this.exceljs_style(e,1,3,1,4,"alignment",this._center(!0)),this.exceljs_style(e,1,9,3,4,"font",this._bold(13)),e.getCell("B6").value="T\xean Doanh nghi\u1ec7p: "+this.setup.TenDonVi,e.getCell("B7").value="\u0110\u1ecba ch\u1ec9: "+this.setup.DiaChi,e.getCell("B8").value="\u0110\u1ecba ch\u1ec9 n\u01a1i t\u1ed5 ch\u1ee9c thu mua: "+this.setup.DiaChi,e.getCell("B9").value="Ng\u01b0\u1eddi ph\u1ee5 tr\xe1ch thu mua: "+this.setup.NguoiKiemTra,e.mergeCells("B6:E6"),e.mergeCells("B7:E7"),e.mergeCells("B8:E8"),e.mergeCells("B9:E9"),e.getCell("F6").value="M\xe3 s\u1ed1 thu\u1ebf: "+this.setup.MaSoThue,this.exceljs_style(e,1,9,11,12,"alignment",this._center(!0)),this.exceljs_style(e,1,9,11,12,"font",this._bold(13)),e.getCell("B11").value="Ng\u01b0\u1eddi b\xe1n",e.getCell("F11").value="H\xe0ng h\xf3a mua v\xe0o",e.mergeCells("B11:E11"),e.mergeCells("F11:I11"),e.mergeCells("A11:A12"),this.exceljs_writeRow(e,["","M\xe3 KH","T\xean ng\u01b0\u1eddi b\xe1n","\u0110\u1ecba ch\u1ec9","S\u1ed1 CMND/CCCD","T\xean m\u1eb7t h\xe0ng","S\u1ed1 l\u01b0\u1ee3ng (kWh)","\u0110\u01a1n gi\xe1 (\u0111/kWh)","T\u1ed5ng gi\xe1 thanh to\xe1n (\u0111\u1ed3ng)"],12,1),e.getCell(11,1).value="Ng\xe0y th\xe1ng n\u0103m mua h\xe0ng";for(let n=0;n<a.DanhSach.length;n++){const r=a.DanhSach[n],i=[];i[1]=r.NgayMuaHang,i[2]=r.MaKhachHang,i[3]=r.KhachHang,i[4]=r.DiaChi,i[5]=r.CCCD,i[6]="\u0110MTMN",i[7]=r.SanLuong,i[8]=r.DonGia,i[9]=r.TongTien,e.addRow(i)}const o=a.DanhSach.length+12;e.getCell(o+1,1).value="T\u1ed4NG C\u1ed8NG",e.getRow(o+1).height=40,e.getCell(o+1,7).value=a.TongPhatLen,e.getCell(o+1,9).value=a.ThanhTienSauThue,e.mergeCells(`A${o+1}:F${o+1}`),this.exceljs_style(e,1,11,o+1,o+1,"font",this._bold()),this.exceljs_style(e,1,9,11,o+1,"border",this._border()),this.exceljs_style(e,1,9,12,o+1,"alignment",this._center(!0)),this.exceljs_style(e,7,9,13,o+1,"alignment",this._center(!0,"right")),e.getCell(o+2,8).value="Xu\xe2n L\u1ed9c, ng\xe0y "+d()().format("DD")+" th\xe1ng "+d()().format("MM")+" n\u0103m "+d()().format("YYYY"),e.getCell(o+2,8).font={italic:!0,size:13,name:"Times New Roman"},e.getRow(o+2).height=30,e.mergeCells(`C${o+3}:D${o+3}`),e.mergeCells(`C${o+10}:D${o+10}`),e.getCell(o+3,2).value="NG\u01af\u1edcI L\u1eacP",e.getCell(o+3,5).value="TT. T\u1ed4 KINH DOANH",e.getCell(o+3,8).value="\u0110\u1ed8I TR\u01af\u1edeNG",e.getCell(o+10,2).value=this.user.fullName||"",e.getCell(o+10,5).value=this.setup.TruongPhong||"",e.getCell(o+10,8).value=this.setup.GiamDoc||"",this.exceljs_style(e,1,11,o+2,o+10,"alignment",this._center()),this.exceljs_style(e,1,11,o+3,o+10,"font",this._bold(13))}export_ChiSo3Bieu(a){let e=this.workbook.addWorksheet("ChiSo3B",{pageSetup:{paperSize:9,orientation:"landscape",scale:88}});e.pageSetup.printTitlesRow="6:7",e.pageSetup.margins={left:.3,right:.3,top:.4,bottom:.7,header:.3,footer:.3},e.headerFooter.oddFooter='&P / &N &"Times New Roman"';const l={width:[5,15,26,10,10,10,10,10,10,10,10,10,10],alignment:["center","left","left","left","center","right","right","right","right","right","right","right"]};for(let _=0;_<l.width.length;_++){let c=e.getColumn(_+1);c.style={font:{name:"Times New Roman",size:12}},c.width=l.width[_]}e.getCell("A1").value="C\xd4NG TY \u0110I\u1ec6N L\u1ef0C \u0110\u1ed2NG NAI",e.getCell("A2").value=this.setup.TenDonVi.toUpperCase(),e.getCell("A3").value="________________________",e.getCell("A4").font={vertAlign:"superscript"},e.mergeCells("A1:D1"),e.mergeCells("A2:D2"),e.mergeCells("A3:D3"),e.mergeCells("A4:D4"),e.getCell("I1").value="C\u1ed8NG H\xd2A X\xc3 H\u1ed8I CH\u1ee6 NGH\u0128A VI\u1ec6T NAM",e.getCell("I2").value="\u0110\u1ed9c l\u1eadp - T\u1ef1 do - H\u1ea1nh ph\xfac",e.getCell("I3").value="___________________________",e.getCell("I3").font={vertAlign:"superscript"},this.exceljs_style(e,1,3,1,4,"alignment",this._center(!0)),this.exceljs_style(e,1,1,3,3,"font",this._bold(13)),this.exceljs_style(e,9,9,1,2,"font",this._bold(13)),this.exceljs_style(e,9,9,1,3,"alignment",this._center()),e.getCell("A5").value="B\u1ea2NG K\xca KI\u1ec2M SO\xc1T CH\u1ec8 S\u1ed0 KH\xc1CH H\xc0NG L\u1eaeP \u0110I\u1ec6N M\u1eb6T TR\u1edcI TR\xcaN M\xc1I NH\xc0",e.getCell("A5").style={font:{name:"Times New Roman",size:14}},e.mergeCells("A5:O5"),e.getRow(5).height=40,this.exceljs_writeRow(e,["TT","M\xe3 kh\xe1ch h\xe0ng","T\xean kh\xe1ch h\xe0ng","S\u1ed1 c\xf4ng t\u01a1","HSN","K\u1ef3-Th\xe1ng/N\u0103m","Ch\u1ec9 s\u1ed1 c\u0169","","","Ch\u1ec9 s\u1ed1 m\u1edbi","","","T\u1ed5ng S\u1ea3n l\u01b0\u1ee3ng"],6,1),e.getCell("G7").value="BN",e.getCell("H7").value="CN",e.getCell("I7").value="TN",e.getCell("J7").value="BN",e.getCell("K7").value="CN",e.getCell("L7").value="TN",e.mergeCells("G6:I6"),e.mergeCells("J6:L6"),e.mergeCells("A6:A7"),e.mergeCells("B6:B7"),e.mergeCells("C6:C7"),e.mergeCells("D6:D7"),e.mergeCells("E6:E7"),e.mergeCells("F6:F7"),e.mergeCells("M6:M7"),this.exceljs_style(e,1,13,5,7,"alignment",this._center(!0)),this.exceljs_style(e,1,13,5,7,"font",this._bold());let o=0,n=0,r=0,i=0,h=0,g=0,s=0;for(let _=0;_<a.length;_++){const c=a[_],T=[];T[1]=_+1,T[2]=c.MA_KHANG,T[3]=c.TEN_KHANG,T[4]=c.SO_CTO,T[5]=c.HS_NHAN,T[6]=c.KY+"-"+c.THANG+"/"+c.NAM,T[7]=c.BN_CU,T[8]=c.CN_CU,T[9]=c.TN_CU,T[10]=c.BN_MOI,T[11]=c.CN_MOI,T[12]=c.TN_MOI,T[13]=c.SAN_LUONG,e.addRow(T),o+=c.BN_CU||0,n+=c.CN_CU||0,r+=c.TN_CU||0,i+=c.BN_MOI||0,h+=c.CN_MOI||0,g+=c.TN_MOI||0,s+=c.SAN_LUONG||0,e.getRow(8+_).height=40}const u=a.length+7;e.getCell(u+1,1).value="T\u1ed4NG C\u1ed8NG",e.getRow(u+1).height=40,e.getRow(u+1).font=this._bold(),e.mergeCells(`A${u+1}:L${u+1}`),e.getCell(`M${u+1}`).value=s,this.exceljs_style(e,1,6,8,u,"alignment",this._center(!0,"center")),this.exceljs_style(e,3,3,8,u,"alignment",this._center(!0,"left")),this.exceljs_style(e,7,13,8,u+1,"alignment",this._center(!0,"right")),this.exceljs_style(e,7,12,8,u,"numFmt","#,##0.0"),this.exceljs_style(e,13,13,8,u+1,"numFmt","#,##0"),this.exceljs_style(e,1,13,6,u+1,"border",this._border()),this.exceljs_style(e,1,1,u+1,u+1,"alignment",this._center()),e.getCell(u+2,10).value="Xu\xe2n L\u1ed9c, ng\xe0y "+d()().format("DD")+" th\xe1ng "+d()().format("MM")+" n\u0103m "+d()().format("YYYY"),e.getCell(u+2,10).font={italic:!0,size:13,name:"Times New Roman"},e.getRow(u+2).height=30,e.getCell(u+3,3).value="NG\u01af\u1edcI L\u1eacP",e.getCell(u+3,10).value="TP. KINH DOANH",e.getCell(u+10,3).value=this.user.fullName||"",e.getCell(u+10,10).value=this.setup.TruongPhong,this.exceljs_style(e,1,15,u+2,u+10,"alignment",this._center()),this.exceljs_style(e,1,15,u+3,u+10,"font",this._bold(13)),e.pageSetup.printArea=`A1:M${u+10}`}export_ChiSo1Bieu(a){let e=this.workbook.addWorksheet("ChiSo1B",{pageSetup:{paperSize:9,orientation:"landscape",scale:100}});e.pageSetup.printTitlesRow="6:7",e.pageSetup.margins={left:.4,right:.3,top:.4,bottom:.7,header:.3,footer:.3},e.headerFooter.oddFooter="&P / &N",e.autoFilter="A7:I7";const l={width:[8,20,33,12,10,12,12,10,10,10,10,10,10],alignment:["center","left","left","left","center","right","right","right","right","right","right","right"]};for(let h=0;h<l.width.length;h++){let g=e.getColumn(h+1);g.style={font:{name:"Times New Roman",size:12}},g.width=l.width[h]}e.getCell("A1").value="C\xd4NG TY \u0110I\u1ec6N L\u1ef0C \u0110\u1ed2NG NAI",e.getCell("A2").value=this.setup.TenDonVi.toUpperCase(),e.getCell("A3").value="______________________",e.getCell("A3").font={vertAlign:"superscript"},e.mergeCells("A1:C1"),e.mergeCells("A2:C2"),e.mergeCells("A3:C3"),e.mergeCells("A4:C4"),this.exceljs_style(e,1,3,1,4,"alignment",this._center(!0)),this.exceljs_style(e,1,1,3,3,"font",this._bold(13)),e.getCell("F1").value="C\u1ed8NG H\xd2A X\xc3 H\u1ed8I CH\u1ee6 NGH\u0128A VI\u1ec6T NAM",e.getCell("F2").value="\u0110\u1ed9c l\u1eadp - T\u1ef1 do - H\u1ea1nh ph\xfac",e.getCell("F3").value="______________________",e.getCell("F3").font={vertAlign:"superscript"},this.exceljs_style(e,6,6,1,2,"font",this._bold(13)),this.exceljs_style(e,1,7,1,3,"alignment",this._center()),e.getCell("A5").value="B\u1ea2NG K\xca KI\u1ec2M SO\xc1T CH\u1ec8 S\u1ed0 KH\xc1CH H\xc0NG L\u1eaeP \u0110I\u1ec6N M\u1eb6T TR\u1edcI TR\xcaN M\xc1I NH\xc0",e.mergeCells("A5:I5"),e.getRow(5).height=40,this.exceljs_style(e,1,11,5,5,"font",this._bold(14)),this.exceljs_writeRow(e,["TT","M\xe3 kh\xe1ch h\xe0ng","T\xean kh\xe1ch h\xe0ng","S\u1ed1 c\xf4ng t\u01a1","HSN","K\u1ef3-Th\xe1ng/N\u0103m","Ch\u1ec9 s\u1ed1 c\u0169","Ch\u1ec9 s\u1ed1 m\u1edbi","T\u1ed5ng S\u1ea3n l\u01b0\u1ee3ng"],7,1),this.exceljs_style(e,1,11,5,7,"alignment",this._center(!0)),this.exceljs_style(e,1,11,5,7,"font",this._bold());let o=0,n=0,r=0;for(let h=0;h<a.length;h++){const g=a[h],s=[];s[1]=h+1,s[2]=g.MA_KHANG,s[3]=g.TEN_KHANG,s[4]=g.SO_CTO,s[5]=g.HS_NHAN,s[6]=g.KY+"-"+g.THANG+"/"+g.NAM,s[7]=g.CHISO_CU,s[8]=g.CHISO_MOI,s[9]=g.SAN_LUONG,e.addRow(s),o+=g.CHISO_CU||0,n+=g.CHISO_MOI||0,r+=g.SAN_LUONG||0,e.getRow(8+h).height=40}const i=a.length+7;e.getCell(i+1,1).value="T\u1ed4NG C\u1ed8NG",e.getRow(i+1).height=40,e.getRow(i+1).font=this._bold(),e.mergeCells(`A${i+1}:F${i+1}`),e.getCell(`G${i+1}`).value=o,e.getCell(`H${i+1}`).value=n,e.getCell(`I${i+1}`).value=r,this.exceljs_style(e,1,6,8,i,"alignment",this._center(!0,"center")),this.exceljs_style(e,3,3,8,i,"alignment",this._center(!0,"left")),this.exceljs_style(e,7,9,8,i+1,"alignment",this._center(!0,"right")),this.exceljs_style(e,7,9,8,i+1,"numFmt","#,##0"),this.exceljs_style(e,1,9,7,i+1,"border",this._border()),this.exceljs_style(e,1,1,i+1,i+1,"alignment",this._center()),e.getCell(i+2,7).value="Xu\xe2n L\u1ed9c, ng\xe0y "+d()().format("DD")+" th\xe1ng "+d()().format("MM")+" n\u0103m "+d()().format("YYYY"),e.getCell(i+2,7).font={italic:!0,size:13,name:"Times New Roman"},e.getRow(i+2).height=30,e.getCell(i+3,2).value="NG\u01af\u1edcI L\u1eacP",e.getCell(i+10,2).value=this.user.fullName||"",e.getCell(i+3,7).value="TP. KINH DOANH",e.getCell(i+10,7).value=this.setup.TruongPhong,this.exceljs_style(e,1,15,i+2,i+10,"alignment",this._center()),this.exceljs_style(e,1,15,i+3,i+10,"font",this._bold(13)),e.pageSetup.printArea=`A1:I${i+10}`}exceljs_style(a,e,l,t,o,n,r){for(let i=e;i<l+1;i++)for(let h=t;h<o+1;h++)a.getCell(h,i)[n]=r}exceljs_styleRange(a,e,l){for(let t=0;t<l.numFmt.length;t++){let o=l.alignment[t],n=a.getCell(e,t+1);n.style={font:{name:"Times New Roman",size:12}},n.numFmt=l.numFmt[t],n.alignment={vertical:"middle",horizontal:o,wrapText:!0}}}exceljs_writeRow(a,e,l,t){for(let o=0;o<e.length+1;o++)a.getCell(l,t+o).value=e[o]}_bold(a=12){return{bold:!0,name:"Times New Roman",size:a}}_border(){return{bottom:{style:"thin"},left:{style:"thin"},right:{style:"thin"},top:{style:"thin"}}}_center(a=!1,e="center"){return{vertical:"middle",horizontal:e,wrapText:a}}}return U.\u0275fac=function(a){return new(a||U)(y.LFG(m.qu),y.LFG(O.T),y.LFG(V.O),y.LFG(f.c1),y.LFG(Y.E),y.LFG(F.Y),y.LFG(Z.b),y.LFG(W.O),y.LFG(X.j),y.LFG(q.j),y.LFG(ee.a))},U.\u0275prov=y.Yz7({token:U,factory:U.\u0275fac,providedIn:"root"}),U})()},41258:(J,$,C)=>{C.d($,{K:()=>d});var A=C(94650),m=C(25555),j=C(5383);let d=(()=>{class L{constructor(S,G){this.plus=S,this.excelSV=G,this.excel=new A.vpe,this.json=new A.vpe,this.label="Copy v\xe0 d\xe1n n\u1ed9i dung v\xe0o \u0111\xe2y",this.output=[],this.table=""}ngOnInit(){}convertJson(S){let G=[];for(let w=1;w<S.length;w++){let K={};const I=S[w];for(let[f,y]of Object.entries(S[0]))K[`${y}`]=I[f];G.push(K)}this.json.emit(G)}parseExcel(S){let G=S.target.value.trim(),w=[],K=[];const I=G.split("\n");for(let f=0;f<I.length;f++)w[f]=I[f].split("\t");return w.forEach(f=>{let O={};f.forEach((V,Y)=>{O[Y]=V}),K.push(O)}),this.output=K,this.json.emit(K),this.table=this.exportTbale(K),localStorage.setItem("parser",JSON.stringify(K)),this.excel.emit(K),this.convertJson(K),K}parseExcel2(S){let G=S.target.value.trim(),w=[],K=[];const I=G.split("\n");for(let f=0;f<I.length;f++)w[f]=I[f].split("\t");return w.forEach(f=>{const y=w[0];let O={};f.forEach((V,Y)=>{O[this.plus.generateKey(y[Y])]=V}),K.push(O)}),this.output=K,this.table=this.exportTbale(K),localStorage.setItem("parser",JSON.stringify(K)),this.excel.emit(K),K}exportTbale(S){let G="<th>STT</th>",w="";for(let I in S[0])S[0].hasOwnProperty(I)&&(G+="<th>"+this.plus.generateKey(S[0][I])+"</th>");return S.forEach((I,f)=>{w+=`<tr><td>${f+1}</td>`;for(const y in I)I.hasOwnProperty(y)&&(w+="<td>"+I[y]+"</td>");w+="</tr>"}),`\n    <table class="table table-bordered table-hover ">\n      <thead>\n        <tr class="text-center">\n         ${G}\n        </tr>\n      <thead>\n      <tbody style = "border: 1px solid black;">\n         ${w}\n      <tbody>\n    <table>\n    `}reset(S){return S.target.value=""}save(){const S=JSON.stringify(this.output);localStorage.setItem("parser",S)}}return L.\u0275fac=function(S){return new(S||L)(A.Y36(m.T),A.Y36(j.x))},L.\u0275cmp=A.Xpm({type:L,selectors:[["app-parse-excel-clipboard"]],inputs:{label:"label"},outputs:{excel:"excel",json:"json"},decls:6,vars:1,consts:[[1,"container"],[1,"form-group"],[1,"text-center"],["rows","2",1,"form-control",3,"placeholder","click","change"],["input1",""]],template:function(S,G){1&S&&(A.TgZ(0,"div",0)(1,"div",1),A._UZ(2,"div",2),A.TgZ(3,"textarea",3,4),A.NdJ("click",function(K){return G.reset(K)})("change",function(K){return G.parseExcel(K)}),A._uU(5,"  "),A.qZA()()()),2&S&&(A.xp6(3),A.s9C("placeholder",G.label))}}),L})()},38376:(J,$,C)=>{C.d($,{j:()=>G});var A=C(54004),m=C(75625),j=C(94650),d=C(94559),L=C(92358),k=C(80529),S=C(10875);let G=(()=>{class w{constructor(I,f,y,O){this.loadSV=I,this.httpSV=f,this.http=y,this.authSV=O}send(I,f){return this.loadSV.load("email"),this.httpSV.post("mail/"+I,f).pipe((0,A.U)(y=>(this.loadSV.loaded("email"),y)),(0,m.X)(1))}}return w.\u0275fac=function(I){return new(I||w)(j.LFG(d.b),j.LFG(L.a),j.LFG(k.eN),j.LFG(S.c1))},w.\u0275prov=j.Yz7({token:w,factory:w.\u0275fac,providedIn:"root"}),w})()}}]);