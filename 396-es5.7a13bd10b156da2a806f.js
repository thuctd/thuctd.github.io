!function(){"use strict";function t(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}function i(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function e(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t}(self.webpackChunk_4la=self.webpackChunk_4la||[]).push([[396],{30396:function(i,n,a){a.r(n),a.d(n,{DlxlModule:function(){return mi}});var o=a(5923),u=a(48387),r=a(85913),c=a(88817),l=a(12057),s=a(15228),h=a(24751),p=a(16738),d=a.n(p),g=a(74788),f=a(57922),m=a(48842),v=a(9157),Z=a(33982),k=a(2895),T=a(49356),b=a(25862),x=a(46833),q=a(46113),I=a(12895);function A(t,i){if(1&t){var e=g.EpF();g.TgZ(0,"button",6),g.NdJ("click",function(){return g.CHM(e),g.oxw().returnList()}),g._uU(1,"Tr\u1ea3 l\u1ea1i"),g.qZA()}}function y(t,i){if(1&t){var e=g.EpF();g.TgZ(0,"button",6),g.NdJ("click",function(){return g.CHM(e),g.oxw().save()}),g._uU(1,"L\u01b0u"),g.qZA()}}function N(t,i){if(1&t){var e=g.EpF();g.TgZ(0,"button",7),g.NdJ("click",function(){return g.CHM(e),g.oxw().exportWord()}),g._uU(1,"Xu\u1ea5t b\xe1o c\xe1o"),g.qZA()}}function _(t,i){1&t&&(g.TgZ(0,"th"),g._uU(1,"Ch\u1ee7 t\xe0i kho\u1ea3n"),g.qZA())}function D(t,i){1&t&&(g.TgZ(0,"th"),g._uU(1,"S\u1ed1 t\xe0i kho\u1ea3n"),g.qZA())}function J(t,i){1&t&&(g.TgZ(0,"th"),g._uU(1,"Ng\xe2n h\xe0ng"),g.qZA())}function w(t,i){1&t&&(g.TgZ(0,"th"),g._uU(1,"Tr\u01b0\u1edbc thu\u1ebf"),g.qZA())}function M(t,i){1&t&&(g.TgZ(0,"th"),g._uU(1,"Thu\u1ebf"),g.qZA())}function U(t,i){if(1&t){var e=g.EpF();g.TgZ(0,"td",13),g.NdJ("click",function(){g.CHM(e);var t=g.oxw().$implicit;return g.oxw(2).onEdit(t)}),g._uU(1),g.qZA()}if(2&t){var n=g.oxw().$implicit;g.xp6(1),g.Oqu(n.ChuTaiKhoan)}}function C(t,i){if(1&t){var e=g.EpF();g.TgZ(0,"td",13),g.NdJ("click",function(){g.CHM(e);var t=g.oxw().$implicit;return g.oxw(2).onEdit(t)}),g._uU(1),g.qZA()}if(2&t){var n=g.oxw().$implicit;g.xp6(1),g.Oqu(n.SoTaiKhoan)}}function H(t,i){if(1&t){var e=g.EpF();g.TgZ(0,"td",13),g.NdJ("click",function(){g.CHM(e);var t=g.oxw().$implicit;return g.oxw(2).onEdit(t)}),g._uU(1),g.qZA()}if(2&t){var n=g.oxw().$implicit;g.xp6(1),g.Oqu(n.NganHang)}}function B(t,i){if(1&t&&(g.TgZ(0,"td",15),g._uU(1),g.ALo(2,"number"),g.qZA()),2&t){var e=g.oxw().$implicit;g.xp6(1),g.Oqu(g.lcZ(2,1,e.TruocThue))}}function Q(t,i){if(1&t&&(g.TgZ(0,"td",15),g._uU(1),g.ALo(2,"number"),g.qZA()),2&t){var e=g.oxw().$implicit;g.xp6(1),g.Oqu(g.lcZ(2,1,e.Thue))}}function Y(t,i){if(1&t){var e=g.EpF();g.TgZ(0,"mat-icon",23),g.NdJ("click",function(){g.CHM(e);var t=g.oxw().$implicit;return g.oxw(2).onDelete(t)}),g._uU(1,"delete"),g.qZA()}}function S(t,i){if(1&t){var e=g.EpF();g.TgZ(0,"tr"),g.TgZ(1,"td",13),g.NdJ("click",function(){var t=g.CHM(e).$implicit;return g.oxw(2).onEdit(t)}),g._uU(2),g.qZA(),g.TgZ(3,"td",13),g.NdJ("click",function(){var t=g.CHM(e).$implicit;return g.oxw(2).onEdit(t)}),g._uU(4),g.qZA(),g.YNc(5,U,2,1,"td",14),g.YNc(6,C,2,1,"td",14),g.YNc(7,H,2,1,"td",14),g.TgZ(8,"td",13),g.NdJ("click",function(){var t=g.CHM(e).$implicit;return g.oxw(2).onEdit(t)}),g._uU(9),g.ALo(10,"number"),g.qZA(),g.TgZ(11,"td",15),g._uU(12),g.ALo(13,"number"),g.qZA(),g.YNc(14,B,3,3,"td",16),g.YNc(15,Q,3,3,"td",16),g.TgZ(16,"td",15),g._uU(17),g.ALo(18,"number"),g.qZA(),g.TgZ(19,"td",15),g.TgZ(20,"span",17),g.NdJ("blur",function(t){var i=g.CHM(e).index;return g.oxw(2).changeLabel(t,i)}),g._uU(21),g.qZA(),g.qZA(),g.TgZ(22,"td",15),g.TgZ(23,"span",17),g.NdJ("blur",function(t){var i=g.CHM(e).index;return g.oxw(2).changeSeri(t,i)}),g._uU(24),g.qZA(),g.qZA(),g.TgZ(25,"td",18),g.TgZ(26,"mat-form-field"),g.TgZ(27,"input",19),g.NdJ("focus",function(){return g.CHM(e),g.MAs(30).open()})("dateChange",function(t){var i=g.CHM(e).index;return g.oxw(2).changeDate(t,i)}),g.qZA(),g._UZ(28,"mat-datepicker-toggle",20),g._UZ(29,"mat-datepicker",null,21),g.qZA(),g.qZA(),g.TgZ(31,"td"),g.YNc(32,Y,2,0,"mat-icon",22),g.qZA(),g.qZA()}if(2&t){var n=i.$implicit,a=g.MAs(30),o=g.oxw(2);g.xp6(2),g.Oqu(n.MaKhachHang),g.xp6(2),g.Oqu(n.KhachHang),g.xp6(1),g.Q6J("Device",3),g.xp6(1),g.Q6J("Device",3),g.xp6(1),g.Q6J("Device",3),g.xp6(2),g.Oqu(g.lcZ(10,18,n.SanLuong)),g.xp6(3),g.Oqu(g.lcZ(13,20,n.DonGia)),g.xp6(2),g.Q6J("Device",3),g.xp6(1),g.Q6J("Device",3),g.xp6(2),g.Oqu(g.lcZ(18,22,n.TongTien)),g.xp6(3),g.Q6J("contentEditable",!0),g.xp6(1),g.hij(" ",n.KyHieuHoaDon,""),g.xp6(2),g.Q6J("contentEditable",!0),g.xp6(1),g.hij(" ",n.SoHoaDon," "),g.xp6(3),g.Q6J("matDatepicker",a)("value",n.NgayHoaDon),g.xp6(1),g.Q6J("for",a),g.xp6(4),g.Q6J("ngIf",o.checkPer(4))}}function E(t,i){if(1&t){var e=g.EpF();g.TgZ(0,"table",8),g.TgZ(1,"thead",9),g.TgZ(2,"tr"),g.TgZ(3,"th"),g._uU(4,"M\xe3 kh\xe1ch h\xe0ng"),g.qZA(),g.TgZ(5,"th"),g._uU(6,"Kh\xe1ch h\xe0ng"),g.qZA(),g.YNc(7,_,2,0,"th",10),g.YNc(8,D,2,0,"th",10),g.YNc(9,J,2,0,"th",10),g.TgZ(10,"th"),g._uU(11,"S\u1ea3n l\u01b0\u1ee3ng"),g.qZA(),g.TgZ(12,"th"),g._uU(13,"\u0110\u01a1n gi\xe1"),g.qZA(),g.YNc(14,w,2,0,"th",10),g.YNc(15,M,2,0,"th",10),g.TgZ(16,"th"),g._uU(17,"T\u1ed5ng ti\u1ec1n"),g.qZA(),g.TgZ(18,"th"),g._uU(19,"K\xfd hi\u1ec7u h\xf3a \u0111\u01a1n"),g.qZA(),g.TgZ(20,"th"),g._uU(21,"S\u1ed1 h\xf3a \u0111\u01a1n"),g.qZA(),g.TgZ(22,"th"),g._uU(23,"Ng\xe0y h\xf3a \u0111\u01a1n"),g.qZA(),g.TgZ(24,"th"),g.TgZ(25,"mat-icon",11),g.NdJ("click",function(){return g.CHM(e),g.oxw().reload()}),g._uU(26,"cached"),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.TgZ(27,"tbody"),g.YNc(28,S,33,24,"tr",12),g.qZA(),g.qZA()}if(2&t){var n=g.oxw();g.Q6J("@slideIn",void 0),g.xp6(7),g.Q6J("Device",3),g.xp6(1),g.Q6J("Device",3),g.xp6(1),g.Q6J("Device",3),g.xp6(5),g.Q6J("Device",3),g.xp6(1),g.Q6J("Device",3),g.xp6(13),g.Q6J("ngForOf",n.items.DanhSach)}}var F,O=((F=function(){function i(e,n,a,o,u){t(this,i),this.plus=e,this.fb=n,this.rtSv=a,this.docxSv=o,this.route=u,this.main=this.fb.group({Email:[,[h.kI.required]],MaKhachHang:[,[h.kI.required]],KhachHang:[,[h.kI.required]],DiaChi:[,[h.kI.required]],MaGCS:[,[h.kI.required]],ChuTaiKhoan:[,[h.kI.required]],SoTaiKhoan:[,[h.kI.required]],NganHang:[,[h.kI.required]],Nam:[,[h.kI.required,h.kI.pattern("^[0-9]*$")]],Thang:[,[h.kI.required,h.kI.pattern("^[0-9]*$")]],SanLuong:[,[h.kI.required,h.kI.pattern("^[0-9]*$")]],DonGia:[,[h.kI.required,h.kI.pattern("^[0-9]*$")]],TruocThue:[,[h.kI.required,h.kI.pattern("^[0-9]*$")]],Thue:[,[h.kI.required,h.kI.pattern("^[0-9]*$")]],TongTien:[,[h.kI.required,h.kI.pattern("^[0-9]*$")]],KyHieuHoaDon:[,[h.kI.required,h.kI.minLength(3)]],SoHoaDon:[,[h.kI.required,h.kI.minLength(3)]],NgayHoaDon:[,[h.kI.required]],TrangThai:[,],DaGuiMail:[0]}),this.title="Chi ti\u1ebft b\u1ea3ng k\xea",this.global=!0,this.dbName="dien-luc",this.api="dmt-input",this.db=null,this.userId=this.plus.userId,this.usr=this.plus.usr,this.selectedItem=null,this.filter=[],this.chart=[],this.errors=[],this.wordFile=null}return e(i,[{key:"ngOnInit",value:function(){var t=this;this.plus.setTiTle(this.title),this.plus.IDB_InitDB(this.dbName).subscribe(function(i){return function(t,i,e,n){return new(e||(e=Promise))(function(i,a){function o(t){try{r(n.next(t))}catch(i){a(i)}}function u(t){try{r(n.throw(t))}catch(i){a(i)}}function r(t){t.done?i(t.value):function(t){return t instanceof e?t:new e(function(i){i(t)})}(t.value).then(o,u)}r((n=n.apply(t,[])).next())})}(t,0,void 0,regeneratorRuntime.mark(function t(){var e=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.db=i,this.getIDB(),this.plus.updateRealtime(this.db,this.api,this.global),this.plus.updateAPi.subscribe(function(t){t&&e.getIDB()});case 1:case"end":return t.stop()}},t,this)}))})}},{key:"getIDB",value:function(){var t=this,i=this.route.snapshot.paramMap.get("id");this.plus.httpGet(this.api+"/"+i).subscribe(function(i){var e=t.plus.Crypt_DecryptRest(i);console.log(t.items,i),t.items=e})}},{key:"changeDate",value:function(t,i){console.log(t.value,i),this.items.DanhSach[i].NgayHoaDon=t.value}},{key:"changeLabel",value:function(t,i){console.log(t.target.innerText,i),this.items.DanhSach[i].KyHieuHoaDon=t.target.innerText}},{key:"changeSeri",value:function(t,i){console.log(t.target.innerText,i),this.items.DanhSach[i].SoHoaDon=t.target.innerText}},{key:"ngOnDestroy",value:function(){console.log("Destroy",this.api),this.plus.subs.unsubscribe(),this.rtSv.leaveRoom(this.api)}},{key:"save",value:function(){var t=this,i=this.items;delete i.__v,this.plus.httpPut(this.api,i,this.global).subscribe(function(i){i.status&&t.plus.updateAPi.next(!0)})}},{key:"completeBill",value:function(){}},{key:"exportWord",value:function(){var t=this;this.docxSv.loadFileUrl("https://thuctd.github.io/templates/BangKe-PTC.docx").then(function(i){t.docxSv.generateOne(t.items,i,"PTC").then(function(t){console.log(t)})})}},{key:"returnList",value:function(){var t=prompt("L\xed do tr\u1ea3 h\u1ed3 s\u01a1?");if(0==t.length)return this.plus.alertWarning("B\u1ea1n ph\u1ea3i nh\u1eadp l\xed do tr\u1ea3 h\u1ed3 s\u01a1");var i=this.items;i.LichSuCapNhat.push("".concat(d()().format("DD/MM/YYYY HH:MM"),": Tr\u1ea3 l\u1ea1i h\u1ed3 s\u01a1, ").concat(t)),i.TrangThai=2,delete i.__v,this.plus.httpPut(this.api,i,this.global).subscribe(function(t){console.log(t)})}},{key:"report",value:function(){}},{key:"complete",value:function(){}},{key:"onEdit",value:function(t){this.selectedItem=t;var i=this.plus.dateToHtmlObj(t,[""]);this.main.patchValue(i),this.plus.clickBtn("openModal")}},{key:"onDelete",value:function(t){var i=this;!confirm("B\u1ea1n mu\u1ed1n x\xf3a?")||(this.plus.load(),this.plus.httpDisable(this.api,t,this.global).then(function(t){i.plus.updateAPi.next(!0)}))}},{key:"search",value:function(t){this.filter=t}},{key:"find",value:function(t){this.items=t}},{key:"checkPer",value:function(t){return this.plus.checkPer(this.api,t)}},{key:"reload",value:function(){return this.plus.reload(this.dbName+"/"+this.api)}},{key:"goBack",value:function(){this.plus.goBack()}},{key:"changePage",value:function(t){}},{key:"trackByFn",value:function(t,i){return i}},{key:"resetDB",value:function(){this.plus.resetDB(this.db,this.api)}}]),i}()).\u0275fac=function(t){return new(t||F)(g.Y36(f.T),g.Y36(h.qu),g.Y36(m.i),g.Y36(v.E),g.Y36(Z.gz))},F.\u0275cmp=g.Xpm({type:F,selectors:[["app-nlmt-detail"]],decls:9,vars:5,consts:[[1,"container-fluid"],["id","back-btn","mat-raised-button","","color","primary",3,"click"],["mat-raised-button","","color","warn",3,"click",4,"ngIf"],["mat-raised-button","","color","accent",3,"click",4,"ngIf"],[1,"row"],["class","table table-hover",4,"ngIf"],["mat-raised-button","","color","warn",3,"click"],["mat-raised-button","","color","accent",3,"click"],[1,"table","table-hover"],[1,"thead-inverse"],[4,"Device"],["color","primary",3,"click"],[4,"ngFor","ngForOf"],[1,"align-middle",3,"click"],["class","align-middle",3,"click",4,"Device"],[1,"align-middle"],["class","align-middle",4,"Device"],[3,"contentEditable","blur"],[1,"align-text-top"],["matInput","",3,"matDatepicker","value","focus","dateChange"],["matSuffix","",3,"for"],["picker",""],["color","warn",3,"click",4,"ngIf"],["color","warn",3,"click"]],template:function(t,i){1&t&&(g.TgZ(0,"div",0),g.TgZ(1,"button",1),g.NdJ("click",function(){return i.goBack()}),g.TgZ(2,"mat-icon"),g._uU(3,"undo"),g.qZA(),g.qZA(),g.YNc(4,A,2,0,"button",2),g.YNc(5,y,2,0,"button",2),g.YNc(6,N,2,0,"button",3),g.TgZ(7,"div",4),g.YNc(8,E,29,7,"table",5),g.qZA(),g.qZA()),2&t&&(g.xp6(1),g.Q6J("@slideIn",void 0),g.xp6(3),g.Q6J("ngIf",1==(null==i.items?null:i.items.TrangThai)),g.xp6(1),g.Q6J("ngIf",1==(null==i.items?null:i.items.TrangThai)),g.xp6(1),g.Q6J("ngIf",1==(null==i.items?null:i.items.TrangThai)),g.xp6(2),g.Q6J("ngIf",1==(null==i.items?null:i.items.TrangThai)))},directives:[k.lW,T.Hw,l.O5,b.HP,l.sg,x.KE,q.Nt,I.hl,I.nW,x.R9,I.Mq],pipes:[l.JJ],styles:["span[_ngcontent-%COMP%]{text-align:center;display:block;border-bottom:dotted 1px}mat-form-field[_ngcontent-%COMP%]{padding:0!important}.mat-form-field-infix[_ngcontent-%COMP%]{width:100px!important}"],data:{animation:[s.Ym]}}),F),K=a(46936),P=a(23487),$=a(68042),L=a(55352),G=a(97012),z=a(73888);function R(t,i){if(1&t){var e=g.EpF();g.TgZ(0,"app-search-api",11),g.NdJ("data",function(t){return g.CHM(e),g.oxw().find(t)}),g.qZA()}if(2&t){var n=g.oxw();g.Q6J("api",n.api)}}function W(t,i){1&t&&(g.TgZ(0,"th"),g._uU(1,"Tr\u1ea1ng th\xe1i"),g.qZA())}function V(t,i){1&t&&(g.TgZ(0,"th"),g._uU(1,"L\u1ecbch s\u1eed c\u1eadp nh\u1eadt"),g.qZA())}function j(t,i){1&t&&(g.TgZ(0,"th"),g._uU(1,"Th\xe0nh ti\u1ec1n sau thu\u1ebf"),g.qZA())}function X(t,i){if(1&t&&(g.TgZ(0,"td",17),g._uU(1),g.ALo(2,"enum"),g.qZA()),2&t){var e=g.oxw().$implicit;g.s9C("routerLink",e._id),g.xp6(1),g.Oqu(g.xi3(2,2,e.TrangThai,"DMTTrangThai"))}}function tt(t,i){if(1&t&&(g.TgZ(0,"td",17),g._uU(1),g.qZA()),2&t){var e=g.oxw().$implicit;g.s9C("routerLink",e._id),g.xp6(1),g.Oqu(e.LichSuCapNhat)}}function it(t,i){if(1&t&&(g.TgZ(0,"td",17),g._uU(1),g.ALo(2,"number"),g.qZA()),2&t){var e=g.oxw().$implicit;g.s9C("routerLink",e._id),g.xp6(1),g.Oqu(g.lcZ(2,2,e.ThanhTienSauThue))}}function et(t,i){if(1&t){var e=g.EpF();g.TgZ(0,"mat-icon",20),g.NdJ("click",function(){g.CHM(e);var t=g.oxw().$implicit;return g.oxw(2).onDelete(t)}),g._uU(1,"delete"),g.qZA()}}function nt(t,i){if(1&t&&(g.TgZ(0,"tr"),g.TgZ(1,"td",17),g._uU(2),g.qZA(),g.YNc(3,X,3,5,"td",18),g.YNc(4,tt,2,2,"td",18),g.TgZ(5,"td",17),g._uU(6),g.ALo(7,"number"),g.qZA(),g.YNc(8,it,3,4,"td",18),g.TgZ(9,"td"),g.YNc(10,et,2,0,"mat-icon",19),g.qZA(),g.qZA()),2&t){var e=i.$implicit,n=g.oxw(2);g.xp6(1),g.s9C("routerLink",e._id),g.xp6(1),g.Oqu(e.TenBangKe),g.xp6(1),g.Q6J("Device",2),g.xp6(1),g.Q6J("Device",2),g.xp6(1),g.s9C("routerLink",e._id),g.xp6(1),g.Oqu(g.lcZ(7,8,e.TongPhatLen)),g.xp6(2),g.Q6J("Device",2),g.xp6(2),g.Q6J("ngIf",n.checkPer(4))}}function at(t,i){if(1&t){var e=g.EpF();g.TgZ(0,"table",12),g.TgZ(1,"thead",13),g.TgZ(2,"tr"),g.TgZ(3,"th"),g._uU(4,"T\xean b\u1ea3ng k\xea"),g.qZA(),g.YNc(5,W,2,0,"th",14),g.YNc(6,V,2,0,"th",14),g.TgZ(7,"th"),g._uU(8,"T\u1ed5ng ph\xe1t l\xean"),g.qZA(),g.YNc(9,j,2,0,"th",14),g.TgZ(10,"th"),g.TgZ(11,"mat-icon",15),g.NdJ("click",function(){return g.CHM(e),g.oxw().reload()}),g._uU(12,"cached"),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.TgZ(13,"tbody"),g.YNc(14,nt,11,10,"tr",16),g.qZA(),g.qZA()}if(2&t){var n=g.oxw();g.Q6J("@slideIn",void 0),g.xp6(5),g.Q6J("Device",2),g.xp6(1),g.Q6J("Device",2),g.xp6(3),g.Q6J("Device",2),g.xp6(5),g.Q6J("ngForOf",n.filter.length>0?n.filter:n.items.slice(0,10))("ngForTrackBy",n.trackByFn)}}function ot(t,i){if(1&t&&g._UZ(0,"app-import-database",21),2&t){var e=g.oxw();g.Q6J("api",e.api)("global",e.global)("form",e.main)}}function ut(t,i){if(1&t&&g._UZ(0,"app-export-ecxel",22),2&t){var e=g.oxw();g.Q6J("dataJson",e.items)}}function rt(t,i){if(1&t){var e=g.EpF();g.TgZ(0,"button",23),g.NdJ("click",function(){return g.CHM(e),g.oxw().resetDB()}),g._uU(1,"X\xf3a to\xe0n b\u1ed9 d\u1eef li\u1ec7u"),g.qZA()}}var ct=function(){return[5,10,25,100]},lt=function(){var i=function(){function i(e,n,a){t(this,i),this.plus=e,this.fb=n,this.rtSv=a,this.main=this.fb.group({keyWord:[,[]],_id:[,[]],TenBangKe:[,[h.kI.required]],TrangThai:[,[h.kI.required]],LichSuCapNhat:[,[h.kI.required]],TongPhatLen:[,[h.kI.required,h.kI.pattern("^[0-9]*$")]],ThanhTienTruocThue:[,[h.kI.required,h.kI.pattern("^[0-9]*$")]],Thue:[,[h.kI.required,h.kI.pattern("^[0-9]*$")]],ThanhTienSauThue:[,[h.kI.required,h.kI.pattern("^[0-9]*$")]],DanhSach:[,[h.kI.required]]}),this.title="L\u1eadp b\u1ea3ng k\xea",this.global=!0,this.dbName="dien-luc",this.api="dmt-input",this.db=null,this.userId=this.plus.userId,this.usr=this.plus.usr,this.items=[],this.selectedItem=null,this.filter=[],this.chart=[],this.errors=[]}return e(i,[{key:"ngOnInit",value:function(){var t=this;this.plus.setTiTle(this.title),this.plus.IDB_InitDB(this.dbName).subscribe(function(i){return function(t,i,e,n){return new(e||(e=Promise))(function(i,a){function o(t){try{r(n.next(t))}catch(i){a(i)}}function u(t){try{r(n.throw(t))}catch(i){a(i)}}function r(t){t.done?i(t.value):function(t){return t instanceof e?t:new e(function(i){i(t)})}(t.value).then(o,u)}r((n=n.apply(t,[])).next())})}(t,0,void 0,regeneratorRuntime.mark(function t(){var e=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.db=i,this.getIDB(),this.plus.updateRealtime(this.db,this.api,this.global),this.plus.updateAPi.subscribe(function(t){t&&e.getIDB()});case 1:case"end":return t.stop()}},t,this)}))})}},{key:"getIDB",value:function(){var t=this;this.filter=[],this.plus.updateDB(this.db,this.api,this.global),this.plus.IDB_DB_GetAll(this.db,this.api).subscribe(function(i){t.items=i})}},{key:"ngOnDestroy",value:function(){console.log("Destroy",this.api),this.plus.subs.unsubscribe(),this.rtSv.leaveRoom(this.api)}},{key:"save",value:function(){var t=this;if(!this.main.invalid){var i=this.main.value,e=this.plus.datetoNumObj(this.main.value,[""]);if(console.log(e),null==i._id)delete i._id,this.plus.httpPost(this.api,e,this.global).subscribe(function(i){i.status&&(t.plus.clickBtn("closeModal"),t.plus.updateAPi.next(!0))});else{var n=this.plus.objVs(this.selectedItem,i);if(0===Object.keys(n).length)return this.plus.alertMatSnackBar("Kh\xf4ng c\xf3 n\u1ed9i dung n\xe0o thay \u0111\u1ed5i");this.plus.httpPut(this.api,e,this.global).subscribe(function(i){i.status&&(t.plus.updateAPi.next(!0),t.plus.clickBtn("closeModal"))})}}}},{key:"onEdit",value:function(t){this.selectedItem=t;var i=this.plus.dateToHtmlObj(t,[""]);this.main.patchValue(i),this.plus.clickBtn("openModal")}},{key:"onDelete",value:function(t){var i=this;!confirm("B\u1ea1n mu\u1ed1n x\xf3a?")||(this.plus.load(),this.plus.httpDisable(this.api,t,this.global).then(function(t){i.plus.updateAPi.next(!0)}))}},{key:"chooseOpt",value:function(t,i,e){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.main.controls[i].setValue(t[e]),n&&this.main.controls[i+"ID"].setValue(t._id)}},{key:"closeModal",value:function(){this.main.reset()}},{key:"search",value:function(t){this.filter=t}},{key:"find",value:function(t){this.items=t}},{key:"checkPer",value:function(t){return this.plus.checkPer(this.api,t)}},{key:"patchForm",value:function(){this.main.reset({_id:" "})}},{key:"reload",value:function(){return this.plus.reload(this.dbName+"/"+this.api)}},{key:"goBack",value:function(){this.plus.goBack()}},{key:"reset",value:function(){this.plus.loaded(),this.filter=[],this.getIDB(),this.main.reset({})}},{key:"changePage",value:function(t){this.filter=this.items.slice(t.pageIndex*t.pageSize,(t.pageIndex+1)*t.pageSize)}},{key:"ondragover",value:function(){document.getElementById("dropZone").setAttribute("drop-active","true")}},{key:"trackByFn",value:function(t,i){return i}},{key:"resetDB",value:function(){this.plus.resetDB(this.db,this.api)}}]),i}();return i.\u0275fac=function(t){return new(t||i)(g.Y36(f.T),g.Y36(h.qu),g.Y36(m.i))},i.\u0275cmp=g.Xpm({type:i,selectors:[["app-nlmt-list"]],decls:15,vars:12,consts:[[1,"container"],["id","add-btn","color","accent","mat-raised-button","","routerLink","/dien-luc/dmt-input"],["id","back-btn","mat-raised-button","","color","primary",3,"click"],[3,"api","data",4,"ngIf"],[3,"db","api","filter"],[1,"row"],["class","table table-hover",4,"ngIf"],[3,"length","pageSize","pageSizeOptions","page"],[3,"api","global","form",4,"ngIf"],[3,"dataJson",4,"ngIf"],["mat-button","","color","warn",3,"click",4,"ngIf"],[3,"api","data"],[1,"table","table-hover"],[1,"thead-inverse"],[4,"Device"],["color","primary",3,"click"],[4,"ngFor","ngForOf","ngForTrackBy"],[3,"routerLink"],[3,"routerLink",4,"Device"],["color","warn",3,"click",4,"ngIf"],["color","warn",3,"click"],[3,"api","global","form"],[3,"dataJson"],["mat-button","","color","warn",3,"click"]],template:function(t,i){1&t&&(g.TgZ(0,"div",0),g.TgZ(1,"button",1),g.TgZ(2,"mat-icon"),g._uU(3,"control_point"),g.qZA(),g.qZA(),g.TgZ(4,"button",2),g.NdJ("click",function(){return i.goBack()}),g.TgZ(5,"mat-icon"),g._uU(6,"undo"),g.qZA(),g.qZA(),g.YNc(7,R,1,1,"app-search-api",3),g.TgZ(8,"app-search-table",4),g.NdJ("filter",function(t){return i.search(t)}),g.qZA(),g.TgZ(9,"div",5),g.YNc(10,at,15,6,"table",6),g.TgZ(11,"mat-paginator",7),g.NdJ("page",function(t){return i.changePage(t)}),g.qZA(),g.qZA(),g.YNc(12,ot,1,3,"app-import-database",8),g.YNc(13,ut,1,1,"app-export-ecxel",9),g.qZA(),g.YNc(14,rt,2,0,"button",10)),2&t&&(g.xp6(4),g.Q6J("@slideIn",void 0),g.xp6(3),g.Q6J("ngIf",i.checkPer(10)),g.xp6(1),g.Q6J("db",i.db)("api",i.api),g.xp6(2),g.Q6J("ngIf",i.items.length+i.filter.length>0),g.xp6(1),g.Q6J("length",i.items.length)("pageSize",10)("pageSizeOptions",g.DdM(11,ct)),g.xp6(1),g.Q6J("ngIf",i.checkPer(4)),g.xp6(1),g.Q6J("ngIf",i.checkPer(4)),g.xp6(1),g.Q6J("ngIf",i.checkPer(6)))},directives:[k.lW,Z.rH,T.Hw,l.O5,K.D,P.NW,$.W,b.HP,l.sg,L.y,G.t],pipes:[l.JJ,z.zZ],styles:[""],data:{animation:[s.Ym]}}),i}(),st=a(31409),ht=a(7365),pt=a(51511),dt=a(89713),gt=function(t,i,e,n){return new(e||(e=Promise))(function(a,o){function u(t){try{c(n.next(t))}catch(i){o(i)}}function r(t){try{c(n.throw(t))}catch(i){o(i)}}function c(t){t.done?a(t.value):function(t){return t instanceof e?t:new e(function(i){i(t)})}(t.value).then(u,r)}c((n=n.apply(t,i||[])).next())})};function ft(t,i){if(1&t){var e=g.EpF();g.TgZ(0,"button",12),g.NdJ("click",function(){return g.CHM(e),g.oxw().reload()}),g.TgZ(1,"mat-icon"),g._uU(2,"undo"),g.qZA(),g.qZA()}2&t&&g.Q6J("@slideIn",void 0)}function mt(t,i){if(1&t){var e=g.EpF();g.TgZ(0,"section",13),g.TgZ(1,"form",14),g.TgZ(2,"mat-form-field",15),g.TgZ(3,"mat-label"),g._uU(4,"T\xean b\u1ea3ng k\xea"),g.qZA(),g._UZ(5,"input",16),g.qZA(),g.qZA(),g.TgZ(6,"app-month-year",17),g.NdJ("month",function(t){return g.CHM(e),g.oxw().getMonth(t)}),g.qZA(),g.qZA()}if(2&t){var n=g.oxw();g.xp6(1),g.Q6J("formGroup",n.main),g.xp6(5),g.Q6J("startDay",n.startDay)}}function vt(t,i){if(1&t){var e=g.EpF();g.TgZ(0,"app-drop-files",18),g.NdJ("files",function(t){return g.CHM(e),g.oxw().onDropFile(t)})("ondragover",function(){return g.CHM(e),g.oxw().ondragover()}),g.qZA()}2&t&&g.Q6J("label","")}function Zt(t,i){if(1&t){var e=g.EpF();g.TgZ(0,"button",19),g.NdJ("click",function(){return g.CHM(e),g.oxw().sendMail()}),g._uU(1," G\u1eedi mail"),g.qZA()}}function kt(t,i){if(1&t){var e=g.EpF();g.TgZ(0,"button",20),g.NdJ("click",function(){return g.CHM(e),g.oxw().report()}),g._uU(1," Xu\u1ea5t file "),g.qZA()}}function Tt(t,i){if(1&t){var e=g.EpF();g.TgZ(0,"button",19),g.NdJ("click",function(){return g.CHM(e),g.oxw().complete()}),g._uU(1," G\u1eedi b\u1ea3ng k\xea "),g.qZA()}}function bt(t,i){1&t&&(g.TgZ(0,"h5",21),g._uU(1,"L\u1ed7i d\u1eef li\u1ec7u"),g.qZA())}function xt(t,i){1&t&&(g.TgZ(0,"h5",22),g._uU(1,"B\u1ea2NG K\xca THANH TO\xc1N TI\u1ec0N \u0110I\u1ec6N M\u1eb6T TR\u1edcI "),g.qZA())}function qt(t,i){if(1&t){var e=g.EpF();g.TgZ(0,"mat-checkbox",27),g.NdJ("change",function(t){return g.CHM(e),g.oxw(2).checkAll(t)}),g.qZA()}}function It(t,i){1&t&&(g.TgZ(0,"th"),g._uU(1,"L\u1ed7i"),g.qZA())}function At(t,i){if(1&t){var e=g.EpF();g.TgZ(0,"mat-checkbox",31),g.NdJ("change",function(t){g.CHM(e);var i=g.oxw().$implicit;return g.oxw(2).checkItem(t,i)}),g.qZA()}if(2&t){var n=g.oxw().$implicit;g.Q6J("checked",1==n.DaGuiMail)("disabled",2==n.DaGuiMail)}}function yt(t,i){if(1&t&&(g.TgZ(0,"td"),g._uU(1),g.qZA()),2&t){var e=g.oxw().$implicit;g.xp6(1),g.Oqu(e.err)}}var Nt=function(t,i){return{"bg-success text-center":t,"bg-danger":i}};function _t(t,i){if(1&t&&(g.TgZ(0,"tr"),g.TgZ(1,"td"),g.YNc(2,At,1,2,"mat-checkbox",28),g.qZA(),g.TgZ(3,"td",29),g._uU(4),g.qZA(),g.TgZ(5,"td"),g._uU(6),g.qZA(),g.TgZ(7,"td"),g._uU(8),g.qZA(),g.TgZ(9,"td",30),g._uU(10),g.qZA(),g.YNc(11,yt,2,1,"td",25),g.qZA()),2&t){var e=i.$implicit,n=g.oxw(2);g.xp6(2),g.Q6J("ngIf",3==n.step),g.xp6(2),g.Oqu(e.MaKhachHang),g.xp6(2),g.Oqu(e.Email),g.xp6(2),g.Oqu(e.KhachHang),g.xp6(1),g.Q6J("ngClass",g.WLB(7,Nt,2==e.DaGuiMail,3==e.status)),g.xp6(1),g.Oqu(2==e.DaGuiMail?"\u0110\xe3 g\u1eedi":"Ch\u01b0a g\u1eedi"),g.xp6(1),g.Q6J("ngIf",2==n.step)}}function Dt(t,i){if(1&t&&(g.TgZ(0,"table",23),g.TgZ(1,"thead"),g.TgZ(2,"tr"),g.TgZ(3,"th"),g.YNc(4,qt,1,0,"mat-checkbox",24),g.qZA(),g.TgZ(5,"th"),g._uU(6,"M\xe3 Kh\xe1ch h\xe0ng"),g.qZA(),g.TgZ(7,"th"),g._uU(8,"Email"),g.qZA(),g.TgZ(9,"th"),g._uU(10,"Kh\xe1ch h\xe0ng"),g.qZA(),g.TgZ(11,"th"),g._uU(12,"\u0110\xe3 g\u1eedi mail"),g.qZA(),g.YNc(13,It,2,0,"th",25),g.qZA(),g.qZA(),g.TgZ(14,"tbody"),g.YNc(15,_t,12,10,"tr",26),g.qZA(),g.qZA()),2&t){var e=g.oxw();g.xp6(4),g.Q6J("ngIf",3==e.step),g.xp6(9),g.Q6J("ngIf",2==e.step),g.xp6(2),g.Q6J("ngForOf",e.errors.length>0?e.errors:e.bangKe)}}function Jt(t,i){if(1&t){var e=g.EpF();g.TgZ(0,"mat-icon",41),g.NdJ("click",function(){g.CHM(e);var t=g.oxw().$implicit;return g.oxw(3).onDelete(t)}),g._uU(1,"delete"),g.qZA()}}var wt=function(t){return{"bg-danger":t}};function Mt(t,i){if(1&t){var e=g.EpF();g.TgZ(0,"tr"),g.TgZ(1,"td",38),g.NdJ("click",function(){var t=g.CHM(e).$implicit;return g.oxw(3).onEdit(t)}),g._uU(2),g.qZA(),g.TgZ(3,"td",39),g.NdJ("click",function(){var t=g.CHM(e).$implicit;return g.oxw(3).onEdit(t)}),g._uU(4),g.ALo(5,"enum"),g.qZA(),g.TgZ(6,"td",38),g.NdJ("click",function(){var t=g.CHM(e).$implicit;return g.oxw(3).onEdit(t)}),g._uU(7),g.qZA(),g.TgZ(8,"td",38),g.NdJ("click",function(){var t=g.CHM(e).$implicit;return g.oxw(3).onEdit(t)}),g._uU(9),g.ALo(10,"number"),g.qZA(),g.TgZ(11,"td",38),g.NdJ("click",function(){var t=g.CHM(e).$implicit;return g.oxw(3).onEdit(t)}),g._uU(12),g.ALo(13,"number"),g.qZA(),g.TgZ(14,"td"),g.YNc(15,Jt,2,0,"mat-icon",40),g.qZA(),g.qZA()}if(2&t){var n=i.$implicit,a=g.oxw(3);g.xp6(2),g.Oqu(n.TenBangKe),g.xp6(1),g.Q6J("ngClass",g.VKq(14,wt,2==n.TrangThai)),g.xp6(1),g.Oqu(g.xi3(5,7,n.TrangThai,"DMTTrangThai")),g.xp6(3),g.Oqu(n.LichSuCapNhat),g.xp6(2),g.Oqu(g.lcZ(10,10,n.TongPhatLen)),g.xp6(3),g.Oqu(g.lcZ(13,12,n.ThanhTienSauThue)),g.xp6(3),g.Q6J("ngIf",a.checkPer(4)&&+n.TrangThai<3)}}function Ut(t,i){if(1&t){var e=g.EpF();g.TgZ(0,"table",34),g.TgZ(1,"thead",35),g.TgZ(2,"tr"),g.TgZ(3,"th"),g._uU(4,"T\xean b\u1ea3ng k\xea"),g.qZA(),g.TgZ(5,"th"),g._uU(6,"Tr\u1ea1ng th\xe1i"),g.qZA(),g.TgZ(7,"th"),g._uU(8,"L\u1ecbch s\u1eed c\u1eadp nh\u1eadt"),g.qZA(),g.TgZ(9,"th"),g._uU(10,"T\u1ed5ng ph\xe1t l\xean"),g.qZA(),g.TgZ(11,"th"),g._uU(12,"Th\xe0nh ti\u1ec1n sau thu\u1ebf"),g.qZA(),g.TgZ(13,"th"),g.TgZ(14,"mat-icon",36),g.NdJ("click",function(){return g.CHM(e),g.oxw(2).reload()}),g._uU(15,"cached"),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.TgZ(16,"tbody"),g.YNc(17,Mt,16,16,"tr",37),g.qZA(),g.qZA()}if(2&t){var n=g.oxw(2);g.Q6J("@slideIn",void 0),g.xp6(17),g.Q6J("ngForOf",n.filter.length>0?n.filter:n.items.slice(0,10))("ngForTrackBy",n.trackByFn)}}var Ct=function(){return[5,10,25,100]};function Ht(t,i){if(1&t){var e=g.EpF();g.TgZ(0,"div",4),g.YNc(1,Ut,18,3,"table",32),g.TgZ(2,"mat-paginator",33),g.NdJ("page",function(t){return g.CHM(e),g.oxw().changePage(t)}),g.qZA(),g.qZA()}if(2&t){var n=g.oxw();g.xp6(1),g.Q6J("ngIf",n.items.length+n.filter.length>0),g.xp6(1),g.Q6J("length",n.items.length)("pageSize",10)("pageSizeOptions",g.DdM(4,Ct))}}function Bt(t,i){if(1&t){var e=g.EpF();g.TgZ(0,"button",42),g.NdJ("click",function(){return g.CHM(e),g.oxw().resetDB()}),g._uU(1,"X\xf3a to\xe0n b\u1ed9 d\u1eef li\u1ec7u"),g.qZA()}}var Qt=function(){var i=function(){function i(e,n,a,o,u){t(this,i),this.plus=e,this.fb=n,this.rtSv=a,this.excelSv=o,this.docxSv=u,this.bangKeForm=this.fb.group({Email:[,[h.kI.required]],MaKhachHang:[,[h.kI.required]],KhachHang:[,[h.kI.required]],DiaChi:[,[h.kI.required]],MaGCS:[,[h.kI.required]],ChuTaiKhoan:[,[h.kI.required]],SoTaiKhoan:[,[h.kI.required]],NganHang:[,[h.kI.required]],Nam:[,[h.kI.required,h.kI.pattern("^[0-9]*$")]],Thang:[,[h.kI.required,h.kI.pattern("^[0-9]*$")]],SanLuong:[,[h.kI.required,h.kI.pattern("^[0-9]*$")]],DonGia:[,[h.kI.required,h.kI.pattern("^[0-9]*$")]],TruocThue:[,[h.kI.required,h.kI.pattern("^[0-9]*$")]],Thue:[,[h.kI.required,h.kI.pattern("^[0-9]*$")]],TongTien:[,[h.kI.required,h.kI.pattern("^[0-9]*$")]],KyHieuHoaDon:[,[]],SoHoaDon:[,[]],NgayHoaDon:[,[]],TrangThai:[,],DaGuiMail:[0]}),this.main=this.fb.group({_id:[,[]],TenBangKe:[,[h.kI.required]],TrangThai:[,[h.kI.required]],LichSuCapNhat:[,[h.kI.required]],TongPhatLen:[,[h.kI.required,h.kI.pattern("^[0-9]*$")]],ThanhTienTruocThue:[,[h.kI.required,h.kI.pattern("^[0-9]*$")]],Thue:[,[h.kI.required,h.kI.pattern("^[0-9]*$")]],ThanhTienSauThue:[,[h.kI.required,h.kI.pattern("^[0-9]*$")]],DanhSach:[]}),this.title="L\u1eadp b\u1ea3ng k\xea",this.global=!0,this.dbName="dien-luc",this.api="dmt-input",this.db=null,this.userId=this.plus.userId,this.usr=this.plus.usr,this.items=[],this.selectedItem=null,this.filter=[],this.chart=[],this.errors=[],this.dataInXls={},this.wordFile=null,this.startDay=new Date,this.bangKe=[],this.readFileDone=!1,this.step=0,this.TongPhatLen=0,this.ThanhTienTruocThue=0,this.Thue=0,this.ThanhTienSauThue=0}return e(i,[{key:"ngOnInit",value:function(){var t=this;this.plus.setTiTle(this.title),this.getMonth(this.startDay),this.plus.IDB_InitDB(this.dbName).subscribe(function(i){return gt(t,void 0,void 0,regeneratorRuntime.mark(function t(){var e=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.db=i,this.getIDB(),this.plus.IDB_DB_CleanTrash(i,this.api),this.plus.updateRealtime(this.db,this.api,this.global),this.plus.updateAPi.subscribe(function(t){t&&e.getIDB()});case 1:case"end":return t.stop()}},t,this)}))})}},{key:"getIDB",value:function(){var t=this;this.filter=[],this.plus.updateDB(this.db,this.api,this.global),this.plus.IDB_DB_GetAll(this.db,this.api).subscribe(function(i){t.items=i,t.plus.updateAPi.next(!1)})}},{key:"ngOnDestroy",value:function(){console.log("Destroy",this.api),this.plus.subs.unsubscribe(),this.rtSv.leaveRoom(this.api)}},{key:"save",value:function(){var t=this;if(!this.main.invalid){var i=this.main.value,e=this.plus.datetoNumObj(this.main.value,[""]);if(console.log(e),null==i._id)delete i._id,this.plus.httpPost(this.api,e,this.global).subscribe(function(i){i.status&&(t.plus.clickBtn("closeModal"),t.plus.updateAPi.next(!0))});else{var n=this.plus.objVs(this.selectedItem,i);if(0===Object.keys(n).length)return this.plus.alertMatSnackBar("Kh\xf4ng c\xf3 n\u1ed9i dung n\xe0o thay \u0111\u1ed5i");this.plus.httpPut(this.api,e,this.global).subscribe(function(i){i.status&&(t.plus.updateAPi.next(!0),t.plus.clickBtn("closeModal"))})}}}},{key:"convertToList",value:function(){for(var t=this,i=this.dataInXls.data,e=function(e){var n=i[e],a={MaKhachHang:n.MA_KHANG,MaGCS:n.MA_SOGCS,Nam:t.year,Thang:t.month,SanLuong:n.DIEN_TTHU,DonGia:n.DON_GIA,TruocThue:n.SO_TIEN,Thue:n.TIEN_GTGT,TongTien:n.TONG_TIEN,DaGuiMail:0};t.TongPhatLen+=n.DIEN_TTHU,t.ThanhTienTruocThue+=n.SO_TIEN,t.Thue+=n.TIEN_GTGT,t.ThanhTienSauThue+=n.TONG_TIEN,t.plus.IDB_DB_GetAllByIndexKey(t.db,"dmt-khach-hang","MaKhachHang",n.MA_KHANG).subscribe(function(e){var n=Object.assign(e[0],a);if(delete n.canEdit,delete n.dateModify,delete n.keyWord,delete n.status,delete n.sync,delete n.__v,delete n._id,t.bangKeForm.patchValue(n),t.bangKeForm.invalid){var o=t.plus.getErrValidateForm(t.bangKeForm);n.err=o,t.errors.push(n),t.step=2}else t.bangKe.push(n);i.length==t.bangKe.length&&(t.readFileDone=!0,console.log(t.bangKe),t.step=3)})},n=0;n<i.length;n++)e(n)}},{key:"onDropFile",value:function(t){var i=this;this.reset();for(var e=0;e<t.length;e++)console.log(t[e].type),"application/vnd.openxmlformats-officedocument.wordprocessingml.document"==t[e].type?function(){var n=new FileReader;n.readAsArrayBuffer(t[e]),n.onloadend=function(){return i.wordFile=n.result}}():"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"==t[e].type?this.excelSv.toJsonArray(t[e]).then(function(t){i.dataInXls=t,i.convertToList()}):this.plus.alertError("File kh\xf4ng h\u1ee3p l\u1ec7")}},{key:"sendMail",value:function(){return gt(this,void 0,void 0,regeneratorRuntime.mark(function t(){var i,e,n=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:i=regeneratorRuntime.mark(function t(i){var e,a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(1!=(e=n.bangKe[i]).DaGuiMail){t.next=7;break}return a={from:n.plus.user.value.unit,status:0,email:e.Email,title:"Th\xf4ng b\xe1o chi ti\u1ec1n \u0111i\u1ec7n NLMTMN th\xe1ng ".concat(n.month," n\u0103m ").concat(n.year),company:e.KhachHang,index:i,message:"<p>K\xednh g\u1eedi kh\xe1ch h\xe0ng: ".concat(e.KhachHang,".</p>\n          <p>\u0110i\u1ec7n l\u1ef1c Xu\xe2n L\u1ed9c k\xednh g\u1eedi \u0111\u1ebfn qu\xfd kh\xe1ch h\xe0ng n\u1ed9i dung thanh to\xe1n ti\u1ec1n \u0111i\u1ec7n m\u1eb7t tr\u1eddi tr\xean m\xe1i nh\xe0 v\u1edbi n\u1ed9i dung nh\u01b0 sau:</p>\n          <ul> M\xe3 kh\xe1ch h\xe0ng: ").concat(e.MaKhachHang,".</ul>\n          <ul> T\xean kh\xe1ch h\xe0ng: ").concat(e.KhachHang,".</ul>\n          <ul> \u0110\u1ecba ch\u1ec9: ").concat(e.DiaChi,".</ul>\n          <ul> M\xe3 ghi ch\u1ec9 s\u1ed1: ").concat(e.MaGCS,".</ul>\n          <ul> T\xean t\xe0i kho\u1ea3n: ").concat(e.ChuTaiKhoan,".</ul>\n          <ul> S\u1ed1 t\xe0i kho\u1ea3n: ").concat(e.SoTaiKhoan,".</ul>\n          <ul> Ng\xe2n h\xe0ng: ").concat(e.NganHang,".</ul>\n          <ul> N\u0103m: ").concat(n.year,".</ul>\n          <ul> Th\xe1ng: ").concat(n.month,".</ul>\n          <ul> \u0110i\u1ec7n ph\xe1t l\xean l\u01b0\u1edbi: ").concat(n.plus.numberWithCommas(e.SanLuong)," kWh.</ul>\n          <ul> \u0110\u01a1n gi\xe1: ").concat(n.plus.numberWithCommas(e.DonGia)," VND/kWh.</ul>\n          <ul> Th\xe0nh ti\u1ec1n ch\u01b0a thu\u1ebf VAT: ").concat(n.plus.numberWithCommas(e.TruocThue)," VND.</ul>\n          <ul> Thu\u1ebf VAT: ").concat(n.plus.numberWithCommas(e.Thue)," VND.</ul>\n          <ul> T\u1ed5ng ti\u1ec1n: ").concat(n.plus.numberWithCommas(e.TongTien),' VND.</ul>\n          <p>M\u1ecdi \xfd ki\u1ebfn th\u1eafc m\u1eafc, vui l\xf2ng li\xean h\u1ec7 \u0110i\u1ec7n l\u1ef1c Xu\xe2n L\u1ed9c qua s\u1ed1 \u0111i\u1ec7n tho\u1ea1i Mr. \u0110\u1ea1t - <a href="tel:0937232239">0937232239 </a> ho\u1eb7c Mrs. Ph\u01b0\u1edbc Anh - <a href="tel:0583223344" >0583223344 </a> \u0111\u1ec3 \u0111\u01b0\u1ee3c gi\u1ea3i \u0111\xe1p.</p>\n          <p>Ph\u1ea3n h\u1ed3i h\xf3a \u0111\u01a1n qu\xfd kh\xe1ch vui l\xf2ng g\u1eedi email v\u1ec1 c\u1ea3 02 \u0111\u1ecba ch\u1ec9: <a href="mailto:dienlucxuanloc.nlmt@gmail.com;tckt.dlxl.pcdn@gmail.com">dienlucxuanloc.nlmt@gmail.com</a> v\xe0 <a href="mailto:dienlucxuanloc.nlmt@gmail.com;tckt.dlxl.pcdn@gmail.com">tckt.dlxl.pcdn@gmail.com</a> </p>\n          Tr\xe2n tr\u1ecdng.')},n.plus.load(),t.next=6,n.plus.sleep(5e3);case 6:n.plus.httpPost("mail/dien-mat-troi",a).subscribe(function(t){var e=t.index;console.log("Mail sent: ",e,t.email),e>=0&&t.email?(n.plus.loaded(),n.bangKe[i].DaGuiMail=2,localStorage.setItem(n.api,JSON.stringify(n.bangKe))):(n.bangKe[i].DaGuiMail=0,n.plus.alertToasrt(t))});case 7:case"end":return t.stop()}},t)}),e=0;case 2:if(!(e<this.bangKe.length)){t.next=7;break}return t.delegateYield(i(e),"t0",4);case 4:e++,t.next=2;break;case 7:case"end":return t.stop()}},t,this)}))}},{key:"report",value:function(){var t=this,i=this.main.value;i.DanhSach=this.bangKe,i.TongPhatLen=this.TongPhatLen,i.ThanhTienTruocThue=this.ThanhTienTruocThue,i.Thue=this.Thue,i.ThanhTienSauThue=this.ThanhTienSauThue,i.Nam=this.year,i.TrangThai=1,i.LichSuCapNhat=["".concat(d()().format("DD/MM/YYYY HH:MM"),": T\u1ea1o m\u1edbi b\u1ea3ng k\xea ")],delete i._id,this.bodyComplete=i,this.docxSv.loadFileUrl("https://thuctd.github.io/templates/BangKe.docx").then(function(e){t.docxSv.generateOne(i,e,"BangKeThang".concat(t.month,"-").concat(t.year)).then(function(i){t.plus.alertSuccess()})})}},{key:"complete",value:function(){var t=this;this.plus.httpPost(this.api,this.bodyComplete,!0).subscribe(function(i){t.getIDB()})}},{key:"checkItem",value:function(t,i){var e=this.bangKe.indexOf(i);this.bangKe[e].DaGuiMail=t.checked?1:0}},{key:"checkAll",value:function(t){this.bangKe.forEach(t.checked?function(t){2!=t.DaGuiMail&&(t.DaGuiMail=1)}:function(t){2!=t.DaGuiMail&&(t.DaGuiMail=0)})}},{key:"ondragover",value:function(){document.getElementById("dropZone").setAttribute("drop-active","true")}},{key:"getMonth",value:function(t){this.month=d()(t).month()+1,this.year=d()(t).year()}},{key:"onEdit",value:function(t){}},{key:"onDelete",value:function(t){var i=this;!confirm("B\u1ea1n mu\u1ed1n x\xf3a?")||(this.plus.load(),this.plus.httpDisable(this.api,t,this.global).then(function(t){i.plus.updateAPi.next(!0)}))}},{key:"chooseOpt",value:function(t,i,e){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.main.controls[i].setValue(t[e]),n&&this.main.controls[i+"ID"].setValue(t._id)}},{key:"closeModal",value:function(){this.main.reset()}},{key:"search",value:function(t){this.filter=t}},{key:"find",value:function(t){this.items=t}},{key:"checkPer",value:function(t){return this.plus.checkPer(this.api,t)}},{key:"patchForm",value:function(){this.main.reset({})}},{key:"reload",value:function(){return this.plus.reload(this.dbName+"/"+this.api)}},{key:"reset",value:function(){this.plus.loaded(),this.filter=[],this.errors=[],this.items=[]}},{key:"changePage",value:function(t){this.filter=this.items.slice(t.pageIndex*t.pageSize,(t.pageIndex+1)*t.pageSize)}},{key:"trackByFn",value:function(t,i){return i}},{key:"resetDB",value:function(){this.plus.resetDB(this.db,this.api)}}]),i}();return i.\u0275fac=function(t){return new(t||i)(g.Y36(f.T),g.Y36(h.qu),g.Y36(m.i),g.Y36(st.x),g.Y36(v.E))},i.\u0275cmp=g.Xpm({type:i,selectors:[["app-nlmt-input"]],decls:13,vars:11,consts:[[1,"container"],["id","back-btn","mat-raised-button","","color","primary",3,"click",4,"ngIf"],["class","py-3",4,"ngIf"],[3,"label","files","ondragover",4,"ngIf"],[1,"row"],["mat-raised-button","","color","warn",3,"click",4,"ngIf"],["mat-raised-button","","color","accent",3,"click",4,"ngIf"],["class","tit bg-warning",4,"ngIf"],["class","tit",4,"ngIf"],["class","table",4,"ngIf"],["class","row",4,"ngIf"],["mat-button","","color","warn",3,"click",4,"ngIf"],["id","back-btn","mat-raised-button","","color","primary",3,"click"],[1,"py-3"],[3,"formGroup"],["appearance","outline"],["required","","type","text","autocomplete","off","matInput","","formControlName","TenBangKe"],[3,"startDay","month"],[3,"label","files","ondragover"],["mat-raised-button","","color","warn",3,"click"],["mat-raised-button","","color","accent",3,"click"],[1,"tit","bg-warning"],[1,"tit"],[1,"table"],["color","warn",3,"checked","change",4,"ngIf"],[4,"ngIf"],[4,"ngFor","ngForOf"],["color","warn",3,"checked","change"],["color","primary",3,"checked","disabled","change",4,"ngIf"],["scope","row"],[3,"ngClass"],["color","primary",3,"checked","disabled","change"],["class","table table-hover",4,"ngIf"],[3,"length","pageSize","pageSizeOptions","page"],[1,"table","table-hover"],[1,"thead-inverse"],["color","primary",3,"click"],[4,"ngFor","ngForOf","ngForTrackBy"],[3,"click"],[3,"ngClass","click"],["color","warn",3,"click",4,"ngIf"],["color","warn",3,"click"],["mat-button","","color","warn",3,"click"]],template:function(t,i){1&t&&(g.TgZ(0,"div",0),g.YNc(1,ft,3,1,"button",1),g.YNc(2,mt,7,2,"section",2),g.YNc(3,vt,1,1,"app-drop-files",3),g.TgZ(4,"div",4),g.YNc(5,Zt,2,0,"button",5),g.YNc(6,kt,2,0,"button",6),g.YNc(7,Tt,2,0,"button",5),g.qZA(),g.YNc(8,bt,2,0,"h5",7),g.YNc(9,xt,2,0,"h5",8),g.YNc(10,Dt,16,3,"table",9),g.YNc(11,Ht,3,5,"div",10),g.qZA(),g.YNc(12,Bt,2,0,"button",11)),2&t&&(g.xp6(1),g.Q6J("ngIf",i.step>1),g.xp6(1),g.Q6J("ngIf",0==i.step),g.xp6(1),g.Q6J("ngIf",0==i.bangKe.length||!i.wordFile),g.xp6(2),g.Q6J("ngIf",i.bangKe.length>0),g.xp6(1),g.Q6J("ngIf",i.bangKe),g.xp6(1),g.Q6J("ngIf",i.bodyComplete),g.xp6(1),g.Q6J("ngIf",2==i.step),g.xp6(1),g.Q6J("ngIf",3==i.step),g.xp6(1),g.Q6J("ngIf",i.step>1),g.xp6(1),g.Q6J("ngIf",(null==i.items?null:i.items.length)>0),g.xp6(1),g.Q6J("ngIf",i.checkPer(6)))},directives:[l.O5,k.lW,T.Hw,h._Y,h.JL,h.sg,x.KE,x.hX,q.Nt,h.Fj,h.Q7,h.JJ,h.u,ht.k,pt.k,l.sg,dt.oG,l.mk,P.NW],pipes:[z.zZ,l.JJ],styles:[""],data:{animation:[s.Ym]}}),i}();function Yt(t,i){if(1&t){var e=g.EpF();g.TgZ(0,"button",10),g.NdJ("click",function(){return g.CHM(e),g.oxw().reload()}),g.TgZ(1,"mat-icon"),g._uU(2,"undo"),g.qZA(),g.qZA()}2&t&&g.Q6J("@slideIn",void 0)}function St(t,i){if(1&t){var e=g.EpF();g.TgZ(0,"app-search-api",11),g.NdJ("data",function(t){return g.CHM(e),g.oxw().find(t)}),g.qZA()}if(2&t){var n=g.oxw();g.Q6J("api",n.api)}}function Et(t,i){if(1&t){var e=g.EpF();g.TgZ(0,"mat-icon",18),g.NdJ("click",function(){g.CHM(e);var t=g.oxw().$implicit;return g.oxw(2).onDelete(t)}),g._uU(1,"delete"),g.qZA()}}function Ft(t,i){if(1&t){var e=g.EpF();g.TgZ(0,"tr"),g.TgZ(1,"td",16),g.NdJ("click",function(){var t=g.CHM(e).$implicit;return g.oxw(2).onEdit(t)}),g._uU(2),g.qZA(),g.TgZ(3,"td",16),g.NdJ("click",function(){var t=g.CHM(e).$implicit;return g.oxw(2).onEdit(t)}),g._uU(4),g.qZA(),g.TgZ(5,"td",16),g.NdJ("click",function(){var t=g.CHM(e).$implicit;return g.oxw(2).onEdit(t)}),g._uU(6),g.ALo(7,"date"),g.qZA(),g.TgZ(8,"td",16),g.NdJ("click",function(){var t=g.CHM(e).$implicit;return g.oxw(2).onEdit(t)}),g._uU(9),g.qZA(),g.TgZ(10,"td"),g.YNc(11,Et,2,0,"mat-icon",17),g.qZA(),g.qZA()}if(2&t){var n=i.$implicit,a=g.oxw(2);g.xp6(2),g.Oqu(n.TaiKhoan),g.xp6(2),g.Oqu(n.NoiDung),g.xp6(2),g.Oqu(g.xi3(7,5,n.ThoiGian,"dd/MM/YYYY HH:mm")),g.xp6(3),g.Oqu(n.MaKhachHang),g.xp6(2),g.Q6J("ngIf",a.checkPer(4))}}function Ot(t,i){if(1&t){var e=g.EpF();g.TgZ(0,"table",12),g.TgZ(1,"thead",13),g.TgZ(2,"tr"),g.TgZ(3,"th"),g._uU(4,"T\xe0i kho\u1ea3n"),g.qZA(),g.TgZ(5,"th"),g._uU(6,"N\u1ed9i dung thay \u0111\u1ed5i"),g.qZA(),g.TgZ(7,"th"),g._uU(8,"Th\u1eddi gian"),g.qZA(),g.TgZ(9,"th"),g._uU(10,"M\xe3 kh\xe1ch h\xe0ng"),g.qZA(),g.TgZ(11,"th"),g.TgZ(12,"mat-icon",14),g.NdJ("click",function(){return g.CHM(e),g.oxw().reload()}),g._uU(13,"cached"),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.TgZ(14,"tbody"),g.YNc(15,Ft,12,8,"tr",15),g.qZA(),g.qZA()}if(2&t){var n=g.oxw();g.Q6J("@slideIn",void 0),g.xp6(15),g.Q6J("ngForOf",n.filter.length>0?n.filter:n.items.slice(0,10))("ngForTrackBy",n.trackByFn)}}function Kt(t,i){if(1&t&&g._UZ(0,"app-export-ecxel",19),2&t){var e=g.oxw();g.Q6J("dataJson",e.items)}}function Pt(t,i){if(1&t){var e=g.EpF();g.TgZ(0,"button",20),g.NdJ("click",function(){return g.CHM(e),g.oxw().resetDB()}),g._uU(1,"X\xf3a to\xe0n b\u1ed9 d\u1eef li\u1ec7u"),g.qZA()}}var $t=function(){return[5,10,25,100]},Lt=function(){var i=function(){function i(e,n,a){t(this,i),this.plus=e,this.fb=n,this.rtSv=a,this.title="L\u1ecbch s\u1eed c\u1eadp nh\u1eadt",this.dbName="dien-luc",this.api="dmt-history",this.db=null,this.items=[],this.selectedItem=null,this.filter=[],this.chart=[],this.main=this.fb.group({keyWord:[,[]],_id:[,[]],TaiKhoan:[,[h.kI.required]],NoiDung:[,[h.kI.required]],ThoiGian:[,[h.kI.required]],MaKhachHang:[,[h.kI.required]]})}return e(i,[{key:"ngOnInit",value:function(){var t=this;this.plus.setTiTle(this.title),this.plus.IDB_InitDB(this.dbName).subscribe(function(i){return function(t,i,e,n){return new(e||(e=Promise))(function(i,a){function o(t){try{r(n.next(t))}catch(i){a(i)}}function u(t){try{r(n.throw(t))}catch(i){a(i)}}function r(t){t.done?i(t.value):function(t){return t instanceof e?t:new e(function(i){i(t)})}(t.value).then(o,u)}r((n=n.apply(t,[])).next())})}(t,0,void 0,regeneratorRuntime.mark(function t(){var e=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.db=i,this.getIDB(),this.plus.updateGlobalLocal(i,this.api),this.plus.updateAPi.subscribe(function(t){t&&e.getIDB()});case 1:case"end":return t.stop()}},t,this)}))})}},{key:"getIDB",value:function(){var t=this;console.log("getIDB"),this.filter=[],this.plus.IDB_DB_GetAll(this.db,this.api).subscribe(function(i){t.items=i,t.plus.updateAPi.next(!1)})}},{key:"ngOnDestroy",value:function(){console.log("Destroy",this.api),this.plus.subs.unsubscribe(),this.rtSv.leaveRoom(this.api)}},{key:"save",value:function(){var t=this;if(!this.main.invalid){var i=this.main.value,e=this.plus.datetoNumObj(this.main.value,["ThoiGian"]);console.log(e),null==i._id?(delete i._id,this.plus.httpPost(this.api,e).subscribe(function(i){i.status&&t.plus.clickBtn("closeModal")})):this.plus.httpPut(this.api,e).subscribe(function(i){i.status&&t.plus.clickBtn("closeModal")})}}},{key:"onEdit",value:function(t){this.selectedItem=t;var i=this.plus.dateToHtmlObj(t,["ThoiGian"]);this.main.patchValue(i),this.plus.clickBtn("openModal")}},{key:"onDelete",value:function(t){!confirm("B\u1ea1n mu\u1ed1n x\xf3a?")||(this.plus.load(),this.plus.httpDisable(this.api,t).then(function(t){console.log(t)}))}},{key:"chooseOpt",value:function(t,i,e){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.main.controls[i].setValue(t[e]),n&&this.main.controls[i+"ID"].setValue(t._id)}},{key:"closeModal",value:function(){this.main.reset()}},{key:"search",value:function(t){this.filter=t}},{key:"find",value:function(t){this.items=t}},{key:"checkPer",value:function(t){return this.plus.checkPer(this.api,t)}},{key:"patchForm",value:function(){this.main.reset({_id:" "})}},{key:"reload",value:function(){return this.plus.reload(this.dbName+"/"+this.api)}},{key:"reset",value:function(){this.plus.loaded(),this.filter=[],this.getIDB(),this.main.reset({})}},{key:"changePage",value:function(t){this.filter=this.items.slice(t.pageIndex*t.pageSize,(t.pageIndex+1)*t.pageSize)}},{key:"trackByFn",value:function(t,i){return i}},{key:"resetDB",value:function(){this.plus.resetDB(this.db,this.api)}}]),i}();return i.\u0275fac=function(t){return new(t||i)(g.Y36(f.T),g.Y36(h.qu),g.Y36(m.i))},i.\u0275cmp=g.Xpm({type:i,selectors:[["app-nlmt-history"]],decls:12,vars:11,consts:[[1,"container"],["id","add-btn","color","accent","mat-raised-button","","data-toggle","modal","data-target","#modelId",3,"click"],["id","back-btn","mat-raised-button","","color","primary",3,"click",4,"ngIf"],[3,"api","data",4,"ngIf"],[3,"db","api","filter"],[1,"row"],["class","table table-hover",4,"ngIf"],[3,"length","pageSize","pageSizeOptions","page"],[3,"dataJson",4,"ngIf"],["mat-button","","color","warn",3,"click",4,"ngIf"],["id","back-btn","mat-raised-button","","color","primary",3,"click"],[3,"api","data"],[1,"table","table-hover"],[1,"thead-inverse"],["color","primary",3,"click"],[4,"ngFor","ngForOf","ngForTrackBy"],[3,"click"],["color","warn",3,"click",4,"ngIf"],["color","warn",3,"click"],[3,"dataJson"],["mat-button","","color","warn",3,"click"]],template:function(t,i){1&t&&(g.TgZ(0,"div",0),g.TgZ(1,"button",1),g.NdJ("click",function(){return i.reset()}),g.TgZ(2,"mat-icon"),g._uU(3,"control_point"),g.qZA(),g.qZA(),g.YNc(4,Yt,3,1,"button",2),g.YNc(5,St,1,1,"app-search-api",3),g.TgZ(6,"app-search-table",4),g.NdJ("filter",function(t){return i.search(t)}),g.qZA(),g.TgZ(7,"div",5),g.YNc(8,Ot,16,3,"table",6),g.TgZ(9,"mat-paginator",7),g.NdJ("page",function(t){return i.changePage(t)}),g.qZA(),g.qZA(),g.YNc(10,Kt,1,1,"app-export-ecxel",8),g.qZA(),g.YNc(11,Pt,2,0,"button",9)),2&t&&(g.xp6(4),g.Q6J("ngIf",i.filter.length>0),g.xp6(1),g.Q6J("ngIf",i.checkPer(10)),g.xp6(1),g.Q6J("db",i.db)("api",i.api),g.xp6(2),g.Q6J("ngIf",i.items.length+i.filter.length>0),g.xp6(1),g.Q6J("length",i.items.length)("pageSize",10)("pageSizeOptions",g.DdM(10,$t)),g.xp6(1),g.Q6J("ngIf",i.checkPer(4)),g.xp6(1),g.Q6J("ngIf",i.checkPer(5)))},directives:[k.lW,T.Hw,l.O5,K.D,P.NW,$.W,l.sg,G.t],pipes:[l.uU],styles:[""],data:{animation:[s.Ym]}}),i}();function Gt(t,i){if(1&t){var e=g.EpF();g.TgZ(0,"button",31),g.NdJ("click",function(){return g.CHM(e),g.oxw().reload()}),g.TgZ(1,"mat-icon"),g._uU(2,"undo"),g.qZA(),g.qZA()}2&t&&g.Q6J("@slideIn",void 0)}function zt(t,i){if(1&t){var e=g.EpF();g.TgZ(0,"app-search-api",32),g.NdJ("data",function(t){return g.CHM(e),g.oxw().find(t)}),g.qZA()}if(2&t){var n=g.oxw();g.Q6J("api",n.api)}}function Rt(t,i){1&t&&(g.TgZ(0,"th"),g._uU(1,"\u0110\u1ecba ch\u1ec9"),g.qZA())}function Wt(t,i){1&t&&(g.TgZ(0,"th"),g._uU(1,"M\xe3 G C S"),g.qZA())}function Vt(t,i){1&t&&(g.TgZ(0,"th"),g._uU(1,"Ch\u1ee7 t\xe0i kho\u1ea3n"),g.qZA())}function jt(t,i){1&t&&(g.TgZ(0,"th"),g._uU(1,"S\u1ed1 t\xe0i kho\u1ea3n"),g.qZA())}function Xt(t,i){1&t&&(g.TgZ(0,"th"),g._uU(1,"Ng\xe2n h\xe0ng"),g.qZA())}function ti(t,i){1&t&&(g.TgZ(0,"th"),g._uU(1,"Email"),g.qZA())}function ii(t,i){if(1&t){var e=g.EpF();g.TgZ(0,"td",38),g.NdJ("click",function(){g.CHM(e);var t=g.oxw().$implicit;return g.oxw(2).onEdit(t)}),g._uU(1),g.qZA()}if(2&t){var n=g.oxw().$implicit;g.xp6(1),g.Oqu(n.DiaChi)}}function ei(t,i){if(1&t){var e=g.EpF();g.TgZ(0,"td",38),g.NdJ("click",function(){g.CHM(e);var t=g.oxw().$implicit;return g.oxw(2).onEdit(t)}),g._uU(1),g.qZA()}if(2&t){var n=g.oxw().$implicit;g.xp6(1),g.Oqu(n.MaGCS)}}function ni(t,i){if(1&t){var e=g.EpF();g.TgZ(0,"td",38),g.NdJ("click",function(){g.CHM(e);var t=g.oxw().$implicit;return g.oxw(2).onEdit(t)}),g._uU(1),g.qZA()}if(2&t){var n=g.oxw().$implicit;g.xp6(1),g.Oqu(n.ChuTaiKhoan)}}function ai(t,i){if(1&t){var e=g.EpF();g.TgZ(0,"td",38),g.NdJ("click",function(){g.CHM(e);var t=g.oxw().$implicit;return g.oxw(2).onEdit(t)}),g._uU(1),g.qZA()}if(2&t){var n=g.oxw().$implicit;g.xp6(1),g.Oqu(n.SoTaiKhoan)}}function oi(t,i){if(1&t){var e=g.EpF();g.TgZ(0,"td",38),g.NdJ("click",function(){g.CHM(e);var t=g.oxw().$implicit;return g.oxw(2).onEdit(t)}),g._uU(1),g.qZA()}if(2&t){var n=g.oxw().$implicit;g.xp6(1),g.Oqu(n.NganHang)}}function ui(t,i){if(1&t){var e=g.EpF();g.TgZ(0,"td",38),g.NdJ("click",function(){g.CHM(e);var t=g.oxw().$implicit;return g.oxw(2).onEdit(t)}),g._uU(1),g.qZA()}if(2&t){var n=g.oxw().$implicit;g.xp6(1),g.Oqu(n.Email)}}function ri(t,i){if(1&t){var e=g.EpF();g.TgZ(0,"mat-icon",41),g.NdJ("click",function(){g.CHM(e);var t=g.oxw().$implicit;return g.oxw(2).onDelete(t)}),g._uU(1,"delete"),g.qZA()}}function ci(t,i){if(1&t){var e=g.EpF();g.TgZ(0,"tr"),g.TgZ(1,"td",38),g.NdJ("click",function(){var t=g.CHM(e).$implicit;return g.oxw(2).onEdit(t)}),g._uU(2),g.qZA(),g.TgZ(3,"td",38),g.NdJ("click",function(){var t=g.CHM(e).$implicit;return g.oxw(2).onEdit(t)}),g._uU(4),g.qZA(),g.YNc(5,ii,2,1,"td",39),g.YNc(6,ei,2,1,"td",39),g.YNc(7,ni,2,1,"td",39),g.YNc(8,ai,2,1,"td",39),g.YNc(9,oi,2,1,"td",39),g.YNc(10,ui,2,1,"td",39),g.TgZ(11,"td"),g.YNc(12,ri,2,0,"mat-icon",40),g.qZA(),g.qZA()}if(2&t){var n=i.$implicit,a=g.oxw(2);g.xp6(2),g.Oqu(n.MaKhachHang),g.xp6(2),g.Oqu(n.KhachHang),g.xp6(1),g.Q6J("Device",3),g.xp6(1),g.Q6J("Device",3),g.xp6(1),g.Q6J("Device",3),g.xp6(1),g.Q6J("Device",3),g.xp6(1),g.Q6J("Device",3),g.xp6(1),g.Q6J("Device",2),g.xp6(2),g.Q6J("ngIf",a.checkPer(4))}}function li(t,i){if(1&t){var e=g.EpF();g.TgZ(0,"table",33),g.TgZ(1,"thead",34),g.TgZ(2,"tr"),g.TgZ(3,"th"),g._uU(4,"M\xe3 kh\xe1ch h\xe0ng"),g.qZA(),g.TgZ(5,"th"),g._uU(6,"Kh\xe1ch h\xe0ng"),g.qZA(),g.YNc(7,Rt,2,0,"th",35),g.YNc(8,Wt,2,0,"th",35),g.YNc(9,Vt,2,0,"th",35),g.YNc(10,jt,2,0,"th",35),g.YNc(11,Xt,2,0,"th",35),g.YNc(12,ti,2,0,"th",35),g.TgZ(13,"th"),g.TgZ(14,"mat-icon",36),g.NdJ("click",function(){return g.CHM(e),g.oxw().reload()}),g._uU(15,"cached"),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.TgZ(16,"tbody"),g.YNc(17,ci,13,9,"tr",37),g.qZA(),g.qZA()}if(2&t){var n=g.oxw();g.Q6J("@slideIn",void 0),g.xp6(7),g.Q6J("Device",3),g.xp6(1),g.Q6J("Device",3),g.xp6(1),g.Q6J("Device",3),g.xp6(1),g.Q6J("Device",3),g.xp6(1),g.Q6J("Device",3),g.xp6(1),g.Q6J("Device",3),g.xp6(5),g.Q6J("ngForOf",n.filter.length>0?n.filter:n.items.slice(0,10))("ngForTrackBy",n.trackByFn)}}function si(t,i){if(1&t&&g._UZ(0,"app-import-database",42),2&t){var e=g.oxw();g.Q6J("api",e.api)("global",!0)("form",e.main)}}function hi(t,i){if(1&t){var e=g.EpF();g.TgZ(0,"button",43),g.NdJ("click",function(){return g.CHM(e),g.oxw().resetDB()}),g._uU(1,"X\xf3a to\xe0n b\u1ed9 d\u1eef li\u1ec7u"),g.qZA()}}function pi(t,i){if(1&t){var e=g.EpF();g.TgZ(0,"button",44),g.NdJ("click",function(){return g.CHM(e),g.oxw().save()}),g.TgZ(1,"mat-icon"),g._uU(2,"save"),g.qZA(),g.qZA()}2&t&&g.Q6J("@slideIn",void 0)}var di=function(){return[5,10,25,100]},gi=[{path:"",component:function(){var i=function(){function i(){t(this,i)}return e(i,[{key:"ngOnInit",value:function(){}}]),i}();return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=g.Xpm({type:i,selectors:[["app-dlxl"]],decls:2,vars:0,template:function(t,i){1&t&&(g.TgZ(0,"p"),g._uU(1,"dlxl works!"),g.qZA())},styles:[""]}),i}()},{path:"dmt-khach-hang",component:function(){var i=function(){function i(e,n,a){t(this,i),this.plus=e,this.fb=n,this.rtSv=a,this.main=this.fb.group({_id:[,[]],MaKhachHang:[,[h.kI.required,h.kI.minLength(5)]],KhachHang:[,[h.kI.required,h.kI.minLength(5)]],DiaChi:[,[h.kI.required,h.kI.minLength(5)]],MaGCS:[,[h.kI.required,h.kI.minLength(5)]],ChuTaiKhoan:[,[h.kI.required,h.kI.minLength(5)]],SoTaiKhoan:[,[h.kI.required,h.kI.minLength(5)]],NganHang:[,[h.kI.required,h.kI.minLength(5)]],Email:[,[h.kI.required,h.kI.email]]}),this.title="Kh\xe1ch h\xe0ng",this.dbName="dien-luc",this.global=!0,this.api="dmt-khach-hang",this.db=null,this.userId=this.plus.userId,this.usr=this.plus.usr,this.items=[],this.selectedItem=null,this.filter=[],this.chart=[]}return e(i,[{key:"ngOnInit",value:function(){var t=this;this.plus.setTiTle(this.title),this.plus.IDB_InitDB(this.dbName).subscribe(function(i){return function(t,i,e,n){return new(e||(e=Promise))(function(i,a){function o(t){try{r(n.next(t))}catch(i){a(i)}}function u(t){try{r(n.throw(t))}catch(i){a(i)}}function r(t){t.done?i(t.value):function(t){return t instanceof e?t:new e(function(i){i(t)})}(t.value).then(o,u)}r((n=n.apply(t,[])).next())})}(t,0,void 0,regeneratorRuntime.mark(function t(){var e=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.db=i,this.getIDB(),this.plus.updateRealtime(this.db,this.api,this.global),this.plus.updateAPi.subscribe(function(t){t&&e.getIDB()});case 1:case"end":return t.stop()}},t,this)}))})}},{key:"getIDB",value:function(){var t=this;this.filter=[],this.plus.updateDB(this.db,this.api,this.global),this.plus.IDB_DB_GetAll(this.db,this.api).subscribe(function(i){t.items=i,t.plus.updateAPi.next(!1)})}},{key:"ngOnDestroy",value:function(){console.log("Destroy",this.api),this.plus.subs.unsubscribe(),this.rtSv.leaveRoom(this.api)}},{key:"save",value:function(){var t=this;if(!this.main.invalid){var i=this.main.value;if(null==i._id)delete i._id,this.plus.httpPost(this.api,i,this.global).subscribe(function(i){i.status&&(t.plus.clickBtn("closeModal"),t.plus.updateAPi.next(!0))});else{var e=this.plus.objVs(this.selectedItem,i);if(0===Object.keys(e).length)return this.plus.alertMatSnackBar("Kh\xf4ng c\xf3 n\u1ed9i dung n\xe0o thay \u0111\u1ed5i");this.plus.httpPut(this.api,i,this.global).subscribe(function(i){i.status&&(t.plus.clickBtn("closeModal"),t.addHistory(e),t.plus.updateAPi.next(!0))})}}}},{key:"addHistory",value:function(t){var i=[];for(var e in t)i.push(this.selectedItem[e]+" => "+t[e]);var n={TaiKhoan:this.plus.user.value.fullName,NoiDung:i.join(", "),ThoiGian:Date.now(),MaKhachHang:this.selectedItem.MaKhachHang};0!=i.length&&this.plus.httpPost("dmt-history",n,!0).subscribe(function(t){})}},{key:"onEdit",value:function(t){this.selectedItem=t,this.main.patchValue(t),this.plus.clickBtn("openModal")}},{key:"onDelete",value:function(t){!confirm("B\u1ea1n mu\u1ed1n x\xf3a?")||(this.plus.load(),this.plus.httpDisable(this.api,t,!0).then(function(t){console.log(t)}))}},{key:"chooseOpt",value:function(t,i,e){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.main.controls[i].setValue(t[e]),n&&this.main.controls[i+"ID"].setValue(t._id)}},{key:"closeModal",value:function(){this.main.reset()}},{key:"search",value:function(t){this.filter=t}},{key:"find",value:function(t){this.items=t}},{key:"checkPer",value:function(t){return this.plus.checkPer(this.api,t)}},{key:"reload",value:function(){return this.plus.reload(this.dbName+"/"+this.api)}},{key:"reset",value:function(){this.plus.loaded(),this.filter=[],this.getIDB(),this.main.reset({})}},{key:"changePage",value:function(t){this.filter=this.items.slice(t.pageIndex*t.pageSize,(t.pageIndex+1)*t.pageSize)}},{key:"trackByFn",value:function(t,i){return i}},{key:"resetDB",value:function(){this.plus.resetDB(this.db,this.api)}}]),i}();return i.\u0275fac=function(t){return new(t||i)(g.Y36(f.T),g.Y36(h.qu),g.Y36(m.i))},i.\u0275cmp=g.Xpm({type:i,selectors:[["app-nlmt-kh"]],decls:66,vars:15,consts:[[1,"container"],["id","add-btn","color","accent","mat-raised-button","","data-toggle","modal","data-target","#modelId",3,"click"],["id","back-btn","mat-raised-button","","color","primary",3,"click",4,"ngIf"],[3,"api","data",4,"ngIf"],[3,"db","api","filter"],[1,"row"],["class","table table-hover",4,"ngIf"],[3,"length","pageSize","pageSizeOptions","page"],[3,"api","global","form",4,"ngIf"],["mat-button","","color","warn",3,"click",4,"ngIf"],[3,"dataJson"],["id","openModal","type","button","data-toggle","modal","data-target","#modelId",1,"d-none"],["id","modelId","data-backdrop","static","tabindex","-1","role","dialog","aria-labelledby","modelTitleId","aria-hidden","true",1,"modal","fade"],["role","document",1,"modal-dialog","modal-lg"],[1,"modal-content"],[1,"modal-body"],[1,"container-fluid"],[3,"formGroup"],["hidden","","formControlName","_id"],["required","","type","text","autocomplete","off","matInput","","formControlName","MaKhachHang"],["matSuffix",""],["required","","type","text","autocomplete","off","matInput","","formControlName","KhachHang"],["required","","type","text","autocomplete","off","matInput","","formControlName","DiaChi"],["required","","type","text","autocomplete","off","matInput","","formControlName","MaGCS"],["required","","type","text","autocomplete","off","matInput","","formControlName","ChuTaiKhoan"],["required","","type","text","autocomplete","off","matInput","","formControlName","SoTaiKhoan"],["required","","type","text","autocomplete","off","matInput","","formControlName","NganHang"],["required","","type","text","autocomplete","off","matInput","","formControlName","Email"],[1,"modal-footer"],["id","closeModal","mat-raised-button","","color","primary","data-dismiss","modal",3,"click"],["mat-raised-button","","color","warn",3,"click",4,"ngIf"],["id","back-btn","mat-raised-button","","color","primary",3,"click"],[3,"api","data"],[1,"table","table-hover"],[1,"thead-inverse"],[4,"Device"],["color","primary",3,"click"],[4,"ngFor","ngForOf","ngForTrackBy"],[3,"click"],[3,"click",4,"Device"],["color","warn",3,"click",4,"ngIf"],["color","warn",3,"click"],[3,"api","global","form"],["mat-button","","color","warn",3,"click"],["mat-raised-button","","color","warn",3,"click"]],template:function(t,i){1&t&&(g.TgZ(0,"div",0),g.TgZ(1,"button",1),g.NdJ("click",function(){return i.reset()}),g.TgZ(2,"mat-icon"),g._uU(3,"control_point"),g.qZA(),g.qZA(),g.YNc(4,Gt,3,1,"button",2),g.YNc(5,zt,1,1,"app-search-api",3),g.TgZ(6,"app-search-table",4),g.NdJ("filter",function(t){return i.search(t)}),g.qZA(),g.TgZ(7,"div",5),g.YNc(8,li,18,9,"table",6),g.TgZ(9,"mat-paginator",7),g.NdJ("page",function(t){return i.changePage(t)}),g.qZA(),g.qZA(),g.YNc(10,si,1,3,"app-import-database",8),g.qZA(),g.YNc(11,hi,2,0,"button",9),g._UZ(12,"app-export-ecxel",10),g._UZ(13,"button",11),g.TgZ(14,"div",12),g.TgZ(15,"div",13),g.TgZ(16,"div",14),g.TgZ(17,"div",15),g.TgZ(18,"div",16),g.TgZ(19,"form",17),g._UZ(20,"input",18),g.TgZ(21,"mat-form-field"),g.TgZ(22,"mat-label"),g._uU(23,"M\xe3 kh\xe1ch h\xe0ng"),g.qZA(),g._UZ(24,"input",19),g._UZ(25,"span",20),g.qZA(),g.TgZ(26,"mat-form-field"),g.TgZ(27,"mat-label"),g._uU(28,"Kh\xe1ch h\xe0ng"),g.qZA(),g._UZ(29,"input",21),g._UZ(30,"span",20),g.qZA(),g.TgZ(31,"mat-form-field"),g.TgZ(32,"mat-label"),g._uU(33,"\u0110\u1ecba ch\u1ec9"),g.qZA(),g._UZ(34,"input",22),g._UZ(35,"span",20),g.qZA(),g.TgZ(36,"mat-form-field"),g.TgZ(37,"mat-label"),g._uU(38,"M\xe3 Ghi ch\u1ec9 s\u1ed1"),g.qZA(),g._UZ(39,"input",23),g._UZ(40,"span",20),g.qZA(),g.TgZ(41,"mat-form-field"),g.TgZ(42,"mat-label"),g._uU(43,"Ch\u1ee7 t\xe0i kho\u1ea3n"),g.qZA(),g._UZ(44,"input",24),g._UZ(45,"span",20),g.qZA(),g.TgZ(46,"mat-form-field"),g.TgZ(47,"mat-label"),g._uU(48,"S\u1ed1 t\xe0i kho\u1ea3n"),g.qZA(),g._UZ(49,"input",25),g._UZ(50,"span",20),g.qZA(),g.TgZ(51,"mat-form-field"),g.TgZ(52,"mat-label"),g._uU(53,"Ng\xe2n h\xe0ng"),g.qZA(),g._UZ(54,"input",26),g._UZ(55,"span",20),g.qZA(),g.TgZ(56,"mat-form-field"),g.TgZ(57,"mat-label"),g._uU(58,"Email"),g.qZA(),g._UZ(59,"input",27),g._UZ(60,"span",20),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.TgZ(61,"div",28),g.TgZ(62,"button",29),g.NdJ("click",function(){return i.closeModal()}),g.TgZ(63,"mat-icon"),g._uU(64,"close"),g.qZA(),g.qZA(),g.YNc(65,pi,3,1,"button",30),g.qZA(),g.qZA(),g.qZA(),g.qZA()),2&t&&(g.xp6(4),g.Q6J("ngIf",i.filter.length>0),g.xp6(1),g.Q6J("ngIf",i.checkPer(10)),g.xp6(1),g.Q6J("db",i.db)("api",i.api),g.xp6(2),g.Q6J("ngIf",i.items.length+i.filter.length>0),g.xp6(1),g.Q6J("length",i.items.length)("pageSize",10)("pageSizeOptions",g.DdM(14,di)),g.xp6(1),g.Q6J("ngIf",i.checkPer(4)),g.xp6(1),g.Q6J("ngIf",i.checkPer(5)),g.xp6(1),g.Q6J("dataJson",i.items),g.xp6(7),g.Q6J("formGroup",i.main),g.xp6(43),g.Q6J("@slideIn",void 0),g.xp6(3),g.Q6J("ngIf",i.checkPer(2)&&i.main.valid))},directives:[k.lW,T.Hw,l.O5,K.D,P.NW,G.t,h._Y,h.JL,h.sg,h.Fj,h.JJ,h.u,x.KE,x.hX,q.Nt,h.Q7,x.R9,$.W,b.HP,l.sg,L.y],styles:[""],data:{animation:[s.Ym]}}),i}()},{path:"dmt-history",component:Lt},{path:"dmt-input",component:Qt},{path:"dmt-list",component:lt},{path:"dmt-list/:id",component:O}],fi=function(){var i=function i(){t(this,i)};return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=g.oAB({type:i}),i.\u0275inj=g.cJS({imports:[[Z.Bz.forChild(gi)],Z.Bz]}),i}(),mi=function(){var i=function i(){t(this,i)};return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=g.oAB({type:i}),i.\u0275inj=g.cJS({imports:[[l.ez,fi,c.ShareModule,r.m,u.D,o.X]]}),i}()}}])}();