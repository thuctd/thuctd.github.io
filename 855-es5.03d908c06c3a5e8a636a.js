!function(){"use strict";function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function n(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}(self.webpackChunk_4la=self.webpackChunk_4la||[]).push([[855],{51511:function(t,o,i){i.d(o,{k:function(){return s}});var r=i(74788),a=i(15194),s=function(){var t=function(){function t(){e(this,t),this.files=new r.vpe}return n(t,[{key:"ngOnInit",value:function(){}},{key:"ngOnDestroy",value:function(){this.files.unsubscribe(),console.log("ngOnDestroy app-drop-files")}},{key:"onDrop",value:function(e){this.files.emit(e),document.getElementById("dropZone").setAttribute("drop-active","false")}},{key:"selectedFile",value:function(e){this.files.emit(e.target.files)}},{key:"ondragover",value:function(){document.getElementById("dropZone").setAttribute("drop-active","true")}}]),t}();return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=r.Xpm({type:t,selectors:[["app-drop-files"]],inputs:{label:"label"},outputs:{files:"files"},decls:9,vars:1,consts:[[1,"row","justify-content-center","d-none-print"],["id","dropZone",3,"appDropZone","dragover"],["for","file-import"],["hidden","","id","file-import","type","file","multiple","false",3,"change"]],template:function(e,t){1&e&&(r.TgZ(0,"div",0),r.TgZ(1,"div",1),r.NdJ("appDropZone",function(e){return t.onDrop(e)})("dragover",function(){return t.ondragover()}),r.TgZ(2,"label",2),r._uU(3),r.TgZ(4,"span"),r._uU(5,"\u2794"),r.qZA(),r.TgZ(6,"a"),r._uU(7," Ch\u1ecdn file "),r.qZA(),r.qZA(),r.TgZ(8,"input",3),r.NdJ("change",function(e){return t.selectedFile(e)}),r.qZA(),r.qZA(),r.qZA()),2&e&&(r.xp6(3),r.hij(" K\xe9o th\u1ea3 file ",t.label," v\xe0o \u0111\xe2y ho\u1eb7c "))},directives:[a.i],styles:["label[_ngcontent-%COMP%]{width:100%;height:100%;text-align:center;line-height:170px;color:#00f;font-weight:bolder}#dropZone[_ngcontent-%COMP%]{top:20%;left:10%;width:80%;height:200px;border-radius:3%;border:2px dashed rgb(38,16,165)}#dropZone[drop-active=true][_ngcontent-%COMP%]{box-shadow:inset 0 0 0 2px #00c;border:2px dashed rgb(38,16,165);background-color:#c9eccb}"],changeDetection:0}),t}()},15194:function(t,o,i){i.d(o,{i:function(){return s}});var r,a=i(74788),s=((r=function(){function t(){e(this,t),this.fileDrop=new a.vpe,this.preventBodyDrop=!0,this.active=!1}return n(t,[{key:"onDrop",value:function(e){e.preventDefault(),this.active=!1;var t=e.dataTransfer;if(t.items){for(var n=[],o=0;o<t.items.length;o++)"file"===t.items[o].kind&&n.push(t.items[o].getAsFile());t.items.clear(),this.fileDrop.emit(n)}else{var i=t.files;t.clearData(),this.fileDrop.emit(Array.from(i))}}},{key:"onDragOver",value:function(e){e.stopPropagation(),e.preventDefault(),this.active=!0}},{key:"onDragLeave",value:function(e){this.active=!1}},{key:"onBodyDragOver",value:function(e){this.preventBodyDrop&&(e.preventDefault(),e.stopPropagation())}},{key:"onBodyDrop",value:function(e){this.preventBodyDrop&&e.preventDefault()}}]),t}()).\u0275fac=function(e){return new(e||r)},r.\u0275dir=a.lG2({type:r,selectors:[["","appDropZone",""]],hostVars:2,hostBindings:function(e,t){1&e&&a.NdJ("drop",function(e){return t.onDrop(e)})("dragover",function(e){return t.onDragOver(e)})("dragleave",function(e){return t.onDragLeave(e)})("dragover",function(e){return t.onBodyDragOver(e)},!1,a.pYS)("drop",function(e){return t.onBodyDrop(e)},!1,a.pYS),2&e&&a.ekj("drop-zone-active",t.active)},inputs:{preventBodyDrop:"preventBodyDrop"},outputs:{fileDrop:"appDropZone"}}),r)},31409:function(t,o,i){i.d(o,{x:function(){return c}});var r,a=i(84487),s=i(74788),u=i(57922),c=((r=function(){function t(n){e(this,t),this.plus=n}return n(t,[{key:"toJsonArray",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return new Promise(function(o){var i={};if(t.plus.load(),null!=e&&"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"!=e.type&&"application/vnd.ms-excel"!=e.type)return t.plus.alertError("Kh\xf4ng ph\u1ea3i file excel");var r=new FileReader;r.readAsBinaryString(e),r.onloadend=function(e){for(var r=a.read(e.target.result,{type:"binary",cellDates:!0,dateNF:"DD/MM/YYYY"}),s=r.SheetNames,u=0;u<s.length;u++){var c=s[u],l=a.utils.sheet_to_json(r.Sheets[c],{header:1,raw:n});i["".concat(c)]=t.convertJSon(l)}t.plus.loaded(),o(i)}})}},{key:"read",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return new Promise(function(o){var i=[];if(t.plus.load(),null!=e&&"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"!=e.type&&"application/vnd.ms-excel"!=e.type)return t.plus.alertError("Kh\xf4ng ph\u1ea3i file excel");var r=new FileReader;r.readAsBinaryString(e),r.onloadend=function(e){for(var r=a.read(e.target.result,{type:"binary",cellDates:!0,dateNF:"DD/MM/YYYY"}),s=r.SheetNames,u=0;u<n;u++){var c=a.utils.sheet_to_json(r.Sheets[s[u]],{header:1});i.push(c)}t.plus.loaded(),o(i)}})}},{key:"convertJSon",value:function(e){for(var t=[],n=function(n){var o={};e[0].forEach(function(t,i){o["".concat(t)]=e[n][i]}),t.push(o)},o=1;o<e.length;o++)n(o);return t}},{key:"convertJSonByX",value:function(e){for(var t=[],n=function(n){if("x"==e[n][0]){var o={};e[0].forEach(function(t,i){o["".concat(t)]=e[n][i]}),t.push(o)}},o=1;o<e.length;o++)n(o);return t}},{key:"readXlsxToMerge",value:function(e){var t=this;return console.log(e),new Promise(function(n,o){t.plus.load();var i={};if(null!=e&&"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"!=e.type&&"application/vnd.ms-excel"!=e.type)return t.plus.alertError("Kh\xf4ng ph\u1ea3i file excel");var r=new FileReader;r.readAsBinaryString(e),r.onloadend=function(e){for(var o=a.read(e.target.result,{type:"binary",cellDates:!0,dateNF:"DD/MM/YYYY"}),r=o.SheetNames,s=0;s<r.length;s++){var u=r[s];if("_Merge"==u)return t.plus.alertError("Vui l\xf2ng \u0111\u1ed5i t\xean sheet _Merge th\xe0nh t\xean kh\xe1c");var c=a.utils.sheet_to_json(o.Sheets[u],{header:1,raw:!0});i["".concat(0==s?"_Merge":u)]=t.convertJSonByX(c)}n(i),t.plus.loaded()}})}},{key:"export",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=a.utils.json_to_sheet(e,{skipHeader:!0,dateNF:"mm/dd/yyyy;@",cellDates:!0}),o=a.utils.book_new();a.utils.book_append_sheet(o,n,"ChuaImport"),a.writeFile(o,"4la-"+t+"-ChuaImport.xlsx")}},{key:"exportTar",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=0;n<e.length;n++)delete e[n].dateModify,delete e[n].canEdit,delete e[n].keyWord,delete e[n].__v,delete e[n]._id;var o=JSON.stringify(e),i="data:application/json;charset=utf-8,"+encodeURIComponent(o);console.log(i);var r="4la-".concat(t||"")+Date.now()+".tar",a=document.createElement("a");a.setAttribute("href",i),a.setAttribute("download",r),a.click()}}]),t}()).\u0275fac=function(e){return new(e||r)(s.LFG(u.T))},r.\u0275prov=s.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r)},97855:function(t,o,i){i.r(o),i.d(o,{XangDauModule:function(){return N}});var r,a=i(88817),s=i(12057),u=i(74788),c=i(57922),l=i(31409),h=i(24751),d=i(9157),p=i(51511),f=((r=function(){function t(n,o,i,r){e(this,t),this.plus=n,this.excel=o,this.fb=i,this.docx=r}return n(t,[{key:"ngOnInit",value:function(){}},{key:"onDrop",value:function(e){}},{key:"ondragover",value:function(){document.getElementById("dropZone").setAttribute("drop-active","true")}}]),t}()).\u0275fac=function(e){return new(e||r)(u.Y36(c.T),u.Y36(l.x),u.Y36(h.qu),u.Y36(d.E))},r.\u0275cmp=u.Xpm({type:r,selectors:[["app-van-chuyen"]],decls:1,vars:0,consts:[[3,"files","ondragover"]],template:function(e,t){1&e&&(u.TgZ(0,"app-drop-files",0),u.NdJ("files",function(e){return t.onDrop(e)})("ondragover",function(){return t.ondragover()}),u.qZA())},directives:[p.k],styles:[""]}),r),g=i(16738),v=i.n(g),y=i(7365),m=i(46833),D=i(46113),T=i(2895),k=i(49356),b=function(e,t,n,o){return new(n||(n=Promise))(function(i,r){function a(e){try{u(o.next(e))}catch(t){r(t)}}function s(e){try{u(o.throw(e))}catch(t){r(t)}}function u(e){e.done?i(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(a,s)}u((o=o.apply(e,t||[])).next())})};function x(e,t){if(1&e){var n=u.EpF();u.TgZ(0,"button",7),u.NdJ("click",function(){return u.CHM(n),u.oxw().onGeneBill()}),u._uU(1,"Thanh to\xe1n"),u.qZA()}}function w(e,t){if(1&e){var n=u.EpF();u.TgZ(0,"button",7),u.NdJ("click",function(){return u.CHM(n),u.oxw().geneSupply()}),u._uU(1,"C\u1ea5p h\xe0ng"),u.qZA()}}var Z=function(){var t=function(){function t(n,o,i){e(this,t),this.plus=n,this.excel=o,this.docx=i,this.items=null,this.wordFileTT=null,this.wordFileCH=null,this.DieuPhoi=[],this.taixe=1,this.Cty="",this.vat=10,this.dataInXls=null,this.startMonth=v()(new Date).startOf("month").subtract(1,"months").toDate(),this.startDay=null,this.endDay=null}return n(t,[{key:"ngOnInit",value:function(){this.getMonth(this.startMonth),this.getWordFile()}},{key:"getWordFile",value:function(){var e=this;this.docx.loadFileUrl("https://thuctd.github.io/templates/ThanhToan.docx").then(function(t){return b(e,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.wordFileTT=t;case 1:case"end":return e.stop()}},e,this)}))}),this.docx.loadFileUrl("https://thuctd.github.io/templates/CapHang.docx").then(function(t){return b(e,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.wordFileCH=t;case 1:case"end":return e.stop()}},e,this)}))})}},{key:"getMonth",value:function(e){this.startDay=v()(e).startOf("month").subtract(1,"minutes").toDate(),this.endDay=v()(e).endOf("month").subtract(1,"minutes").toDate(),this.init()}},{key:"onDropNew",value:function(e){for(var t=this,n=0;n<e.length;n++)console.log(e[n].type),"application/vnd.openxmlformats-officedocument.wordprocessingml.document"==e[n].type?function(){var o=new FileReader;o.readAsArrayBuffer(e[n]),o.onloadend=function(){return t.wordFileTT=o.result},o.onloadend=function(){return t.wordFileCH=o.result}}():"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"==e[n].type?this.excel.toJsonArray(e[n]).then(function(e){t.dataInXls=e}):this.plus.alertError("File kh\xf4ng h\u1ee3p l\u1ec7")}},{key:"onGeneBill",value:function(){for(var e=this.dataInXls.Merge,t=0;t<e.length;t++){var n=e[t];this.items=n,this.items.TongSL=0,this.items.TongTT=0,this.items.NgayBC=v()(this.endDay).add(1,"days").toDate(),this.items.TuNgay=this.startDay,this.items.VAT=this.vat,this.Cty=this.plus.removeAccents(n.NhaVC),"TX"==n.PhanLoai?this.getByDriver():"NCC"==n.PhanLoai&&this.getByCompany()}}},{key:"getByDriver",value:function(){return b(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,n,o,i,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(t=this.dataInXls,n=[],o=0;o<t.Data.length;o++)i=t.Data[o],r=i.NgayGiaoHang,v()(r).add(1,"days").toDate().getDate(),r>=this.startDay&&r<=this.endDay&&this.plus.removeAccents(i.NVGiaoHang)==this.Cty&&(n.push(i),this.items.TongSL+=i.SoLuong,this.items.TongTT+=i.ThanhTien);return this.items.Data=n,this.items.Thue=Math.round(this.items.TongTT*this.vat/100),this.items.TongVAT=Math.round(this.items.Thue+this.items.TongTT),e.next=7,this.geneBill();case 7:case"end":return e.stop()}},e,this)}))}},{key:"getByCompany",value:function(){for(var e=this.dataInXls,t=[],n=0;n<e.Data.length;n++){var o=e.Data[n],i=o.NgayGiaoHang;v()(i).add(1,"days").toDate().getDate(),i>=this.startDay&&i<=this.endDay&&this.plus.removeAccents(o.NhaVC)==this.Cty&&(t.push(o),this.items.TongSL+=o.SoLuong,this.items.TongTT+=o.ThanhTien)}this.items.Data=t,this.items.Thue=Math.round(this.items.TongTT*this.vat/100),this.items.TongVAT=Math.round(this.items.Thue+this.items.TongTT),this.geneBill()}},{key:"geneSupply",value:function(){var e=this;this.onGeneSupply(),this.docx.loadFileUrl("https://thuctd.github.io/templates/CapHang.docx").then(function(t){return b(e,void 0,void 0,regeneratorRuntime.mark(function e(){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=1;case 1:if(!(n<this.DieuPhoi.length)){e.next=8;break}return this.docx.generateOne(this.DieuPhoi[n],t,"Ngay ".concat(this.DieuPhoi[n].NgayGiaoHang.slice(0,2))),e.next=5,this.plus.sleep(1e3).then(function(e){});case 5:n++,e.next=1;break;case 8:this.reload();case 9:case"end":return e.stop()}},e,this)}))})}},{key:"geneBill",value:function(){this.docx.generateOne(this.items,this.wordFileTT,this.Cty+"-"+this.vat).then(function(e){console.log(e)})}},{key:"onGeneSupply",value:function(){for(var e=this.dataInXls,t=[],n=0;n<e.Data.length;n++){var o=e.Data[n],i=o.NgayGiaoHang,r=v()(i).add(1,"days").toDate().getDate();i>=this.startDay&&i<=this.endDay&&this.plus.removeAccents(o.NhaVC)==this.Cty&&t.push(o),this.checkByCustommer(o,i,r)}}},{key:"checkByCustommer",value:function(e,t,n){var o=this.plus.removeAccents(e.TenKH);if(t>=this.startDay&&this.startDay<=this.endDay)switch(o){case"an binh":this.DieuPhoi[n].AnBinh.push(e);break;case"tan bien":this.DieuPhoi[n].TanBien.push(e);break;case"long phuoc":this.DieuPhoi[n].LongPhuoc.push(e);break;case"trang bom":this.DieuPhoi[n].TrangBom.push(e);break;case"trang dai":this.DieuPhoi[n].TrangDai.push(e);break;case"so 2":this.DieuPhoi[n].So2.push(e);break;case"phu binh":this.DieuPhoi[n].PhuBinh.push(e);break;case"nui le":this.DieuPhoi[n].NuiLe.push(e);break;case"hung nghia":this.DieuPhoi[n].HungNghia.push(e);break;case"dau giay":this.DieuPhoi[n].DauGiay.push(e)}}},{key:"init",value:function(){for(var e=1;e<32;e++){var t=v()(this.startDay).add(e,"days").toDate();this.DieuPhoi[e]={NgayLap:v()(t).subtract(1,"days").format("DD/MM/YYYY"),NgayGiaoHang:v()(t).format("DD/MM/YYYY"),AnBinh:[],TanBien:[],LongPhuoc:[],TrangBom:[],TrangDai:[],So2:[],PhuBinh:[],NuiLe:[],HungNghia:[],DauGiay:[]}}}},{key:"reload",value:function(){this.plus.reload("xang-dau/dieu-phoi")}},{key:"ondragover",value:function(){document.getElementById("dropZone").setAttribute("drop-active","true")}}]),t}();return t.\u0275fac=function(e){return new(e||t)(u.Y36(c.T),u.Y36(l.x),u.Y36(d.E))},t.\u0275cmp=u.Xpm({type:t,selectors:[["app-dieu-phoi"]],decls:11,vars:5,consts:[[1,"container","py-3"],[3,"startDay","month"],["matInput","","placeholder","Thu\u1ebf GTGT (%)",3,"ngModel","ngModelChange"],[3,"label","files","ondragover"],[1,"row","justify-content-center"],["mat-raised-button","","color","primary",3,"click"],["mat-raised-button","","color","warn",3,"click",4,"ngIf"],["mat-raised-button","","color","warn",3,"click"]],template:function(e,t){1&e&&(u.TgZ(0,"div",0),u.TgZ(1,"app-month-year",1),u.NdJ("month",function(e){return t.getMonth(e)}),u.qZA(),u.TgZ(2,"mat-form-field"),u.TgZ(3,"input",2),u.NdJ("ngModelChange",function(e){return t.vat=e}),u.qZA(),u.qZA(),u.TgZ(4,"app-drop-files",3),u.NdJ("files",function(e){return t.onDropNew(e)})("ondragover",function(){return t.ondragover()}),u.qZA(),u.TgZ(5,"div",4),u.TgZ(6,"button",5),u.NdJ("click",function(){return t.reload()}),u.TgZ(7,"mat-icon"),u._uU(8,"refresh"),u.qZA(),u.qZA(),u.YNc(9,x,2,0,"button",6),u.YNc(10,w,2,0,"button",6),u.qZA(),u.qZA()),2&e&&(u.xp6(1),u.Q6J("startDay",t.startMonth),u.xp6(2),u.Q6J("ngModel",t.vat),u.xp6(1),u.Q6J("label",""),u.xp6(5),u.Q6J("ngIf",t.dataInXls),u.xp6(1),u.Q6J("ngIf",t.dataInXls))},directives:[y.k,m.KE,D.Nt,h.Fj,h.JJ,h.On,p.k,T.lW,k.Hw,s.O5],styles:["#dropZone[_ngcontent-%COMP%]{position:absolute;top:20%;left:10%;width:80%;height:150px;border-radius:3%;border:solid}#dropZone[drop-active=true][_ngcontent-%COMP%]{box-shadow:inset 0 0 0 2px #00c;border:2px dashed rgb(38,16,165);background-color:#c9eccb}.x[_ngcontent-%COMP%]{border:solid;width:300px;height:200px}th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{text-align:right}"]}),t}(),A=i(33982),B=[{path:"",component:function(){var t=function(){function t(){e(this,t)}return n(t,[{key:"ngOnInit",value:function(){}}]),t}();return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=u.Xpm({type:t,selectors:[["app-xang-dau"]],decls:2,vars:0,template:function(e,t){1&e&&(u.TgZ(0,"p"),u._uU(1,"xang-dau works!"),u.qZA())},styles:[""]}),t}()},{path:"dieu-phoi",component:Z},{path:"van-chuyen",component:f}],C=function(){var t=function t(){e(this,t)};return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=u.oAB({type:t}),t.\u0275inj=u.cJS({imports:[[A.Bz.forChild(B)],A.Bz]}),t}(),M=i(5923),N=function(){var t=function t(){e(this,t)};return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=u.oAB({type:t}),t.\u0275inj=u.cJS({imports:[[s.ez,C,a.ShareModule,M.X]]}),t}()}}])}();