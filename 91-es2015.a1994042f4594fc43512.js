(self.webpackChunk_4la=self.webpackChunk_4la||[]).push([[91],{49091:function(t,e,i){"use strict";i.r(e),i.d(e,{VehicleModule:function(){return qt}});var n=i(61511),o=i(82393),s=i(31572),r=i(29063);let l=(()=>{class t{constructor(t,e){this.http=t,this.plus=e,this.httpOptions=this.plus.getHeader(),this.apiUrl=this.plus.getApiUrl("settlement/"),this.collection="settlement"}get(){return this.http.get(this.apiUrl,this.httpOptions)}getByMonth(t){return this.http.get(this.apiUrl+"getByMonth/"+t,this.httpOptions)}getByIdMonth(t,e){return console.log(t,e),this.http.get(this.apiUrl+"id/"+t+"/month/"+e,this.httpOptions)}create(t){return this.http.post(this.apiUrl,t,this.httpOptions)}update(t){return this.http.put(this.apiUrl,t,this.httpOptions)}delete(t){return this.http.delete(this.apiUrl+t,this.httpOptions)}find(t){return this.http.post(this.apiUrl+"/find",t,this.httpOptions)}}return t.\u0275fac=function(e){return new(e||t)(s.LFG(r.eN),s.LFG(o.T))},t.\u0275prov=s.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),a=(()=>{class t{constructor(t,e){this.http=t,this.plus=e,this.httpOptions=this.plus.getHeader(),this.apiUrl=this.plus.getApiUrl("vehicle/"),this.collection="vehicle"}get(){return this.http.get(this.apiUrl,this.httpOptions)}getByStatus(){return this.http.get(this.apiUrl,this.httpOptions)}getForOrder(){return this.http.get(this.apiUrl+"order",this.httpOptions)}create(t){return this.http.post(this.apiUrl,t,this.httpOptions)}update(t){return this.http.put(this.apiUrl,t,this.httpOptions)}delete(t){return this.http.delete(this.apiUrl+t,this.httpOptions)}find(t){return this.http.post(this.apiUrl+"/find",t,this.httpOptions)}}return t.\u0275fac=function(e){return new(e||t)(s.LFG(r.eN),s.LFG(o.T))},t.\u0275prov=s.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var c=i(16073),h=i(47701),d=i(31153);function u(t,e){1&t&&(s.TgZ(0,"div",8),s._UZ(1,"i",9),s.qZA())}function g(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"tbody"),s.TgZ(1,"tr"),s.TgZ(2,"td",16),s.NdJ("click",function(){const e=s.CHM(t).$implicit;return s.oxw(2).log(e)}),s._uU(3),s.qZA(),s.TgZ(4,"td"),s._uU(5),s.qZA(),s.TgZ(6,"td"),s._uU(7),s.ALo(8,"number"),s.qZA(),s.TgZ(9,"td"),s._uU(10),s.ALo(11,"number"),s.qZA(),s.TgZ(12,"td"),s.TgZ(13,"button",17),s.NdJ("click",function(){const e=s.CHM(t).$implicit;return s.oxw(2).delSettlement(e._id)}),s._UZ(14,"i",18),s.qZA(),s.qZA(),s.qZA(),s.qZA()}if(2&t){const t=e.$implicit;s.xp6(3),s.Oqu(t.vehicleId.label),s.xp6(2),s.Oqu(t.vehicleId.fuel),s.xp6(2),s.Oqu(s.lcZ(8,4,t.used)),s.xp6(3),s.Oqu(s.lcZ(11,6,t.fuelAdvance))}}function p(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"div",10),s.TgZ(1,"h4",11),s._uU(2,"B\u1ea2NG QUY\u1ebeT TO\xc1N NHI\xcaN LI\u1ec6U "),s.TgZ(3,"i",12),s.NdJ("click",function(){return s.CHM(t),s.oxw().download()}),s.qZA(),s.qZA(),s.TgZ(4,"table",13),s.TgZ(5,"thead",14),s.TgZ(6,"tr"),s.TgZ(7,"th"),s._uU(8,"Bi\u1ec3n s\u1ed1 xe"),s.qZA(),s.TgZ(9,"th"),s._uU(10,"Nhi\xean li\u1ec7u s\u1eed d\u1ee5ng"),s.qZA(),s.TgZ(11,"th"),s._uU(12,"S\u1ed1 Km ch\u1ed1t"),s.qZA(),s.TgZ(13,"th"),s._uU(14,"Nhi\xean li\u1ec7u t\u1ea1m \u1ee9ng"),s.qZA(),s._UZ(15,"th"),s.qZA(),s.qZA(),s.YNc(16,g,15,8,"tbody",15),s.qZA(),s.qZA()}if(2&t){const t=s.oxw();s.xp6(16),s.Q6J("ngForOf",t.vehiclesCheck)}}function Z(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"tr"),s.TgZ(1,"td",16),s.NdJ("click",function(){const e=s.CHM(t).$implicit;return s.oxw(2).log(e)}),s._uU(2),s.qZA(),s.TgZ(3,"td"),s._uU(4),s.qZA(),s.TgZ(5,"td"),s._uU(6),s.qZA(),s.TgZ(7,"td"),s.TgZ(8,"button",22),s.NdJ("click",function(){const e=s.CHM(t).$implicit;return s.oxw(2).selectItem(e)}),s._uU(9,"Ch\u1ed1t km"),s.qZA(),s.qZA(),s.qZA()}if(2&t){const t=e.$implicit;s.xp6(2),s.Oqu(t.label),s.xp6(2),s.Oqu(t.brand),s.xp6(2),s.Oqu(t.manager.fullName||t.manager.displayName)}}function m(t,e){if(1&t&&(s.TgZ(0,"div",10),s.TgZ(1,"H4",19),s._uU(2,"DANH S\xc1CH CH\u01afA CH\u1ed0T KM"),s.qZA(),s.TgZ(3,"table",20),s.TgZ(4,"thead",21),s.TgZ(5,"tr"),s.TgZ(6,"th"),s._uU(7,"Bi\u1ec3n s\u1ed1"),s.qZA(),s.TgZ(8,"th"),s._uU(9,"Hi\u1ec7u xe"),s.qZA(),s.TgZ(10,"th"),s._uU(11,"Ng\u01b0\u1eddi qu\u1ea3n l\xfd"),s.qZA(),s._UZ(12,"th"),s.qZA(),s.qZA(),s.TgZ(13,"tbody"),s.YNc(14,Z,10,3,"tr",15),s.qZA(),s.qZA(),s.qZA()),2&t){const t=s.oxw();s.xp6(14),s.Q6J("ngForOf",t.vehiclesFilter)}}function f(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"div"),s.TgZ(1,"h6"),s._uU(2,"S\u1ed1 gi\u1edd c\u1ea9u "),s.qZA(),s.TgZ(3,"input",40),s.NdJ("input",function(){return s.CHM(t),s.oxw(2).used()}),s.qZA(),s.qZA()}}function q(t,e){if(1&t&&(s.TgZ(0,"div",41),s.TgZ(1,"h6"),s._uU(2,"S\u1ed1 km th\xe1ng tr\u01b0\u1edbc: "),s.TgZ(3,"span",42),s._uU(4),s.ALo(5,"number"),s.qZA(),s.qZA(),s._UZ(6,"hr"),s.TgZ(7,"h6"),s._uU(8),s.qZA(),s._UZ(9,"hr"),s.TgZ(10,"h6"),s._uU(11),s.ALo(12,"number"),s.qZA(),s.qZA()),2&t){const t=s.oxw(2);s.xp6(4),s.hij("",s.lcZ(5,3,t.itemSelected.preUsed)," "),s.xp6(4),s.hij("S\u1ed1 km th\u1ef1c hi\u1ec7n trong th\xe1ng: ",t.newUsed-t.itemSelected.preUsed||"Ch\u01b0a c\xf3 s\u1ed1 li\u1ec7u",""),s.xp6(3),s.hij("T\u1ed5ng s\u1ed1 nhi\xean li\u1ec7u \u0111\u01b0\u1ee3c c\u1ea5p: ",s.xi3(12,5,(t.newUsed-t.itemSelected.preUsed)*t.itemSelected.quota/100+(t.timeCrane*t.itemSelected.quotaCrane||0),"0.0-1")," l\xedt")}}function b(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"div",23),s.TgZ(1,"div",24),s.TgZ(2,"div",25),s.TgZ(3,"div",26),s.TgZ(4,"h5",27),s._uU(5),s.qZA(),s.TgZ(6,"button",28),s.TgZ(7,"span",29),s._uU(8,"\xd7"),s.qZA(),s.qZA(),s.qZA(),s.TgZ(9,"div",30),s.TgZ(10,"form",31),s.TgZ(11,"div",32),s.TgZ(12,"h6"),s._uU(13,"S\u1ed1 km:"),s.qZA(),s.TgZ(14,"input",33),s.NdJ("input",function(){return s.CHM(t),s.oxw().used()}),s.qZA(),s.YNc(15,f,4,0,"div",34),s.TgZ(16,"h6"),s._uU(17,"S\u1ed1 nhi\xean li\u1ec7u \u0111\xe3 t\u1ea1m \u1ee9ng "),s.qZA(),s._UZ(18,"input",35),s._UZ(19,"hr"),s.YNc(20,q,13,8,"div",36),s.qZA(),s.qZA(),s.qZA(),s.TgZ(21,"div",37),s.TgZ(22,"button",38),s.NdJ("click",function(){return s.CHM(t),s.oxw().resetModal()}),s._uU(23,"H\u1ee7y"),s.qZA(),s.TgZ(24,"button",39),s.NdJ("click",function(){return s.CHM(t),s.oxw().submit()}),s._uU(25,"L\u01b0u"),s.qZA(),s.qZA(),s.qZA(),s.qZA(),s.qZA()}if(2&t){const t=s.oxw();s.xp6(5),s.AsE("Ch\u1ed1t s\u1ed1 km xe ",t.itemSelected.brand," - ",t.itemSelected.label,""),s.xp6(5),s.Q6J("formGroup",t.main),s.xp6(5),s.Q6J("ngIf",t.itemSelected.quotaCrane>0),s.xp6(5),s.Q6J("ngIf",t.newUsed>0||t.timeCrane>0),s.xp6(4),s.Q6J("disabled",!t.main.valid)}}let T=(()=>{class t{constructor(t,e,i,n){this.fb=t,this.plus=e,this.vehicleService=i,this.settlementService=n,this.api="settlement/",this.vehicles=[],this.vehiclesFilter=[],this.vehiclesCheck=[],this.loading=!0,this.loadMoreBtn=!1,this.today=this.plus.dateYMD((new Date).toISOString()),this.newUsed=0,this.timeCrane=0,this.data=[[1,2],[3,4]],this.wopts={bookType:"xlsx",type:"array"},this.fileName="SheetJS.xlsx",this.month=null,this.main=this.fb.group({preUsed:[,[c.kI.required]],used:[,[c.kI.required]],timeCrane:[0,[c.kI.max(255)]],fuelAdvance:[0,[]],quotaSet:[,[c.kI.required]]}),this.search=this.fb.group({what:["",[c.kI.minLength(3),c.kI.maxLength(100)]]}),this.dateForm=this.fb.group({date:[this.today,[c.kI.required]]})}ngOnInit(){this.getVehicles()}getVehicles(){this.vehicleService.get().subscribe(t=>{t?(this.vehicles=t,this.getVehiclesCheck()):this.plus.alertToasrt({war:"Vui l\xf2ng th\u1eed l\u1ea1i sau v\xe0i ph\xfat"})}),this.loading=!1}getVehiclesCheck(){this.loading=!0;const t=this.dateForm.value.date.slice(0,7);this.month=t,console.log(t),this.plus.httpGet(this.api+"getByMonth/"+t).subscribe(t=>{console.log(t),this.plus.alertToasrt(t),t?(this.vehiclesCheck=t,this.vehiclesFilter=this.plus.compareObj(this.vehicles,t),console.log(this.vehiclesFilter)):this.plus.alertToasrt({err:"L\u1ed7i k\u1ebft n\u1ed1i"}),console.log(this.vehiclesCheck),this.loading=!1})}selectItem(t){console.log(t),this.itemSelected=t,this.main.controls.quotaSet.setValue(t.quota),this.main.controls.timeCrane.setValue(0),this.main.controls.fuelAdvance.setValue(0);const e=this.dateForm.get("date").value;this.plus.httpGet(this.api+"id/"+t._id+"/month/"+e).subscribe(t=>{console.log(t),t.length>0?(this.main.controls.preUsed.setValue(t[0].used),this.itemSelected.preUsed=t[0].used):(this.plus.alertToasrt({war:"B\u1ea1n ch\u01b0a ch\u1ed1t s\u1ed1 th\xe1ng tr\u01b0\u1edbc!"}),this.main.controls.preUsed.setValue(0),this.itemSelected.preUsed=0)}),console.log(this.itemSelected)}submit(){const t=this.main.value;t.month=this.dateForm.value.date.slice(0,7),t.vehicleId=this.itemSelected._id;const e=this.plus.generateData(t);console.log("SUBMIT -> ",e),this.plus.httpPost(this.api,e).subscribe(t=>{this.plus.alertToasrt(t),this.ngOnInit(),this.resetModal()})}resetModal(){this.plus.clickBtn("closeModal"),this.itemSelected=null,this.newUsed=0,this.main.reset()}delSettlement(t){confirm("Xo\xe1 m\u1ee5c n\xe0y?")?(this.loading=!0,console.log(t),this.plus.httpDelete(this.api,t).subscribe(t=>{this.plus.alertToasrt(t),this.ngOnInit()})):this.plus.alertToasrt({war:"\u0110\xe3 h\u1ee7y"})}find(){this.search.valid&&this.search.valueChanges.pipe((0,h.b)(2e3)).subscribe(t=>{console.log(t),this.loading=!0,t.what=this.plus.removeAccents(t.what),this.vehicleService.find(t).subscribe(t=>{t.length>0&&(this.vehicles=t.sort((t,e)=>t.dateModify-e.dateModify)),this.loadMoreBtn=!0,this.loading=!1})})}loadMore(){this.loading=!0;const t=Math.ceil(this.vehicles.length/10)+1,e=this.search.value;e.what=this.plus.removeAccents(e.what),e.page=t,this.vehicleService.find(e).subscribe(t=>{t.length>0?t.forEach(t=>{this.vehicles.push(t)}):(this.plus.alertToasrt({msg:"Kh\xf4ng c\xf2n k\u1ebft qu\u1ea3 ph\xf9 h\u1ee3p \n Nh\u1eadp n\u1ed9i dung c\u1ea7n t\xecm c\u1ee5 th\u1ec3 h\u01a1n"}),this.loadMoreBtn=!1),this.loading=!1})}toYM(t){return t.slice(0,6)}used(){this.newUsed=this.main.get("used").value,this.timeCrane=this.main.get("timeCrane").value}log(t){return console.log(t)}download(){const t=JSON.parse(localStorage.getItem("usrInfo"));t.unit&&t.fullName||this.plus.alertToasrt({err:"B\u1ea1n c\u1ea7n khai b\xe1o th\xeam th\xf4ng tin t\xe0i kho\u1ea3n c\u1ee7a b\u1ea1n"})}export(){this.vehicles.push("asdasasdas");const t=d.utils.table_to_sheet("settlement");console.log(t);const e=d.utils.book_new();d.utils.book_append_sheet(e,t,"Sheet1"),d.writeFile(e,this.fileName)}}return t.\u0275fac=function(e){return new(e||t)(s.Y36(c.qu),s.Y36(o.T),s.Y36(a),s.Y36(l))},t.\u0275cmp=s.Xpm({type:t,selectors:[["app-settlement"]],decls:10,vars:5,consts:[[1,"container"],[1,"form-group",3,"formGroup"],["for",""],["type","date","formControlName","date",1,"form-control",3,"change"],["class","text-center text-primary",4,"ngIf"],[1,"row"],["class","col",4,"ngIf"],["class","modal fade","id","modelId","tabindex","-1","role","dialog","aria-labelledby","modelTitleId","aria-hidden","true",4,"ngIf"],[1,"text-center","text-primary"],[1,"fa","fa-spinner","fa-spin",2,"font-size","36px"],[1,"col"],[1,"text-center","text-success","py-2"],["aria-hidden","true",1,"fa","fa-download","text-primary",3,"click"],["id","settlement",1,"table","table-hover"],[1,"thead-default"],[4,"ngFor","ngForOf"],[3,"click"],["type","button",1,"btn","btn-danger",3,"click"],[1,"fa","fa-trash"],[1,"text-center","text-warning","py-2"],[1,"table","table-hover"],[1,"thead-inverse"],["type","button","data-toggle","modal","data-target","#modelId",1,"btn","btn-primary",3,"click"],["id","modelId","tabindex","-1","role","dialog","aria-labelledby","modelTitleId","aria-hidden","true",1,"modal","fade"],["role","document",1,"modal-dialog"],[1,"modal-content"],[1,"modal-header","bg-primary"],[1,"modal-title"],["type","button","data-dismiss","modal","aria-label","Close",1,"close"],["aria-hidden","true"],[1,"modal-body"],[3,"formGroup"],[1,"form-group"],["type","number","placeholder","Nh\u1eadp s\u1ed1 km ch\u1ed1t trong th\xe1ng","formControlName","used",1,"form-control",3,"input"],[4,"ngIf"],["type","number","placeholder","Nh\u1eadp s\u1ed1 l\xedt nhi\xean li\u1ec7u \u0111\xe3 t\u1ea1m \u1ee9ng","formControlName","fuelAdvance",1,"form-control"],["class","calculator",4,"ngIf"],[1,"modal-footer"],["type","button","id","closeModal","data-dismiss","modal",1,"btn","btn-secondary",3,"click"],["type","button","data-dismiss","modal",1,"btn","btn-primary",3,"disabled","click"],["type","number","placeholder","Nh\u1eadp s\u1ed1 l\xedt nhi\xean li\u1ec7u \u0111\xe3 t\u1ea1m \u1ee9ng","formControlName","timeCrane",1,"form-control",3,"input"],[1,"calculator"],[1,"text-danger","font-weight-bold"]],template:function(t,e){1&t&&(s.TgZ(0,"div",0),s.TgZ(1,"div",1),s._UZ(2,"label",2),s._uU(3,"Ch\u1ecdn th\xe1ng: "),s.TgZ(4,"input",3),s.NdJ("change",function(){return e.ngOnInit()}),s.qZA(),s.qZA(),s.YNc(5,u,2,0,"div",4),s.TgZ(6,"div",5),s.YNc(7,p,17,1,"div",6),s.YNc(8,m,15,1,"div",6),s.qZA(),s.qZA(),s.YNc(9,b,26,6,"div",7)),2&t&&(s.xp6(1),s.Q6J("formGroup",e.dateForm),s.xp6(4),s.Q6J("ngIf",e.loading),s.xp6(2),s.Q6J("ngIf",e.vehiclesCheck.length>0),s.xp6(1),s.Q6J("ngIf",e.vehiclesFilter.length>0),s.xp6(1),s.Q6J("ngIf",e.itemSelected))},directives:[c.JL,c.sg,c.Fj,c.JJ,c.u,n.O5,n.sg,c._Y,c.wV],pipes:[n.JJ],styles:[""]}),t})();var A=i(68591);let v=(()=>{class t{constructor(t,e){this.http=t,this.plus=e,this.httpOptions=this.plus.getHeader(),this.apiUrl=this.plus.getApiUrl("order/"),this.collection="order"}get(){return this.http.get(this.apiUrl,this.httpOptions)}create(t){return this.http.post(this.apiUrl,t,this.httpOptions)}update(t){return this.http.put(this.apiUrl,t,this.httpOptions)}updateContact(t){return this.http.put(this.apiUrl+"contacts",t,this.httpOptions)}delete(t){return this.http.delete(this.apiUrl+t,this.httpOptions)}find(t){return this.http.post(this.apiUrl+"find",t,this.httpOptions)}getByDate(t){return this.http.post(this.apiUrl+"orderDate",t,this.httpOptions)}wait(t){return this.http.post(this.apiUrl+"wait",t,this.httpOptions)}cancelWait(t){return this.http.delete(this.apiUrl+"wait/"+t,this.httpOptions)}}return t.\u0275fac=function(e){return new(e||t)(s.LFG(r.eN),s.LFG(o.T))},t.\u0275prov=s.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();class x{}function U(t,e){1&t&&(s.TgZ(0,"div",17),s._UZ(1,"i",18),s.qZA())}function y(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"button",20),s.NdJ("click",function(){s.CHM(t);const e=s.oxw().$implicit;return s.oxw(2).compOrder(e)}),s._uU(1," \u0110i gh\xe9p "),s.qZA()}}function _(t,e){if(1&t&&(s.TgZ(0,"tr"),s.TgZ(1,"td"),s._uU(2),s.qZA(),s.TgZ(3,"td"),s._uU(4),s.qZA(),s.TgZ(5,"td"),s._uU(6),s.qZA(),s.TgZ(7,"td"),s._uU(8),s.qZA(),s.TgZ(9,"td"),s._uU(10),s.qZA(),s.TgZ(11,"td"),s.YNc(12,y,2,0,"button",19),s.qZA(),s.qZA()),2&t){const t=e.$implicit;s.xp6(2),s.Oqu(t.vehicleId.type),s.xp6(2),s.Oqu(t.vehicleId.label),s.xp6(2),s.Oqu(t.how),s.xp6(2),s.Oqu(t.pointDes||"Xe \u0111ang \u0111\u01b0\u1ee3c ng\u01b0\u1eddi kh\xe1c \u0111\u0103ng k\xfd"),s.xp6(2),s.Oqu(1===t.orderStatus?"\u0110\xe3 duy\u1ec7t":"Ch\u1edd duy\u1ec7t"),s.xp6(2),s.Q6J("ngIf",0===t.orderStatus)}}function k(t,e){if(1&t&&(s.TgZ(0,"tbody"),s.YNc(1,_,13,6,"tr",15),s.qZA()),2&t){const t=s.oxw();s.xp6(1),s.Q6J("ngForOf",t.orderList)}}function I(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"tr"),s.TgZ(1,"td"),s._uU(2),s.qZA(),s.TgZ(3,"td"),s._uU(4),s.qZA(),s.TgZ(5,"td"),s.TgZ(6,"button",21),s.NdJ("click",function(){const e=s.CHM(t).$implicit;return s.oxw().order(e)}),s._uU(7," \u0110\u0103ng k\xfd "),s.qZA(),s.qZA(),s.qZA()}if(2&t){const t=e.$implicit,i=s.oxw();s.xp6(2),s.Oqu(t.label),s.xp6(2),s.Oqu(t.type),s.xp6(2),s.MGl("routerLink","/dangkyxe/token/",i.token,"")}}function w(t,e){if(1&t&&(s.TgZ(0,"h6"),s._uU(1),s.qZA()),2&t){const t=e.$implicit;s.xp6(1),s.Oqu(t)}}function N(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"h6"),s._uU(1),s.TgZ(2,"i",38),s.NdJ("click",function(){const e=s.CHM(t).index;return s.oxw(2).delContact(e)}),s.qZA(),s.qZA()}if(2&t){const t=e.$implicit;s.xp6(1),s.hij("",t," ")}}function C(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"div",22),s.TgZ(1,"div",23),s.TgZ(2,"div",24),s.TgZ(3,"div",25),s.TgZ(4,"h5",26),s._uU(5,"\u0110\u0102NG K\xdd \u0110I GH\xc9P"),s.qZA(),s.TgZ(6,"button",27),s.TgZ(7,"span",28),s._uU(8,"\xd7"),s.qZA(),s.qZA(),s.qZA(),s.TgZ(9,"div",29),s.TgZ(10,"div",0),s.TgZ(11,"div",6),s.TgZ(12,"div",12),s.TgZ(13,"h6"),s._uU(14,"S\u1ed1 ng\u01b0\u1eddi \u0111i:"),s.qZA(),s.qZA(),s.TgZ(15,"div",7),s.TgZ(16,"h6"),s._uU(17),s.qZA(),s.qZA(),s._UZ(18,"hr"),s.qZA(),s.TgZ(19,"div",6),s.TgZ(20,"div",12),s.TgZ(21,"h6"),s._uU(22,"C\xf4ng t\xe1c:"),s.qZA(),s.qZA(),s.TgZ(23,"div",7),s.TgZ(24,"h6"),s._uU(25),s.qZA(),s.qZA(),s._UZ(26,"hr"),s.qZA(),s.TgZ(27,"div",6),s.TgZ(28,"div",12),s.TgZ(29,"h6"),s._uU(30,"Gi\u1edd \u0111i:"),s.qZA(),s.qZA(),s.TgZ(31,"div",7),s.TgZ(32,"h6"),s._uU(33),s.qZA(),s.qZA(),s._UZ(34,"hr"),s.qZA(),s.TgZ(35,"div",6),s.TgZ(36,"div",12),s.TgZ(37,"h6"),s._uU(38,"Ng\xe0y \u0111i:"),s.qZA(),s.qZA(),s.TgZ(39,"div",7),s.TgZ(40,"h6"),s._uU(41),s.ALo(42,"date"),s.qZA(),s.qZA(),s._UZ(43,"hr"),s.qZA(),s.TgZ(44,"div",6),s.TgZ(45,"div",12),s.TgZ(46,"h6"),s._uU(47,"Gi\u1edd v\u1ec1:"),s.qZA(),s.qZA(),s.TgZ(48,"div",7),s.TgZ(49,"h6"),s._uU(50),s.qZA(),s.qZA(),s._UZ(51,"hr"),s.qZA(),s.TgZ(52,"div",6),s.TgZ(53,"div",12),s.TgZ(54,"h6"),s._uU(55,"Ng\xe0y v\u1ec1:"),s.qZA(),s.qZA(),s.TgZ(56,"div",7),s.TgZ(57,"h6"),s._uU(58),s.ALo(59,"date"),s.qZA(),s.qZA(),s._UZ(60,"hr"),s.qZA(),s.TgZ(61,"div",6),s.TgZ(62,"div",12),s.TgZ(63,"h6"),s._uU(64,"\u0110i\u1ec3m xu\u1ea5t ph\xe1t:"),s.qZA(),s.qZA(),s.TgZ(65,"div",7),s.TgZ(66,"h6"),s._uU(67),s.qZA(),s.qZA(),s._UZ(68,"hr"),s.qZA(),s.TgZ(69,"div",6),s.TgZ(70,"div",12),s.TgZ(71,"h6"),s._uU(72,"\u0110i\u1ec3m cu\u1ed1i:"),s.qZA(),s.qZA(),s.TgZ(73,"div",7),s.TgZ(74,"h6"),s._uU(75),s.qZA(),s.qZA(),s._UZ(76,"hr"),s.qZA(),s.TgZ(77,"div",6),s.TgZ(78,"div",12),s.TgZ(79,"h6"),s._uU(80,"Li\xean h\u1ec7:"),s.qZA(),s.qZA(),s.TgZ(81,"div",7),s.YNc(82,w,2,1,"h6",15),s.YNc(83,N,3,1,"h6",15),s.TgZ(84,"form",30),s._UZ(85,"input",31),s.TgZ(86,"button",32),s.NdJ("click",function(){return s.CHM(t),s.oxw().addContact()}),s._uU(87,"Th\xeam li\xean h\u1ec7"),s.qZA(),s.qZA(),s.qZA(),s.qZA(),s.qZA(),s.qZA(),s.TgZ(88,"div",33),s.TgZ(89,"button",34),s.NdJ("click",function(){return s.CHM(t),s.oxw().resetModal()}),s._UZ(90,"i",35),s.qZA(),s.TgZ(91,"button",36),s.NdJ("click",function(){return s.CHM(t),s.oxw().updateOrderContact()}),s._UZ(92,"i",37),s.qZA(),s.qZA(),s.qZA(),s.qZA(),s.qZA()}if(2&t){const t=s.oxw();s.xp6(17),s.hij("",t.orderSelected.how," ng\u01b0\u1eddi"),s.xp6(8),s.Oqu(t.orderSelected.todo),s.xp6(8),s.Oqu(t.orderSelected.timeGo),s.xp6(8),s.Oqu(s.xi3(42,12,t.orderSelected.dateGo,"dd/MM/yyyy")),s.xp6(9),s.Oqu(t.orderSelected.timeBack),s.xp6(8),s.Oqu(s.xi3(59,15,t.orderSelected.dayBack,"dd/MM/yyyy")),s.xp6(9),s.Oqu(t.orderSelected.pointGo),s.xp6(8),s.Oqu(t.orderSelected.pointDes),s.xp6(7),s.Q6J("ngForOf",t.orderSelected.contact),s.xp6(1),s.Q6J("ngForOf",t.contacts),s.xp6(1),s.Q6J("formGroup",t.contactForm),s.xp6(7),s.Q6J("disabled",0===t.contacts.length)}}let O=(()=>{class t{constructor(t,e,i,n){this.plus=t,this.orderSV=e,this.vehicleSV=i,this.fb=n,this.vehicles=[],this.vehiclesWait=[],this.orderList=[],this.loading=!0,this.loadMoreBtn=!1,this.contacts=[],this.api="order/",this.today=this.plus.dateYMD((new Date).toISOString()),this.token=(new Date).getTime()+18e4,this.search=this.fb.group({what:["",[c.kI.minLength(3),c.kI.maxLength(100)]]}),this.dateForm=this.fb.group({dateGo:[this.today,[c.kI.required,c.kI.minLength(10),c.kI.maxLength(10)]]}),this.contactForm=this.fb.group({pesonnel:["",c.kI.required]})}ngOnInit(){this.getVehicles()}find(){this.search.valueChanges.pipe((0,h.b)(1500)).subscribe(t=>{this.search.valid&&(t.what=this.plus.removeAccents(t.what),this.loading=!0,this.orderSV.find(t).subscribe(t=>{t.length>0&&(this.orderList=t.sort((t,e)=>t.dateModify-e.dateModify)),this.loadMoreBtn=!0,this.loading=!1}))})}getVehicles(){this.plus.httpGet("vehicle/order/").subscribe(t=>{t?(this.vehicles=t,this.getOrderDay(this.today)):this.plus.alertToasrt({war:"Vui l\xf2ng th\u1eed l\u1ea1i sau v\xe0i ph\xfat"})}),this.loading=!1}getOrders(){const t=this.dateForm.value;this.dateForm.valid&&(this.loading=!0,this.orderList=[],this.plus.httpPost("order/orderDate",t).subscribe(t=>{this.plus.alertToasrt(t),this.vehiclesWait=this.plus.compareObj(this.vehicles,t),this.loading=!1,this.orderList=t,this.delWait(t)}))}getOrderDay(t){this.plus.httpPost("order/orderDate",{dateGo:t}).subscribe(t=>{this.plus.alertToasrt(t),this.vehiclesWait=this.plus.compareObj(this.vehicles,t),this.loading=!1,this.orderList=t,this.delWait(t)})}loadMore(){this.loading=!0;const t=Math.ceil(this.orderList.length/10)+1,e=this.search.value;e.what=this.plus.removeAccents(e.what),e.page=t,this.orderSV.find(e).subscribe(t=>{t.length>0?t.forEach(t=>{this.orderList.push(t)}):(this.plus.alertToasrt({msg:"Kh\xf4ng c\xf2n k\u1ebft qu\u1ea3 ph\xf9 h\u1ee3p \n Nh\u1eadp n\u1ed9i dung c\u1ea7n t\xecm c\u1ee5 th\u1ec3 h\u01a1n"}),this.loadMoreBtn=!1),this.loading=!1})}resetModal(){this.contacts=[]}wait(t){this.orderSV.vehicle=t;const e=this.dateForm.value;this.orderSV.dateGo=e.dateGo,this.orderSV.wait({vehicleId:t._id,dateGo:e.dateGo}).subscribe(t=>this.plus.alertToasrt(t))}delWait(t){const e=Date.now();t.length>0&&t.forEach((t,i)=>{3===t.orderStatus&&t.canEdit-e<0&&this.plus.httpDelete("order/wait/",t._id).subscribe(t=>{t.id&&this.getOrders()})})}order(t){const e=this.dateForm.value;e.vehicle=t,e.token=this.token,console.log(e),localStorage.setItem("order",JSON.stringify(e))}compOrder(t){this.orderSelected=t}addContact(){this.contacts.push(this.contactForm.value.pesonnel),this.contactForm.reset()}delContact(t){this.contacts.splice(t,1)}updateOrderContact(){this.orderSelected.contact=this.contacts.concat(this.orderSelected.contact);const t=this.plus.addKeyWord(this.orderSelected),e=new x;e._id=this.orderSelected._id,e.contact=t.contact,e.keyWord=t.keyWord,this.orderSV.updateContact(e).subscribe(t=>{this.plus.alertToasrt(t),this.plus.clickBtn("closeModal")}),this.contacts=[]}}return t.\u0275fac=function(e){return new(e||t)(s.Y36(o.T),s.Y36(v),s.Y36(a),s.Y36(c.qu))},t.\u0275cmp=s.Xpm({type:t,selectors:[["app-order-list"]],decls:41,vars:5,consts:[[1,"container-fluid"],[1,"text-center","bg-warning","py-2","rounded"],[1,"form-group",3,"formGroup"],["for",""],["type","date","formControlName","dateGo",1,"form-control",3,"change"],["class","text-center text-primary",4,"ngIf"],[1,"row"],[1,"col-sm-8"],[1,"text-center","bg-info","py-2","rounded"],[1,"table","table-hover","table-inverse"],[1,"thead-inverse"],[4,"ngIf"],[1,"col-sm-4"],[1,"text-center","bg-success","py-2","rounded"],[1,"text-center"],[4,"ngFor","ngForOf"],["class","modal fade","id","modelId","tabindex","-1",4,"ngIf"],[1,"text-center","text-primary"],[1,"fa","fa-spinner","fa-spin",2,"font-size","36px"],["type","button","class","btn btn-outline-success mx-1","data-toggle","modal","data-target","#modelId",3,"click",4,"ngIf"],["type","button","data-toggle","modal","data-target","#modelId",1,"btn","btn-outline-success","mx-1",3,"click"],["type","button",1,"btn","btn-outline-success",3,"routerLink","click"],["id","modelId","tabindex","-1",1,"modal","fade"],["role","document",1,"modal-dialog","modal-lg"],[1,"modal-content"],[1,"modal-header","bg-primary","text-white"],[1,"modal-title"],["type","button","data-dismiss","modal","aria-label","Close",1,"close"],["aria-hidden","true"],[1,"modal-body"],[1,"contact",3,"formGroup"],["type","text","placeholder","H\u1ecd v\xe0 t\xean + s\u1ed1 \u0111i\u1ec7n tho\u1ea1i, N\u01a1i \u0111\xf3n ...","required","","formControlName","pesonnel",1,"form-control","mb-2"],[1,"btn","btn-outline-info","my-1",3,"click"],[1,"modal-footer"],["type","button","id","closeModal","data-dismiss","modal",1,"btn","btn-outline-danger","mx-2",3,"click"],[1,"fa","fa-times","text-danger"],["type","button",1,"btn","btn-outline-primary","mx-2",3,"disabled","click"],[1,"fa","fa-floppy-o"],[1,"fa","fa-trash","text-danger",3,"click"]],template:function(t,e){1&t&&(s.TgZ(0,"div",0),s.TgZ(1,"h4",1),s._uU(2,"\u0110\u0102NG K\xdd XE C\xd4NG T\xc1C"),s.qZA(),s.TgZ(3,"div",2),s._UZ(4,"label",3),s._uU(5,"Ch\u1ecdn ng\xe0y \u0111i: "),s.TgZ(6,"input",4),s.NdJ("change",function(){return e.getOrders()}),s.qZA(),s.qZA(),s.YNc(7,U,2,0,"div",5),s.TgZ(8,"div",6),s.TgZ(9,"div",7),s.TgZ(10,"h5",8),s._uU(11,"DANH S\xc1CH XE \u0110\xc3 \u0110\u0102NG K\xdd"),s.qZA(),s.TgZ(12,"table",9),s.TgZ(13,"thead",10),s.TgZ(14,"tr"),s.TgZ(15,"th"),s._uU(16,"Lo\u1ea1i xe"),s.qZA(),s.TgZ(17,"th"),s._uU(18,"Bi\u1ec3n s\u1ed1"),s.qZA(),s.TgZ(19,"th"),s._uU(20,"S\u1ed1 ng\u01b0\u1eddi \u0111i"),s.qZA(),s.TgZ(21,"th"),s._uU(22,"\u0110i\u1ec3m \u0111\u1ebfn"),s.qZA(),s.TgZ(23,"th"),s._uU(24,"Tr\u1ea1ng th\xe1i"),s.qZA(),s._UZ(25,"th"),s.qZA(),s.qZA(),s.YNc(26,k,2,1,"tbody",11),s.qZA(),s.qZA(),s.TgZ(27,"div",12),s.TgZ(28,"h5",13),s._uU(29,"DANH S\xc1CH XE CH\u1edc"),s.qZA(),s.TgZ(30,"table",9),s.TgZ(31,"thead",10),s.TgZ(32,"tr"),s.TgZ(33,"th"),s._uU(34,"Bi\u1ec3n s\u1ed1"),s.qZA(),s.TgZ(35,"th"),s._uU(36,"Lo\u1ea1i xe"),s.qZA(),s._UZ(37,"th",14),s.qZA(),s.qZA(),s.TgZ(38,"tbody"),s.YNc(39,I,8,3,"tr",15),s.qZA(),s.qZA(),s.qZA(),s.qZA(),s.YNc(40,C,93,18,"div",16),s.qZA()),2&t&&(s.xp6(3),s.Q6J("formGroup",e.dateForm),s.xp6(4),s.Q6J("ngIf",e.loading),s.xp6(19),s.Q6J("ngIf",e.orderList.length>0),s.xp6(13),s.Q6J("ngForOf",e.vehiclesWait),s.xp6(1),s.Q6J("ngIf",e.orderSelected))},directives:[c.JL,c.sg,c.Fj,c.JJ,c.u,n.O5,n.sg,A.rH,c._Y,c.Q7],pipes:[n.uU],styles:[""]}),t})();function J(t,e){1&t&&(s.TgZ(0,"div",7),s._UZ(1,"i",8),s.qZA())}function S(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"button",16),s.NdJ("click",function(){s.CHM(t);const e=s.oxw().$implicit;return s.oxw(2).onDelete(e)}),s._UZ(1,"i",17),s.qZA()}}function M(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"tr"),s.TgZ(1,"td"),s._uU(2),s.qZA(),s.TgZ(3,"td"),s._uU(4),s.ALo(5,"date"),s.qZA(),s.TgZ(6,"td"),s._uU(7),s.ALo(8,"date"),s.qZA(),s.TgZ(9,"td"),s._uU(10),s.qZA(),s.TgZ(11,"td",11),s.TgZ(12,"button",13),s.NdJ("click",function(){const e=s.CHM(t).$implicit;return s.oxw(2).download(e)}),s._UZ(13,"i",14),s.qZA(),s.YNc(14,S,2,0,"button",15),s.qZA(),s.qZA()}if(2&t){const t=e.$implicit;s.xp6(2),s.Oqu(t.todo),s.xp6(2),s.Oqu(s.xi3(5,5,t.dateGo,"dd/MM/yyyy")),s.xp6(3),s.Oqu(s.xi3(8,8,t.dayBack,"dd/MM/yyyy")),s.xp6(3),s.Oqu(t.pointDes),s.xp6(4),s.Q6J("ngIf",1!==t.orderStatus)}}function L(t,e){if(1&t&&(s.TgZ(0,"table",9),s.TgZ(1,"thead",10),s.TgZ(2,"tr"),s.TgZ(3,"th"),s._uU(4,"C\xf4ng t\xe1c"),s.qZA(),s.TgZ(5,"th"),s._uU(6,"Ng\xe0y \u0111i"),s.qZA(),s.TgZ(7,"th"),s._uU(8,"Ng\xe0y v\u1ec1"),s.qZA(),s.TgZ(9,"th"),s._uU(10,"\u0110i\u1ec3m c\xf4ng t\xe1c"),s.qZA(),s._UZ(11,"th",11),s.qZA(),s.qZA(),s.TgZ(12,"tbody"),s.YNc(13,M,15,11,"tr",12),s.qZA(),s.qZA()),2&t){const t=s.oxw();s.xp6(13),s.Q6J("ngForOf",t.datalist)}}function F(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"div",11),s.TgZ(1,"button",18),s.NdJ("click",function(){return s.CHM(t),s.oxw().loadMore()}),s._uU(2," K\u1ebft qu\u1ea3 kh\xe1c "),s.qZA(),s.qZA()}}const Y=function(t){return{loading:t}};let G=(()=>{class t{constructor(t,e,i,n){this.plus=t,this.DB=e,this.fb=i,this.vehicleSV=n,this.vehicles=[],this.loading=!0,this.search=this.fb.group({what:["",[c.kI.minLength(3),c.kI.maxLength(100)]]})}ngOnInit(){this.getOrders(),this.find()}getOrders(){this.DB.get().subscribe(t=>{this.loading=!1,this.datalist=t,this.plus.alertToasrt(t)})}getVehicles(){this.vehicleSV.get().subscribe(t=>{this.vehicles=t,this.plus.alertToasrt(t)})}find(){this.search.valid&&this.search.valueChanges.pipe((0,h.b)(1e3)).subscribe(t=>{t.what=this.plus.removeAccents(t.what),this.loading=!0,this.DB.find(t).subscribe(t=>{t.length>0?this.datalist=t.sort((t,e)=>t.dateModify-e.dateModify):this.plus.alertToasrt({msg:"Kh\xf4ng c\xf3 k\u1ebft qu\u1ea3 ph\xf9 h\u1ee3p!"}),this.loadMoreBtn=!0,this.loading=!1})})}loadMore(){this.loading=!0;const t=Math.ceil(this.datalist.length/10)+1,e=this.search.value;e.what=this.plus.removeAccents(e.what),e.page=t,this.DB.find(e).subscribe(t=>{t.length>0?t.forEach(t=>{this.datalist.push(t)}):(this.plus.alertToasrt({msg:"Kh\xf4ng c\xf2n k\u1ebft qu\u1ea3 ph\xf9 h\u1ee3p \n Nh\u1eadp n\u1ed9i dung c\u1ea7n t\xecm c\u1ee5 th\u1ec3 h\u01a1n"}),this.loadMoreBtn=!1),this.loading=!1})}onEdit(t){console.log(t)}onDelete(t){console.log(t),1===t.orderStatus?this.plus.alertToasrt({err:"Vui l\xf2ng kh\xf4ng th\u1ef1c hi\u1ec7n l\u1ea1i! T\xe0i kho\u1ea3n c\u1ee7a b\u1ea1n s\u1ebd b\u1ecb kho\xe1!"}):this.DB.delete(t._id).subscribe(t=>{this.plus.alertToasrt(t),this.getOrders()})}download(t){JSON.parse(localStorage.getItem("usrInfo")).unit||this.plus.alertToasrt({err:"B\u1ea1n c\u1ea7n khai b\xe1o th\xeam th\xf4ng tin t\xe0i kho\u1ea3n c\u1ee7a b\u1ea1n"}),console.log(t);const e=Object.assign({},t);e.dateGo=this.plus.dateToDMY(e.dateGo),e.dayBack=this.plus.dateToDMY(e.dayBack)}}return t.\u0275fac=function(e){return new(e||t)(s.Y36(o.T),s.Y36(v),s.Y36(c.qu),s.Y36(a))},t.\u0275cmp=s.Xpm({type:t,selectors:[["app-order-manager"]],decls:8,vars:7,consts:[[1,"container"],[1,"text-primary","text-center","bg-white","py-2","rounded"],[1,"form-group",3,"formGroup"],["list","students","type","text","formControlName","what","aria-describedby","helpId","placeholder","Nh\u1eadp th\xf4ng tin b\u1ea1n c\u1ea7n t\xecm","autocomplete","on",1,"form-control","text-danger",3,"ngClass"],["class","text-center text-primary",4,"ngIf"],["class","table table-hover table-inverse",4,"ngIf"],["class","text-center",4,"ngIf"],[1,"text-center","text-primary"],[1,"fa","fa-spinner","fa-spin",2,"font-size","36px"],[1,"table","table-hover","table-inverse"],[1,"thead-inverse"],[1,"text-center"],[4,"ngFor","ngForOf"],["type","button","data-toggle","modal","data-target","#modelId",1,"btn","btn-outline-primary","mx-1",3,"click"],["aria-hidden","true",1,"fa","fa-print","text-info"],["type","button","class","btn btn-outline-danger mx-1",3,"click",4,"ngIf"],["type","button",1,"btn","btn-outline-danger","mx-1",3,"click"],[1,"fa","fa-trash"],["type","button",1,"btn","btn-outline-primary",3,"click"]],template:function(t,e){1&t&&(s.TgZ(0,"div",0),s.TgZ(1,"h4",1),s._uU(2," DANH S\xc1CH XE \u0110\xc3 \u0110\u0102NG K\xdd "),s.qZA(),s.TgZ(3,"div",2),s._UZ(4,"input",3),s.qZA(),s.YNc(5,J,2,0,"div",4),s.YNc(6,L,14,1,"table",5),s.YNc(7,F,3,0,"div",6),s.qZA()),2&t&&(s.xp6(3),s.Q6J("formGroup",e.search),s.xp6(1),s.Q6J("ngClass",s.VKq(5,Y,e.loading)),s.xp6(1),s.Q6J("ngIf",e.loading),s.xp6(1),s.Q6J("ngIf",e.datalist),s.xp6(1),s.Q6J("ngIf",e.loadMoreBtn))},directives:[c.JL,c.sg,c.Fj,c.JJ,c.u,n.mk,n.O5,n.sg],pipes:[n.uU],styles:[""]}),t})(),D=(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=s.Xpm({type:t,selectors:[["app-vehicle"]],decls:2,vars:0,template:function(t,e){1&t&&(s.TgZ(0,"p"),s._uU(1,"vehicle !"),s.qZA())},styles:[""]}),t})();function B(t,e){if(1&t&&(s.TgZ(0,"h4",4),s._uU(1),s.qZA()),2&t){const t=s.oxw();s.xp6(1),s.AsE("Lo\u1ea1i xe: ",t.vehicle.type," - Bi\u1ec3n s\u1ed1: ",t.vehicle.label,"")}}function Q(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"div"),s.TgZ(1,"p"),s._uU(2),s.TgZ(3,"i",23),s.NdJ("click",function(){const e=s.CHM(t).index;return s.oxw().delContact(e)}),s.qZA(),s.qZA(),s.qZA()}if(2&t){const t=e.$implicit,i=e.index;s.xp6(2),s.AsE("",i+1,"./ ",t," ")}}function V(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"div",24),s.TgZ(1,"button",25),s.NdJ("click",function(){return s.CHM(t),s.oxw().submit()}),s._UZ(2,"i",26),s.qZA(),s.TgZ(3,"button",27),s.NdJ("click",function(){return s.CHM(t),s.oxw().back()}),s._UZ(4,"i",28),s.qZA(),s.qZA()}if(2&t){const t=s.oxw();s.xp6(1),s.Q6J("disabled",!t.main.valid||0===t.contact.length)}}function H(t,e){1&t&&s._UZ(0,"option",29),2&t&&s.s9C("value",e.$implicit)}let E=(()=>{class t{constructor(t,e,i,n,o,s,r){this.plus=t,this.DB=e,this.vehicleSV=i,this.fb=n,this.router=o,this.location=s,this.route=r,this.api="order/",this.vehicle=null,this.loading=!0,this.loadMoreBtn=!1,this.dateGo=null,this.contact=[],this.timeOut=!1,this.waitId="",this.token=null,this.over=null,this.time=[],this.main=this.fb.group({how:[,[c.kI.required]],todo:[,[c.kI.required]],timeGo:[,[c.kI.required,c.kI.minLength(5)]],dateGo:[,[c.kI.required]],timeBack:[,[c.kI.required,c.kI.minLength(5)]],dayBack:[this.dateGo,[c.kI.required]],pointGo:[],pointDes:[,[c.kI.required]]}),this.contactForm=this.fb.group({pesonnel:["",c.kI.required]})}ngOnInit(){clearInterval(this.over),this.getById(),this.timeInit()}getById(){const t=JSON.parse(localStorage.getItem("order"));if(console.log(t),!t||t.token<Date.now()||t.token-Date.now()>19e4)return this.router.navigate(["/dangkyxe"]);this.token=t.token,this.vehicle=t.vehicle,this.countDown(),this.plus.alertToasrt({msg:"Xe \u0111\u01b0\u1ee3c gi\u1eef cho b\u1ea1n 03 ph\xfat \u0111\u1ec3 ho\xe0n t\u1ea5t th\xf4ng tin!"}),this.main.controls.dateGo.setValue(t.dateGo),this.main.controls.dayBack.setValue(t.dateGo),this.plus.httpPost(this.api+"wait",{vehicleId:t.vehicle._id,dateGo:t.dateGo}).subscribe(t=>{this.waitId=t.id})}addContact(){this.contact.push(this.contactForm.value.pesonnel),this.contactForm.reset()}delContact(t){this.contact.splice(t,1)}submit(){const t=this.main.value;if(t.vehicleId=this.vehicle._id,t.driverId=this.vehicle.manager._id,t.contact=this.contact,new Date(t.dateGo)>new Date(t.dayBack))this.plus.alertToasrt({war:"Ng\xe0y v\u1ec1 ph\u1ea3i sau ng\xe0y \u0111i"});else{const e=this.plus.generateData(t);console.log(e),this.DB.create(e).subscribe(t=>{t.msg?(this.plus.alertToasrt(t),this.location.back(),clearInterval(this.over)):this.plus.alertToasrt(t)})}}back(){clearInterval(this.over),this.location.back(),this.plus.httpDelete(this.api+"wait/",this.waitId).subscribe(t=>{this.plus.alertToasrt(t)})}countDown(){clearInterval(this.over),this.over=setInterval(()=>{const t=(new Date).getTime(),e=+this.token-t,i=Math.floor(e%36e5/6e4),n=Math.floor(e%6e4/1e3);this.remain=Math.round(100*(60*i+n)/180),console.log(this.over),localStorage.setItem("over",this.over),e<0&&(clearInterval(this.over),this.back())},2e3)}timeOver(){const t=setTimeout(()=>{clearInterval(this.over),console.log("timeOver()",this.over),this.router.navigate(["/dangkyxe"])},18e4);console.log(t)}timeInit(){const t=[];for(let e=0;e<23;)e<10?(t.push("0"+e+"g00"),t.push("0"+e+"g30")):(t.push(e+"g00"),t.push(e+"g30")),e++;return this.time=t}}return t.\u0275fac=function(e){return new(e||t)(s.Y36(o.T),s.Y36(v),s.Y36(a),s.Y36(c.qu),s.Y36(A.F0),s.Y36(n.Ye),s.Y36(A.gz))},t.\u0275cmp=s.Xpm({type:t,selectors:[["app-order"]],decls:40,vars:8,consts:[[1,"container"],[1,"text-center","bg-warning","py-2","rounded"],["class","font-weight-bold",4,"ngIf"],["id","orderVehicle",3,"formGroup"],[1,"font-weight-bold"],["type","number","placeholder","S\u1ed1 ng\u01b0\u1eddi \u0111i","required","","formControlName","how",1,"form-control","mb-2"],["type","text","placeholder","N\u1ed9i dung c\xf4ng t\xe1c","required","","formControlName","todo",1,"form-control","mb-2"],[1,"row"],[1,"col-sm"],["type","text","list","time","placeholder","VD: 05g30","formControlName","timeGo",1,"form-control","mb-2"],["type","text","list","time","placeholder","VD: 16g30","formControlName","timeBack",1,"form-control","mb-2"],["type","date","placeholder","Ng\xe0y v\u1ec1","required","","formControlName","dayBack",1,"form-control","mb-2"],["type","text","placeholder","\u0110i\u1ec3m \u0111\u1ebfn","autocomplete","on","required","","formControlName","pointDes",1,"form-control","mb-2"],[4,"ngFor","ngForOf"],[1,"contact",3,"formGroup"],["type","text","list","users","placeholder","H\u1ecd v\xe0 t\xean + s\u1ed1 \u0111i\u1ec7n tho\u1ea1i, N\u01a1i \u0111\xf3n ...","required","","formControlName","pesonnel",1,"form-control","mb-2"],[1,"btn","btn-outline-info","my-1",3,"click"],["id","users"],["class","action my-2 text-center","style","font-size: 24px",4,"ngIf"],[1,"progress","my-2"],["role","progressbar","aria-valuenow","0","aria-valuemin","0","aria-valuemax","100",1,"progress-bar","progress-bar-animated","progress-bar-striped","bg-warning"],["id","time"],[3,"value",4,"ngFor","ngForOf"],[1,"fa","fa-trash","text-danger",3,"click"],[1,"action","my-2","text-center",2,"font-size","24px"],["type","button",1,"btn","btn-primary","mx-2","px-4",2,"font-size","24px",3,"disabled","click"],["aria-hidden","true",1,"fa","fa-floppy-o"],["type","button",1,"btn","btn-second","px-4",2,"font-size","24px",3,"click"],[1,"fa","fa-times","text-danger"],[3,"value"]],template:function(t,e){1&t&&(s.TgZ(0,"div",0),s.TgZ(1,"h4",1),s._uU(2,"\u0110\u0102NG K\xdd XE C\xd4NG T\xc1C "),s.qZA(),s.YNc(3,B,2,2,"h4",2),s.TgZ(4,"form",3),s.TgZ(5,"label",4),s._uU(6,"S\u1ed1 ng\u01b0\u1eddi \u0111i"),s.qZA(),s._UZ(7,"input",5),s.TgZ(8,"label",4),s._uU(9,"C\xf4ng t\xe1c"),s.qZA(),s._UZ(10,"input",6),s.TgZ(11,"div",7),s.TgZ(12,"div",8),s.TgZ(13,"label",4),s._uU(14,"Gi\u1edd \u0111i"),s.qZA(),s._UZ(15,"input",9),s.qZA(),s.TgZ(16,"div",8),s.TgZ(17,"label",4),s._uU(18,"Gi\u1edd v\u1ec1"),s.qZA(),s._UZ(19,"input",10),s.qZA(),s.TgZ(20,"div",8),s.TgZ(21,"label",4),s._uU(22,"Ng\xe0y v\u1ec1"),s.qZA(),s._UZ(23,"input",11),s.qZA(),s.qZA(),s.TgZ(24,"label",4),s._uU(25,"\u0110\u1ecba \u0111i\u1ec3m c\xf4ng t\xe1c"),s.qZA(),s._UZ(26,"input",12),s.TgZ(27,"label",4),s._uU(28,"Li\xean h\u1ec7"),s.qZA(),s.YNc(29,Q,4,2,"div",13),s.qZA(),s.TgZ(30,"form",14),s._UZ(31,"input",15),s.TgZ(32,"button",16),s.NdJ("click",function(){return e.addContact()}),s._uU(33,"Th\xeam li\xean h\u1ec7"),s.qZA(),s.qZA(),s._UZ(34,"datalist",17),s.YNc(35,V,5,1,"div",18),s.TgZ(36,"div",19),s._UZ(37,"div",20),s.qZA(),s.qZA(),s.TgZ(38,"datalist",21),s.YNc(39,H,1,1,"option",22),s.qZA()),2&t&&(s.xp6(3),s.Q6J("ngIf",e.vehicle),s.xp6(1),s.Q6J("formGroup",e.main),s.xp6(25),s.Q6J("ngForOf",e.contact),s.xp6(1),s.Q6J("formGroup",e.contactForm),s.xp6(5),s.Q6J("ngIf",e.waitId.length>0),s.xp6(2),s.Udp("width",e.remain+"%"),s.xp6(2),s.Q6J("ngForOf",e.time))},directives:[n.O5,c._Y,c.JL,c.sg,c.wV,c.Fj,c.Q7,c.JJ,c.u,n.sg,c.YN,c.Kr],styles:[""]}),t})();function $(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"tr"),s.TgZ(1,"td"),s._uU(2),s.qZA(),s.TgZ(3,"td",45),s.NdJ("click",function(){const e=s.CHM(t).$implicit;return s.oxw(2).log(e)}),s._uU(4),s.qZA(),s.TgZ(5,"td"),s._uU(6),s.ALo(7,"date"),s.qZA(),s.TgZ(8,"td"),s._uU(9),s.ALo(10,"date"),s.qZA(),s.TgZ(11,"td"),s._uU(12),s.ALo(13,"number"),s.qZA(),s.TgZ(14,"td"),s.TgZ(15,"button",46),s.NdJ("click",function(){const e=s.CHM(t).$implicit;return s.oxw(2).editItem(e)}),s._UZ(16,"i",47),s.qZA(),s.TgZ(17,"button",48),s.NdJ("click",function(){const e=s.CHM(t),i=e.$implicit,n=e.index;return s.oxw(2).delItem(i._id,n)}),s._UZ(18,"i",49),s.qZA(),s.qZA(),s.qZA()}if(2&t){const t=e.$implicit;s.xp6(2),s.Oqu(t.vehicleId.label),s.xp6(2),s.Oqu(t.regType),s.xp6(2),s.Oqu(s.xi3(7,5,t.fromDate,"dd/MM/yyyy")),s.xp6(3),s.Oqu(s.xi3(10,8,t.toDate,"dd/MM/yyyy")),s.xp6(3),s.Oqu(s.lcZ(13,11,t.cost))}}function K(t,e){if(1&t&&(s.TgZ(0,"tbody"),s.YNc(1,$,19,13,"tr",44),s.qZA()),2&t){const t=s.oxw();s.xp6(1),s.Q6J("ngForOf",t.DBlist)}}function j(t,e){1&t&&(s.TgZ(0,"div",50),s._UZ(1,"i",51),s.qZA())}function P(t,e){if(1&t&&(s.TgZ(0,"span"),s._uU(1),s.qZA()),2&t){const t=s.oxw();s.xp6(1),s.hij(" ",t.itemSelected.vehicleId.label,"")}}function X(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"tr"),s.TgZ(1,"td"),s._uU(2),s.qZA(),s.TgZ(3,"td"),s._uU(4),s.qZA(),s.TgZ(5,"td"),s._uU(6),s.qZA(),s.TgZ(7,"td"),s.TgZ(8,"button",13),s.NdJ("click",function(){const e=s.CHM(t).$implicit;return s.oxw(3).selectVehicle(e)}),s._uU(9,"Ch\u1ecdn"),s.qZA(),s.qZA(),s.qZA()}if(2&t){const t=e.$implicit;s.xp6(2),s.Oqu(t.label),s.xp6(2),s.Oqu(t.type),s.xp6(2),s.Oqu(t.brand)}}function z(t,e){if(1&t&&(s.TgZ(0,"table",4),s.TgZ(1,"thead",5),s.TgZ(2,"tr"),s.TgZ(3,"th"),s._uU(4,"Bi\u1ec3n s\u1ed1"),s.qZA(),s.TgZ(5,"th"),s._uU(6,"Lo\u1ea1i xe"),s.qZA(),s.TgZ(7,"th"),s._uU(8,"Hi\u1ec7u xe"),s.qZA(),s._UZ(9,"th"),s.qZA(),s.qZA(),s.TgZ(10,"tbody"),s.YNc(11,X,10,3,"tr",44),s.qZA(),s.qZA()),2&t){const t=s.oxw(2);s.xp6(11),s.Q6J("ngForOf",t.vehicleList)}}const W=function(t){return{loading:t}};function R(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"div",2),s.TgZ(1,"input",52),s.NdJ("change",function(){return s.CHM(t),s.oxw().getVehicles()}),s.qZA(),s.YNc(2,z,12,1,"table",53),s.qZA()}if(2&t){const t=s.oxw();s.Q6J("formGroup",t.searchVehicle),s.xp6(1),s.Q6J("ngClass",s.VKq(3,W,t.loading)),s.xp6(1),s.Q6J("ngIf",t.vehicleList.length>0)}}function tt(t,e){if(1&t&&(s.TgZ(0,"div",27),s.TgZ(1,"div",28),s.TgZ(2,"h6"),s._uU(3,"Xe:"),s.qZA(),s.qZA(),s.TgZ(4,"div",29),s._uU(5," \xa0"),s.TgZ(6,"h6"),s._uU(7),s.qZA(),s.qZA(),s.qZA()),2&t){const t=s.oxw();s.xp6(7),s.AsE("",t.vehicleSelected.label," - ",t.vehicleSelected.brand,"")}}let et=(()=>{class t{constructor(t,e,i,n){this.plus=t,this.vehicleSV=e,this.fb=i,this.route=n,this.api="registry/",this.loading=!0,this.DBlist=[],this.vehicleList=[],this.vehicleSelected=null,this.today=this.plus.dateYMD((new Date).toISOString()),this.main=this.fb.group({_id:[,[]],vehicleId:[,[c.kI.required]],regType:[,[c.kI.required]],fromDate:[,[c.kI.required]],toDate:[,[c.kI.required]],cost:[,[]]}),this.search=this.fb.group({what:["",[c.kI.minLength(4),c.kI.maxLength(100)]]}),this.searchVehicle=this.fb.group({what:["",[c.kI.minLength(4),c.kI.maxLength(100)]]})}ngOnInit(){this.getReg(),this.find(),this.getVehicles()}getReg(){this.plus.httpPost(this.api+"find",{page:1}).subscribe(t=>{this.plus.alertToasrt(t),this.DBlist=t,this.loading=!1})}find(){this.search.valid&&this.search.valueChanges.pipe((0,h.b)(1500)).subscribe(t=>{this.loading=!0,t.what=this.plus.removeAccents(t.what),this.plus.httpPost(this.api+"find",t).subscribe(t=>{this.loading=!1,t.length>0&&(this.DBlist=t)})})}submit(){const t=this.plus.generateData(this.main.value);t._id?this.update(t):this.create(t),this.resetModal(),this.ngOnInit()}create(t){this.plus.httpPost(this.api,t).subscribe(e=>{this.plus.alertToasrt(e),e.msg&&(this.DBlist.push(t),this.plus.sortArr(this.DBlist,"dateModify"),this.resetModal()),this.getReg()})}update(t){this.plus.httpPut(this.api,t).subscribe(t=>{this.plus.alertToasrt(t),t.msg&&this.resetModal()})}resetModal(){this.plus.clickBtn("closeModal"),this.main.reset(),this.itemSelected=null,this.vehicleList=[]}loadMore(){const t=Math.ceil(this.DBlist.length/10)+1;this.plus.httpPost(this.api+"find",{page:t}).subscribe(t=>{t.length>0?t.forEach(t=>{this.DBlist.push(t)}):this.plus.alertToasrt({msg:"Kh\xf4ng\xa0c\xf2n\xa0k\u1ebft\xa0qu\u1ea3\xa0ph\xf9\xa0h\u1ee3p\xa0\n\xa0Nh\u1eadp\xa0n\u1ed9i\xa0dung\xa0c\u1ea7n\xa0t\xecm\xa0c\u1ee5\xa0th\u1ec3\xa0h\u01a1n"}),this.loading=!1})}addItem(){this.resetModal(),this.plus.clickBtn("openModal")}editItem(t){const e=t;this.itemSelected=e,e.fromDate=this.plus.UTCtoYMD(e.fromDate),e.toDate=this.plus.UTCtoYMD(e.toDate),this.main.patchValue(t),this.plus.clickBtn("openModal"),console.log(e)}delItem(t,e){this.plus.httpDelete(this.api,t).subscribe(t=>{this.plus.alertToasrt(t),t.msg&&this.DBlist.splice(e,1)})}getVehicles(){this.searchVehicle.valid&&this.searchVehicle.valueChanges.pipe((0,h.b)(1500)).subscribe(t=>{this.loading=!0,t.what=this.plus.removeAccents(t.what),this.plus.httpPost("vehicle/find",t).subscribe(t=>{this.loading=!1,t.length>0?this.vehicleList=t:this.plus.alertToasrt({war:"Kh\xf4ng c\xf3 k\u1ebft qu\u1ea3 ph\xf9 h\u1ee3p"})})})}selectVehicle(t){console.log(t),this.main.controls.vehicleId.setValue(t._id),this.vehicleSelected=t,this.vehicleList=[]}log(t){console.log(t)}}return t.\u0275fac=function(e){return new(e||t)(s.Y36(o.T),s.Y36(a),s.Y36(c.qu),s.Y36(A.gz))},t.\u0275cmp=s.Xpm({type:t,selectors:[["app-registry"]],decls:90,vars:11,consts:[[1,"container"],[1,"text-primary","text-center","bg-light","py-2","rounded"],[1,"form-group",3,"formGroup"],["list","students","type","text","formControlName","what","aria-describedby","helpId","placeholder","Nh\u1eadp th\xf4ng tin b\u1ea1n c\u1ea7n t\xecm","autocomplete","on",1,"form-control",3,"ngClass"],[1,"table","table-hover"],[1,"thead-default"],["type","button",1,"btn","btn-success","mx-1",3,"click"],[1,"fa","fa-plus"],["type","button",1,"btn","btn-primary","mx-1",3,"click"],["aria-hidden","true",1,"fa","fa-refresh"],[4,"ngIf"],["class","text-center text-primary",4,"ngIf"],[1,"loadMore","text-center","my-2"],["type","button",1,"btn","btn-outline-primary",3,"click"],["type","button","id","openModal","hidden","","data-toggle","modal","data-target","#modelId"],["id","modelId","tabindex","-1","role","dialog","aria-labelledby","modelTitleId","aria-hidden","true",1,"modal","fade"],["myModal",""],["role","document",1,"modal-dialog"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],["type","button","data-dismiss","modal","aria-label","Close",1,"close"],["aria-hidden","true"],[1,"modal-body"],["class","form-group",3,"formGroup",4,"ngIf"],[3,"formGroup"],["class","row",4,"ngIf"],[1,"row"],[1,"col-sm-4"],[1,"col-sm-8"],[1,"form-group"],["formControlName","regType",1,"form-control"],["value","\u0110\u0103ng ki\u1ec3m"],["value","C\u01b0\u1edbc \u0111\u01b0\u1eddng b\u1ed9"],["value","B\u1ea3o hi\u1ec3m b\u1eaft bu\u1ed9c"],["value","B\u1ea3o hi\u1ec3m v\u1eadt ch\u1ea5t"],["value","Ph\xed VTEC"],[1,"row","form-group"],["type","date","formControlName","fromDate",1,"form-control"],["type","date","formControlName","toDate",1,"form-control"],["type","number","formControlName","cost",1,"form-control"],[1,"modal-footer"],["id","closeModal","type","button","data-dismiss","modal",1,"btn","btn-secondary"],["type","button","data-dismiss","modal",1,"btn","btn-primary",3,"disabled","click"],[4,"ngFor","ngForOf"],[3,"click"],["type","button",1,"btn","btn-outline-success","mx-1",3,"click"],[1,"fa","fa-pencil"],["type","button",1,"btn","btn-outline-danger","mx-1",3,"click"],[1,"fa","fa-trash"],[1,"text-center","text-primary"],[1,"fa","fa-spinner","fa-spin",2,"font-size","36px"],["type","text","required","","formControlName","what","placeholder","Nh\u1eadp th\xf4ng tin xe c\u1ea7n t\xecm v\xe0 ch\u1ecdn",1,"form-control",3,"ngClass","change"],["class","table table-hover",4,"ngIf"]],template:function(t,e){1&t&&(s.TgZ(0,"div",0),s.TgZ(1,"h4",1),s._uU(2," H\u1ea0N D\xd9NG Y\xcaU C\u1ea6U "),s.qZA(),s.TgZ(3,"div",2),s._UZ(4,"input",3),s.qZA(),s.TgZ(5,"table",4),s.TgZ(6,"thead",5),s.TgZ(7,"tr"),s.TgZ(8,"th"),s._uU(9,"Xe"),s.qZA(),s.TgZ(10,"th"),s._uU(11,"Lo\u1ea1i h\u1ed3 s\u01a1"),s.qZA(),s.TgZ(12,"th"),s._uU(13,"Ng\xe0y s\u1eed d\u1ee5ng"),s.qZA(),s.TgZ(14,"th"),s._uU(15,"Ng\xe0y h\u1ebft h\u1ea1n"),s.qZA(),s.TgZ(16,"th"),s._uU(17,"S\u1ed1 ti\u1ec1n"),s.qZA(),s.TgZ(18,"th"),s.TgZ(19,"button",6),s.NdJ("click",function(){return e.addItem()}),s._UZ(20,"i",7),s.qZA(),s.TgZ(21,"button",8),s.NdJ("click",function(){return e.ngOnInit()}),s._UZ(22,"i",9),s.qZA(),s.qZA(),s.qZA(),s.qZA(),s.YNc(23,K,2,1,"tbody",10),s.qZA(),s.YNc(24,j,2,0,"div",11),s.TgZ(25,"div",12),s.TgZ(26,"button",13),s.NdJ("click",function(){return e.loadMore()}),s._uU(27,"Xem th\xeam"),s.qZA(),s.qZA(),s.qZA(),s.TgZ(28,"button",14),s._uU(29,"Modal"),s.qZA(),s.TgZ(30,"div",15,16),s.TgZ(32,"div",17),s.TgZ(33,"div",18),s.TgZ(34,"div",19),s.TgZ(35,"h5",20),s._uU(36,"Nh\u1eadp th\xf4ng tin xe "),s.YNc(37,P,2,1,"span",10),s.qZA(),s.TgZ(38,"button",21),s.TgZ(39,"span",22),s._uU(40,"\xd7"),s.qZA(),s.qZA(),s.qZA(),s.TgZ(41,"div",23),s.YNc(42,R,3,5,"div",24),s.TgZ(43,"form",25),s.YNc(44,tt,8,2,"div",26),s._UZ(45,"hr"),s.TgZ(46,"div",27),s.TgZ(47,"div",28),s.TgZ(48,"h6"),s._uU(49,"Lo\u1ea1i h\u1ed3 s\u01a1:"),s.qZA(),s.qZA(),s.TgZ(50,"div",29),s.TgZ(51,"div",30),s.TgZ(52,"select",31),s.TgZ(53,"option",32),s._uU(54,"\u0110\u0103ng ki\u1ec3m"),s.qZA(),s.TgZ(55,"option",33),s._uU(56,"C\u01b0\u1edbc \u0111\u01b0\u1eddng b\u1ed9"),s.qZA(),s.TgZ(57,"option",34),s._uU(58,"B\u1ea3o hi\u1ec3m b\u1eaft bu\u1ed9c"),s.qZA(),s.TgZ(59,"option",35),s._uU(60,"B\u1ea3o hi\u1ec3m v\u1eadt ch\u1ea5t"),s.qZA(),s.TgZ(61,"option",36),s._uU(62,"Ph\xed VTEC"),s.qZA(),s.qZA(),s.qZA(),s.qZA(),s.qZA(),s._UZ(63,"hr"),s.TgZ(64,"div",37),s.TgZ(65,"div",28),s.TgZ(66,"h6"),s._uU(67,"Ng\xe0y s\u1eed d\u1ee5ng:"),s.qZA(),s.qZA(),s.TgZ(68,"div",29),s._UZ(69,"input",38),s.qZA(),s.qZA(),s._UZ(70,"hr"),s.TgZ(71,"div",37),s.TgZ(72,"div",28),s.TgZ(73,"h6"),s._uU(74,"Ng\xe0y h\u1ebft h\u1ea1n:"),s.qZA(),s.qZA(),s.TgZ(75,"div",29),s._UZ(76,"input",39),s.qZA(),s.qZA(),s._UZ(77,"hr"),s.TgZ(78,"div",37),s.TgZ(79,"div",28),s.TgZ(80,"h6"),s._uU(81,"S\u1ed1 ti\u1ec1n:"),s.qZA(),s.qZA(),s.TgZ(82,"div",29),s._UZ(83,"input",40),s.qZA(),s.qZA(),s._UZ(84,"hr"),s.qZA(),s.qZA(),s.TgZ(85,"div",41),s.TgZ(86,"button",42),s._uU(87,"H\u1ee7y"),s.qZA(),s.TgZ(88,"button",43),s.NdJ("click",function(){return e.submit()}),s._uU(89,"L\u01b0u"),s.qZA(),s.qZA(),s.qZA(),s.qZA(),s.qZA()),2&t&&(s.xp6(3),s.Q6J("formGroup",e.search),s.xp6(1),s.Q6J("ngClass",s.VKq(9,W,e.loading)),s.xp6(19),s.Q6J("ngIf",e.DBlist.length>0),s.xp6(1),s.Q6J("ngIf",e.loading),s.xp6(13),s.Q6J("ngIf",e.itemSelected),s.xp6(5),s.Q6J("ngIf",!e.itemSelected),s.xp6(1),s.Q6J("formGroup",e.main),s.xp6(1),s.Q6J("ngIf",e.vehicleSelected),s.xp6(44),s.Q6J("disabled",!e.main.valid))},directives:[c.JL,c.sg,c.Fj,c.JJ,c.u,n.mk,n.O5,c._Y,c.EJ,c.YN,c.Kr,c.wV,n.sg,c.Q7],pipes:[n.uU,n.JJ],styles:[""]}),t})();function it(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"button",43),s.NdJ("click",function(){s.CHM(t);const e=s.oxw(),i=e.$implicit,n=e.index;return s.oxw(2).accept(i,n)}),s._UZ(1,"i",44),s.qZA()}}function nt(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"button",45),s.NdJ("click",function(){s.CHM(t);const e=s.oxw().$implicit;return s.oxw(2).editItem(e)}),s._UZ(1,"i",46),s.qZA()}}function ot(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"button",47),s.NdJ("click",function(){s.CHM(t);const e=s.oxw().$implicit;return s.oxw(2).changeStatus(e)}),s._UZ(1,"i",48),s.qZA()}}function st(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"tr"),s.TgZ(1,"td"),s._uU(2),s.qZA(),s.TgZ(3,"td"),s._uU(4),s.qZA(),s.TgZ(5,"td"),s._uU(6),s.qZA(),s.TgZ(7,"td"),s._uU(8),s.ALo(9,"date"),s.qZA(),s.TgZ(10,"td"),s._uU(11),s.qZA(),s.TgZ(12,"td"),s.YNc(13,it,2,0,"button",38),s.YNc(14,nt,2,0,"button",39),s.TgZ(15,"button",40),s.NdJ("click",function(){const e=s.CHM(t).$implicit;return s.oxw(2).download(e)}),s._UZ(16,"i",41),s.qZA(),s.YNc(17,ot,2,0,"button",42),s.qZA(),s.qZA()}if(2&t){const t=e.$implicit,i=s.oxw(2);s.xp6(2),s.Oqu(t.vehicleId.label),s.xp6(2),s.Oqu(t.vehicleId.type),s.xp6(2),s.Oqu(t.driverId.fullName||t.driverId.displayName),s.xp6(2),s.Oqu(s.xi3(9,8,t.dateGo,"dd/MM/yyyy")),s.xp6(3),s.Oqu(t.todo),s.xp6(2),s.Q6J("ngIf",1!==t.orderStatus),s.xp6(1),s.Q6J("ngIf",1!==t.orderStatus),s.xp6(3),s.Q6J("ngIf",i.admin)}}function rt(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"table",33),s.TgZ(1,"thead",34),s.TgZ(2,"tr"),s.TgZ(3,"th"),s._uU(4,"Bi\u1ec3n s\u1ed1"),s.qZA(),s.TgZ(5,"th"),s._uU(6,"Lo\u1ea1i xe"),s.qZA(),s.TgZ(7,"th"),s._uU(8,"T\xe0i x\u1ebf"),s.qZA(),s.TgZ(9,"th"),s._uU(10,"Ng\xe0y \u0111i"),s.qZA(),s.TgZ(11,"th"),s._uU(12,"C\xf4ng t\xe1c"),s.qZA(),s.TgZ(13,"th",35),s.TgZ(14,"i",36),s.NdJ("click",function(){return s.CHM(t),s.oxw().ngOnInit()}),s.qZA(),s.qZA(),s.qZA(),s.qZA(),s.TgZ(15,"tbody"),s.YNc(16,st,18,11,"tr",37),s.qZA(),s.qZA()}if(2&t){const t=s.oxw();s.xp6(16),s.Q6J("ngForOf",t.dbList)}}function lt(t,e){if(1&t&&(s.TgZ(0,"span",49),s._uU(1),s.qZA()),2&t){const t=s.oxw();s.xp6(1),s.Oqu(t.vehicleSelected.label)}}function at(t,e){1&t&&s._UZ(0,"input",50)}function ct(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"tr"),s.TgZ(1,"td"),s._uU(2),s.qZA(),s.TgZ(3,"td"),s._uU(4),s.qZA(),s.TgZ(5,"td"),s.TgZ(6,"button",31),s.NdJ("click",function(){const e=s.CHM(t).$implicit;return s.oxw(2).selectVehicle(e)}),s._uU(7,"Ch\u1ecdn"),s.qZA(),s.qZA(),s.qZA()}if(2&t){const t=e.$implicit;s.xp6(2),s.Oqu(t.type),s.xp6(2),s.Oqu(t.label)}}function ht(t,e){if(1&t&&(s.TgZ(0,"table",33),s.TgZ(1,"thead",51),s.TgZ(2,"tr"),s.TgZ(3,"th"),s._uU(4,"Lo\u1ea1i xe"),s.qZA(),s.TgZ(5,"th"),s._uU(6,"Bi\u1ec3n s\u1ed1"),s.qZA(),s._UZ(7,"th"),s.qZA(),s.qZA(),s.TgZ(8,"tbody"),s.YNc(9,ct,8,2,"tr",37),s.qZA(),s.qZA()),2&t){const t=s.oxw();s.xp6(9),s.Q6J("ngForOf",t.vehicleList)}}function dt(t,e){if(1&t&&(s.TgZ(0,"span",49),s._uU(1),s.qZA()),2&t){const t=s.oxw();s.xp6(1),s.Oqu(t.userSelected.user_Id.fullName)}}function ut(t,e){1&t&&s._UZ(0,"input",52)}function gt(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"tr"),s.TgZ(1,"td"),s._uU(2),s.qZA(),s.TgZ(3,"td"),s._uU(4),s.qZA(),s.TgZ(5,"td"),s.TgZ(6,"button",31),s.NdJ("click",function(){const e=s.CHM(t).$implicit;return s.oxw(2).selectDriver(e)}),s._uU(7,"Ch\u1ecdn"),s.qZA(),s.qZA(),s.qZA()}if(2&t){const t=e.$implicit;s.xp6(2),s.Oqu(t.user_Id.fullName||"Ch\u01b0a khai b\xe1o"),s.xp6(2),s.Oqu(t.level)}}function pt(t,e){if(1&t&&(s.TgZ(0,"table",33),s.TgZ(1,"thead",51),s.TgZ(2,"tr"),s.TgZ(3,"th"),s._uU(4,"H\u1ecd v\xe0 t\xean"),s.qZA(),s.TgZ(5,"th"),s._uU(6,"H\u1ea1ng b\u1eb1ng l\xe1i"),s.qZA(),s._UZ(7,"th"),s.qZA(),s.qZA(),s.TgZ(8,"tbody"),s.YNc(9,gt,8,2,"tr",37),s.qZA(),s.qZA()),2&t){const t=s.oxw();s.xp6(9),s.Q6J("ngForOf",t.userList)}}const Zt=function(t){return{loading:t}},mt=[{path:"",component:D},{path:"quanlyxe",component:D},{path:"quanlydangkyxe",component:G},{path:"dangkyxe",component:O},{path:"dangkyxe/token/:token",component:E},{path:"quyettoan",component:T},{path:"hansudung/:id",component:et},{path:"hansudung",component:et},{path:"duyetxe",component:(()=>{class t{constructor(t,e){this.plus=t,this.fb=e,this.api="accept/",this.loading=!0,this.dbList=[],this.userList=[],this.vehicleList=[],this.userSelected=null,this.vehicleSelected=null,this.orderSelected=null,this.admin=this.plus.isAdmin(),this.from=localStorage.getItem("usrInfo"),this.main=this.fb.group({_id:[],vehicleId:[,[c.kI.required]],driverId:[,[c.kI.required]],how:[,[c.kI.required]],todo:[,[c.kI.required]],timeGo:[,[]],dateGo:[,[c.kI.required]],timeBack:[,[]],dayBack:[,[c.kI.required]],pointGo:[,[c.kI.required]],pointDes:[,[c.kI.required]],contact:[,[]],note:["",c.kI.maxLength(100)]}),this.searchForm=this.fb.group({what:["",[c.kI.minLength(4),c.kI.maxLength(100)]]}),this.searchUser=this.fb.group({what:["",[c.kI.minLength(4),c.kI.maxLength(100)]]}),this.searchVehicle=this.fb.group({what:["",[c.kI.minLength(4),c.kI.maxLength(100)]]})}ngOnInit(){this.get(),this.findUser(),this.findVehicle(),this.findOrder()}get(){this.plus.httpGet(this.api+"1").subscribe(t=>{this.dbList=t,this.plus.alertToasrt(t),this.loading=!1})}findOrder(){this.searchForm.valid&&this.searchForm.valueChanges.pipe((0,h.b)(1500)).subscribe(t=>{console.log(t),t.what&&t.what.length>3&&(this.loading=!0,t.what=this.plus.removeAccents(t.what),this.plus.httpPost("accept/find",t).subscribe(t=>{this.loading=!1,this.plus.alertToasrt(t),t.length>0&&(this.dbList=t)}))})}findVehicle(){this.searchVehicle.valid&&this.searchVehicle.valueChanges.pipe((0,h.b)(1500)).subscribe(t=>{console.log(t),t.what&&t.what.length>3&&(this.loading=!0,t.what=this.plus.removeAccents(t.what),this.plus.httpPost("vehicle/find",t).subscribe(t=>{this.loading=!1,this.plus.alertToasrt(t),t.length>0&&(this.vehicleList=t)}))})}findUser(){this.searchUser.valid&&this.searchUser.valueChanges.pipe((0,h.b)(1500)).subscribe(t=>{console.log(t),t.what&&t.what.length>3&&(t.what=this.plus.removeAccents(t.what),this.loading=!0,this.plus.httpPost("driver/find",t).subscribe(t=>{this.loading=!1,this.plus.alertToasrt(t),this.userList=t}))})}selectDriver(t){this.userSelected=t,this.userList=[],console.log(t),this.main.controls.driverId.setValue(t.user_Id._id)}selectVehicle(t){this.vehicleSelected=t,this.vehicleList=[],console.log(t),this.main.controls.vehicleId.setValue(t._id)}changeStatus(t){this.plus.httpPut("order",{_id:t._id,orderStatus:0}).subscribe(t=>{this.plus.alertToasrt(t)})}editItem(t){console.log(t),this.orderSelected=t,this.main.patchValue(t),this.main.controls.vehicleId.setValue(t.vehicleId._id),this.main.controls.driverId.setValue(t.driverId._id),this.plus.clickBtn("openModal")}reset(){this.plus.clickBtn("closeModal"),this.main.reset(),this.searchForm.reset(),this.searchUser.reset(),this.searchVehicle.reset(),this.orderSelected=null,this.userSelected=null,this.vehicleSelected=null}submit(){const t=this.plus.addKeyWord(this.main.value);console.log(t),this.plus.httpPut("order",t).subscribe(t=>{this.plus.alertToasrt(t),this.plus.clickBtn("closeModal")})}accept(t,e){console.log(t);const i={title:`Th\xf4ng b\xe1o c\xf4ng t\xe1c ng\xe0y ${this.plus.dateToDMY(t.dateGo)}.`,email:t.driverId.email,message:`<h4>Th\xf4ng b\xe1o c\xf4ng t\xe1c ng\xe0y ${this.plus.dateToDMY(t.dateGo)}:</h4>\n      <h4>Lo\u1ea1i xe: ${t.vehicleId.type} - ${t.vehicleId.label}.</h4>\n      <h4>Gi\u1edd \u0111i: ${t.timeGo}.</h4>\n      <h4>C\xf4ng t\xe1c: ${t.todo}.</h4>\n      <h4>\u0110\u1ecba \u0111i\u1ec3m: ${t.pointDes}.</h4>\n      <h4>Li\xean h\u1ec7: ${t.contact.join(", ")}.</h4>\n      `,t0k3n:{user:"tckt.dlxl@gmail.com",pass:"pdhorsgfplhxhecj"}};1===t.orderStatus?(this.plus.alertToasrt({war:"B\u1ea1n \u0111\xe3 duy\u1ec7t xe n\xe0y!"}),this.get()):(this.plus.httpPost(this.api,{id:t._id,orderStatus:1}).subscribe(t=>{this.dbList[e].orderStatus=1,this.plus.alertToasrt(t)}),console.log(i),this.plus.sendMail(i).subscribe(e=>{return n=this,void 0,s=function*(){e.email&&(this.plus.alertToasrt({msg:"\u0110\xe3 g\u1eedi mail cho l\xe1i xe"}),yield this.plus.sleep(5e3),i.email=t.userId.email,this.plus.sendMail(i).subscribe(t=>{this.plus.alertToasrt({msg:"\u0110\xe3 g\u1eedi mail cho ng\u01b0\u1eddi \u0111\u0103ng k\xfd xe"})}))},new((o=void 0)||(o=Promise))(function(t,e){function i(t){try{l(s.next(t))}catch(i){e(i)}}function r(t){try{l(s.throw(t))}catch(i){e(i)}}function l(e){var n;e.done?t(e.value):(n=e.value,n instanceof o?n:new o(function(t){t(n)})).then(i,r)}l((s=s.apply(n,[])).next())});var n,o,s}))}download(t){JSON.parse(localStorage.getItem("usrInfo")).unit||this.plus.alertToasrt({err:"B\u1ea1n c\u1ea7n khai b\xe1o th\xeam th\xf4ng tin t\xe0i kho\u1ea3n c\u1ee7a b\u1ea1n"}),console.log(t);const e=Object.assign({},t);e.dateGo=this.plus.dateToDMY(e.dateGo),e.dayBack=this.plus.dateToDMY(e.dayBack)}}return t.\u0275fac=function(e){return new(e||t)(s.Y36(o.T),s.Y36(c.qu))},t.\u0275cmp=s.Xpm({type:t,selectors:[["app-acception"]],decls:66,vars:14,consts:[[1,"form-group",3,"formGroup"],["type","text","placeholder","Nh\u1eadp th\xf4ng tin b\u1ea1n c\u1ea7n t\xecm","formControlName","what",1,"form-control",3,"ngClass","change"],["class","table table-hover",4,"ngIf"],["type","button","id","openModal","hidden","","data-toggle","modal","data-target","#regModal",1,"btn","btn-primary","btn-lg"],["id","regModal","tabindex","-1","role","dialog","aria-labelledby","modelTitleId","aria-hidden","true",1,"modal","fade"],["role","document",1,"modal-dialog"],[1,"modal-content"],[1,"modal-header","bg-primary"],[1,"modal-title","text-center","text-white"],["type","button","data-dismiss","modal","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[1,"container"],[3,"formGroup"],[1,"form-group"],["class","text-danger",4,"ngIf"],["type","text","class","form-control","placeholder","Nh\u1eadp th\xf4ng tin xe c\u1ea7n \u0111\u1ed5i","formControlName","what",4,"ngIf"],[1,"vehicleList"],["type","text","class","form-control","placeholder","Nh\u1eadp th\xf4ng tin t\xe0i x\u1ebf c\u1ea7n \u0111\u1ed5i","formControlName","what",4,"ngIf"],[1,"userList"],["type","text","hidden","","formControlName","_id",1,"form-control"],[1,"row","form-group"],[1,"col-sm-4"],[1,"col-sm-8"],["type","number","formControlName","how",1,"form-control"],["rows","2","formControlName","todo",1,"form-control"],["type","text","formControlName","timeGo",1,"form-control"],["rows","3","formControlName","note",1,"form-control"],[1,"modal-footer"],["type","button","id","closeModal","data-dismiss","modal",1,"btn","btn-outline-danger",3,"click"],[1,"fa","fa-times"],["type","button",1,"btn","btn-outline-primary",3,"click"],[1,"fa","fa-floppy-o"],[1,"table","table-hover"],[1,"thead-default"],[1,"text-center","text-primary"],[1,"fa","fa-refresh",3,"click"],[4,"ngFor","ngForOf"],["type","button","class","btn btn-outline-warning mx-1","title","Duy\u1ec7t",3,"click",4,"ngIf"],["type","button","class","btn btn-outline-success mx-1",3,"click",4,"ngIf"],["type","button","data-toggle","modal","data-target","#modelId",1,"btn","btn-outline-primary","mx-1",3,"click"],["aria-hidden","true",1,"fa","fa-print","text-info"],["type","button","class","btn btn-outline-danger mx-1",3,"click",4,"ngIf"],["type","button","title","Duy\u1ec7t",1,"btn","btn-outline-warning","mx-1",3,"click"],["aria-hidden","true",1,"fa","fa-check"],["type","button",1,"btn","btn-outline-success","mx-1",3,"click"],["aria-hidden","true",1,"fa","fa-pencil"],["type","button",1,"btn","btn-outline-danger","mx-1",3,"click"],[1,"fa","fa-trash","text-danger"],[1,"text-danger"],["type","text","placeholder","Nh\u1eadp th\xf4ng tin xe c\u1ea7n \u0111\u1ed5i","formControlName","what",1,"form-control"],[1,"thead-inverse"],["type","text","placeholder","Nh\u1eadp th\xf4ng tin t\xe0i x\u1ebf c\u1ea7n \u0111\u1ed5i","formControlName","what",1,"form-control"]],template:function(t,e){1&t&&(s.TgZ(0,"form",0),s.TgZ(1,"input",1),s.NdJ("change",function(){return e.findOrder()}),s.qZA(),s.qZA(),s.YNc(2,rt,17,1,"table",2),s._UZ(3,"button",3),s.TgZ(4,"div",4),s.TgZ(5,"div",5),s.TgZ(6,"div",6),s.TgZ(7,"div",7),s.TgZ(8,"h5",8),s._uU(9,"Hi\u1ec7u ch\u1ec9nh xe \u0111\u0103ng k\xfd"),s.qZA(),s.TgZ(10,"button",9),s.NdJ("click",function(){return e.reset()}),s.TgZ(11,"span",10),s._uU(12,"\xd7"),s.qZA(),s.qZA(),s.qZA(),s.TgZ(13,"div",11),s.TgZ(14,"div",12),s.TgZ(15,"form",13),s.TgZ(16,"div",14),s.TgZ(17,"h6"),s._uU(18,"\u0110\u1ed5i xe: "),s.YNc(19,lt,2,1,"span",15),s.qZA(),s.YNc(20,at,1,0,"input",16),s.qZA(),s.TgZ(21,"div",17),s.YNc(22,ht,10,1,"table",2),s.qZA(),s.qZA(),s.TgZ(23,"form",13),s.TgZ(24,"div",14),s.TgZ(25,"h6"),s._uU(26,"\u0110\u1ed5i t\xe0i x\u1ebf: "),s.YNc(27,dt,2,1,"span",15),s.qZA(),s.YNc(28,ut,1,0,"input",18),s.qZA(),s.TgZ(29,"div",19),s.YNc(30,pt,10,1,"table",2),s.qZA(),s.qZA(),s.TgZ(31,"form",13),s._UZ(32,"input",20),s.TgZ(33,"div",21),s.TgZ(34,"div",22),s.TgZ(35,"h6"),s._uU(36,"S\u1ed1 ng\u01b0\u1eddi \u0111i:"),s.qZA(),s.qZA(),s.TgZ(37,"div",23),s._UZ(38,"input",24),s.qZA(),s.qZA(),s._UZ(39,"hr"),s.TgZ(40,"div",21),s.TgZ(41,"div",22),s.TgZ(42,"h6"),s._uU(43,"C\xf4ng t\xe1c:"),s.qZA(),s.qZA(),s.TgZ(44,"div",23),s._UZ(45,"textarea",25),s.qZA(),s.qZA(),s._UZ(46,"hr"),s.TgZ(47,"div",21),s.TgZ(48,"div",22),s.TgZ(49,"h6"),s._uU(50,"Gi\u1edd \u0111i:"),s.qZA(),s.qZA(),s.TgZ(51,"div",23),s._UZ(52,"input",26),s.qZA(),s.qZA(),s._UZ(53,"hr"),s.TgZ(54,"div",21),s.TgZ(55,"div",22),s.TgZ(56,"h6"),s._uU(57,"L\u1eddi nh\u1eafn cho l\xe1i xe"),s.qZA(),s.qZA(),s.TgZ(58,"div",23),s._UZ(59,"textarea",27),s.qZA(),s.qZA(),s._UZ(60,"hr"),s.qZA(),s.qZA(),s.qZA(),s.TgZ(61,"div",28),s.TgZ(62,"button",29),s.NdJ("click",function(){return e.reset()}),s._UZ(63,"i",30),s.qZA(),s.TgZ(64,"button",31),s.NdJ("click",function(){return e.submit()}),s._UZ(65,"i",32),s.qZA(),s.qZA(),s.qZA(),s.qZA(),s.qZA()),2&t&&(s.Q6J("formGroup",e.searchForm),s.xp6(1),s.Q6J("ngClass",s.VKq(12,Zt,e.loading)),s.xp6(1),s.Q6J("ngIf",e.dbList.length>0),s.xp6(13),s.Q6J("formGroup",e.searchVehicle),s.xp6(4),s.Q6J("ngIf",e.vehicleSelected),s.xp6(1),s.Q6J("ngIf",!e.vehicleSelected),s.xp6(2),s.Q6J("ngIf",e.vehicleList.length>0),s.xp6(1),s.Q6J("formGroup",e.searchUser),s.xp6(4),s.Q6J("ngIf",e.userSelected),s.xp6(1),s.Q6J("ngIf",!e.userSelected),s.xp6(2),s.Q6J("ngIf",e.userList.length>0),s.xp6(1),s.Q6J("formGroup",e.main))},directives:[c._Y,c.JL,c.sg,c.Fj,c.JJ,c.u,n.mk,n.O5,c.wV,n.sg],pipes:[n.uU],styles:[""]}),t})()},{path:"taixe",component:G}];let ft=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=s.oAB({type:t}),t.\u0275inj=s.cJS({imports:[[A.Bz.forChild(mt)],A.Bz]}),t})(),qt=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=s.oAB({type:t}),t.\u0275inj=s.cJS({imports:[[n.ez,ft,c.UX,c.u5]]}),t})()}}]);