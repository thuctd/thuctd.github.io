"use strict";(self.webpackChunk_4la=self.webpackChunk_4la||[]).push([[672],{52672:function(t,e,n){n.r(e),n.d(e,{ChanhModule:function(){return Y}});var i=n(48387),a=n(83886),o=n(87841),r=n(12057),c=n(74788);let s=(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=c.Xpm({type:t,selectors:[["app-custommer"]],decls:2,vars:0,template:function(t,e){1&t&&(c.TgZ(0,"p"),c._uU(1,"custommer works!"),c.qZA())},styles:[""]}),t})(),l=(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=c.Xpm({type:t,selectors:[["app-report"]],decls:2,vars:0,template:function(t,e){1&t&&(c.TgZ(0,"p"),c._uU(1,"report works!"),c.qZA())},styles:[""]}),t})();var u=n(33982),h=n(84875),p=n(16738),g=n(24751),d=n(15228),m=n(57922);let f=(()=>{class t{constructor(t){this.plus=t,this.trangthai=h.ji,this.dbName="chanh",this.api="chanh"}initDB(){}create(t){delete t._id,this.plus.httpPost(this.api,t,!0).subscribe(t=>{t.status&&(this.plus.alertMatSnackBar("\u0110\xe3 l\xean \u0111\u01a1n m\u01a1i"),this.plus.clickBtn("closeModal"))})}update(t){!t._id||this.plus.httpPost(this.api,t,!0).subscribe(t=>{t.status&&this.plus.clickBtn("closeModal")})}createChart(t){const e=[];for(let n=0;n<t.length;n++){let i={};i.TrangThai=this.trangthai[t[n].TrangThai].val,i.count=1,e.push(i)}return this.plus.generateChart(e,"TrangThai","TrangThai",!0)}reportChart(t){const e=[];for(let n=0;n<t.length;n++){let i={};i.TrangThai=this.trangthai[t[n].TrangThai].val,i.count=1,e.push(i)}return this.plus.generateChart(e,"TrangThai","TrangThai",!0)}addDays(t,e){var n=new Date(t);return n.setDate(n.getDate()+e),n}subDays(t,e){var n=new Date(t);return n.setDate(n.getDate()-e),n}}return t.\u0275fac=function(e){return new(e||t)(c.LFG(m.T))},t.\u0275prov=c.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var Z=n(2895),T=n(49356),b=n(46936),q=n(23202),A=n(23487),y=n(46926),k=n(97012),_=n(46833),N=n(46113),x=n(61260),I=n(12895),v=n(17935),J=n(73888);function U(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"button",40),c.NdJ("click",function(){return c.CHM(t),c.oxw().reload()}),c.TgZ(1,"mat-icon"),c._uU(2,"undo"),c.qZA(),c.qZA()}2&t&&c.Q6J("@slideIn",void 0)}function w(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"mat-chip",41),c.NdJ("click",function(){const e=c.CHM(t).$implicit;return c.oxw().getbyTT(e.key)}),c._uU(1),c.qZA()}if(2&t){const t=e.$implicit,n=c.oxw();c.Q6J("selected",n.chipKey==t.key),c.xp6(1),c.Oqu(t.val)}}function D(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"mat-icon",48),c.NdJ("click",function(){c.CHM(t);const e=c.oxw().$implicit;return c.oxw(2).onDelete(e)}),c._uU(1,"delete"),c.qZA()}}function C(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"tr"),c.TgZ(1,"td",46),c.NdJ("click",function(){const e=c.CHM(t).$implicit;return c.oxw(2).onEdit(e)}),c.TgZ(2,"a"),c._uU(3),c.qZA(),c.qZA(),c.TgZ(4,"td",46),c.NdJ("click",function(){const e=c.CHM(t).$implicit;return c.oxw(2).onEdit(e)}),c._uU(5),c.qZA(),c.TgZ(6,"td",46),c.NdJ("click",function(){const e=c.CHM(t).$implicit;return c.oxw(2).onEdit(e)}),c._uU(7),c.qZA(),c.TgZ(8,"td",46),c.NdJ("click",function(){const e=c.CHM(t).$implicit;return c.oxw(2).onEdit(e)}),c._uU(9),c.qZA(),c.TgZ(10,"td",46),c.NdJ("click",function(){const e=c.CHM(t).$implicit;return c.oxw(2).onEdit(e)}),c._uU(11),c.ALo(12,"date"),c.qZA(),c.TgZ(13,"td"),c.YNc(14,D,2,0,"mat-icon",47),c.qZA(),c.qZA()}if(2&t){const t=e.$implicit,n=c.oxw(2);c.xp6(3),c.Oqu(t.KhachHang),c.xp6(2),c.hij("",t.SoLuong,"kg"),c.xp6(2),c.Oqu(t.TrangThai),c.xp6(2),c.Oqu(t.NguoiGiaoHang),c.xp6(2),c.Oqu(c.xi3(12,6,t.NgayGiaoHang,"dd/MM/yyyy")),c.xp6(3),c.Q6J("ngIf",n.checkPer(4))}}function M(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"table",42),c.TgZ(1,"thead",43),c.TgZ(2,"tr"),c.TgZ(3,"th"),c._uU(4,"Kh\xe1ch h\xe0ng"),c.qZA(),c.TgZ(5,"th"),c._uU(6,"S\u1ed1 l\u01b0\u1ee3ng"),c.qZA(),c.TgZ(7,"th"),c._uU(8,"Ti\u1ebfn \u0111\u1ed9"),c.qZA(),c.TgZ(9,"th"),c._uU(10,"Ng\u01b0\u1eddi giao h\xe0ng"),c.qZA(),c.TgZ(11,"th"),c._uU(12,"Ng\xe0y giao h\xe0ng"),c.qZA(),c.TgZ(13,"th"),c.TgZ(14,"mat-icon",44),c.NdJ("click",function(){return c.CHM(t),c.oxw().reload()}),c._uU(15,"cached"),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.TgZ(16,"tbody"),c.YNc(17,C,15,9,"tr",45),c.qZA(),c.qZA()}if(2&t){const t=c.oxw();c.Q6J("@slideIn",void 0),c.xp6(17),c.Q6J("ngForOf",t.filter.length>0?t.filter:t.items.slice(0,10))}}function H(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"button",49),c.NdJ("click",function(){return c.CHM(t),c.oxw().resetDB()}),c._uU(1,"X\xf3a to\xe0n b\u1ed9 d\u1eef li\u1ec7u"),c.qZA()}}function B(t,e){if(1&t&&(c.TgZ(0,"mat-option",50),c._uU(1),c.qZA()),2&t){const t=e.$implicit;c.Q6J("value",+t.GiaTri),c.xp6(1),c.hij("",t.NoiDung," ")}}function G(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"button",51),c.NdJ("click",function(){return c.CHM(t),c.oxw().addNews()}),c._uU(1,"T\u1ea1o m\u1edbi"),c.qZA()}2&t&&c.Q6J("@slideIn",void 0)}function Q(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"button",52),c.NdJ("click",function(){return c.CHM(t),c.oxw().save()}),c.TgZ(1,"mat-icon"),c._uU(2,"save"),c.qZA(),c.qZA()}2&t&&c.Q6J("@slideIn",void 0)}const E=function(){return[5,10,25,100]},F=[{path:"",component:(()=>{class t{constructor(t,e,n){this.plus=t,this.fb=e,this.chanhsv=n,this.chart=[],this.chartReport=[],this.trangthai=h.ji,this.main=this.fb.group({keyWord:[,[]],_id:[,[]],KhachHang:[,[g.kI.required]],SoLuong:[,[g.kI.required,g.kI.min(0)]],ChuKy:[0,[]],TrangThai:[0],GiaVon:[,[g.kI.required,g.kI.min(0)]],GiaBan:[,[g.kI.required,g.kI.min(0)]],NguoiGiaoHang:[,[g.kI.required]],NgayGiaoHang:[new Date,[g.kI.required]],LienHe:[,[g.kI.required]],GhiChu:[,[]]}),this.title="Chanh \u0111\xe8",this.dbName="chanh",this.api="chanh",this.db=null,this.items=[],this.selectedItem=null,this.filter=[],this.DoanhThuThang=[],this.LoiNhuanThang=[],this.LoiNhuan=0,this.DoanhThu=0}ngOnInit(){this.plus.setTiTle(this.title),this.plus.IDB_InitDB(this.dbName).subscribe(t=>function(t,e,n,i){return new(n||(n=Promise))(function(a,o){function r(t){try{s(i.next(t))}catch(e){o(e)}}function c(t){try{s(i.throw(t))}catch(e){o(e)}}function s(t){t.done?a(t.value):function(t){return t instanceof n?t:new n(function(e){e(t)})}(t.value).then(r,c)}s((i=i.apply(t,e||[])).next())})}(this,void 0,void 0,function*(){this.db=t,this.getIDB(),this.plus.updateGlobalLocal(t,this.api),this.plus.updateAPi.subscribe(t=>{this.getIDB()})}))}getIDB(){this.filter=[],this.plus.IDB_DB_GetAll(this.db,this.api,"NgayGiaoHang",1).subscribe(t=>{console.log(t),this.items=t,this.chart=this.chanhsv.createChart(this.items),this.doanhThuNgay(t,30)})}ngOnDestroy(){console.log("Destroy",this.api),this.plus.subs.unsubscribe()}save(){if(this.main.invalid)return;const t=this.main.value;if(localStorage.setItem("giachanh",`${t.GiaVon}`),null==t._id)this.chanhsv.create(t);else{if(this.selectedItem.TrangThai>2)return;this.plus.httpPut(this.api,t,!0).subscribe(e=>{if(e.status){if(t.ChuKy>0&&t.TrangThai>1){if(!confirm(2==t.TrangThai?"L\xean \u0111\u01a1n ti\u1ebfp theo tr\u01b0\u1edbc khi thanh to\xe1n?":"L\xean \u0111\u01a1n ti\u1ebfp theo?"))return;const e=Object.assign(t);delete e._id,e.TrangThai=0,e.NgayGiaoHang=this.chanhsv.addDays(e.NgayGiaoHang,e.ChuKy),this.plus.httpPost(this.api,t,!0).subscribe(t=>{t.status&&this.plus.clickBtn("closeModal")})}this.plus.clickBtn("closeModal")}})}}doanhThuNgay(t,e){Date.now();const n=[];for(let i=0;i<t.length;i++)if(p(t[i].NgayGiaoHang).isAfter(this.chanhsv.subDays(new Date,e))&&t[i].TrangThai>2){const e={LoiNhuan:1e3*(t[i].GiaBan-t[i].GiaVon),ThanhTien:1e3*t[i].GiaBan,Ngay:p(t[i].NgayGiaoHang).format("DD/MM")};n.push(e)}console.log(n),this.DoanhThuThang=this.plus.generateChart(n,"Ngay","ThanhTien"),this.LoiNhuanThang=this.plus.generateChart(n,"Ngay","LoiNhuan"),this.DoanhThu=this.plus.sumByKey(n,"ThanhTien"),this.LoiNhuan=this.plus.sumByKey(n,"LoiNhuan")}addNews(){this.main.invalid||this.chanhsv.create(this.main.value)}onEdit(t){console.log(t),this.selectedItem=t,this.main.patchValue(t),this.plus.clickBtn("openModal")}onDelete(t){!confirm("B\u1ea1n mu\u1ed1n x\xf3a?")||(this.plus.load(),this.plus.httpDisable(this.api,t,!0).then(t=>{console.log(t)}))}getbyTT(t){this.chipKey=t,this.plus.IDB_DB_GetAllByIndexKey(this.db,this.api,"TrangThai",t).subscribe(t=>{0==t.length?this.filter.push({}):this.filter=t})}chooseOpt(t,e,n,i=!1){this.main.controls[e].setValue(t[n]),i&&this.main.controls[e+"ID"].setValue(t._id)}closeModal(){this.main.reset()}search(t){this.filter=t}find(t){this.items=t}checkPer(t){return this.plus.checkPer(this.api,t)}patchForm(){this.main.reset({_id:" "})}reload(){return this.plus.reload(this.dbName)}reset(){this.plus.loaded(),this.filter=[],this.getIDB(),this.main.reset({GiaVon:+localStorage.getItem("giachanh"),NgayGiaoHang:new Date})}resetDB(){this.plus.resetDB(this.db,this.api)}changePage(t){this.filter=this.items.slice(t.pageIndex*t.pageSize,(t.pageIndex+1)*t.pageSize)}trackByFn(t,e){return e}}return t.\u0275fac=function(e){return new(e||t)(c.Y36(m.T),c.Y36(g.qu),c.Y36(f))},t.\u0275cmp=c.Xpm({type:t,selectors:[["app-chanh"]],decls:92,vars:28,consts:[[1,"container"],["id","add-btn","color","accent","mat-raised-button","","data-toggle","modal","data-target","#modelId",3,"click"],["id","back-btn","mat-raised-button","","color","primary",3,"click",4,"ngIf"],[3,"db","api","filter"],[1,"row"],[1,"col-md-6"],[1,"justify-content-center","my-2"],["color","accent",3,"selected","click",4,"ngFor","ngForOf"],["class","table table-hover",4,"ngIf"],[3,"length","pageSize","pageSizeOptions","page"],[3,"id","label","arr","type"],[3,"dataJson"],["mat-button","","color","warn",3,"click",4,"ngIf"],["id","openModal","type","button","data-toggle","modal","data-target","#modelId",1,"d-none"],["id","modelId","data-backdrop","static","tabindex","-1","role","dialog","aria-labelledby","modelTitleId","aria-hidden","true",1,"modal","fade"],["role","document",1,"modal-dialog","modal-lg"],[1,"modal-content"],[1,"modal-body"],[1,"container-fluid"],[3,"formGroup"],["hidden","","formControlName","_id"],["type","text","autocomplete","off","matInput","","formControlName","KhachHang"],["matSuffix",""],["formControlName","TrangThai"],[3,"value",4,"ngFor","ngForOf"],[1,"col"],["matInput","","formControlName","NgayGiaoHang","autocomplete","off",3,"matDatepicker","focus"],["matSuffix","",3,"for"],["NgayGiaoHang",""],["type","number","autocomplete","off","matInput","","formControlName","SoLuong",2,"text-align","right"],["type","number","value","0","autocomplete","off","matInput","","formControlName","ChuKy",2,"text-align","right"],["placeholder","S\u1ed1 123 Tr\u1ea7n Ph\xfa ... 0902","type","text","autocomplete","off","matInput","","formControlName","LienHe"],["type","number","autocomplete","off","matInput","","formControlName","GiaVon",2,"text-align","right"],["type","number","autocomplete","off","matInput","","formControlName","GiaBan",2,"text-align","right"],["type","text","autocomplete","off","matInput","","formControlName","NguoiGiaoHang"],["type","text","autocomplete","off","matInput","","formControlName","GhiChu"],[1,"modal-footer"],["mat-raised-button","","color","accent",3,"click",4,"ngIf"],["id","closeModal","mat-raised-button","","color","primary","data-dismiss","modal",3,"click"],["mat-raised-button","","color","warn",3,"click",4,"ngIf"],["id","back-btn","mat-raised-button","","color","primary",3,"click"],["color","accent",3,"selected","click"],[1,"table","table-hover"],[1,"thead-inverse"],["color","primary",3,"click"],[4,"ngFor","ngForOf"],[3,"click"],["color","warn",3,"click",4,"ngIf"],["color","warn",3,"click"],["mat-button","","color","warn",3,"click"],[3,"value"],["mat-raised-button","","color","accent",3,"click"],["mat-raised-button","","color","warn",3,"click"]],template:function(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"div",0),c.TgZ(1,"button",1),c.NdJ("click",function(){return e.reset()}),c.TgZ(2,"mat-icon"),c._uU(3,"control_point"),c.qZA(),c.qZA(),c.YNc(4,U,3,1,"button",2),c.TgZ(5,"app-search-table",3),c.NdJ("filter",function(t){return e.search(t)}),c.qZA(),c.TgZ(6,"div",4),c.TgZ(7,"div",5),c.TgZ(8,"div",6),c.TgZ(9,"mat-chip-list"),c.YNc(10,w,2,2,"mat-chip",7),c.qZA(),c.qZA(),c.YNc(11,M,18,2,"table",8),c.TgZ(12,"mat-paginator",9),c.NdJ("page",function(t){return e.changePage(t)}),c.qZA(),c.qZA(),c.TgZ(13,"div",5),c._UZ(14,"app-chart",10),c._UZ(15,"app-chart",10),c.qZA(),c.qZA(),c._UZ(16,"app-export-ecxel",11),c.qZA(),c.YNc(17,H,2,0,"button",12),c._UZ(18,"button",13),c.TgZ(19,"div",14),c.TgZ(20,"div",15),c.TgZ(21,"div",16),c.TgZ(22,"div",17),c.TgZ(23,"div",18),c.TgZ(24,"form",19),c._UZ(25,"input",20),c.TgZ(26,"div",4),c.TgZ(27,"mat-form-field"),c.TgZ(28,"mat-label"),c._uU(29,"Kh\xe1ch h\xe0ng"),c.qZA(),c._UZ(30,"input",21),c._UZ(31,"span",22),c.qZA(),c.TgZ(32,"mat-form-field"),c.TgZ(33,"mat-label"),c._uU(34,"Tr\u1ea1ng th\xe1i"),c.qZA(),c.TgZ(35,"mat-select",23),c.YNc(36,B,2,2,"mat-option",24),c.ALo(37,"catalog"),c.qZA(),c.qZA(),c.TgZ(38,"div",25),c.TgZ(39,"mat-form-field"),c.TgZ(40,"mat-label"),c._uU(41,"Ng\xe0y giao h\xe0ng"),c.qZA(),c.TgZ(42,"input",26),c.NdJ("focus",function(){return c.CHM(t),c.MAs(45).open()}),c.qZA(),c._UZ(43,"mat-datepicker-toggle",27),c._UZ(44,"mat-datepicker",null,28),c.qZA(),c.TgZ(46,"mat-form-field"),c.TgZ(47,"mat-label"),c._uU(48,"S\u1ed1 l\u01b0\u1ee3ng"),c.qZA(),c._UZ(49,"input",29),c.TgZ(50,"span",22),c._uU(51,"Kg"),c.qZA(),c.qZA(),c.TgZ(52,"mat-form-field"),c.TgZ(53,"mat-label"),c._uU(54,"Chu k\u1ef3"),c.qZA(),c._UZ(55,"input",30),c.TgZ(56,"span",22),c._uU(57,"Ng\xe0y"),c.qZA(),c.qZA(),c.TgZ(58,"mat-form-field"),c.TgZ(59,"mat-label"),c._uU(60,"Li\xean h\u1ec7"),c.qZA(),c._UZ(61,"input",31),c._UZ(62,"span",22),c.qZA(),c.qZA(),c.TgZ(63,"div",25),c.TgZ(64,"mat-form-field"),c.TgZ(65,"mat-label"),c._uU(66,"Gi\xe1 v\u1ed1n"),c.qZA(),c._UZ(67,"input",32),c.TgZ(68,"span",22),c._uU(69,".000\u0111"),c.qZA(),c.qZA(),c.TgZ(70,"mat-form-field"),c.TgZ(71,"mat-label"),c._uU(72,"Gi\xe1 b\xe1n"),c.qZA(),c._UZ(73,"input",33),c.TgZ(74,"span",22),c._uU(75,".000\u0111"),c.qZA(),c.qZA(),c.TgZ(76,"mat-form-field"),c.TgZ(77,"mat-label"),c._uU(78,"Ng\u01b0\u1eddi giao h\xe0ng"),c.qZA(),c._UZ(79,"input",34),c._UZ(80,"span",22),c.qZA(),c.TgZ(81,"mat-form-field"),c.TgZ(82,"mat-label"),c._uU(83,"Ghi ch\xfa"),c.qZA(),c._UZ(84,"input",35),c._UZ(85,"span",22),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.TgZ(86,"div",36),c.YNc(87,G,2,1,"button",37),c.TgZ(88,"button",38),c.NdJ("click",function(){return e.closeModal()}),c.TgZ(89,"mat-icon"),c._uU(90,"close"),c.qZA(),c.qZA(),c.YNc(91,Q,3,1,"button",39),c.qZA(),c.qZA(),c.qZA(),c.qZA()}if(2&t){const t=c.MAs(45);c.xp6(4),c.Q6J("ngIf",e.filter.length>0),c.xp6(1),c.Q6J("db",e.db)("api",e.api),c.xp6(5),c.Q6J("ngForOf",e.trangthai),c.xp6(1),c.Q6J("ngIf",e.items.length+e.filter.length>0),c.xp6(1),c.Q6J("length",e.items.length)("pageSize",10)("pageSizeOptions",c.DdM(27,E)),c.xp6(2),c.Q6J("id","tiendo")("label","Ti\u1ebfn \u0111\u1ed9 giao h\xe0ng")("arr",e.chart)("type","pie"),c.xp6(1),c.Q6J("id","doanhthu")("label","Doanh Thu")("arr",e.DoanhThuThang)("type","bar"),c.xp6(1),c.Q6J("dataJson",e.items),c.xp6(1),c.Q6J("ngIf",e.checkPer(5)),c.xp6(7),c.Q6J("formGroup",e.main),c.xp6(12),c.Q6J("ngForOf",c.lcZ(37,25,"TrangThaiGiaoHang")),c.xp6(6),c.Q6J("matDatepicker",t),c.xp6(1),c.Q6J("for",t),c.xp6(44),c.Q6J("ngIf",e.checkPer(2)&&e.main.valid),c.xp6(1),c.Q6J("@slideIn",void 0),c.xp6(3),c.Q6J("ngIf",e.checkPer(2)&&e.main.valid)}},directives:[Z.lW,T.Hw,r.O5,b.D,q.qn,r.sg,A.NW,y.x,k.t,g._Y,g.JL,g.sg,g.Fj,g.JJ,g.u,_.KE,_.hX,N.Nt,_.R9,x.gD,I.hl,I.nW,I.Mq,g.wV,q.HS,v.ey],pipes:[J.pW,r.uU],styles:[""],data:{animation:[d.Ym]}}),t})()},{path:"report",component:l},{path:"custommer",component:s}];let O=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=c.oAB({type:t}),t.\u0275inj=c.cJS({imports:[[u.Bz.forChild(F)],u.Bz]}),t})();var S=n(85913);let Y=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=c.oAB({type:t}),t.\u0275inj=c.cJS({imports:[[r.ez,O,o.ShareModule,S.m,a.N,i.D]]}),t})()},97012:function(t,e,n){n.d(e,{t:function(){return g}});var i=n(16738),a=n.n(i),o=n(84487),r=n(74788),c=n(57922),s=n(12057),l=n(2895);function u(t,e){if(1&t){const t=r.EpF();r.TgZ(0,"button",3),r.NdJ("click",function(){return r.CHM(t),r.oxw(2).export()}),r._uU(1,"Export Excel"),r.qZA()}}function h(t,e){if(1&t){const t=r.EpF();r.TgZ(0,"button",3),r.NdJ("click",function(){return r.CHM(t),r.oxw(2).exportTar()}),r._uU(1,"Export BackupDB"),r.qZA()}}function p(t,e){if(1&t&&(r.TgZ(0,"span",1),r.YNc(1,u,2,0,"button",2),r.YNc(2,h,2,0,"button",2),r.qZA()),2&t){const t=r.oxw();r.xp6(1),r.Q6J("ngIf",t.check()),r.xp6(1),r.Q6J("ngIf",t.check())}}let g=(()=>{class t{constructor(t){this.plus=t}ngOnInit(){}export(){const t=[];this.dataJson.forEach(e=>{delete e.dateModify,delete e.status,delete e.sync,delete e.canEdit,delete e.keyWord,delete e.__v,t.push(e)});const e=o.utils.json_to_sheet(t),n=o.utils.book_new();o.utils.book_append_sheet(n,e,this.api),o.writeFile(n,a()(Date.now()).format("YYYYMMDDHHMM")+"-4la-"+this.api+".xlsx")}exportTar(){for(let a=0;a<this.dataJson.length;a++)delete this.dataJson[a].dateModify,delete this.dataJson[a].canEdit,delete this.dataJson[a].keyWord,delete this.dataJson[a].__v,delete this.dataJson[a]._id;let t=JSON.stringify(this.dataJson),e="data:application/json;charset=utf-8,"+encodeURIComponent(t);console.log(e);let n=`4la-${this.api?this.api:""}`+Date.now()+".tar",i=document.createElement("a");i.setAttribute("href",e),i.setAttribute("download",n),i.click()}check(){return this.plus.checkPer("admin",4)}}return t.\u0275fac=function(e){return new(e||t)(r.Y36(c.T))},t.\u0275cmp=r.Xpm({type:t,selectors:[["app-export-ecxel"]],inputs:{dataJson:"dataJson",api:"api"},decls:1,vars:1,consts:[["class","d-print-none",4,"ngIf"],[1,"d-print-none"],["mat-raised-button","","color","primary",3,"click",4,"ngIf"],["mat-raised-button","","color","primary",3,"click"]],template:function(t,e){1&t&&r.YNc(0,p,3,2,"span",0),2&t&&r.Q6J("ngIf",e.dataJson.length>0)},directives:[s.O5,l.lW],styles:[""]}),t})()},85913:function(t,e,n){n.d(e,{m:function(){return c}});var i=n(39609),a=n(24751),o=n(12057),r=n(74788);let c=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=r.oAB({type:t}),t.\u0275inj=r.cJS({imports:[[o.ez,a.UX,i.qX]]}),t})()}}]);