(self.webpackChunk_4la=self.webpackChunk_4la||[]).push([[28],{97534:function(t,e,s){"use strict";s.d(e,{F:function(){return i}});var r=s(61511),n=s(35366);let i=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=n.oAB({type:t}),t.\u0275inj=n.cJS({imports:[[r.ez]]}),t})()},69121:function(t,e,s){"use strict";s.d(e,{t:function(){return l}});var r=s(82393),n=s(31153),i=s(35366),o=s(15980),a=s(61511);function c(t,e){if(1&t){const t=i.EpF();i.TgZ(0,"button",0),i.NdJ("click",function(){return i.CHM(t),i.oxw().exportToJsonFile()}),i._uU(1,"Export Json"),i.qZA()}}let l=(()=>{class t{constructor(t){this.plus=t}ngOnInit(){}export(){const t=[];this.dataJson.forEach(e=>{delete e.dateModify,delete e.status,delete e.sync,delete e.canEdit,delete e.keyWord,delete e.__v,t.push(e)});const e=n.utils.json_to_sheet(t),s=n.utils.book_new();n.utils.book_append_sheet(s,e,"Sheet1"),n.writeFile(s,"4la-"+Date.now()+".xlsx")}exportToJsonFile(){for(let n=0;n<this.dataJson.length;n++)delete this.dataJson[n].dateModify,delete this.dataJson[n].canEdit,delete this.dataJson[n].keyWord;let t=JSON.stringify(this.dataJson),e="data:application/json;charset=utf-8,"+encodeURIComponent(t),s="4la-"+Date.now()+".json",r=document.createElement("a");r.setAttribute("href",e),r.setAttribute("download",s),r.click()}check(){return this.plus.checkPer("admin",4)}}return t.\u0275fac=function(e){return new(e||t)(i.Y36(r.T))},t.\u0275cmp=i.Xpm({type:t,selectors:[["app-export-ecxel"]],inputs:{dataJson:"dataJson"},decls:3,vars:1,consts:[["mat-raised-button","","color","primary",3,"click"],["mat-raised-button","","color","primary",3,"click",4,"ngIf"]],template:function(t,e){1&t&&(i.TgZ(0,"button",0),i.NdJ("click",function(){return e.export()}),i._uU(1,"Export"),i.qZA(),i.YNc(2,c,2,0,"button",1)),2&t&&(i.xp6(2),i.Q6J("ngIf",e.check()))},directives:[o.lW,a.O5],styles:[""]}),t})()},78477:function(t,e,s){"use strict";s.d(e,{y:function(){return b}});var r=s(7171),n=s(82393),i=s(31153),o=s(35366),a=s(15980),c=s(61511);function l(t,e){1&t&&(o.TgZ(0,"label",12),o._uU(1," Ch\u1ecdn file "),o._UZ(2,"i",13),o.qZA())}function u(t,e){if(1&t&&(o.TgZ(0,"td",17),o._uU(1),o.qZA()),2&t){const t=o.oxw().$implicit;o.xp6(1),o.hij(" ",t.err||"","")}}function h(t,e){if(1&t&&(o.TgZ(0,"tr"),o.YNc(1,u,2,1,"td",16),o.qZA()),2&t){const t=e.$implicit;o.Q6J("@slideIn",void 0),o.xp6(1),o.Q6J("ngIf",t.err)}}function p(t,e){if(1&t&&(o.TgZ(0,"table",14),o.TgZ(1,"h4"),o._uU(2,"L\u1ed7i d\u1eef li\u1ec7u file import"),o.qZA(),o.TgZ(3,"tbody"),o.YNc(4,h,2,2,"tr",15),o.qZA(),o.qZA()),2&t){const t=o.oxw(2);o.xp6(4),o.Q6J("ngForOf",t.errorData.length>0?t.errorData:t.dataJson)}}function d(t,e){if(1&t){const t=o.EpF();o.TgZ(0,"button",18),o.NdJ("click",function(){return o.CHM(t),o.oxw(2).import()}),o._uU(1,"Import"),o.qZA()}}function f(t,e){if(1&t){const t=o.EpF();o.TgZ(0,"button",19),o.NdJ("click",function(){return o.CHM(t),o.oxw(2).reload()}),o._uU(1,"L\xe0m l\u1ea1i"),o.qZA()}}function m(t,e){if(1&t){const t=o.EpF();o.TgZ(0,"div",3),o.TgZ(1,"a",4),o._uU(2,"File import m\u1eabu"),o.qZA(),o.TgZ(3,"h4",5),o._uU(4,"Import t\u1eeb file excel"),o.qZA(),o.YNc(5,l,3,0,"label",6),o.TgZ(6,"input",7),o.NdJ("change",function(e){return o.CHM(t),o.oxw().readXlsx(e)}),o.qZA(),o.TgZ(7,"a",4),o._uU(8,"File import m\u1eabu"),o.qZA(),o.YNc(9,p,5,1,"table",8),o.TgZ(10,"div",9),o.YNc(11,d,2,0,"button",10),o.YNc(12,f,2,0,"button",11),o.qZA(),o.qZA()}if(2&t){const t=o.oxw();o.xp6(1),o.MGl("href","https://github.com/thuctd/FileStore/raw/master/templates/",t.api,".xlsx",o.LSH),o.xp6(4),o.Q6J("ngIf",0===t.dataJson.length),o.xp6(2),o.MGl("href","https://github.com/thuctd/FileStore/raw/master/templates/",t.api,".xlsx",o.LSH),o.xp6(2),o.Q6J("ngIf",t.errorData.length>0),o.xp6(2),o.Q6J("ngIf",t.checkPer(4)&&0==t.errorData.length&&t.dataJson.length>0),o.xp6(1),o.Q6J("ngIf",t.checkPer(1))}}function g(t,e){if(1&t&&(o.TgZ(0,"tr"),o.TgZ(1,"td"),o._uU(2),o.qZA(),o.TgZ(3,"td"),o._uU(4),o.qZA(),o.qZA()),2&t){const t=e.$implicit;o.xp6(2),o.Oqu(t.index),o.xp6(2),o.Oqu(t.msg)}}function x(t,e){if(1&t&&(o.TgZ(0,"table",20),o.TgZ(1,"thead"),o.TgZ(2,"tr"),o.TgZ(3,"th"),o._uU(4,"D\xf2ng"),o.qZA(),o.TgZ(5,"th"),o._uU(6,"L\u1ed7i"),o.qZA(),o.qZA(),o.qZA(),o.TgZ(7,"tbody"),o.YNc(8,g,5,2,"tr",15),o.qZA(),o.qZA()),2&t){const t=o.oxw();o.xp6(8),o.Q6J("ngForOf",t.errServer)}}let b=(()=>{class t{constructor(t){this.plus=t,this.dataImport=[],this.dataJson=[],this.errorData=[],this.errServer=[],this.show=!1}ngOnInit(){this.dataJson=[],this.dataImport=[]}readXlsx(t){this.plus.load();let e=t.target;const s=new FileReader;s.onload=t=>{const e=i.read(t.target.result,{type:"binary"});this.dataImport=i.utils.sheet_to_json(e.Sheets[e.SheetNames[0]],{header:1}),this.selectedFile(this.dataImport),this.plus.loaded()},s.readAsBinaryString(e.files[0]),e=null}selectedFile(t){console.log(t.length);for(let e=1;e<t.length;e++){const s={};t[0].forEach((r,n)=>{s[`${r}`]=t[e][n]}),this.form.patchValue(this.plus.Obj_clean(s));const r=s;this.form.valid?(r.dateModify=Date.now()+e,r.keyWord=this.plus.generateKeyWord(r),this.dataJson.push(r)):(r.err=`T\u1ea1i h\xe0ng ${e}: ${this.plus.getErrValidateForm(this.form)}`,this.errorData.push(s))}}import(){return t=this,void 0,s=function*(){if(this.dataJson.length>2e3)return void this.plus.alertWarning("Vui l\xf2ng import s\u1ed1 l\u01b0\u1ee3ng d\u01b0\u1edbi 2000 d\xf2ng/l\u1ea7n");const t=this.dataJson.length;let e=0,s=!1;const r=this.dataJson;for(;e<t;){let n=r.slice(e,e+200);if(console.log(e,n),this.plus.httpPost(this.api+"/import",n).subscribe(t=>{if(!t.status)return s=!0;console.log(t.code),this.plus.FBS_PostByUser(this.api,this.plus.Arr_MaxValue(this.dataJson)),this.plus.FBS_PostByUser(this.api,this.plus.Arr_MaxValue(this.dataJson),!0),this.plus.alertSuccess("Import th\xe0nh c\xf4ng!"),e+=200},r=>{console.log(r.error.code),this.errServer=JSON.parse(r.error.code),this.plus.alertError("Import kh\xf4ng th\xe0nh c\xf4ng!"),s=!0,e=t}),s)break;yield this.plus.sleep(3e3)}},new((e=void 0)||(e=Promise))(function(r,n){function i(t){try{a(s.next(t))}catch(e){n(e)}}function o(t){try{a(s.throw(t))}catch(e){n(e)}}function a(t){var s;t.done?r(t.value):(s=t.value,s instanceof e?s:new e(function(t){t(s)})).then(i,o)}a((s=s.apply(t,[])).next())});var t,e,s}checkPer(t){return this.plus.checkPer(this.api,t)}reload(){return this.plus.reload(this.dbName+"/"+this.api)}}return t.\u0275fac=function(e){return new(e||t)(o.Y36(n.T))},t.\u0275cmp=o.Xpm({type:t,selectors:[["app-import-database"]],inputs:{form:"form",api:"api",dbName:"dbName"},decls:4,vars:2,consts:[["mat-raised-button","","href","","color","accent",3,"click"],["class","import",4,"ngIf"],["class","table card",4,"ngIf"],[1,"import"],["target","_blank",1,"badge","badge-warning",3,"href"],[1,"text-center","text-white","py-2","my-3","bg-primary","rounded-pill","justify-content-center"],["for","file-import","class","custom-file-upload text-primary mx-5",4,"ngIf"],["hidden","","id","file-import","type","file","multiple","false",3,"change"],["class","table table-inverse table-responsive",4,"ngIf"],[1,"text-center","mx-3"],["class","text-center mx-3","mat-raised-button","","color","accent",3,"click",4,"ngIf"],["class","text-center mx-3","mat-raised-button","","color","primary",3,"click",4,"ngIf"],["for","file-import",1,"custom-file-upload","text-primary","mx-5"],["aria-hidden","true",1,"fa","fa-file-excel-o","fa-2x","text-success"],[1,"table","table-inverse","table-responsive"],[4,"ngFor","ngForOf"],["class","text-danger",4,"ngIf"],[1,"text-danger"],["mat-raised-button","","color","accent",1,"text-center","mx-3",3,"click"],["mat-raised-button","","color","primary",1,"text-center","mx-3",3,"click"],[1,"table","card"]],template:function(t,e){1&t&&(o.TgZ(0,"button",0),o.NdJ("click",function(){return e.show=!e.show}),o._uU(1,"Import Excel"),o.qZA(),o.YNc(2,m,13,6,"div",1),o.YNc(3,x,9,1,"table",2)),2&t&&(o.xp6(2),o.Q6J("ngIf",e.show),o.xp6(1),o.Q6J("ngIf",e.errServer.length>0))},directives:[a.lW,c.O5,c.sg],styles:[""],data:{animation:[r.Y]}}),t})()},43552:function(t,e,s){"use strict";s.d(e,{D:function(){return a}});var r=s(99594),n=s(61511),i=s(16073),o=s(35366);let a=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=o.oAB({type:t}),t.\u0275inj=o.cJS({imports:[[n.ez,i.u5,r.q]]}),t})()},89274:function(t,e,s){"use strict";s.d(e,{W:function(){return x}});var r=s(35366),n=s(16073),i=s(47701),o=s(79996),a=s(56998),c=s(47727),l=s(82393),u=s(29063),h=s(66283),p=s(26756),d=s(61511),f=s(15980),m=s(43691);function g(t,e){if(1&t){const t=r.EpF();r.TgZ(0,"button",4),r.NdJ("click",function(){return r.CHM(t),r.oxw().reset()}),r.TgZ(1,"mat-icon"),r._uU(2,"x"),r.qZA(),r.qZA()}}let x=(()=>{class t{constructor(t,e,s){this.plus=t,this.fb=e,this.http=s,this.data=new r.vpe,this.searchtxt=this.plus.search.getValue().what,this.searchForm=this.fb.group({what:["",[n.kI.required,n.kI.minLength(3),n.kI.maxLength(100)]]})}ngOnInit(){this.find()}find(){this.searchForm.valueChanges.pipe((0,i.b)(1e3)).subscribe(t=>{this.searchForm.valid?(this.plus.load(),t.what=this.plus.removeAccents(t.what),this.plus.search.next(t),this.httpPost(this.api+"/find",t).subscribe(t=>{t.data&&this.data.emit(this.plus.Crypt_DecryptRest(t)),this.plus.alertToasrt(t)},t=>this.reset())):this.plus.loaded()})}reset(){this.plus.loaded(),this.searchForm.reset()}httpPost(t,e){return console.log("%FIND -> "+t,"font-style: italic; color:green",e),this.http.post(this.plus.getApiUrl(t),e,this.plus.getHeader()).pipe((0,o.U)(s=>(this.plus.logger(t+"PUT",e),s)),(0,a.X)(1),(0,c.K)(s=>{throw this.plus.loaded(),this.plus.alertError("Kh\xf4ng c\xf3 ph\u1ea3n h\u1ed3i!"),this.plus.logger(t+"POST",e,!1),s}))}}return t.\u0275fac=function(e){return new(e||t)(r.Y36(l.T),r.Y36(n.qu),r.Y36(u.eN))},t.\u0275cmp=r.Xpm({type:t,selectors:[["app-search-api"]],inputs:{api:"api"},outputs:{data:"data"},decls:6,vars:2,consts:[[1,"form-group","search",3,"formGroup"],[1,"example-form-field"],["matInput","","type","text","formControlName","what"],["mat-button","","matSuffix","","mat-icon-button","",3,"click",4,"ngIf"],["mat-button","","matSuffix","","mat-icon-button","",3,"click"]],template:function(t,e){1&t&&(r.TgZ(0,"div",0),r.TgZ(1,"mat-form-field",1),r.TgZ(2,"mat-label"),r._uU(3,"T\xecm ki\u1ebfm n\xe2ng cao"),r.qZA(),r._UZ(4,"input",2),r.YNc(5,g,3,0,"button",3),r.qZA(),r.qZA()),2&t&&(r.Q6J("formGroup",e.searchForm),r.xp6(5),r.Q6J("ngIf",e.searchForm.dirty))},directives:[n.JL,n.sg,h.KE,h.hX,p.Nt,n.Fj,n.JJ,n.u,d.O5,f.lW,h.R9,m.Hw],styles:[".search[_ngcontent-%COMP%]{width:300px;transition:width .4s ease-in-out}"]}),t})()}}]);