!function(){"use strict";function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function n(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}(self.webpackChunk_4la=self.webpackChunk_4la||[]).push([[511],{51511:function(t,r,o){o.d(r,{k:function(){return c}});var i,a=o(74788),l=o(57922),u=o(31409),s=o(15194),c=((i=function(){function t(n,r){e(this,t),this.plus=n,this.excel=r,this.files=new a.vpe}return n(t,[{key:"ngOnInit",value:function(){}},{key:"ngOnDestroy",value:function(){this.files.unsubscribe(),console.log("ngOnDestroy app-drop-files")}},{key:"onDrop",value:function(e){this.files.emit(e),document.getElementById("dropZone").setAttribute("drop-active","false")}},{key:"selectedFile",value:function(e){this.files.emit(e.target.files)}},{key:"ondragover",value:function(){document.getElementById("dropZone").setAttribute("drop-active","true")}}]),t}()).\u0275fac=function(e){return new(e||i)(a.Y36(l.T),a.Y36(u.x))},i.\u0275cmp=a.Xpm({type:i,selectors:[["app-drop-files"]],outputs:{files:"files"},decls:10,vars:0,consts:[[1,"row","justify-content-center","d-none-print"],["id","dropZone",1,"col-6",3,"appDropZone","dragover"],["for","file-import"],["for","file-import",1,"custom-file-upload","text-primary","mx-5"],["hidden","","id","file-import","type","file","multiple","false",3,"change"]],template:function(e,t){1&e&&(a.TgZ(0,"div",0),a.TgZ(1,"div",1),a.NdJ("appDropZone",function(e){return t.onDrop(e)})("dragover",function(){return t.ondragover()}),a.TgZ(2,"label",2),a._uU(3," K\xe9o th\u1ea3 file v\xe0o \u0111\xe2y ho\u1eb7c "),a.TgZ(4,"span"),a._uU(5,"\u2794"),a.qZA(),a.TgZ(6,"a"),a._uU(7," Ch\u1ecdn file "),a.qZA(),a.qZA(),a._UZ(8,"label",3),a.TgZ(9,"input",4),a.NdJ("change",function(e){return t.selectedFile(e)}),a.qZA(),a.qZA(),a.qZA())},directives:[s.i],styles:["label[_ngcontent-%COMP%]{width:100%;height:100%;text-align:center;line-height:170px;color:#00f;font-weight:bolder}#dropZone[_ngcontent-%COMP%]{width:40%;height:15%;border:2px dashed rgb(38,16,165);border-radius:3%}#dropZone[drop-active=true][_ngcontent-%COMP%]{box-shadow:inset 0 0 0 2px #00c;border:solid blue}"]}),i)},15194:function(t,r,o){o.d(r,{i:function(){return l}});var i,a=o(74788),l=((i=function(){function t(){e(this,t),this.fileDrop=new a.vpe,this.preventBodyDrop=!0,this.active=!1}return n(t,[{key:"onDrop",value:function(e){e.preventDefault(),this.active=!1;var t=e.dataTransfer;if(t.items){for(var n=[],r=0;r<t.items.length;r++)"file"===t.items[r].kind&&n.push(t.items[r].getAsFile());t.items.clear(),this.fileDrop.emit(n)}else{var o=t.files;t.clearData(),this.fileDrop.emit(Array.from(o))}}},{key:"onDragOver",value:function(e){e.stopPropagation(),e.preventDefault(),this.active=!0}},{key:"onDragLeave",value:function(e){this.active=!1}},{key:"onBodyDragOver",value:function(e){this.preventBodyDrop&&(e.preventDefault(),e.stopPropagation())}},{key:"onBodyDrop",value:function(e){this.preventBodyDrop&&e.preventDefault()}}]),t}()).\u0275fac=function(e){return new(e||i)},i.\u0275dir=a.lG2({type:i,selectors:[["","appDropZone",""]],hostVars:2,hostBindings:function(e,t){1&e&&a.NdJ("drop",function(e){return t.onDrop(e)})("dragover",function(e){return t.onDragOver(e)})("dragleave",function(e){return t.onDragLeave(e)})("dragover",function(e){return t.onBodyDragOver(e)},!1,a.pYS)("drop",function(e){return t.onBodyDrop(e)},!1,a.pYS),2&e&&a.ekj("drop-zone-active",t.active)},inputs:{preventBodyDrop:"preventBodyDrop"},outputs:{fileDrop:"appDropZone"}}),i)},31409:function(t,r,o){o.d(r,{x:function(){return s}});var i,a=o(84487),l=o(74788),u=o(57922),s=((i=function(){function t(n){e(this,t),this.plus=n}return n(t,[{key:"readXlsx",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return new Promise(function(r,o){var i={};if(t.plus.load(),null!=e&&"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"!=e.type&&"application/vnd.ms-excel"!=e.type)return t.plus.alertError("Kh\xf4ng ph\u1ea3i file excel");var l=new FileReader;l.readAsBinaryString(e),l.onloadend=function(e){for(var o=a.read(e.target.result,{type:"binary",cellDates:!0,dateNF:"DD/MM/YYYY"}),l=o.SheetNames,u=0;u<l.length;u++){var s=l[u],c=a.utils.sheet_to_json(o.Sheets[s],{header:1,raw:n});i["".concat(s)]=t.convertJSon(c)}t.plus.loaded(),r(i)}})}},{key:"convertJSon",value:function(e){for(var t=[],n=function(n){var r={};e[0].forEach(function(t,o){r["".concat(t)]=e[n][o]}),t.push(r)},r=1;r<e.length;r++)n(r);return t}},{key:"convertJSonByX",value:function(e){for(var t=[],n=function(n){if("x"==e[n][0]){var r={};e[0].forEach(function(t,o){r["".concat(t)]=e[n][o]}),t.push(r)}},r=1;r<e.length;r++)n(r);return t}},{key:"readXlsxToMerge",value:function(e){var t=this;return console.log(e),new Promise(function(n,r){t.plus.load();var o={};if(null!=e&&"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"!=e.type&&"application/vnd.ms-excel"!=e.type)return t.plus.alertError("Kh\xf4ng ph\u1ea3i file excel");var i=new FileReader;i.readAsBinaryString(e),i.onloadend=function(e){for(var r=a.read(e.target.result,{type:"binary",cellDates:!0,dateNF:"DD/MM/YYYY"}),i=r.SheetNames,l=0;l<i.length;l++){var u=i[l];if("_Merge"==u)return t.plus.alertError("Vui l\xf2ng \u0111\u1ed5i t\xean sheet _Merge th\xe0nh t\xean kh\xe1c");var s=a.utils.sheet_to_json(r.Sheets[u],{header:1,raw:!0});o["".concat(0==l?"_Merge":u)]=t.convertJSon(s)}n(o),t.plus.loaded()}})}},{key:"export",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=a.utils.json_to_sheet(e,{skipHeader:!0}),r=a.utils.book_new();a.utils.book_append_sheet(r,n,"ChuaImport"),a.writeFile(r,"4la-"+t+"-ChuaImport.xlsx")}},{key:"exportTar",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=0;n<e.length;n++)delete e[n].dateModify,delete e[n].canEdit,delete e[n].keyWord,delete e[n].__v,delete e[n]._id;var r=JSON.stringify(e),o="data:application/json;charset=utf-8,"+encodeURIComponent(r);console.log(o);var i="4la-".concat(t||"")+Date.now()+".tar",a=document.createElement("a");a.setAttribute("href",o),a.setAttribute("download",i),a.click()}}]),t}()).\u0275fac=function(e){return new(e||i)(l.LFG(u.T))},i.\u0275prov=l.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i)}}])}();