!function(){function n(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}function t(n,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(n,o.key,o)}}function i(n,i,o){return i&&t(n.prototype,i),o&&t(n,o),n}(self.webpackChunk_4la=self.webpackChunk_4la||[]).push([[32],{66909:function(t,o,e){"use strict";e.r(o),e.d(o,{BanHangModule:function(){return $n}});var a=e(94803),u=e(35180),r=e(62283),c=e(35845),s=e(43552),h=e(61511),l=e(7171),g=e(529),d=e(82393),p=e(31572),Z=e(16073),f=e(68591),m=function(){var t=function(){function t(i,o,e,a){n(this,t),this.fb=i,this.plus=o,this.route=e,this.location=a,this.permissions=g.N.nav,this.api="user",this.perUser={}}return i(t,[{key:"ngOnInit",value:function(){this.getById()}},{key:"getById",value:function(){var n=this;this.plus.load();var t=this.route.snapshot.paramMap.get("id");this.userId=t,this.plus.httpGet("user/"+t).subscribe(function(t){var i=n.plus.Crypt_DecryptRest(t);console.log(i.opt),n.user=i,n.perUser=i.opt,n.lock=i.lock,n.fullName=i.fullName,n.phoneNumber=i.phoneNumber,n.unit=i.unit,n.plus.loaded()},function(t){return n.plus.alertError()})}},{key:"onSelect",value:function(n,t,i){var o={};if(o[n]=t,i.target.checked)this.perUser=Object.assign(Object.assign({},this.perUser),o);else switch(t){case 1:delete this.perUser[n];break;case 2:this.perUser[n]=1;break;case 4:this.perUser[n]=2;break;case 7:this.perUser[n]=4}}},{key:"checked",value:function(n,t){return this.perUser[n]>=t}},{key:"deletePer",value:function(){this.perUser={}}},{key:"lockUser",value:function(){var n=this,t=this.user;t.lock=this.lock,this.plus.httpPut(this.api,t).subscribe(function(t){n.plus.alertToasrt(t)})}},{key:"update",value:function(){var n=this,t={_id:this.user._id,opt:this.perUser,lock:this.lock,fullName:this.fullName,email:this.user.email,unit:this.unit,phoneNumber:this.phoneNumber,dateModify:Date.now()};this.plus.httpPut(this.api,t).subscribe(function(i){n.plus.FBS_SetData("login",n.user._id,{dateModify:t.dateModify}),n.plus.alertToasrt(i)})}}]),t}();return t.\u0275fac=function(n){return new(n||t)(p.Y36(Z.qu),p.Y36(d.T),p.Y36(f.gz),p.Y36(h.Ye))},t.\u0275cmp=p.Xpm({type:t,selectors:[["app-khach-hang"]],decls:15,vars:0,consts:[["type","button","data-toggle","modal","data-target","#themKH",1,"btn","btn-primary","btn-lg"],["id","themKH","tabindex","-1","role","dialog","aria-labelledby","modelTitleId","aria-hidden","true",1,"modal","fade"],["role","document",1,"modal-dialog"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],[1,"modal-body"],[1,"modal-footer"],["type","button","data-dismiss","modal",1,"btn","btn-secondary"],["type","button",1,"btn","btn-primary"]],template:function(n,t){1&n&&(p.TgZ(0,"button",0),p._uU(1," Th\xeam KH\n"),p.qZA(),p.TgZ(2,"div",1),p.TgZ(3,"div",2),p.TgZ(4,"div",3),p.TgZ(5,"div",4),p.TgZ(6,"h5",5),p._uU(7,"Th\xeam KH"),p.qZA(),p.qZA(),p.TgZ(8,"div",6),p._uU(9," Body "),p.qZA(),p.TgZ(10,"div",7),p.TgZ(11,"button",8),p._uU(12,"Close"),p.qZA(),p.TgZ(13,"button",9),p._uU(14,"Save"),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA())},styles:[""],data:{animation:[l.Y]}}),t}(),T=e(29609),b=e.n(T),v=e(15980),A=e(84521),q=e(99194),x=e(85354),y=function(){var t=function(){function t(i){n(this,t),this.plus=i,this.db=null,this.title="B\xe1o c\xe1o b\xe1n h\xe0ng",this.dbName="ban-hang",this.items=[],this.DoanhThu=0,this.LoiNhuan=0,this.DoanhThuThang=[],this.LoiNhuanThang=[],this.BanChay=[],this.BanNgoiNhieu=[]}return i(t,[{key:"ngOnDestroy",value:function(){console.log("Destroy bao-cao"),this.plus.subs.unsubscribe()}},{key:"ngOnInit",value:function(){var n=this;this.plus.setTiTle(this.title),this.plus.IDB_InitDB(this.dbName).subscribe(function(t){n.plus.updateUserLocal(t,"nhan-don"),n.db=t,n.plus.updateAPi.subscribe(function(t){n.getNhanDon()})})}},{key:"getNhanDon",value:function(){var n=this;this.plus.subs.add(this.plus.IDB_DB_GetAll(this.db,"nhan-don").subscribe(function(t){null==t&&(t=[]),n.items=t,n.doanhThuNgay(1)}))}},{key:"doanhThuNgay",value:function(n){for(var t=this.items,i=Date.now()-24*n*60*60*1e3,o=[],e=[],a=[],u=0;u<t.length;u++)if(t[u].dateModify>i&&t[u].LoiNhuan>0&&1==t[u].DaThanhToan){var r={LoiNhuan:1e3*t[u].LoiNhuan,ThanhTien:t[u].ThanhTien,Ngay:b()(t[u].dateModify).format("DD/MM")};o.push(r),t[u].DonMua.forEach(function(n){e.push({TenHangHoa:n.TenHangHoa,TongCong:n.TongCong})}),a.push({TenBan:t[u].TenBan,SoKH:t[u].SoKH})}this.DoanhThuThang=this.plus.generateChart(o,"Ngay","ThanhTien"),this.LoiNhuanThang=this.plus.generateChart(o,"Ngay","LoiNhuan"),this.DoanhThu=this.plus.sumByKey(o,"ThanhTien"),this.LoiNhuan=this.plus.sumByKey(o,"LoiNhuan");var c=this.plus.sortArr(e,"TongCong"),s=this.plus.generateChart(c,"TenHangHoa","TongCong");this.BanChay=this.plus.generateChart(s.slice(0,5),"x","y"),this.BanNgoiNhieu=this.plus.generateChart(a,"TenBan","SoKH")}}]),t}();return t.\u0275fac=function(n){return new(n||t)(p.Y36(d.T))},t.\u0275cmp=p.Xpm({type:t,selectors:[["app-bao-cao"]],decls:37,vars:24,consts:[[1,"container"],[1,"tit"],[1,"row","text-center"],["mat-raised-button","","color","warn"],[1,"row"],[3,"day"],[1,"row","my-3"],[1,"col-md-6"],[3,"id","arr","type"],[1,"col-md-4"],[1,"col-md-8"]],template:function(n,t){1&n&&(p.TgZ(0,"div",0),p.TgZ(1,"h5",1),p._uU(2,"B\xc1O C\xc1O B\xc1N H\xc0NG"),p.qZA(),p.TgZ(3,"div",2),p.TgZ(4,"button",3),p._uU(5),p.ALo(6,"commas"),p.qZA(),p.TgZ(7,"button",3),p._uU(8),p.ALo(9,"commas"),p.qZA(),p.qZA(),p.TgZ(10,"div",4),p.TgZ(11,"app-chip",5),p.NdJ("day",function(n){return t.doanhThuNgay(n)}),p.qZA(),p.qZA(),p.TgZ(12,"div",6),p.TgZ(13,"div",7),p.TgZ(14,"h6",1),p._uU(15,"B\u1ea3ng Doanh thu"),p.qZA(),p._UZ(16,"app-chart",8),p.qZA(),p.TgZ(17,"div",7),p.TgZ(18,"h6",1),p._uU(19,"B\u1ea3ng L\u1ee3i nhu\u1eadn"),p.qZA(),p._UZ(20,"app-chart",8),p.qZA(),p.qZA(),p._UZ(21,"hr"),p.TgZ(22,"h6",1),p._uU(23,"Top b\xe1n ch\u1ea1y"),p.qZA(),p.TgZ(24,"div",6),p.TgZ(25,"div",9),p._UZ(26,"app-chart",8),p.qZA(),p.TgZ(27,"div",10),p._UZ(28,"app-chart",8),p.qZA(),p.qZA(),p._UZ(29,"hr"),p.TgZ(30,"h6",1),p._uU(31,"Top B\xe0n kh\xe1ch ch\u1ecdn"),p.qZA(),p.TgZ(32,"div",6),p.TgZ(33,"div",9),p._UZ(34,"app-chart",8),p.qZA(),p.TgZ(35,"div",10),p._UZ(36,"app-chart",8),p.qZA(),p.qZA(),p.qZA()),2&n&&(p.xp6(5),p.hij(" Doanh thu: ",p.lcZ(6,20,t.DoanhThu),""),p.xp6(3),p.hij(" L\u1ee3i nhu\u1eadn: ",p.lcZ(9,22,t.LoiNhuan),""),p.xp6(8),p.Q6J("id","doanhthuthang")("arr",t.DoanhThuThang)("type","line"),p.xp6(4),p.Q6J("id","LoinhuanThan")("arr",t.LoiNhuanThang)("type","bar"),p.xp6(6),p.Q6J("id","BanChay")("arr",t.BanChay)("type","doughnut"),p.xp6(2),p.Q6J("id","BanChayBar")("arr",t.BanChay)("type","bar"),p.xp6(6),p.Q6J("id","BanNgoiNhieu")("arr",t.BanNgoiNhieu)("type","doughnut"),p.xp6(2),p.Q6J("id","BanNgoiNhieuBar")("arr",t.BanNgoiNhieu)("type","bar"))},directives:[v.lW,A.Y,q.x],pipes:[x.W],styles:["mat-chip[_ngcontent-%COMP%]{max-width:200px}"]}),t}(),k=e(43691);function D(n,t){1&n&&(p.TgZ(0,"h4",4),p._uU(1,"\u0110\xe3 ho\xe0n th\xe0nh "),p.qZA())}function _(n,t){if(1&n){var i=p.EpF();p.TgZ(0,"button",15),p.NdJ("click",function(){p.CHM(i);var n=p.oxw().index,t=p.oxw().$implicit;return p.oxw().onComplete(t,n)}),p.TgZ(1,"mat-icon"),p._uU(2,"done"),p.qZA(),p.qZA()}}function C(n,t){if(1&n&&(p.TgZ(0,"div",9),p.TgZ(1,"b",10),p._uU(2),p.TgZ(3,"b",11),p._uU(4),p.qZA(),p.qZA(),p.TgZ(5,"i",12),p._uU(6),p.qZA(),p._UZ(7,"br"),p.TgZ(8,"i",13),p._uU(9),p.ALo(10,"fromNow"),p.qZA(),p.YNc(11,_,3,0,"button",14),p.qZA()),2&n){var i=t.$implicit,o=p.oxw(2);p.Q6J("@slideIn",void 0),p.xp6(2),p.hij("",i.TenHangHoa,": "),p.xp6(2),p.AsE(" ",i.TongCong," ",i.DVT," "),p.xp6(2),p.Oqu(i.GhiChu),p.xp6(3),p.Oqu(p.lcZ(10,7,i.GioVao)),p.xp6(2),p.Q6J("ngIf",o.checkPer(2)&&0==i.DaLam)}}function B(n,t){if(1&n){var i=p.EpF();p.TgZ(0,"div"),p.TgZ(1,"div",5),p.TgZ(2,"h4",6),p._uU(3),p.qZA(),p.YNc(4,C,12,9,"div",7),p.TgZ(5,"button",8),p.NdJ("click",function(){var n=p.CHM(i).$implicit;return p.oxw().onCompleteAll(n)}),p.TgZ(6,"mat-icon"),p._uU(7,"done_all"),p.qZA(),p.qZA(),p.qZA(),p.qZA()}if(2&n){var o=t.$implicit;p.xp6(3),p.Oqu(o.TenBan),p.xp6(1),p.Q6J("ngForOf",o.DonMua)}}var N=function(){var t=function(){function t(i,o){n(this,t),this.plus=i,this.fb=o,this.dbName="ban-hang",this.db=null,this.api="nhan-don",this.items=[],this.tittle="Pha ch\u1ebf",this.DonMua=[],this.groups=[],this.main=this.fb.group({_id:[,[]],idHangHoa:[,[Z.kI.required]],TrangThai:[0,[Z.kI.required]]})}return i(t,[{key:"ngOnDestroy",value:function(){console.log("Destroy pha-che")}},{key:"ngOnInit",value:function(){var n=this;this.plus.setTiTle(this.tittle),this.plus.IDB_InitDB(this.dbName).subscribe(function(t){n.db=t,n.plus.updateUserLocal(t,n.api),n.plus.updateAPi.subscribe(function(i){n.plus.notify_send("C\xf3 kh\xe1ch v\xe0o!"),n.getIDB(t),n.plus.playUpdate()})})}},{key:"getIDB",value:function(n){var t=this;this.groups=[],this.plus.IDB_DB_GetAll(n,this.api).subscribe(function(n){for(var i=[],o=0;o<n.length;o++)if(0==n[o].DaThanhToan){var e=n[o].DonMua.filter(function(n){return 0==n.DaLam&&(t.addNewItem(n),t.groups.push(n)),0==n.DaLam});e.length>0&&(n[o].DonMua=e,i.push(n[o]))}t.items=i,console.log(t.groups),t.groupItems()})}},{key:"groupItems",value:function(){var n=this.plus.obj_GroupByKey(this.groups,"TenHangHoa");console.log(n)}},{key:"addNewItem",value:function(n){var t=this.DonMua.find(function(t){return t._id==n._id});if(window.navigator.vibrate(200),t){var i=this.DonMua.findIndex(function(n){return n._id==t._id});this.DonMua[i].TongCong+=n.TongCong}else n.TongCong=1,n.GioVao=Date.now(),n.DaLam=!1,this.DonMua.push(n)}},{key:"onComplete",value:function(n,t){var i=this;console.log(n,t);var o=n;delete o.__v,o.DonMua[t].DaLam=!0,console.log(o),this.plus.httpPut(this.api,o).subscribe(function(n){console.log(n),i.getIDB(i.db)})}},{key:"onCompleteAll",value:function(n){var t=this,i=n;delete i.__v;for(var o=0;o<i.DonMua.length;o++)i.DonMua[o].DaLam=!0;console.log(i),this.plus.httpPut(this.api,i).subscribe(function(n){console.log(n),t.plus.IDB_DB_Add(t.db,t.api,i),t.getIDB(t.db)})}},{key:"reload",value:function(){this.plus.reload("ban-hang/pha-che")}},{key:"checkPer",value:function(n){return this.plus.checkPer(this.api,n)}}]),t}();return t.\u0275fac=function(n){return new(n||t)(p.Y36(d.T),p.Y36(Z.qu))},t.\u0275cmp=p.Xpm({type:t,selectors:[["app-pha-che"]],decls:4,vars:2,consts:[[1,"container"],["class","text-center text-primary",4,"ngIf"],[1,"card-group"],[4,"ngFor","ngForOf"],[1,"text-center","text-primary"],[1,"card","text-center","mx-3","mb-3"],[1,"card-title","bg-success"],["class","card-body text-left",4,"ngFor","ngForOf"],["mat-raised-button","","color","accent",3,"click"],[1,"card-body","text-left"],[1,"font-blue"],[1,"text-danger","mx-3"],[1,"font-red","font-note"],[1,"mx-3"],["hidden","","mat-raised-button","","color","accent",3,"click",4,"ngIf"],["hidden","","mat-raised-button","","color","accent",3,"click"]],template:function(n,t){1&n&&(p.TgZ(0,"div",0),p.YNc(1,D,2,0,"h4",1),p.TgZ(2,"div",2),p.YNc(3,B,8,2,"div",3),p.qZA(),p.qZA()),2&n&&(p.xp6(1),p.Q6J("ngIf",0==t.items.length),p.xp6(2),p.Q6J("ngForOf",t.items))},directives:[h.O5,h.sg,v.lW,k.Hw],pipes:[x.dw],styles:[".card[_ngcontent-%COMP%], .card-title[_ngcontent-%COMP%]{border-radius:1rem}"],data:{animation:[l.Y]}}),t}(),M=e(43605),U=e(55109),w=e(66283),I=e(26756);function H(n,t){if(1&n&&(p.TgZ(0,"button",32),p._uU(1),p.qZA()),2&n){var i=p.oxw();p.xp6(1),p.hij("B\xe0n hi\u1ec7n t\u1ea1i: ",i.BanDuocChon.TenBan,"")}}function J(n,t){if(1&n){var i=p.EpF();p.TgZ(0,"div"),p.TgZ(1,"button",33),p.NdJ("click",function(){return p.CHM(i),p.oxw().LuuTam()}),p._uU(2),p.qZA(),p.TgZ(3,"button",33),p.NdJ("click",function(){return p.CHM(i),p.oxw().LuuCho()}),p._uU(4,"L\u01b0u"),p.qZA(),p.TgZ(5,"button",34),p.NdJ("click",function(){return p.CHM(i),p.oxw().thanhToan()}),p._uU(6),p.ALo(7,"commas"),p.qZA(),p.qZA()}if(2&n){var o=p.oxw();p.xp6(2),p.Oqu(o.xemMon?"Th\xeam ghi ch\xfa":"Ch\u1ecdn th\xeam m\xf3n"),p.xp6(4),p.AsE("",o.total," m\xf3n: ",p.lcZ(7,3,o.ThanhTien),"")}}function O(n,t){if(1&n&&(p.TgZ(0,"button",47),p._uU(1),p.ALo(2,"commas"),p.qZA()),2&n){var i=p.oxw(2).$implicit;p.xp6(1),p.Oqu(p.lcZ(2,1,i.ThanhTien))}}function F(n,t){if(1&n&&(p.TgZ(0,"span",48),p._uU(1),p.ALo(2,"fromNow"),p.qZA()),2&n){var i=p.oxw(2).$implicit;p.xp6(1),p.hij(" ",p.lcZ(2,1,i.GioVao),"")}}var L=function(n){return{"border border-danger":n}};function G(n,t){if(1&n){var i=p.EpF();p.TgZ(0,"div",42),p.NdJ("click",function(){p.CHM(i);var n=p.oxw().index;return p.oxw(3).chonBan(n)}),p.TgZ(1,"h4",43),p._uU(2),p.qZA(),p.YNc(3,O,3,3,"button",44),p.YNc(4,F,3,3,"span",45),p._UZ(5,"div",46),p.qZA()}if(2&n){var o=p.oxw().$implicit;p.Q6J("ngClass",p.VKq(4,L,o.ThanhTien>0)),p.xp6(2),p.Oqu(o.TenBan),p.xp6(1),p.Q6J("ngIf",o.ThanhTien>0),p.xp6(1),p.Q6J("ngIf",o.GioVao>0)}}function Q(n,t){if(1&n&&(p.TgZ(0,"div",40),p.YNc(1,G,6,6,"div",41),p.qZA()),2&n){var i=t.$implicit,o=p.oxw().$implicit;p.xp6(1),p.Q6J("ngIf",i.NhomBan==o.NoiDung)}}function P(n,t){if(1&n&&(p.TgZ(0,"mat-tab",38),p.TgZ(1,"div",27),p.YNc(2,Q,2,1,"div",39),p.qZA(),p.qZA()),2&n){var i=t.$implicit,o=p.oxw(2);p.s9C("label",i.NoiDung),p.xp6(2),p.Q6J("ngForOf",o.ChiaBan)}}function Y(n,t){if(1&n&&(p.TgZ(0,"div",35),p.TgZ(1,"mat-tab-group",36),p.YNc(2,P,3,2,"mat-tab",37),p.qZA(),p.qZA()),2&n){var i=p.oxw();p.xp6(1),p.Q6J("@slideIn",void 0),p.xp6(1),p.Q6J("ngForOf",i.TabBan)}}function V(n,t){if(1&n){var i=p.EpF();p.TgZ(0,"div",55),p.NdJ("click",function(){var n=p.CHM(i).$implicit;return p.oxw(4).addNewItem(n)}),p.TgZ(1,"div",56),p.TgZ(2,"h4",57),p._uU(3),p.qZA(),p.qZA(),p.qZA()}if(2&n){var o=t.$implicit;p.xp6(1),p.Udp("border-bottom-color",o.MauSac),p.xp6(2),p.hij("",o.TenHangHoa," ")}}function E(n,t){if(1&n&&(p.TgZ(0,"mat-tab",38),p.TgZ(1,"div",53),p.YNc(2,V,4,3,"div",54),p.ALo(3,"filterByKV"),p.qZA(),p.qZA()),2&n){var i=t.$implicit,o=p.oxw(3);p.s9C("label",i.NoiDung),p.xp6(1),p.Q6J("@slideX",void 0),p.xp6(1),p.Q6J("ngForOf",p.Dn7(3,3,o.items,"NhomHang",i.NoiDung))}}function K(n,t){if(1&n&&(p.TgZ(0,"div",52),p.TgZ(1,"mat-tab-group",36),p.YNc(2,E,4,7,"mat-tab",37),p.qZA(),p.qZA()),2&n){var i=p.oxw(2);p.xp6(1),p.Q6J("@slideIn",void 0),p.xp6(1),p.Q6J("ngForOf",i.NhomHang)}}function j(n,t){if(1&n){var i=p.EpF();p.TgZ(0,"span",73),p.NdJ("click",function(){p.CHM(i);var n=p.oxw().index;return p.oxw(3).delItem(n)}),p._UZ(1,"i",74),p.qZA()}}function S(n,t){if(1&n&&(p.TgZ(0,"i",75),p._uU(1),p.qZA()),2&n){var i=p.oxw().$implicit;p.xp6(1),p.Oqu(i.GhiChu.length>30?i.GhiChu.slice(0,25)+"...":i.GhiChu)}}function $(n,t){if(1&n){var i=p.EpF();p.TgZ(0,"i",76),p.NdJ("click",function(){p.CHM(i);var n=p.oxw().index;return p.oxw(3).openModal(n)}),p.qZA()}}function W(n,t){if(1&n){var i=p.EpF();p.TgZ(0,"mat-icon",77),p.NdJ("click",function(){p.CHM(i);var n=p.oxw().index;return p.oxw(3).removeItem(n)}),p._uU(1,"arrow_left"),p.qZA()}}function X(n,t){if(1&n){var i=p.EpF();p.TgZ(0,"mat-icon",78),p.NdJ("click",function(){p.CHM(i);var n=p.oxw(),t=n.$implicit,o=n.index;return p.oxw(3).addItem(t,o)}),p._uU(1,"arrow_right"),p.qZA()}}function R(n,t){if(1&n&&(p.TgZ(0,"tr",59),p.TgZ(1,"td",60),p._uU(2),p.YNc(3,j,2,0,"span",63),p.qZA(),p.TgZ(4,"td",64),p.TgZ(5,"b",65),p._uU(6),p.qZA(),p._UZ(7,"br"),p._uU(8),p.ALo(9,"commas"),p.YNc(10,S,2,1,"i",66),p.YNc(11,$,1,0,"i",67),p.qZA(),p.TgZ(12,"td",68),p.TgZ(13,"mat-form-field"),p.YNc(14,W,2,0,"mat-icon",69),p._UZ(15,"input",70),p.ALo(16,"number"),p.YNc(17,X,2,0,"mat-icon",71),p.qZA(),p.qZA(),p.TgZ(18,"td",72),p._uU(19),p.ALo(20,"commas"),p.qZA(),p.qZA()),2&n){var i=t.$implicit,o=t.index;p.xp6(2),p.hij("",o+1," "),p.xp6(1),p.Q6J("ngIf",0==i.DaLam),p.xp6(3),p.hij(" ",i.TenHangHoa,""),p.xp6(2),p.AsE(" ",p.lcZ(9,11,1e3*i.GiaBan)," ",i.KhuyenMai>0?"(Gi\u1ea3m "+i.KhuyenMai+"%)":""," "),p.xp6(2),p.Q6J("ngIf",0==i.DaLam),p.xp6(1),p.Q6J("ngIf",0==i.DaLam),p.xp6(3),p.Q6J("ngIf",0==i.DaLam),p.xp6(1),p.s9C("value",p.lcZ(16,13,i.TongCong)),p.xp6(2),p.Q6J("ngIf",0==i.DaLam),p.xp6(2),p.Oqu(p.lcZ(20,15,i.TongCong*(i.GiaBan-i.GiaBan*i.KhuyenMai/100)*1e3))}}function z(n,t){if(1&n){var i=p.EpF();p.TgZ(0,"div",1),p.TgZ(1,"table",58),p.TgZ(2,"thead",18),p.TgZ(3,"tr",59),p.TgZ(4,"th"),p._uU(5,"TT "),p.qZA(),p.TgZ(6,"th"),p._uU(7,"H\u1ea1ng m\u1ee5c"),p.qZA(),p.TgZ(8,"th",60),p._uU(9,"S\u1ed1 l\u01b0\u1ee3ng"),p.qZA(),p._UZ(10,"th"),p.qZA(),p.qZA(),p.TgZ(11,"tbody"),p.YNc(12,R,21,17,"tr",61),p.TgZ(13,"tr",35),p.TgZ(14,"td",62),p.TgZ(15,"h5"),p._uU(16),p.ALo(17,"commas"),p.qZA(),p.TgZ(18,"h6"),p.TgZ(19,"i"),p._uU(20),p.ALo(21,"titlecase"),p.qZA(),p.qZA(),p.qZA(),p.TgZ(22,"td"),p.TgZ(23,"button",34),p.NdJ("click",function(){return p.CHM(i),p.oxw(2).thanhToan()}),p._uU(24),p.ALo(25,"commas"),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA()}if(2&n){var o=p.oxw(2);p.xp6(12),p.Q6J("ngForOf",o.BanDuocChon.DonMua),p.xp6(4),p.AsE("T\u1ed5ng c\u1ed9ng: ",p.lcZ(17,5,o.ThanhTien)," / ",o.total," m\xf3n"),p.xp6(4),p.Oqu(p.lcZ(21,7,o.bangchu)),p.xp6(4),p.hij("Thanh to\xe1n ",p.lcZ(25,9,o.ThanhTien),"")}}function nn(n,t){if(1&n&&(p.TgZ(0,"div",49),p.YNc(1,K,3,2,"div",50),p.YNc(2,z,26,11,"div",51),p.qZA()),2&n){var i=p.oxw();p.xp6(1),p.Q6J("ngIf",i.xemMon),p.xp6(1),p.Q6J("ngIf",!i.xemMon)}}function tn(n,t){if(1&n&&(p.TgZ(0,"tr"),p.TgZ(1,"td"),p._uU(2),p.qZA(),p.TgZ(3,"td"),p._uU(4),p._UZ(5,"br"),p._uU(6),p.ALo(7,"commas"),p.qZA(),p.TgZ(8,"td",35),p._uU(9),p.qZA(),p.TgZ(10,"td",81),p._uU(11),p.ALo(12,"commas"),p.qZA(),p.qZA()),2&n){var i=t.$implicit,o=t.index;p.xp6(2),p.hij("",o+1," "),p.xp6(2),p.hij(" ",i.TenHangHoa," "),p.xp6(2),p.AsE(" ",p.lcZ(7,6,1e3*i.GiaBan)," ",i.KhuyenMai>0?"(Gi\u1ea3m "+i.KhuyenMai+"%)":""," "),p.xp6(3),p.Oqu(i.TongCong),p.xp6(2),p.Oqu(p.lcZ(12,8,i.TongCong*(i.GiaBan-i.GiaBan*i.KhuyenMai/100)*1e3))}}function on(n,t){if(1&n&&(p.TgZ(0,"tbody"),p.YNc(1,tn,13,10,"tr",28),p.TgZ(2,"tr"),p.TgZ(3,"td",79),p.TgZ(4,"h5"),p._uU(5,"T\u1ed5ng c\u1ed9ng:"),p.qZA(),p.qZA(),p.TgZ(6,"td"),p.TgZ(7,"h5"),p._uU(8),p.qZA(),p.qZA(),p.TgZ(9,"td",35),p.TgZ(10,"h5"),p._uU(11),p.ALo(12,"commas"),p.qZA(),p.TgZ(13,"h6"),p.TgZ(14,"i"),p._uU(15),p.ALo(16,"titlecase"),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.TgZ(17,"td",80),p.TgZ(18,"h6"),p._uU(19,"Xin c\u1ea3m \u01a1n qu\xfd kh\xe1ch"),p.qZA(),p.TgZ(20,"h6"),p._uU(21,"S\u1ea3n ph\u1ea9m c\u1ee7a 4la.vn"),p.qZA(),p.qZA(),p.qZA()),2&n){var i=p.oxw();p.xp6(1),p.Q6J("ngForOf",i.BanDuocChon.DonMua),p.xp6(7),p.hij("",i.total," m\xf3n"),p.xp6(3),p.hij(" ",p.lcZ(12,4,i.ThanhTien),""),p.xp6(4),p.Oqu(p.lcZ(16,6,i.bangchu))}}function en(n,t){if(1&n){var i=p.EpF();p.TgZ(0,"div"),p.TgZ(1,"span",82),p.NdJ("click",function(){var n=p.CHM(i).$implicit;return p.oxw().note.push(n.NoiDung)}),p._uU(2),p.qZA(),p.qZA()}if(2&n){var o=t.$implicit;p.xp6(2),p.Oqu(o.NoiDung)}}function an(n,t){if(1&n){var i=p.EpF();p.TgZ(0,"div"),p.TgZ(1,"span",83),p.NdJ("click",function(){var n=p.CHM(i).$implicit;return p.oxw().note.push(n.NoiDung)}),p._uU(2),p.qZA(),p.qZA()}if(2&n){var o=t.$implicit;p.xp6(2),p.Oqu(o.NoiDung)}}var un=function(){var t=function(){function t(i,o,e){n(this,t),this.plus=i,this.route=o,this.fb=e,this.db=null,this.title="H\xe0ng h\xf3a",this.dbName="ban-hang",this.api="nhan-don",this.tabs=[],this.items=[],this.DonMua=[],this.total=0,this.ThanhTien=0,this.donHang=[],this.bangchu="",this.filter=[],this.note=[],this.user=this.plus.user.getValue(),this.printTime=Date.now(),this.NhomHang=this.plus.user.getValue().NhomHang,this.TabBan=this.plus.sortArr(this.plus.user.getValue().NhomBan,"ThuTu",1),this.ChiaBan=[],this.ban=0,this.now=Date.now(),this.xemBan=!0,this.xemMon=!1,this.donHangFB=this.fb.group({TenBan:[,[Z.kI.required]],NhomBan:[,[Z.kI.required]],ThanhTien:[,[Z.kI.required]],LoiNhuan:[,[Z.kI.required]],SoKH:[,[Z.kI.required]],GioVao:[,[Z.kI.required]],DaThanhToan:[,[Z.kI.required]],DonMua:this.fb.array([this.fb.group({idHangHoa:[,[Z.kI.required]],DVT:[,[Z.kI.required]],GiaBan:[,[Z.kI.required]],GiaVon:[,[Z.kI.required]],KhuyenMai:[,[Z.kI.required]],TenHangHoa:[,[Z.kI.required]],TongCong:[,[Z.kI.required]],DaLam:[,[]],GioVao:[,[Z.kI.required]],GhiChu:[]})])})}return i(t,[{key:"ngOnDestroy",value:function(){if(console.log("Destroy nhan-don"),console.log(this.BanDuocChon),this.note.length>0&&confirm("Ban c\xf3 mu\u1ed1n l\u01b0u ghi ch\xfa?"))return this.LuuCho();this.plus.subs.unsubscribe()}},{key:"ngOnInit",value:function(){var n=this;this.chiaBan(),this.plus.setTiTle(this.title),this.plus.IDB_InitDB(this.dbName).subscribe(function(t){n.db=t,n.getHangHoa(),n.plus.updateUserLocal(t,n.api),n.getDonHangLocal(),n.plus.updateAPi.subscribe(function(t){console.log("updateAPi",t),n.chiaBan(),n.getDonHangLocal()})}),this.DonMua=[]}},{key:"thanhToan",value:function(){var n=this,t=confirm("B\u1ea1n c\xf3 mu\u1ed1n in h\xf3a \u0111\u01a1n ko?"),i=this.BanDuocChon;if(delete i.__v,i.DaThanhToan=!0,0==i.ThanhTien&&(this.BanDuocChon=Object.assign(this.BanDuocChon,{DonMua:this.DonMua.map(function(n){return{idHangHoa:n._id,TenHangHoa:n.TenHangHoa,GiaBan:n.GiaBan,GiaVon:n.GiaVon,KhuyenMai:n.KhuyenMai,DVT:n.DVT,TongCong:n.TongCong,DaLam:n.DaLam}}),LoiNhuan:this.DonMua.map(function(n){return n.GiaBan-n.GiaVon-n.GiaBan*n.KhuyenMai/100}).reduce(function(n,t){return n+t}),ThanhTien:this.ThanhTien,GioVao:Date.now(),SoKH:this.total,DaThanhToan:!0}),this.donHangFB.patchValue(this.BanDuocChon),this.donHangFB.invalid)){var o=this.plus.getErrValidateForm(this.donHangFB);console.log(o)}void 0!==i._id?(delete i.__v,this.plus.httpPut("nhan-don",i).subscribe(function(t){n.back(),n.plus.IDB_DB_Add(n.db,n.api,i)})):this.plus.httpPost("nhan-don",i).subscribe(function(t){n.back()}),t?(this.PrintDiv("HoaDon"),console.log(0,i)):console.log(1,i)}},{key:"getDonHangLocal",value:function(){var n=this;this.plus.subs.add(this.plus.IDB_DB_GetAll(this.db,this.api,"TenBan",1).pipe((0,M.map)(function(n){return n?n.filter(function(n){return 0==n.DaThanhToan}):[]})).subscribe(function(t){null==t&&(t=[]),n.donHang=t,n.ChiaBan=t.concat(n.ChiaBan.filter(function(n){var i=n.TenBan;return!t.find(function(n){return n.TenBan==i})})),n.ChiaBan=n.plus.sortArr(n.ChiaBan,"TenBan",1)}))}},{key:"LuuTam",value:function(){this.xemMon=!this.xemMon,this.ChiaBan[this.ban]=Object.assign(this.ChiaBan[this.ban],{DonMua:this.DonMua.map(function(n){return{idHangHoa:n._id,TenHangHoa:n.TenHangHoa,GiaBan:n.GiaBan,GiaVon:n.GiaVon,KhuyenMai:n.KhuyenMai,DVT:n.DVT,TongCong:n.TongCong,DaLam:n.DaLam,GioVao:n.GioVao,GhiChu:n.GhiChu}}),LoiNhuan:this.DonMua.map(function(n){return n.GiaBan-n.GiaVon-n.GiaBan*n.KhuyenMai/100}).reduce(function(n,t){return n+t}),ThanhTien:this.ThanhTien,GioVao:Date.now(),SoKH:this.total,DaThanhToan:!1})}},{key:"LuuCho",value:function(){this.LuuTam(),this.xemMon=!1,this.xemBan=!0,this.total=0,this.DonMua=[];var n=this.ChiaBan[this.ban];if(this.donHangFB.patchValue(n),this.donHangFB.valid)console.log(n._id),void 0!==n._id?(delete n.__v,this.plus.httpPut("nhan-don",n).subscribe(function(n){console.log(n)})):this.plus.httpPost("nhan-don",n).subscribe(function(n){console.log(n)});else{var t=this.plus.getErrValidateForm(this.donHangFB);console.log(t)}}},{key:"chiaBan",value:function(){var n=this;this.plus.load(),this.ChiaBan=[],this.TabBan.forEach(function(t){n.ChiaBan.push({TenBan:t.NoiDung+"- Mang v\u1ec1",NhomBan:t.NoiDung,DonMua:[],ThanhTien:0,GioVao:0,SoKH:0,DaThanhToan:!1});for(var i=1;i<t.SoLuong+1;i++)n.ChiaBan.push({TenBan:t.NoiDung+"-"+i,NhomBan:t.NoiDung,DonMua:[],ThanhTien:0,GioVao:0,SoKH:0,DaThanhToan:!1})}),this.plus.loaded()}},{key:"chonBan",value:function(n){this.BanDuocChon=this.ChiaBan[n],console.log(this.BanDuocChon),this.bangchu=this.plus.numToVi(this.BanDuocChon.ThanhTien),this.xemBan=!1,this.ban=n;var t=this.ChiaBan[n];console.log(t),t.ThanhTien>0?(this.DonMua=t.DonMua,this.xemMon=!1):this.xemMon=!0,this.getTongCong()}},{key:"getHangHoa",value:function(){var n=this;this.plus.subs.add(this.plus.IDB_DB_GetAll(this.db,"hang-hoa").subscribe(function(t){try{n.items=t}catch(i){n.items=[],n.plus.alertWarning("B\u1ea1n ch\u01b0a c\xf3 h\xe0ng h\xf3a trong kho!!!")}0==t.length&&n.plus.alertWarning("B\u1ea1n ch\u01b0a c\xf3 h\xe0ng h\xf3a trong kho!"),console.log("getHangHoa: "+t.length)}))}},{key:"addNewItem",value:function(n){var t=this.DonMua.find(function(t){return t._id==n._id});if(window.navigator.vibrate(200),!t)return n.TongCong=1,n.GioVao=Date.now(),n.DaLam=!1,n.GhiChu=this.note.join(" "),this.DonMua.push(n),this.getTongCong();var i=this.DonMua.findIndex(function(n){return n._id==t._id});this.DonMua[i].TongCong+=1,this.getTongCong()}},{key:"removeItem",value:function(n){this.BanDuocChon.DonMua[n].TongCong>0&&(this.BanDuocChon.DonMua[n].TongCong-=1),this.getTongCong()}},{key:"addItem",value:function(n,t){this.BanDuocChon.DonMua[t].TongCong+=1,this.getTongCong()}},{key:"delItem",value:function(n){this.BanDuocChon.DonMua.splice(n,1),this.getTongCong()}},{key:"getTongCong",value:function(){this.total=this.plus.sumByKey(this.DonMua,"TongCong"),this.getThanhTien()}},{key:"getThanhTien",value:function(){var n=0;return this.DonMua.forEach(function(t){n+=(t.GiaBan-t.GiaBan*t.KhuyenMai/100)*t.TongCong*1e3}),this.ThanhTien=n}},{key:"openModal",value:function(n){this.plus.clickBtn("ghichubtn"),this.indexDonMua=n}},{key:"addNote",value:function(){this.BanDuocChon.DonMua[this.indexDonMua].GhiChu=this.note.join(", "),this.note=[]}},{key:"updateList",value:function(n,t,i){var o=+i.target.textContent;if(console.log(o),"Enter"===i.key&&i.preventDefault(),"number"!=typeof o)return this.plus.alertError("Sai \u0111\u1ecbnh d\u1ea1ng"),this.DonMua[n][t]=0;this.DonMua[n][t]=+o,this.getTongCong()}},{key:"PrintDiv",value:function(n){var t=window.document.getElementById(n),i=window.open("","PRINT");i.document.write(document.documentElement.innerHTML),setTimeout(function(){i.document.body.innerHTML=t.outerHTML,i.document.close(),i.focus(),i.print(),i.close()},1e3)}},{key:"back",value:function(){this.plus.reload("ban-hang/nhan-don")}}]),t}();return t.\u0275fac=function(n){return new(n||t)(p.Y36(d.T),p.Y36(f.gz),p.Y36(Z.qu))},t.\u0275cmp=p.Xpm({type:t,selectors:[["app-nhan-don"]],decls:65,vars:18,consts:[[1,"row","text-center","inline"],[1,"col"],["mat-raised-button","","color","primary",3,"click"],["mat-raised-button","","color","warn","class","float-rigth",4,"ngIf"],[4,"ngIf"],["class","text-center",4,"ngIf"],["class","row",4,"ngIf"],["id","modelId","tabindex","-1","role","dialog","aria-labelledby","modelTitleId","aria-hidden","true",1,"modal","fade"],["role","document",1,"modal-dialog"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],["type","button","data-dismiss","modal","aria-label","Close",1,"close"],["aria-hidden","true"],[1,"modal-body","hoadon"],["id","HoaDon",1,"div"],[1,"text-left"],[1,"table","table-hover"],[1,"thead-inverse"],[1,"modal-footer"],["type","button","data-dismiss","modal",1,"btn","btn-secondary"],["type","button",1,"btn","btn-primary"],["id","ghichubtn","mat-raised-button","","color","accent","data-toggle","modal","data-target","#notes",1,"d-none"],["id","notes","tabindex","-1","role","dialog","aria-labelledby","modelTitleId","aria-hidden","true",1,"modal","fade"],["notes",""],["role","document",1,"modal-dialog","modal-sm"],[1,"modal-body"],[1,"card-group"],[4,"ngFor","ngForOf"],["type","text","placeholder","Ghi ch\xfa kh\xe1c",1,"form-control",3,"blur"],["ghichuKhac",""],["type","button","data-dismiss","modal",1,"btn","btn-primary",3,"click"],["mat-raised-button","","color","warn",1,"float-rigth"],["mat-raised-button","","color","accent",3,"click"],["mat-raised-button","","color","warn",3,"click"],[1,"text-center"],["dynamicHeight",""],[3,"label",4,"ngFor","ngForOf"],[3,"label"],["class","div",4,"ngFor","ngForOf"],[1,"div"],["class","card hangHoa",3,"ngClass","click",4,"ngIf"],[1,"card","hangHoa",3,"ngClass","click"],[1,"text-center","pt-3"],["class","badge badge-warning",4,"ngIf"],["class","badge badge-light",4,"ngIf"],[1,"card-body","py-3","px-2"],[1,"badge","badge-warning"],[1,"badge","badge-light"],[1,"row"],["class","list",4,"ngIf"],["class","col",4,"ngIf"],[1,"list"],["id","item",1,"card-group"],[3,"click",4,"ngFor","ngForOf"],[3,"click"],[1,"card","hangHoa"],[1,"text-center","py-3"],["id","myDiv",1,"table","table-hover"],[1,"d-flex"],[1,"col-1"],["class","d-flex",4,"ngFor","ngForOf"],["colspan","3"],["class","badge badge-danger mx-2 ",3,"click",4,"ngIf"],[1,"col-6"],[1,"font-blue"],["class"," font-note",4,"ngIf"],["class","fa fa-pencil text-success",3,"click",4,"ngIf"],[1,"col-2"],["matPrefix","",3,"click",4,"ngIf"],["readonly","","required","","type","text","autocomplete","off","matInput","",2,"text-align","center",3,"value"],["matSuffix","",3,"click",4,"ngIf"],[1,"col-3"],[1,"badge","badge-danger","mx-2",3,"click"],["aria-hidden","true",1,"fa","fa-trash"],[1,"font-note"],[1,"fa","fa-pencil","text-success",3,"click"],["matPrefix","",3,"click"],["matSuffix","",3,"click"],["colspan","2",1,"text-center"],["colspan","4",1,"text-center"],[1,"text-rigth"],[1,"badge","badge-primary","py-2","mx-2","my-2",3,"click"],[1,"badge","badge-warning","py-2","mx-2","my-2",3,"click"]],template:function(n,t){if(1&n){var i=p.EpF();p.TgZ(0,"div",0),p.TgZ(1,"div",1),p.TgZ(2,"button",2),p.NdJ("click",function(){return t.back()}),p._uU(3,"Ch\u1ecdn b\xe0n"),p.qZA(),p.YNc(4,H,2,1,"button",3),p.qZA(),p.TgZ(5,"div",1),p.YNc(6,J,8,5,"div",4),p.qZA(),p.qZA(),p.YNc(7,Y,3,2,"div",5),p.YNc(8,nn,3,2,"div",6),p.TgZ(9,"div",7),p.TgZ(10,"div",8),p.TgZ(11,"div",9),p.TgZ(12,"div",10),p.TgZ(13,"h5",11),p._uU(14,"Modal title"),p.qZA(),p.TgZ(15,"button",12),p.TgZ(16,"span",13),p._uU(17,"\xd7"),p.qZA(),p.qZA(),p.qZA(),p.TgZ(18,"div",14),p.TgZ(19,"div",15),p.TgZ(20,"div",16),p.TgZ(21,"h6"),p._uU(22),p.qZA(),p.TgZ(23,"h6"),p._uU(24),p.qZA(),p.TgZ(25,"h6"),p._uU(26),p.ALo(27,"date"),p.qZA(),p.qZA(),p.TgZ(28,"table",17),p.TgZ(29,"thead",18),p.TgZ(30,"tr"),p.TgZ(31,"th"),p._uU(32,"TT"),p.qZA(),p.TgZ(33,"th"),p._uU(34,"H\u1ea1ng m\u1ee5c"),p.qZA(),p.TgZ(35,"th"),p._uU(36,"S\u1ed1 l\u01b0\u1ee3ng"),p.qZA(),p.TgZ(37,"th"),p._uU(38,"Th\xe0nh ti\u1ec1n"),p.qZA(),p.qZA(),p.qZA(),p.YNc(39,on,22,8,"tbody",4),p.qZA(),p.qZA(),p.qZA(),p.TgZ(40,"div",19),p.TgZ(41,"button",20),p._uU(42,"Close"),p.qZA(),p.TgZ(43,"button",21),p._uU(44,"Save"),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p._UZ(45,"button",22),p.TgZ(46,"div",23,24),p.TgZ(48,"div",25),p.TgZ(49,"div",9),p.TgZ(50,"div",10),p.TgZ(51,"h6",11),p._uU(52,"Ghi ch\xfa"),p.qZA(),p.qZA(),p.TgZ(53,"div",26),p._uU(54),p.TgZ(55,"div",27),p.YNc(56,en,3,1,"div",28),p.ALo(57,"catalog"),p.YNc(58,an,3,1,"div",28),p.ALo(59,"catalog"),p.qZA(),p.qZA(),p.TgZ(60,"input",29,30),p.NdJ("blur",function(){p.CHM(i);var n=p.MAs(61);return t.note.push(n.value)}),p.qZA(),p.TgZ(62,"div",19),p.TgZ(63,"button",31),p.NdJ("click",function(){return t.addNote()}),p._uU(64," Ok "),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA()}2&n&&(p.xp6(4),p.Q6J("ngIf",t.BanDuocChon),p.xp6(2),p.Q6J("ngIf",t.total>0),p.xp6(1),p.Q6J("ngIf",t.xemBan),p.xp6(1),p.Q6J("ngIf",!t.xemBan),p.xp6(14),p.Oqu(t.user.title),p.xp6(2),p.Oqu(t.user.phoneNumber),p.xp6(2),p.hij("Gi\u1edd in: ",p.xi3(27,11,t.printTime,"HH:MM dd/MM/yyyy"),""),p.xp6(13),p.Q6J("ngIf",t.BanDuocChon),p.xp6(15),p.hij(" ",t.note.join(", ")," "),p.xp6(2),p.Q6J("ngForOf",p.lcZ(57,14,"SoLy")),p.xp6(2),p.Q6J("ngForOf",p.lcZ(59,16,"GhiChuMon")))},directives:[v.lW,h.O5,h.sg,U.SP,U.uX,h.mk,w.KE,I.Nt,k.Hw,w.qo,w.R9],pipes:[h.uU,x.pW,x.W,x.dw,x.H$,h.rS,h.JJ],styles:[".hangHoa[_ngcontent-%COMP%]{height:10rem;width:10rem;border-radius:1rem;margin:.2rem;border-bottom-width:3rem;border-color:#90ee90;color:blue;float:left;display:flex;align-items:center;justify-content:center}@media print,screen{.container[_ngcontent-%COMP%]{background-color:#999;position:relative;border:1px solid #000;width:500px;height:500px}}@media screen{.hideForPrint[_ngcontent-%COMP%]{position:absolute;width:100px;height:200px;top:100px;left:50px;border:5px dashed #ccc;z-index:98;background-color:#fff}}@media print{.hideForPrint[_ngcontent-%COMP%], .hideForPrint2[_ngcontent-%COMP%], .noPrint[_ngcontent-%COMP%]{display:none}}.hangHoa[_ngcontent-%COMP%]:active{transform:scale(1.1);opacity:50%;background-color:tomato}.hoadon[_ngcontent-%COMP%]{width:200px}mat-icon[_ngcontent-%COMP%]{transform:scale(2);color:tomato}mat-icon[_ngcontent-%COMP%]:active{transform:scale(2.2);color:red}"],data:{animation:[l.Y,l.M]}}),t}(),rn=e(47701),cn=e(89274),sn=e(69121),hn=e(39012),ln=e(78477);function gn(n,t){if(1&n){var i=p.EpF();p.TgZ(0,"div",16),p.TgZ(1,"div",3),p.TgZ(2,"button",17),p.NdJ("click",function(){p.CHM(i);var n=p.oxw();return n.showInput=!n.showInput}),p._UZ(3,"i",18),p.qZA(),p.qZA(),p.qZA()}}function dn(n,t){if(1&n&&(p.TgZ(0,"option",38),p._uU(1),p.qZA()),2&n){var i=t.$implicit;p.s9C("value",i.NoiDung),p.xp6(1),p.Oqu(i.NoiDung)}}function pn(n,t){if(1&n&&(p.TgZ(0,"option",38),p._uU(1),p.qZA()),2&n){var i=t.$implicit;p.s9C("value",i.NoiDung),p.xp6(1),p.hij("",i.NoiDung," ")}}function Zn(n,t){if(1&n){var i=p.EpF();p.TgZ(0,"button",39),p.NdJ("click",function(){return p.CHM(i),p.oxw(2).save()}),p._uU(1,"L\u01b0u"),p.qZA()}}function fn(n,t){if(1&n){var i=p.EpF();p.TgZ(0,"div",2),p.TgZ(1,"form",6),p.TgZ(2,"div",2),p.TgZ(3,"div",3),p.TgZ(4,"div",19),p.TgZ(5,"div",20),p.TgZ(6,"span",21),p._uU(7,"Nh\xf3m"),p.qZA(),p.qZA(),p.TgZ(8,"select",22),p.YNc(9,dn,2,2,"option",23),p.qZA(),p.qZA(),p.TgZ(10,"div",19),p.TgZ(11,"div",20),p.TgZ(12,"span",21),p._uU(13,"T\xean"),p.qZA(),p.qZA(),p._UZ(14,"input",24),p.qZA(),p.TgZ(15,"div",19),p.TgZ(16,"div",20),p.TgZ(17,"span",21),p._uU(18,"Gi\xe1 v\u1ed1n"),p.qZA(),p.qZA(),p._UZ(19,"input",25),p.TgZ(20,"div",26),p.TgZ(21,"span",21),p._uU(22,"000"),p.qZA(),p.qZA(),p.qZA(),p.TgZ(23,"div",19),p.TgZ(24,"div",20),p.TgZ(25,"span",21),p._uU(26,"Gi\xe1n B\xe1n"),p.qZA(),p.qZA(),p._UZ(27,"input",27),p.TgZ(28,"div",26),p.TgZ(29,"span",21),p._uU(30,"000"),p.qZA(),p.qZA(),p.qZA(),p.TgZ(31,"div",19),p.TgZ(32,"div",20),p.TgZ(33,"span",21),p._uU(34,"\u0110\u01a1n v\u1ecb t\xednh"),p.qZA(),p.qZA(),p.TgZ(35,"select",28),p.YNc(36,pn,2,2,"option",23),p.ALo(37,"catalog"),p.qZA(),p.qZA(),p.TgZ(38,"app-barcode-scanner",29),p.NdJ("barcodeResult",function(n){return p.CHM(i),p.oxw().getBarcode(n)}),p.qZA(),p.qZA(),p.TgZ(39,"div",3),p.TgZ(40,"div",19),p.TgZ(41,"div",20),p.TgZ(42,"span",21),p._uU(43,"T\u1ed3n kho"),p.qZA(),p.qZA(),p._UZ(44,"input",30),p.qZA(),p.TgZ(45,"div",19),p.TgZ(46,"div",20),p.TgZ(47,"span",21),p._uU(48,"Khuy\u1ebfn m\xe3i"),p.qZA(),p.qZA(),p._UZ(49,"input",31),p.TgZ(50,"div",26),p.TgZ(51,"span",21),p._uU(52,"%"),p.qZA(),p.qZA(),p.qZA(),p.TgZ(53,"div",19),p.TgZ(54,"div",20),p.TgZ(55,"span",21),p._uU(56,"Quy \u0111\u1ed5i \u0111\u01a1n v\u1ecb"),p.qZA(),p.qZA(),p._UZ(57,"input",32),p.qZA(),p.TgZ(58,"div",19),p.TgZ(59,"div",20),p.TgZ(60,"span",21),p._uU(61,"M\xe0u s\u1eafc"),p.qZA(),p.qZA(),p._UZ(62,"input",33),p.qZA(),p.TgZ(63,"div",19),p.TgZ(64,"div",20),p.TgZ(65,"span",21),p._uU(66,"M\xe3 v\u1ea1ch"),p.qZA(),p.qZA(),p._UZ(67,"input",34),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.TgZ(68,"div",35),p.YNc(69,Zn,2,0,"button",36),p.TgZ(70,"button",37),p.NdJ("click",function(){return p.CHM(i),p.oxw().reload()}),p._uU(71,"H\u1ee7y"),p.qZA(),p.qZA(),p.qZA()}if(2&n){var o=p.oxw();p.xp6(1),p.Q6J("formGroup",o.main),p.xp6(8),p.Q6J("ngForOf",o.NhomHang),p.xp6(5),p.Q6J("readOnly",o.readonly),p.xp6(5),p.Q6J("readOnly",o.readonly),p.xp6(8),p.Q6J("readOnly",o.readonly),p.xp6(9),p.Q6J("ngForOf",p.lcZ(37,12,"DVT")),p.xp6(2),p.Q6J("patchCode",o.main.get("Barcode").value),p.xp6(6),p.Q6J("readOnly",o.readonly),p.xp6(5),p.Q6J("readOnly",o.readonly),p.xp6(8),p.Q6J("readOnly",o.readonly),p.xp6(5),p.Q6J("readOnly",o.readonly),p.xp6(7),p.Q6J("ngIf",o.checkPer(2)&&o.main.valid)}}function mn(n,t){if(1&n){var i=p.EpF();p.TgZ(0,"i",44),p.NdJ("click",function(){p.CHM(i);var n=p.oxw().$implicit;return p.oxw().onEdit(n)}),p.qZA()}}function Tn(n,t){if(1&n){var i=p.EpF();p.TgZ(0,"i",45),p.NdJ("click",function(){p.CHM(i);var n=p.oxw().$implicit;return p.oxw().onDelete(n)}),p.qZA()}}function bn(n,t){if(1&n){var i=p.EpF();p.TgZ(0,"tr"),p.TgZ(1,"td"),p.TgZ(2,"a",40),p.NdJ("click",function(){var n=p.CHM(i).$implicit;return p.oxw().onEdit(n)}),p._uU(3),p.qZA(),p.qZA(),p.TgZ(4,"td"),p._uU(5),p.qZA(),p.TgZ(6,"td"),p._uU(7),p.ALo(8,"commas"),p.qZA(),p.TgZ(9,"td"),p._uU(10),p.qZA(),p.TgZ(11,"td",41),p.YNc(12,mn,1,0,"i",42),p.YNc(13,Tn,1,0,"i",43),p.qZA(),p.qZA()}if(2&n){var o=t.$implicit,e=p.oxw();p.Q6J("@slideIn",void 0),p.xp6(3),p.hij(" ",o.TenHangHoa,""),p.xp6(1),p.Udp("background-color",o.MauSac),p.xp6(1),p.Oqu(o.TonKho),p.xp6(2),p.Oqu(p.lcZ(8,9,1e3*o.GiaBan)),p.xp6(3),p.Oqu(o.KhuyenMai),p.xp6(2),p.Q6J("ngIf",e.checkPer(2)),p.xp6(1),p.Q6J("ngIf",e.checkPer(4))}}function vn(n,t){if(1&n&&p._UZ(0,"app-import-database",46),2&n){var i=p.oxw();p.Q6J("dbName",i.dbName)("api",i.api)("form",i.main)}}var An=function(n){return{"fa-spin":n}},qn=function(){var t=function(){function t(i,o){n(this,t),this.plus=i,this.fb=o,this.searchForm=this.fb.group({input:[,[Z.kI.minLength(3),Z.kI.maxLength(50)]]}),this.main=this.fb.group({_id:[,[]],Barcode:[,[]],TenHangHoa:[,[Z.kI.required]],NhomHang:[,[Z.kI.required]],catalogId:[,],TonKho:[1e3,[Z.kI.required]],DVT:[,[,]],GiaVon:[,[Z.kI.required]],GiaBan:[,[Z.kI.required]],KhuyenMai:[0,[]],QuyDoi:[1,[]],MauSac:[,[]]}),this.title="H\xe0ng h\xf3a",this.dbName="ban-hang",this.api="hang-hoa",this.db=null,this.items=[],this.readonly=!1,this.filter=[],this.importData=[],this.errorData=[],this.show=!1,this.showInput=!1,this.NhomHang=this.plus.user.getValue().NhomHang}return i(t,[{key:"ngOnDestroy",value:function(){console.log("destroy app-hang-hoa"),this.plus.subs.unsubscribe()}},{key:"ngOnInit",value:function(){var n=this;this.plus.setTiTle(this.title),this.plus.IDB_InitDB(this.dbName).subscribe(function(t){n.db=t,n.plus.updateUserLocal(t,n.api),n.plus.updateAPi.subscribe(function(t){n.getIDB()}),n.search()})}},{key:"getIDB",value:function(){var n=this;this.plus.subs.add(this.plus.IDB_DB_GetAll(this.db,this.api).subscribe(function(t){console.log(t.length),n.items=t}))}},{key:"save",value:function(){var n=this.main.value;null!==n._id?this.plus.httpPut(this.api,n).subscribe(function(n){console.log(n)}):(delete n._id,this.plus.httpPost(this.api,n).subscribe(function(n){}))}},{key:"onEdit",value:function(n){this.showInput=!0,this.items=[],this.plus.scrollTop(),this.main.patchValue(n),this.filter[0]=n}},{key:"onDelete",value:function(n){confirm("B\u1ea1n mu\u1ed1n x\xf3a?")&&this.plus.httpDisable(this.api,n).then(function(n){})}},{key:"search",value:function(){var n=this;this.searchForm.valueChanges.pipe((0,rn.b)(300)).subscribe(function(t){var i=n.plus.removeAccents(t.input);i.trim().length<2||n.plus.IDB_DB_Search(n.db,"hang-hoa",i).subscribe(function(t){n.filter=t})})}},{key:"find",value:function(n){this.items=n}},{key:"checkPer",value:function(n){return this.plus.checkPer(this.api,n)}},{key:"getLink",value:function(n){console.log(n)}},{key:"getBarcode",value:function(n){this.main.controls.Barcode.setValue(n)}},{key:"reset",value:function(){this.plus.loaded(),this.filter=[],this.importData=[],this.errorData=[]}},{key:"reload",value:function(){return this.plus.reload(this.dbName+"/"+this.api)}},{key:"getById",value:function(){var n=this;this.plus.httpGet(this.api+"/6071af9f7daf7e1218f8daf0").subscribe(function(t){var i=n.plus.Crypt_DecryptRest(t);console.log(i)})}}]),t}();return t.\u0275fac=function(n){return new(n||t)(p.Y36(d.T),p.Y36(Z.qu))},t.\u0275cmp=p.Xpm({type:t,selectors:[["app-hang-hoa"]],decls:30,vars:13,consts:[[1,"container"],[1,"text-center","text-white","py-2","my-3","bg-primary","rounded-pill","justify-content-center"],[1,"row"],[1,"col"],[3,"api","data"],[1,"col-5"],[1,"form-group",3,"formGroup"],["type","text","id","search-api","autocomplete","off","formControlName","input","placeholder","T\xecm ki\u1ebfm nhanh (F2)",1,"form-control"],["class","row float-right",4,"ngIf"],["class","row",4,"ngIf"],[1,"table","table-hover"],[1,"thead-inverse"],[1,"fa","fa-refresh","mx-2","text-info",3,"ngClass","click"],[4,"ngFor","ngForOf"],[3,"dbName","api","form",4,"ngIf"],[3,"dataJson"],[1,"row","float-right"],["mat-raised-button","","color","primary",1,"float-right",3,"click"],["aria-hidden","true",1,"fa","fa-plus"],[1,"input-group","mb-3"],[1,"input-group-prepend"],[1,"input-group-text"],["name","nhom","id","nhom","formControlName","NhomHang",1,"custom-select"],[3,"value",4,"ngFor","ngForOf"],["type","text","formControlName","TenHangHoa",1,"form-control",3,"readOnly"],["type","number","formControlName","GiaVon",1,"form-control",3,"readOnly"],[1,"input-group-append"],["type","number","formControlName","GiaBan",1,"form-control",3,"readOnly"],["formControlName","DVT",1,"custom-select"],[3,"patchCode","barcodeResult"],["type","number","formControlName","TonKho",1,"form-control",3,"readOnly"],["type","number","formControlName","KhuyenMai",1,"form-control",3,"readOnly"],["type","number","formControlName","QuyDoi",1,"form-control",3,"readOnly"],["type","color","formControlName","MauSac",1,"form-control",3,"readOnly"],["type","text","formControlName","Barcode",1,"form-control"],[1,"text-center","example-button-row"],["style","margin: 8px 8px 8px 0;","mat-raised-button","","color","warn",3,"click",4,"ngIf"],["mat-raised-button","","color","primary",2,"margin","8px 8px 8px 0",3,"click"],[3,"value"],["mat-raised-button","","color","warn",2,"margin","8px 8px 8px 0",3,"click"],[3,"click"],[1,"text-center"],["class","fa fa-pencil text-success mx-3 fa-lg","aria-hidden","true",3,"click",4,"ngIf"],["class","fa fa-trash text-danger mx-3 fa-lg","aria-hidden","true",3,"click",4,"ngIf"],["aria-hidden","true",1,"fa","fa-pencil","text-success","mx-3","fa-lg",3,"click"],["aria-hidden","true",1,"fa","fa-trash","text-danger","mx-3","fa-lg",3,"click"],[3,"dbName","api","form"]],template:function(n,t){1&n&&(p.TgZ(0,"div",0),p.TgZ(1,"h5",1),p._uU(2),p.ALo(3,"uppercase"),p.qZA(),p.TgZ(4,"div",2),p.TgZ(5,"div",3),p.TgZ(6,"app-search-api",4),p.NdJ("data",function(n){return t.find(n)}),p.qZA(),p.qZA(),p.TgZ(7,"div",5),p.TgZ(8,"div",6),p._UZ(9,"input",7),p.qZA(),p.qZA(),p.YNc(10,gn,4,0,"div",8),p.qZA(),p.YNc(11,fn,72,14,"div",9),p.TgZ(12,"div",2),p.TgZ(13,"table",10),p.TgZ(14,"thead",11),p.TgZ(15,"tr"),p.TgZ(16,"th"),p._uU(17,"T\xean"),p.qZA(),p.TgZ(18,"th"),p._uU(19,"T\u1ed3n kho"),p.qZA(),p.TgZ(20,"th"),p._uU(21,"Gi\xe1n B\xe1n"),p.qZA(),p.TgZ(22,"th"),p._uU(23,"Khuy\u1ebfn m\xe3i"),p.qZA(),p.TgZ(24,"th"),p.TgZ(25,"i",12),p.NdJ("click",function(){return t.reload()}),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.TgZ(26,"tbody"),p.YNc(27,bn,14,11,"tr",13),p.qZA(),p.qZA(),p.qZA(),p.YNc(28,vn,1,3,"app-import-database",14),p._UZ(29,"app-export-ecxel",15),p.qZA()),2&n&&(p.xp6(2),p.Oqu(p.lcZ(3,9,t.title)),p.xp6(4),p.Q6J("api",t.api),p.xp6(2),p.Q6J("formGroup",t.searchForm),p.xp6(2),p.Q6J("ngIf",!t.showInput),p.xp6(1),p.Q6J("ngIf",t.showInput),p.xp6(14),p.Q6J("ngClass",p.VKq(11,An,t.show)),p.xp6(2),p.Q6J("ngForOf",t.filter.length>0?t.filter:t.items.slice(0,20)),p.xp6(1),p.Q6J("ngIf",t.checkPer(4)),p.xp6(1),p.Q6J("dataJson",t.items))},directives:[cn.W,Z.JL,Z.sg,Z.Fj,Z.JJ,Z.u,h.O5,h.mk,h.sg,sn.t,v.lW,Z._Y,Z.EJ,Z.wV,hn.O,Z.YN,Z.Kr,ln.y],pipes:[h.gd,x.pW,x.W],styles:[""],data:{animation:[l.Y,l.M]}}),t}();function xn(n,t){if(1&n){var i=p.EpF();p.TgZ(0,"div",2),p.TgZ(1,"button",3),p.NdJ("click",function(){return p.CHM(i),p.oxw().resetNhanDon()}),p._uU(2,"nhan-don"),p.qZA(),p.TgZ(3,"button",3),p.NdJ("click",function(){return p.CHM(i),p.oxw().resetHangHoa()}),p._uU(4,"hang-hoa"),p.qZA(),p.qZA()}}var yn=function(){var t=function(){function t(i){n(this,t),this.plus=i,this.db=null,this.dbName="ban-hang",this.isAdmin=this.plus.isAdmin()}return i(t,[{key:"ngOnInit",value:function(){var n=this;this.plus.IDB_InitDB(this.dbName).subscribe(function(t){n.db=t})}},{key:"resetNhanDon",value:function(){var n=this,t="nhan-don";confirm("Reset DB"+t)&&this.plus.httpDelete(t,"del").subscribe(function(i){console.log("Clear DB"),n.plus.FBS_PostByUser(t,0).then(function(i){console.log("Clear FBS"),console.log(i),n.plus.IDB_DB_ClearCollection(n.db,t).subscribe(function(n){console.log("Clear IDB")})})})}},{key:"resetHangHoa",value:function(){var n=this,t="hang-hoa";confirm("Reset DB"+t)&&this.plus.httpDelete(t,"del").subscribe(function(i){console.log("Clear DB"),n.plus.FBS_PostByUser(t,0).then(function(i){console.log("Clear FBS"),console.log(i),n.plus.IDB_DB_ClearCollection(n.db,t).subscribe(function(n){console.log("Clear IDB")})})})}},{key:"checkPer",value:function(n,t){return this.plus.checkPer(n,t)}},{key:"onDetect",value:function(n){console.log(n)}}]),t}();return t.\u0275fac=function(n){return new(n||t)(p.Y36(d.T))},t.\u0275cmp=p.Xpm({type:t,selectors:[["app-ban-hang"]],decls:2,vars:1,consts:[[1,"container"],["class","row",4,"ngIf"],[1,"row"],["type","button",1,"btn","btn-primary",3,"click"]],template:function(n,t){1&n&&(p.TgZ(0,"div",0),p.YNc(1,xn,5,0,"div",1),p.qZA()),2&n&&(p.xp6(1),p.Q6J("ngIf",t.checkPer("hang-hoa",7)))},directives:[h.O5],styles:[""]}),t}(),kn=e(40084),Dn=e(10033),_n=e(71522);function Cn(n,t){if(1&n){var i=p.EpF();p.TgZ(0,"mat-option",38),p.NdJ("click",function(){var n=p.CHM(i).$implicit;return p.oxw().addNewItem(n)})("keyup.enter",function(){var n=p.CHM(i).$implicit;return p.oxw().addNewItem(n)}),p.TgZ(1,"b"),p._uU(2),p.qZA(),p._uU(3),p.qZA()}if(2&n){var o=t.$implicit;p.xp6(2),p.hij(" ",o.TenHangHoa,""),p.xp6(1),p.AsE(" | ",o.GiaBan,"k/",o.DVT," ")}}function Bn(n,t){1&n&&(p.TgZ(0,"mat-option"),p._uU(1," Kh\xf4ng c\xf2n k\u1ebft qu\u1ea3 ph\xf9 h\u1ee3p! "),p.qZA())}function Nn(n,t){if(1&n){var i=p.EpF();p.TgZ(0,"tr"),p.TgZ(1,"td"),p._uU(2),p.TgZ(3,"span",39),p.NdJ("click",function(){var n=p.CHM(i).index;return p.oxw().delItem(n)}),p._UZ(4,"i",40),p.qZA(),p.qZA(),p.TgZ(5,"td"),p.TgZ(6,"b"),p._uU(7),p.qZA(),p._UZ(8,"br"),p.TgZ(9,"span",41),p.NdJ("blur",function(n){var t=p.CHM(i).index;return p.oxw().updateGiaBan(t,"GiaBan",n)})("keydown.enter",function(n){var t=p.CHM(i).index;return p.oxw().updateGiaBan(t,"GiaBan",n)})("keydown.enter",function(n){var t=p.CHM(i).index;return p.oxw().updateList(t,"GiaBan",n)})("blur",function(n){var t=p.CHM(i).index;return p.oxw().updateList(t,"GiaBan",n)}),p._uU(10),p.ALo(11,"number"),p.qZA(),p._uU(12),p.qZA(),p.TgZ(13,"td",42),p.TgZ(14,"mat-icon",43),p.NdJ("click",function(){var n=p.CHM(i).index;return p.oxw().removeItem(n)}),p._uU(15,"chevron_left"),p.qZA(),p.TgZ(16,"b",44),p.NdJ("keydown.enter",function(n){var t=p.CHM(i).index;return p.oxw().updateList(t,"TongCong",n)})("blur",function(n){var t=p.CHM(i).index;return p.oxw().updateList(t,"TongCong",n)}),p._uU(17),p.ALo(18,"number"),p.qZA(),p.TgZ(19,"mat-icon",43),p.NdJ("click",function(){var n=p.CHM(i),t=n.$implicit,o=n.index;return p.oxw().addItem(t,o)}),p._uU(20,"navigate_next"),p.qZA(),p.qZA(),p.TgZ(21,"td",45),p.TgZ(22,"b"),p._uU(23),p.ALo(24,"commas"),p.qZA(),p.qZA(),p.qZA()}if(2&n){var o=t.$implicit,e=t.index;p.xp6(2),p.hij("",e+1," "),p.xp6(5),p.Oqu(o.TenHangHoa),p.xp6(3),p.Oqu(p.lcZ(11,6,o.GiaBan)),p.xp6(2),p.hij("k/",o.DVT," "),p.xp6(5),p.hij(" ",p.lcZ(18,8,o.TongCong)," "),p.xp6(6),p.Oqu(p.lcZ(24,10,o.TongCong*o.GiaBan*1e3))}}function Mn(n,t){if(1&n){var i=p.EpF();p.TgZ(0,"mat-chip",46),p.NdJ("click",function(){var n=p.CHM(i).$implicit,t=p.oxw();return t.khachDua=+t.khachDua+1e3*n}),p._uU(1),p.qZA()}if(2&n){var o=t.$implicit;p.xp6(1),p.hij("",o,"k")}}function Un(n,t){if(1&n){var i=p.EpF();p.TgZ(0,"mat-chip",47),p.NdJ("click",function(){var n=p.CHM(i).$implicit,t=p.oxw();return t.khachDua=+t.khachDua+1e3*n}),p._uU(1),p.qZA()}if(2&n){var o=t.$implicit;p.xp6(1),p.hij("",o,"k")}}function wn(n,t){if(1&n){var i=p.EpF();p.TgZ(0,"mat-chip",48),p.NdJ("click",function(){var n=p.CHM(i).$implicit,t=p.oxw();return t.khachDua=+t.khachDua+1e3*n}),p._uU(1),p.qZA()}if(2&n){var o=t.$implicit;p.xp6(1),p.hij("",o,"k")}}function In(n,t){if(1&n&&(p.TgZ(0,"mat-hint"),p._uU(1),p.ALo(2,"commas"),p.ALo(3,"titlecase"),p.ALo(4,"bangChu"),p.qZA()),2&n){var i=p.oxw();p.xp6(1),p.AsE(" ",p.lcZ(2,2,i.khachDua),": ",p.lcZ(3,4,p.lcZ(4,6,i.khachDua)),"")}}function Hn(n,t){if(1&n&&(p.TgZ(0,"mat-hint",49),p._uU(1),p.ALo(2,"commas"),p.qZA()),2&n){var i=p.oxw();p.xp6(1),p.hij(" Ti\u1ec1n th\u1eeba: ",p.lcZ(2,1,+i.khachDua-i.ThanhTien),"")}}function Jn(n,t){if(1&n&&(p.TgZ(0,"tr"),p.TgZ(1,"td"),p._uU(2),p.qZA(),p.TgZ(3,"td"),p._uU(4),p._UZ(5,"br"),p._uU(6),p.ALo(7,"commas"),p.qZA(),p.TgZ(8,"td",51),p._uU(9),p.qZA(),p.TgZ(10,"td",53),p._uU(11),p.ALo(12,"commas"),p.qZA(),p.qZA()),2&n){var i=t.$implicit,o=t.index;p.xp6(2),p.hij("",o+1," "),p.xp6(2),p.hij("",i.TenHangHoa," "),p.xp6(2),p.hij(" ",p.lcZ(7,5,1e3*i.GiaBan)," "),p.xp6(3),p.Oqu(i.TongCong),p.xp6(2),p.Oqu(p.lcZ(12,7,i.TongCong*i.GiaBan*1e3))}}function On(n,t){if(1&n&&(p.TgZ(0,"tbody"),p.YNc(1,Jn,13,9,"tr",13),p.TgZ(2,"tr"),p.TgZ(3,"td",50),p.TgZ(4,"h5"),p._uU(5,"T\u1ed5ng c\u1ed9ng:"),p.qZA(),p.qZA(),p.TgZ(6,"td"),p.TgZ(7,"h5"),p._uU(8),p.qZA(),p.qZA(),p.TgZ(9,"td",51),p.TgZ(10,"h5"),p._uU(11),p.ALo(12,"commas"),p.qZA(),p.TgZ(13,"h6"),p.TgZ(14,"i"),p._uU(15),p.ALo(16,"titlecase"),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.TgZ(17,"td",52),p.TgZ(18,"h6"),p._uU(19,"Xin c\u1ea3m \u01a1n qu\xfd kh\xe1ch"),p.qZA(),p.TgZ(20,"h6"),p._uU(21,"S\u1ea3n ph\u1ea9m c\u1ee7a 4la.vn"),p.qZA(),p.qZA(),p.qZA()),2&n){var i=p.oxw();p.xp6(1),p.Q6J("ngForOf",i.DonMua),p.xp6(7),p.hij("",i.total," m\xf3n"),p.xp6(3),p.hij(" ",p.lcZ(12,4,i.ThanhTien),""),p.xp6(4),p.Oqu(p.lcZ(16,6,i.bangchu))}}var Fn,Ln,Gn=function(n){return{loading:n}},Qn=function(){return[1,2,5]},Pn=function(){return[10,20,50]},Yn=function(){return[100,200,500]},Vn=[{path:"",component:yn},{path:"hang-hoa",component:qn},{path:"nhan-don/:ten-ban",component:un},{path:"nhan-don",component:un},{path:"pha-che",component:N},{path:"tap-hoa",component:(Fn=function(){function t(i,o,e){n(this,t),this.plus=i,this.route=o,this.fb=e,this.db=null,this.title="B\xe1n h\xe0ng t\u1ea1p h\xf3a",this.dbName="ban-hang",this.api="tap-hoa",this.tabs=[],this.items=[],this.DonMua=[],this.total=0,this.ThanhTien=0,this.donHang=[],this.bangchu="",this.filter=[],this.audio=new Audio,this.nhapThuCong=!1,this.xemHoaDon=!0,this.khachDua=0,this.user=this.plus.user.getValue(),this.printTime=Date.now(),this.NhomHang=this.plus.user.getValue().NhomHang,this.TabBan=this.plus.sortArr(this.plus.user.getValue().NhomBan,"ThuTu",1),this.ChiaBan=[],this.ban=0,this.width=window.innerWidth,this.count=0,this.now=Date.now(),this.xemBan=!0,this.xemMon=!1,this.donHangFB=this.fb.group({ThanhTien:[,[Z.kI.required]],LoiNhuan:[,[Z.kI.required]],SoKH:[,[Z.kI.required]],GioVao:[,[Z.kI.required]],DaThanhToan:[,[Z.kI.required]],DonMua:this.fb.array([this.fb.group({idHangHoa:[,[Z.kI.required]],DVT:[,[Z.kI.required]],GiaBan:[,[Z.kI.required]],GiaVon:[,[Z.kI.required]],KhuyenMai:[,[Z.kI.required]],TenHangHoa:[,[Z.kI.required]],TongCong:[,[Z.kI.required]]})])}),this.searchForm=this.fb.group({input:[,[Z.kI.minLength(3),Z.kI.maxLength(50)]]})}return i(t,[{key:"ngOnDestroy",value:function(){console.log("Destroy nhan-don"),this.plus.subs.unsubscribe()}},{key:"test",value:function(n){console.log(+n.replace(/\D/g,"")),this.khachDua=+n}},{key:"ngOnInit",value:function(){var n=this;this.plus.setTiTle(this.title),this.plus.IDB_InitDB(this.dbName).subscribe(function(t){n.db=t,document.getElementById("search-api").focus(),n.plus.updateUserLocal(t,"hang-hoa")}),this.search()}},{key:"search",value:function(){var n=this;this.searchForm.valueChanges.subscribe(function(t){var i=n.plus.removeAccents(t.input);i.trim().length<2||n.plus.IDB_DB_GetByBarCode(n.db,"hang-hoa",i).subscribe(function(t){t?(n.searchForm.reset(),n.addNewItem(t)):(n.filter=[],n.plus.IDB_DB_Search(n.db,"hang-hoa",i,5).subscribe(function(t){n.filter=t}))})})}},{key:"thanhToan",value:function(){var n=this,t=confirm("In h\xf3a \u0111\u01a1n?"),i=Object.assign({DonMua:this.DonMua.map(function(n){return{idHangHoa:n._id,TenHangHoa:n.TenHangHoa,GiaBan:n.GiaBan,GiaVon:n.GiaVon,KhuyenMai:n.KhuyenMai,DVT:n.DVT,TongCong:n.TongCong}}),LoiNhuan:this.DonMua.map(function(n){return n.GiaBan-n.GiaVon-n.GiaBan*n.KhuyenMai/100}).reduce(function(n,t){return n+t}),ThanhTien:this.ThanhTien,GioVao:Date.now(),SoKH:this.total,DaThanhToan:!0});if(this.donHangFB.patchValue(i),this.donHangFB.invalid){var o=this.plus.getErrValidateForm(this.donHangFB);console.log(o,this.donHangFB.status)}else this.plus.httpPost("tap-hoa",i).subscribe(function(t){console.log(t),n.DonMua=[],n.reload()});t?(this.PrintDiv("HoaDon"),console.log(0,i)):console.log(1,i)}},{key:"addNewItem",value:function(n){this.filter=[],this.playAudio(),this.xemHoaDon=!0,window.navigator.vibrate(100);var t=this.DonMua.find(function(t){return t._id==n._id});if(!t)return n.TongCong=1,this.DonMua.push(n),this.getTongCong();var i=this.DonMua.findIndex(function(n){return n._id==t._id});this.DonMua[i].TongCong+=1,this.getTongCong(),this.filter=[],this.searchForm.controls.input.setValue("")}},{key:"removeItem",value:function(n){this.DonMua[n].TongCong>0&&(this.DonMua[n].TongCong-=1),this.getTongCong()}},{key:"addItem",value:function(n,t){this.playAudio(),this.DonMua[t].TongCong+=1,this.getTongCong()}},{key:"delItem",value:function(n){this.DonMua.splice(n,1),this.getTongCong()}},{key:"getTongCong",value:function(){this.total=this.plus.sumByKey(this.DonMua,"TongCong"),this.getThanhTien()}},{key:"getThanhTien",value:function(){var n=0;return this.DonMua.forEach(function(t){n+=t.GiaBan*t.TongCong*1e3}),this.bangchu=this.plus.numToVi(n),this.ThanhTien=n}},{key:"PrintDiv",value:function(n){this.plus.load();var t=window.document.getElementById(n),i=window.open("","PRINT");i.document.write(document.documentElement.innerHTML),setTimeout(function(){i.document.body.innerHTML=t.outerHTML,i.document.close(),i.focus(),i.print(),i.close()},1e3),this.plus.loaded()}},{key:"getBarcode",value:function(n){this.searchForm.controls.input.setValue(n)}},{key:"find",value:function(n){this.filter=n}},{key:"getByBarcode",value:function(n){}},{key:"reload",value:function(){this.plus.reload("ban-hang/tap-hoa")}},{key:"updateList",value:function(n,t,i){var o=+i.target.textContent;if(console.log(o),"Enter"===i.key&&i.preventDefault(),"number"!=typeof o)return this.plus.alertError("Sai \u0111\u1ecbnh d\u1ea1ng"),this.DonMua[n][t]=0;this.DonMua[n][t]=+o,this.getTongCong()}},{key:"updateGiaBan",value:function(n,t,i){var o=this;if(this.DonMua[n][t]!=+i.target.textContent){var e=this.DonMua[n].TongCong,a=this.DonMua[n];delete a.__v,delete a.TongCong,a.GiaBan=+i.target.textContent,this.plus.httpPut("hang-hoa",a).subscribe(function(t){document.getElementById("search-api").focus(),console.log(o.DonMua[n])}),this.DonMua[n][t]=+i.target.textContent,this.DonMua[n].TongCong=+e,this.getTongCong()}}},{key:"playAudio",value:function(){this.audio.src="assets/audio/beep.mp3",this.audio.load(),this.audio.play()}}]),t}(),Fn.\u0275fac=function(n){return new(n||Fn)(p.Y36(d.T),p.Y36(f.gz),p.Y36(Z.qu))},Fn.\u0275cmp=p.Xpm({type:Fn,selectors:[["app-tap-hoa"]],decls:94,vars:37,consts:[[1,"row"],[1,"col-lg-8"],[1,"form-group",3,"formGroup"],["type","text","id","search-api","autocomplete","off","formControlName","input","placeholder","T\xecm ki\u1ebfm (F2)",1,"form-control",3,"readonly","matAutocomplete","ngClass"],["autoActiveFirstOption",""],["auto","matAutocomplete"],[3,"click","keyup.enter",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"col-lg-4"],[3,"barcodeResult"],["mat-raised-button","","color","warn",1,"float-rigth"],[1,"col"],[1,"table","table-hover"],[4,"ngFor","ngForOf"],["colspan","2"],["mat-raised-button","","id","thanh-toan","color","warn",3,"disabled","click"],["colspan","2",1,"float-rigth"],["color","primary","selected","",3,"click",4,"ngFor","ngForOf"],["color","accent","selected","",3,"click",4,"ngFor","ngForOf"],["color","warn","selected","",3,"click",4,"ngFor","ngForOf"],["colspan","2",1,"text-left"],["matInput","","autocomplete","off",3,"ngModel","ngModelChange"],["mat-button","","matSuffix","","mat-icon-button","",3,"click"],["align","end",4,"ngIf"],["id","modelId","tabindex","-1","role","dialog","aria-labelledby","modelTitleId","aria-hidden","true",1,"modal","fade"],["role","document",1,"modal-dialog"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],["type","button","data-dismiss","modal","aria-label","Close",1,"close"],["aria-hidden","true"],[1,"modal-body","hoadon"],["id","HoaDon",1,"div"],[1,"text-left"],[1,"thead-inverse"],[1,"modal-footer"],["type","button","data-dismiss","modal",1,"btn","btn-secondary"],["type","button",1,"btn","btn-primary"],[3,"click","keyup.enter"],[1,"badge","badge-danger",3,"click"],["aria-hidden","true",1,"fa","fa-trash"],["contenteditable","true",1,"px-2","font-blue",3,"blur","keydown.enter"],[1,""],[3,"click"],["contenteditable","true",1,"font-blue",3,"keydown.enter","blur"],[1,"text-right"],["color","primary","selected","",3,"click"],["color","accent","selected","",3,"click"],["color","warn","selected","",3,"click"],["align","end"],["colspan","2",1,"text-center"],[1,"text-center"],["colspan","4",1,"text-center"],[1,"text-rigth"]],template:function(n,t){if(1&n&&(p.TgZ(0,"div",0),p.TgZ(1,"div",1),p.TgZ(2,"div",2),p._UZ(3,"input",3),p.TgZ(4,"mat-autocomplete",4,5),p.YNc(6,Cn,4,3,"mat-option",6),p.YNc(7,Bn,2,0,"mat-option",7),p.qZA(),p.qZA(),p.qZA(),p.TgZ(8,"div",8),p.TgZ(9,"app-barcode-scanner",9),p.NdJ("barcodeResult",function(n){return t.getBarcode(n)}),p.qZA(),p.TgZ(10,"button",10),p._uU(11),p.ALo(12,"commas"),p.qZA(),p.qZA(),p.qZA(),p.TgZ(13,"div",0),p.TgZ(14,"div",11),p.TgZ(15,"table",12),p.TgZ(16,"thead"),p.TgZ(17,"tr"),p.TgZ(18,"th"),p._uU(19,"TT "),p.qZA(),p.TgZ(20,"th"),p._uU(21,"H\u1ea1ng m\u1ee5c"),p.qZA(),p.TgZ(22,"th"),p._uU(23,"S\u1ed1 l\u01b0\u1ee3ng"),p.qZA(),p.TgZ(24,"th"),p._uU(25,"Th\xe0nh ti\u1ec1n"),p.qZA(),p.qZA(),p.qZA(),p.TgZ(26,"tbody"),p.YNc(27,Nn,25,12,"tr",13),p.TgZ(28,"tr"),p.TgZ(29,"td",14),p.TgZ(30,"h5"),p._uU(31),p.ALo(32,"commas"),p.qZA(),p.TgZ(33,"h6"),p.TgZ(34,"i"),p._uU(35),p.ALo(36,"titlecase"),p.qZA(),p.qZA(),p.qZA(),p.TgZ(37,"td"),p.TgZ(38,"button",15),p.NdJ("click",function(){return t.thanhToan()}),p._uU(39,"Thanh to\xe1n (F9)"),p.qZA(),p.qZA(),p.qZA(),p.TgZ(40,"tr"),p.TgZ(41,"td",16),p.TgZ(42,"mat-chip-list"),p.YNc(43,Mn,2,1,"mat-chip",17),p.qZA(),p.TgZ(44,"mat-chip-list"),p.YNc(45,Un,2,1,"mat-chip",18),p.qZA(),p.TgZ(46,"mat-chip-list"),p.YNc(47,wn,2,1,"mat-chip",19),p.qZA(),p.qZA(),p.TgZ(48,"td",20),p.TgZ(49,"mat-form-field"),p.TgZ(50,"mat-label"),p._uU(51,"Kh\xe1ch \u0111\u01b0a"),p.qZA(),p.TgZ(52,"input",21),p.NdJ("ngModelChange",function(n){return t.khachDua=n}),p.qZA(),p.TgZ(53,"button",22),p.NdJ("click",function(){return t.khachDua=0}),p.TgZ(54,"mat-icon"),p._uU(55,"backspace"),p.qZA(),p.qZA(),p.YNc(56,In,5,8,"mat-hint",7),p.qZA(),p.YNc(57,Hn,3,3,"mat-hint",23),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.TgZ(58,"div",24),p.TgZ(59,"div",25),p.TgZ(60,"div",26),p.TgZ(61,"div",27),p.TgZ(62,"h5",28),p._uU(63,"Modal title"),p.qZA(),p.TgZ(64,"button",29),p.TgZ(65,"span",30),p._uU(66,"\xd7"),p.qZA(),p.qZA(),p.qZA(),p.TgZ(67,"div",31),p.TgZ(68,"div",32),p.TgZ(69,"div",33),p.TgZ(70,"h6"),p._uU(71),p.qZA(),p.TgZ(72,"h6"),p._uU(73),p.qZA(),p.TgZ(74,"h6"),p._uU(75),p.ALo(76,"date"),p.qZA(),p.qZA(),p.TgZ(77,"table",12),p.TgZ(78,"thead",34),p.TgZ(79,"tr"),p.TgZ(80,"th"),p._uU(81,"TT"),p.qZA(),p.TgZ(82,"th"),p._uU(83,"H\u1ea1ng m\u1ee5c"),p.qZA(),p.TgZ(84,"th"),p._uU(85,"S\u1ed1 l\u01b0\u1ee3ng"),p.qZA(),p.TgZ(86,"th"),p._uU(87,"Th\xe0nh ti\u1ec1n"),p.qZA(),p.qZA(),p.qZA(),p.YNc(88,On,22,8,"tbody",7),p.qZA(),p.qZA(),p.qZA(),p.TgZ(89,"div",35),p.TgZ(90,"button",36),p._uU(91,"Close"),p.qZA(),p.TgZ(92,"button",37),p._uU(93,"Save"),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA()),2&n){var i=p.MAs(5);p.xp6(2),p.Q6J("formGroup",t.searchForm),p.xp6(1),p.Q6J("readonly",!1)("matAutocomplete",i)("ngClass",p.VKq(32,Gn,t.filter.length>1&&t.filter.length<5)),p.xp6(3),p.Q6J("ngForOf",t.filter),p.xp6(1),p.Q6J("ngIf",0==t.filter.length&&t.searchForm.value.input),p.xp6(4),p.AsE(" ",t.DonMua.length," | ",p.lcZ(12,23,t.ThanhTien)," "),p.xp6(16),p.Q6J("ngForOf",t.DonMua),p.xp6(4),p.AsE("T\u1ed5ng c\u1ed9ng: ",p.lcZ(32,25,t.ThanhTien)," / ",t.total," m\xf3n"),p.xp6(4),p.Oqu(p.lcZ(36,27,t.bangchu)),p.xp6(3),p.Q6J("disabled",t.ThanhTien<=0),p.xp6(5),p.Q6J("ngForOf",p.DdM(34,Qn)),p.xp6(2),p.Q6J("ngForOf",p.DdM(35,Pn)),p.xp6(2),p.Q6J("ngForOf",p.DdM(36,Yn)),p.xp6(5),p.Q6J("ngModel",t.khachDua),p.xp6(4),p.Q6J("ngIf",t.khachDua>0),p.xp6(1),p.Q6J("ngIf",t.khachDua>0&&t.khachDua>t.ThanhTien),p.xp6(14),p.Oqu(t.user.title),p.xp6(2),p.Oqu(t.user.phoneNumber),p.xp6(2),p.hij("Gi\u1edd in:",p.xi3(76,29,t.printTime,"hh:mm dd/MM/yyyy"),""),p.xp6(13),p.Q6J("ngIf",t.DonMua)}},directives:[Z.JL,Z.sg,Z.Fj,kn.ZL,Z.JJ,Z.u,h.mk,kn.XC,h.sg,h.O5,hn.O,v.lW,Dn.qn,w.KE,w.hX,I.Nt,Z.On,w.R9,k.Hw,_n.ey,Dn.HS,w.bx],pipes:[x.W,h.rS,h.uU,h.JJ,x.ID],styles:[".hangHoa[_ngcontent-%COMP%]{height:8rem;width:8rem;border-radius:1rem;margin:.2rem;border-bottom-width:1rem;border-color:#90ee90;color:blue;float:left;display:flex;align-items:center;justify-content:center}.hangHoa[_ngcontent-%COMP%]:active{transform:scale(1.1);opacity:50%}.hoadon[_ngcontent-%COMP%]{width:200px}.font-mat[_ngcontent-%COMP%]{color:#fff;font-size:medium}.le[_ngcontent-%COMP%]{background-color:#ff0}.chuc[_ngcontent-%COMP%], .le[_ngcontent-%COMP%]{border:#0000cd;border-radius:.2rem;color:brown;margin:.8rem;padding-left:.5rem;padding-right:.5rem}.chuc[_ngcontent-%COMP%]{background-color:#deb887}.tram[_ngcontent-%COMP%]{border:#0000cd;border-radius:.2rem;color:brown;background-color:#7fff00;margin:.8rem;padding-left:.5rem;padding-right:.5rem}.arrow-bt[_ngcontent-%COMP%]{font-size:larger;color:blue;font-weight:700;padding:.5rem}.arrow-bt[_ngcontent-%COMP%]:hover{border:brown;border-radius:.5rem;background-color:aqua}.example-form-field[_ngcontent-%COMP%]{max-width:8rem}"],data:{animation:[l.Y]}}),Fn)},{path:"bao-cao",component:y},{path:"khach-hang",component:m}],En=function(){var t=function t(){n(this,t)};return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=p.oAB({type:t}),t.\u0275inj=p.cJS({imports:[[f.Bz.forChild(Vn)],f.Bz]}),t}(),Kn=e(41007),jn=function(){var t=function t(){n(this,t)};return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=p.oAB({type:t}),t.\u0275inj=p.cJS({imports:[[h.ez]]}),t}(),Sn=e(97534),$n=((Ln=function t(){n(this,t)}).\u0275fac=function(n){return new(n||Ln)},Ln.\u0275mod=p.oAB({type:Ln}),Ln.\u0275inj=p.cJS({providers:[Sn.F],imports:[[h.ez,u.ShareModule,c.q,En,s.D,Kn.m,Sn.F,jn,r.k,a.N]]}),Ln)},64762:function(n,t,i){"use strict";function o(n,t,i,o){return new(i||(i=Promise))(function(e,a){function u(n){try{c(o.next(n))}catch(t){a(t)}}function r(n){try{c(o.throw(n))}catch(t){a(t)}}function c(n){var t;n.done?e(n.value):(t=n.value,t instanceof i?t:new i(function(n){n(t)})).then(u,r)}c((o=o.apply(n,t||[])).next())})}i.d(t,{mG:function(){return o}})}}])}();