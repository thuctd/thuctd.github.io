!function(){"use strict";function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function e(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function n(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}(self.webpackChunk_4la=self.webpackChunk_4la||[]).push([[441],{16314:function(e,r,a){a.d(r,{W:function(){return p},H$:function(){return d},cf:function(){return h},pW:function(){return g},ID:function(){return m},dw:function(){return v},yl:function(){return b}});var o,i=a(16738),u=a.n(i),c=a(24347),s=a(74788),l=a(88638),f=a(91211),p=((o=function(){function e(){t(this,e)}return n(e,[{key:"transform",value:function(t){return(+"".concat(t).replace(/\D/g,"")).toString().replace(/\B(?=(\d{3})+(?!\d))/g,".")}}]),e}()).\u0275fac=function(t){return new(t||o)},o.\u0275pipe=s.Yjl({name:"commas",type:o,pure:!0}),o),d=function(){var e=function(){function e(){t(this,e)}return n(e,[{key:"transform",value:function(t,e,n){return t?t.filter(function(t){return t[e]==n}):[]}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=s.Yjl({name:"filterByKV",type:e,pure:!0}),e}(),h=function(){var e=function(){function e(){t(this,e)}return n(e,[{key:"transform",value:function(t){return"number"!=typeof t?u()(t).format("DD/MM/YYYY"):u()(new Date(86400*(t-25569)*1e3)).format("DD/MM/YYYY")}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=s.Yjl({name:"excelDay",type:e,pure:!0}),e}(),g=function(){var e=function(){function e(n){t(this,e),this.plus=n}return n(e,[{key:"transform",value:function(t){var e=JSON.parse(localStorage.getItem("catalog"));return e?e.filter(function(e){return e.Nhom==t}).sort(function(t,e){return t.GiaTri<e.GiaTri?-1:t.GiaTri>e.GiaTri?1:0}):(this.plus.reload("/taikhoan"),this.plus.getCatalog(),[])}}]),e}();return e.\u0275fac=function(t){return new(t||e)(s.Y36(l.T,16))},e.\u0275pipe=s.Yjl({name:"catalog",type:e,pure:!0}),e}(),m=function(){var e=function(){function e(){t(this,e)}return n(e,[{key:"transform",value:function(t){var e=+"".concat(t).replace(/\D/g,"");return console.log(e,t),(0,c.Z)(e)+" \u0111\u1ed3ng."}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=s.Yjl({name:"bangChu",type:e,pure:!0}),e}(),v=function(){var e=function(){function e(){t(this,e)}return n(e,[{key:"transform",value:function(t){return u()(t).locale("vi").fromNow()}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=s.Yjl({name:"fromNow",type:e,pure:!0}),e}(),b=function(){var e=function(){function e(n){t(this,e),this.sanitizer=n}return n(e,[{key:"transform",value:function(t){return this.sanitizer.bypassSecurityTrustResourceUrl(t)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(s.Y36(f.H7,16))},e.\u0275pipe=s.Yjl({name:"safe",type:e,pure:!0}),e}()},97012:function(e,r,a){a.d(r,{t:function(){return g}});var o=a(16738),i=a.n(o),u=a(84487),c=a(74788),s=a(88638),l=a(12057),f=a(2895);function p(t,e){if(1&t){var n=c.EpF();c.TgZ(0,"button",1),c.NdJ("click",function(){return c.CHM(n),c.oxw().export()}),c._uU(1,"Export Excel"),c.qZA()}}function d(t,e){if(1&t){var n=c.EpF();c.TgZ(0,"button",1),c.NdJ("click",function(){return c.CHM(n),c.oxw().exportToJsonFile()}),c._uU(1,"Export BackupDB"),c.qZA()}}var h,g=((h=function(){function e(n){t(this,e),this.plus=n}return n(e,[{key:"ngOnInit",value:function(){}},{key:"export",value:function(){var t=[];this.dataJson.forEach(function(e){delete e.dateModify,delete e.status,delete e.sync,delete e.canEdit,delete e.keyWord,delete e.__v,t.push(e)});var e=u.utils.json_to_sheet(t),n=u.utils.book_new();u.utils.book_append_sheet(n,e,this.api),u.writeFile(n,i()(Date.now()).format("YYYYMMDDHHMM")+"-4la-"+this.api+".xlsx")}},{key:"exportToJsonFile",value:function(){for(var t=0;t<this.dataJson.length;t++)delete this.dataJson[t].dateModify,delete this.dataJson[t].canEdit,delete this.dataJson[t].keyWord,delete this.dataJson[t].__v,delete this.dataJson[t]._id;var e=JSON.stringify(this.dataJson),n="data:application/json;charset=utf-8,"+encodeURIComponent(e),r="4la-".concat(this.api?this.api:"")+Date.now()+".db",a=document.createElement("a");a.setAttribute("href",n),a.setAttribute("download",r),a.click()}},{key:"check",value:function(){return this.plus.checkPer("admin",4)}}]),e}()).\u0275fac=function(t){return new(t||h)(c.Y36(s.T))},h.\u0275cmp=c.Xpm({type:h,selectors:[["app-export-ecxel"]],inputs:{dataJson:"dataJson",api:"api"},decls:2,vars:2,consts:[["mat-raised-button","","color","primary",3,"click",4,"ngIf"],["mat-raised-button","","color","primary",3,"click"]],template:function(t,e){1&t&&(c.YNc(0,p,2,0,"button",0),c.YNc(1,d,2,0,"button",0)),2&t&&(c.Q6J("ngIf",e.check()),c.xp6(1),c.Q6J("ngIf",e.check()))},directives:[l.O5,f.lW],styles:[""]}),h)},55352:function(e,r,a){a.d(r,{y:function(){return _}});var o=a(28831),i=a(84487),u=a(74788),c=a(88638),s=a(2895),l=a(12057),f=a(49356),p=function(t,e,n,r){return new(n||(n=Promise))(function(a,o){function i(t){try{c(r.next(t))}catch(e){o(e)}}function u(t){try{c(r.throw(t))}catch(e){o(e)}}function c(t){t.done?a(t.value):function(t){return t instanceof n?t:new n(function(e){e(t)})}(t.value).then(i,u)}c((r=r.apply(t,e||[])).next())})};function d(t,e){if(1&t){var n=u.EpF();u.TgZ(0,"div",10),u.TgZ(1,"input",11),u.NdJ("change",function(t){return u.CHM(n),u.oxw(2).readXlsx(t)}),u.qZA(),u.TgZ(2,"label",12),u._uU(3,"Ch\u1ecdn file "),u.TgZ(4,"mat-icon"),u._uU(5,"attachment"),u.qZA(),u.qZA(),u.TgZ(6,"a",13),u.TgZ(7,"mat-icon"),u._uU(8,"cloud_download"),u.qZA(),u._uU(9,"M\u1eabu import "),u.qZA(),u._UZ(10,"hr"),u.qZA()}if(2&t){var r=u.oxw(2);u.xp6(6),u.MGl("href","https://github.com/thuctd/FileStore/raw/master/templates/",r.api,".xlsx",u.LSH)}}function h(t,e){if(1&t&&(u.TgZ(0,"td",17),u._uU(1),u.qZA()),2&t){var n=u.oxw().$implicit;u.xp6(1),u.hij(" ",n.err||"","")}}function g(t,e){if(1&t&&(u.TgZ(0,"tr"),u.YNc(1,h,2,1,"td",16),u.qZA()),2&t){var n=e.$implicit;u.Q6J("@slideIn",void 0),u.xp6(1),u.Q6J("ngIf",n.err)}}function m(t,e){if(1&t&&(u.TgZ(0,"table",14),u.TgZ(1,"h4"),u._uU(2,"L\u1ed7i d\u1eef li\u1ec7u file import"),u.qZA(),u.TgZ(3,"tbody"),u.YNc(4,g,2,2,"tr",15),u.qZA(),u.qZA()),2&t){var n=u.oxw(2);u.xp6(4),u.Q6J("ngForOf",n.errorData.length>0?n.errorData:n.dataJson)}}function v(t,e){if(1&t){var n=u.EpF();u.TgZ(0,"button",18),u.NdJ("click",function(){return u.CHM(n),u.oxw(2).import()}),u._uU(1,"Import Excel"),u.qZA()}}function b(t,e){if(1&t){var n=u.EpF();u.TgZ(0,"button",18),u.NdJ("click",function(){return u.CHM(n),u.oxw(2).importDBFile()}),u._uU(1,"Import BackupDB"),u.qZA()}}function x(t,e){if(1&t){var n=u.EpF();u.TgZ(0,"button",19),u.NdJ("click",function(){return u.CHM(n),u.oxw(2).reload()}),u._uU(1,"L\xe0m l\u1ea1i"),u.qZA()}}function k(t,e){if(1&t&&(u.TgZ(0,"div",3),u.TgZ(1,"h4",4),u._uU(2,"Import t\u1eeb file excel"),u.qZA(),u._UZ(3,"hr"),u.YNc(4,d,11,1,"div",5),u.YNc(5,m,5,1,"table",6),u.TgZ(6,"div",7),u.YNc(7,v,2,0,"button",8),u.YNc(8,b,2,0,"button",8),u.YNc(9,x,2,0,"button",9),u.qZA(),u.qZA()),2&t){var n=u.oxw();u.xp6(4),u.Q6J("ngIf",0===n.dataJson.length),u.xp6(1),u.Q6J("ngIf",n.errorData.length>0),u.xp6(2),u.Q6J("ngIf",n.checkPer(4)&&0==n.errorData.length&&n.dataJson.length>0),u.xp6(1),u.Q6J("ngIf",n.checkPer(4)&&0==n.errorData.length&&n.backup.length>0),u.xp6(1),u.Q6J("ngIf",n.errorData.length>0||n.dataJson.length>0||n.backup.length>0)}}function y(t,e){if(1&t&&(u.TgZ(0,"tr"),u.TgZ(1,"td"),u._uU(2),u.qZA(),u.TgZ(3,"td"),u._uU(4),u.qZA(),u.qZA()),2&t){var n=e.$implicit;u.xp6(2),u.Oqu(n.index),u.xp6(2),u.Oqu(n.msg)}}function w(t,e){if(1&t&&(u.TgZ(0,"table"),u.TgZ(1,"thead"),u.TgZ(2,"tr"),u.TgZ(3,"th"),u._uU(4,"D\xf2ng"),u.qZA(),u.TgZ(5,"th"),u._uU(6,"L\u1ed7i"),u.qZA(),u.qZA(),u.qZA(),u.TgZ(7,"tbody"),u.YNc(8,y,5,2,"tr",15),u.qZA(),u.qZA()),2&t){var n=u.oxw();u.xp6(8),u.Q6J("ngForOf",n.errServer)}}var Z,_=((Z=function(){function e(n){t(this,e),this.plus=n,this.global=!1,this.dataImport=[],this.dataJson=[],this.errorData=[],this.errServer=[],this.show=!1,this.header=[],this.backup=[]}return n(e,[{key:"ngOnInit",value:function(){this.dataJson=[],this.dataImport=[]}},{key:"readXlsx",value:function(t){var e=this;this.plus.load();var n=t.target.files[0];if("application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"==n.type||"application/vnd.ms-excel"==n.type){var r=t.target,a=new FileReader;a.onload=function(t){var n=i.read(t.target.result,{type:"binary"});e.dataImport=i.utils.sheet_to_json(n.Sheets[n.SheetNames[0]],{header:1}),e.selectedFile(e.dataImport),e.plus.loaded(),r=null},a.onerror=function(){return e.plus.alertError("L\u1ed7i file excel import")},a.readAsBinaryString(r.files[0])}else{var o=new FileReader;o.readAsText(t.target.files[0],"UTF-8"),o.onload=function(t){var n=JSON.parse(t.target.result);e.backup=e.cleanData(n),e.plus.loaded()},o.onerror=function(t){e.plus.alertError("L\u1ed7i file import"),e.plus.loaded()}}}},{key:"selectedFile",value:function(t){var e=this;this.header=t[0];for(var n=function(n){var r={};t[0].forEach(function(e,a){r["".concat(e)]=t[n][a]}),delete r._id,delete r.__v,e.form.patchValue(r),e.form.valid?(r.keyWord=e.plus.generateKeyWord(r),r.dateModify=Date.now()+n,e.dataJson.push(r)):(r.err="T\u1ea1i h\xe0ng ".concat(n,": ").concat(e.plus.getErrValidateForm(e.form)),e.errorData.push(r))},r=1;r<t.length;r++)n(r)}},{key:"import",value:function(){return p(this,void 0,void 0,regeneratorRuntime.mark(function t(){var e,n,r,a,o,i=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.plus.subs.unsubscribe(),e=this.dataJson.length,n=0,r=!1,a=this.dataJson,o=regeneratorRuntime.mark(function t(){var o,u;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(o=a.slice(n,n+200),u=i.plus.Arr_MaxValue(o),i.plus.httpPost(i.api+"/import",o).subscribe(function(t){if(1!=t.status)return r=!0;console.log(t.code),i.plus.FBS_PostByUser(i.api,u,i.global),n+=200},function(t){403==t.status&&(i.plus.alertError(t),localStorage.clear(),window.location.reload()),console.log(t),r=!0;var a=JSON.parse(t.error.code);i.errServer.push({index:"",msg:a.message}),i.plus.alertError("Import kh\xf4ng th\xe0nh c\xf4ng!"),n>0&&i.export(i.dataImport.slice(n+1)),n=e}),!r){t.next=4;break}return t.abrupt("return","break");case 4:return t.next=6,i.plus.sleep(3e3);case 6:case"end":return t.stop()}},t)});case 5:if(!(n<e)){t.next=12;break}return t.delegateYield(o(),"t0",7);case 7:if("break"!==t.t0){t.next=10;break}return t.abrupt("break",12);case 10:t.next=5;break;case 12:0==r&&(this.plus.alertSuccess("Import th\xe0nh c\xf4ng!"),this.plus.reload("/taikhoan"));case 13:case"end":return t.stop()}},t,this)}))}},{key:"importDBFile",value:function(){return p(this,void 0,void 0,regeneratorRuntime.mark(function t(){var e,n,r,a,o,i=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.plus.subs.unsubscribe(),e=this.backup.length,n=0,r=!1,a=this.backup,o=regeneratorRuntime.mark(function t(){var o,u;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(o=a.slice(n,n+200),u=i.plus.Arr_MaxValue(o),i.plus.httpPost(i.api+"/import",o).subscribe(function(t){if(console.log(t),1!=t.status)return r=!0;console.log(t.code),i.plus.FBS_PostByUser(i.api,u,i.global),n+=200},function(t){console.log(t),r=!0,i.errServer=JSON.parse(t.error.code),i.plus.alertError("Import kh\xf4ng th\xe0nh c\xf4ng!"),n>0&&i.export(i.dataImport.slice(n+1)),n=e}),!r){t.next=4;break}return t.abrupt("return","break");case 4:return t.next=6,i.plus.sleep(3e3);case 6:case"end":return t.stop()}},t)});case 5:if(!(n<e)){t.next=12;break}return t.delegateYield(o(),"t0",7);case 7:if("break"!==t.t0){t.next=10;break}return t.abrupt("break",12);case 10:t.next=5;break;case 12:0==r&&(this.plus.alertSuccess("Import th\xe0nh c\xf4ng!"),this.plus.reload("/taikhoan"));case 13:case"end":return t.stop()}},t,this)}))}},{key:"checkPer",value:function(t){return this.plus.checkPer(this.api,t)}},{key:"reload",value:function(){return this.plus.reload("/")}},{key:"export",value:function(t){t.unshift(this.header);var e=i.utils.json_to_sheet(t,{skipHeader:!0}),n=i.utils.book_new();i.utils.book_append_sheet(n,e,"ChuaImport"),i.writeFile(n,"4la-"+this.api+"-ChuaImport.xlsx")}},{key:"cleanData",value:function(t){for(var e=[],n=0;n<t.length;n++){var r=t[n];r.keyWord=this.plus.generateKeyWord(r),r.dateModify=Date.now()+n,delete r._id,delete r.__v,e.push(r)}return e}}]),e}()).\u0275fac=function(t){return new(t||Z)(u.Y36(c.T))},Z.\u0275cmp=u.Xpm({type:Z,selectors:[["app-import-database"]],inputs:{form:"form",api:"api",global:"global"},decls:4,vars:2,consts:[["mat-raised-button","","color","accent",3,"click"],["class","card",4,"ngIf"],[4,"ngIf"],[1,"card"],[1,"text-center","text-white","py-2","my-3","bg-primary","rounded-pill","justify-content-center"],["class","ix",4,"ngIf"],["class","table table-inverse table-responsive",4,"ngIf"],[1,"text-center","mx-3"],["class","text-center mx-3","mat-raised-button","","color","accent",3,"click",4,"ngIf"],["class","text-center mx-3","mat-raised-button","","color","primary",3,"click",4,"ngIf"],[1,"ix"],["hidden","","id","file-import","type","file","multiple","false",3,"change"],["for","file-import",1,"custom-file-upload","text-primary","mx-5"],["mat-button","","target","_blank",3,"href"],[1,"table","table-inverse","table-responsive"],[4,"ngFor","ngForOf"],["class","text-danger",4,"ngIf"],[1,"text-danger"],["mat-raised-button","","color","accent",1,"text-center","mx-3",3,"click"],["mat-raised-button","","color","primary",1,"text-center","mx-3",3,"click"]],template:function(t,e){1&t&&(u.TgZ(0,"button",0),u.NdJ("click",function(){return e.show=!e.show}),u._uU(1,"Import Database"),u.qZA(),u.YNc(2,k,10,5,"div",1),u.YNc(3,w,9,1,"table",2)),2&t&&(u.xp6(2),u.Q6J("ngIf",e.show),u.xp6(1),u.Q6J("ngIf",e.errServer.length>0))},directives:[s.lW,l.O5,f.Hw,s.zs,l.sg],styles:[""],data:{animation:[o.Ym]}}),Z)},85913:function(e,n,r){r.d(n,{m:function(){return s}});var a,o=r(62136),i=r(24751),u=r(12057),c=r(74788),s=((a=function e(){t(this,e)}).\u0275fac=function(t){return new(t||a)},a.\u0275mod=c.oAB({type:a}),a.\u0275inj=c.cJS({imports:[[u.ez,i.UX,o.q]]}),a)}}])}();