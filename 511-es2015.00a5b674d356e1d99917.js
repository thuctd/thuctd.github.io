"use strict";(self.webpackChunk_4la=self.webpackChunk_4la||[]).push([[511],{15194:function(e,t,r){r.d(t,{i:function(){return o}});var n=r(74788);let o=(()=>{class e{constructor(){this.fileDrop=new n.vpe,this.preventBodyDrop=!0,this.active=!1}onDrop(e){e.preventDefault(),this.active=!1;const{dataTransfer:t}=e;if(t.items){const e=[];for(let r=0;r<t.items.length;r++)"file"===t.items[r].kind&&e.push(t.items[r].getAsFile());t.items.clear(),this.fileDrop.emit(e)}else{const e=t.files;t.clearData(),this.fileDrop.emit(Array.from(e))}}onDragOver(e){e.stopPropagation(),e.preventDefault(),this.active=!0}onDragLeave(e){this.active=!1}onBodyDragOver(e){this.preventBodyDrop&&(e.preventDefault(),e.stopPropagation())}onBodyDrop(e){this.preventBodyDrop&&e.preventDefault()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=n.lG2({type:e,selectors:[["","appDropZone",""]],hostVars:2,hostBindings:function(e,t){1&e&&n.NdJ("drop",function(e){return t.onDrop(e)})("dragover",function(e){return t.onDragOver(e)})("dragleave",function(e){return t.onDragLeave(e)})("dragover",function(e){return t.onBodyDragOver(e)},!1,n.pYS)("drop",function(e){return t.onBodyDrop(e)},!1,n.pYS),2&e&&n.ekj("drop-zone-active",t.active)},inputs:{preventBodyDrop:"preventBodyDrop"},outputs:{fileDrop:"appDropZone"}}),e})()},31409:function(e,t,r){r.d(t,{x:function(){return a}});var n=r(84487),o=r(74788),s=r(57922);let a=(()=>{class e{constructor(e){this.plus=e}toJsonArray(e,t=!0){return new Promise(r=>{let o={};if(this.plus.load(),null!=e&&"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"!=e.type&&"application/vnd.ms-excel"!=e.type)return this.plus.alertError("Kh\xf4ng ph\u1ea3i file excel");const s=new FileReader;s.readAsBinaryString(e),s.onloadend=e=>{const s=n.read(e.target.result,{type:"binary",cellDates:!0,dateNF:"DD/MM/YYYY"}),a=s.SheetNames;for(let r=0;r<a.length;r++){const e=a[r],l=n.utils.sheet_to_json(s.Sheets[e],{header:1,raw:t});o[`${e}`]=this.convertJSon(l)}this.plus.loaded(),r(o)}})}read(e,t=2){return new Promise(r=>{let o=[];if(this.plus.load(),null!=e&&"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"!=e.type&&"application/vnd.ms-excel"!=e.type)return this.plus.alertError("Kh\xf4ng ph\u1ea3i file excel");const s=new FileReader;s.readAsBinaryString(e),s.onloadend=e=>{const s=n.read(e.target.result,{type:"binary",cellDates:!0,dateNF:"DD/MM/YYYY"}),a=s.SheetNames;for(let r=0;r<t;r++){const e=n.utils.sheet_to_json(s.Sheets[a[r]],{header:1});o.push(e)}this.plus.loaded(),r(o)}})}convertJSon(e){const t=[];for(let r=1;r<e.length;r++){const n={};e[0].forEach((t,o)=>{n[`${t}`]=e[r][o]}),t.push(n)}return t}convertJSonByX(e){const t=[];for(let r=1;r<e.length;r++)if("x"==e[r][0]){const n={};e[0].forEach((t,o)=>{n[`${t}`]=e[r][o]}),t.push(n)}return t}readXlsxToMerge(e){return console.log(e),new Promise((t,r)=>{this.plus.load();let o={};if(null!=e&&"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"!=e.type&&"application/vnd.ms-excel"!=e.type)return this.plus.alertError("Kh\xf4ng ph\u1ea3i file excel");const s=new FileReader;s.readAsBinaryString(e),s.onloadend=e=>{const r=n.read(e.target.result,{type:"binary",cellDates:!0,dateNF:"DD/MM/YYYY"}),s=r.SheetNames;for(let t=0;t<s.length;t++){const e=s[t];if("_Merge"==e)return this.plus.alertError("Vui l\xf2ng \u0111\u1ed5i t\xean sheet _Merge th\xe0nh t\xean kh\xe1c");const a=n.utils.sheet_to_json(r.Sheets[e],{header:1,raw:!0});o[`${0==t?"_Merge":e}`]=this.convertJSonByX(a)}t(o),this.plus.loaded()}})}export(e,t=""){const r=n.utils.json_to_sheet(e,{skipHeader:!0,dateNF:"mm/dd/yyyy;@",cellDates:!0}),o=n.utils.book_new();n.utils.book_append_sheet(o,r,"ChuaImport"),n.writeFile(o,"4la-"+t+"-ChuaImport.xlsx")}exportTar(e,t=""){for(let a=0;a<e.length;a++)delete e[a].dateModify,delete e[a].canEdit,delete e[a].keyWord,delete e[a].__v,delete e[a]._id;let r=JSON.stringify(e),n="data:application/json;charset=utf-8,"+encodeURIComponent(r);console.log(n);let o=`4la-${t||""}`+Date.now()+".tar",s=document.createElement("a");s.setAttribute("href",n),s.setAttribute("download",o),s.click()}}return e.\u0275fac=function(t){return new(t||e)(o.LFG(s.T))},e.\u0275prov=o.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},48387:function(e,t,r){r.d(t,{D:function(){return i}});var n=r(13397),o=r(12057),s=r(24751),a=r(5923),l=r(74788);let i=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=l.oAB({type:e}),e.\u0275inj=l.cJS({imports:[[o.ez,s.u5,n.qX,a.X]]}),e})()}}]);