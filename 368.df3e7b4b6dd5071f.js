"use strict";(self.webpackChunkdlxl=self.webpackChunkdlxl||[]).push([[368],{76368:(gn,at,D)=>{D.r(at),D.d(at,{Cmis4Module:()=>Tn});var H=D(36895),j=D(9116),g=D(15861),mt=D(23970),X=D(92340),t=D(94650),O=D(1768),y=D(10875),pt=D(85033),d=D(24006),Y=D(4859),L=D(97392),Z=D(284),M=D(59549),it=D(77331),x=D(49652),Tt=D(44850);function gt(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"mat-expansion-panel")(1,"mat-expansion-panel-header")(2,"button",3),t._uU(3," \u0110\u0102NG NH\u1eacP"),t.qZA()(),t.TgZ(4,"mat-form-field",4)(5,"input",5),t.NdJ("ngModelChange",function(o){t.CHM(e);const a=t.oxw();return t.KtG(a.userName=o)}),t.qZA()(),t.TgZ(6,"mat-form-field",4)(7,"input",6),t.NdJ("keyup.enter",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.login())})("ngModelChange",function(o){t.CHM(e);const a=t.oxw();return t.KtG(a.password=o)}),t.qZA(),t.TgZ(8,"span",7),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.showpass=!o.showpass)}),t.TgZ(9,"mat-icon"),t._uU(10),t.qZA()()(),t.TgZ(11,"div",8)(12,"button",9),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.login())}),t._uU(13,"\u0110\u0103ng nh\u1eadp"),t.qZA()()()}if(2&i){const e=t.oxw();t.xp6(5),t.Q6J("ngModel",e.userName),t.xp6(2),t.Q6J("type",e.showpass?"text":"password")("ngModel",e.password),t.xp6(3),t.Oqu(e.showpass?"visibility":"visibility_off")}}function At(i,r){1&i&&(t.TgZ(0,"thead")(1,"tr")(2,"th",16),t._uU(3,"\u0110\u01a1n v\u1ecb"),t.qZA(),t.TgZ(4,"th",16),t._uU(5,"Ph\xf2ng ban"),t.qZA(),t.TgZ(6,"th",16),t._uU(7,"H\u1ecd t\xean"),t.qZA(),t.TgZ(8,"th",16),t._uU(9,"\u0110i\u1ec7n tho\u1ea1i"),t.qZA(),t.TgZ(10,"th"),t._uU(11,"Token"),t.qZA()()())}function Nt(i,r){if(1&i&&(t.TgZ(0,"mat-chip-option",20),t._uU(1),t.qZA()),2&i){const e=t.oxw().$implicit;t.MGl("routerLink","/cmis4/",e.api,""),t.xp6(1),t.Oqu(e.label)}}function dt(i,r){if(1&i&&(t.TgZ(0,"mat-chip-listbox"),t._UZ(1,"mat-divider"),t.YNc(2,Nt,2,2,"mat-chip-option",19),t.qZA()),2&i){const e=r.$implicit,n=t.oxw(3);t.xp6(2),t.Q6J("ngIf",n.checkPer(e.api,1)&&e.label.length>0)}}function Ct(i,r){if(1&i&&(t.TgZ(0,"div",17),t.YNc(1,dt,3,1,"mat-chip-listbox",18),t.qZA()),2&i){const e=t.oxw(2);t.xp6(1),t.Q6J("ngForOf",e.nav)}}function Dt(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"div",10)(1,"table",11),t.YNc(2,At,12,0,"thead",1),t.TgZ(3,"tbody")(4,"tr",12)(5,"td",13),t._uU(6),t.qZA(),t.TgZ(7,"td",13),t._uU(8),t.qZA(),t.TgZ(9,"td",13),t._uU(10),t.qZA(),t.TgZ(11,"td",13),t._uU(12),t.qZA(),t.TgZ(13,"td",13),t._uU(14),t.qZA(),t.TgZ(15,"td")(16,"button",14),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.logout())}),t._uU(17,"\u0110\u0103ng xu\u1ea5t"),t.qZA()()()()(),t.YNc(18,Ct,2,1,"div",15),t.qZA()}if(2&i){const e=t.oxw();t.xp6(2),t.Q6J("ngIf",!1),t.xp6(4),t.Oqu(null==e.user?null:e.user.DEPT),t.xp6(2),t.Oqu(null==e.user?null:e.user.SUBDIVISIONNAME),t.xp6(2),t.Oqu(null==e.user?null:e.user.FULLNAME),t.xp6(2),t.Oqu(null==e.user?null:e.user.MOBILE),t.xp6(2),t.Oqu(null==e.user?null:e.user.ACCESS_TOKEN.length),t.xp6(4),t.Q6J("ngIf",e.user||e.checkPer("dev"))}}let St=(()=>{class i{constructor(e,n,o,a){this.cmis4SV=e,this.authSV=n,this.Cmis4SV=o,this.nlmtSV=a,this.environment=X.N,this.nav=mt.w.filter(l=>"cmis4"==l.dbName)[0].sub.slice(1),this.user=JSON.parse(localStorage.getItem("USERCMIS"))||null,this.userName=localStorage.UCMIS||"",this.password=localStorage.PCMIS||"",this.showpass=!1}ngOnInit(){console.log(this.user),this.login()}login(){var e=this;return(0,g.Z)(function*(){localStorage.setItem("UCMIS",e.userName),localStorage.setItem("PCMIS",e.password),""!=e.userName&&""!=e.password&&(yield e.cmis4SV.login(e.userName,e.password),e.user=JSON.parse(localStorage.getItem("USERCMIS")))})()}logout(){localStorage.removeItem("USERCMIS"),localStorage.removeItem("PCMIS"),this.authSV.reload()}checkPer(e,n=1){return!X.N.production||this.authSV.checkPer(e,n)}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(O.a),t.Y36(y.c1),t.Y36(O.a),t.Y36(pt.j))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-cmis4"]],decls:3,vars:2,consts:[[1,"container"],[4,"ngIf"],["class","table-responsive",4,"ngIf"],["mat-raised-button","","color","warn"],["appearance","outline"],["matInput","","placeholder","T\xe0i kho\u1ea3n CMIS",3,"ngModel","ngModelChange"],["matInput","","placeholder","M\u1eadt kh\u1ea9u CMIS",3,"type","ngModel","keyup.enter","ngModelChange"],["matSuffix","",2,"padding-right","1rem",3,"click"],[1,"text-center"],["mat-raised-button","",3,"click"],[1,"table-responsive"],[1,"table"],[1,""],["scope","row"],["mat-raised-button","","color","warn",3,"click"],["class","menu",4,"ngIf"],["scope","col"],[1,"menu"],[4,"ngFor","ngForOf"],["selected","",3,"routerLink",4,"ngIf"],["selected","",3,"routerLink"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0),t.YNc(1,gt,14,4,"mat-expansion-panel",1),t.YNc(2,Dt,19,7,"div",2),t.qZA()),2&e&&(t.xp6(1),t.Q6J("ngIf",!n.user),t.xp6(1),t.Q6J("ngIf",n.user||n.checkPer("dev")))},dependencies:[H.sg,H.O5,j.rH,d.Fj,d.JJ,d.On,Y.lW,L.Hw,Z.Nt,M.KE,M.R9,it.z2,it.iO,x.ib,x.yz,Tt.d]}),i})();var E=D(88996),U=D(24351),Ht=D(15439),N=D.n(Ht),v=D(12157),f=D(25555),b=D(5383),V=D(58441),J=D(9157),B=D(90455),W=D(3238),lt=D(84385),R=D(99433),Gt=D(31361),q=D(41258);function It(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"mat-option",14),t.NdJ("click",function(){const a=t.CHM(e).$implicit,l=t.oxw();return t.KtG(l.optSelected=a.TenFile)}),t._uU(1),t.qZA()}if(2&i){const e=r.$implicit;t.Q6J("value",e.TenFile),t.xp6(1),t.hij("",e.NoiDung," ")}}function Yt(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"tr")(1,"td",17),t.NdJ("click",function(){const a=t.CHM(e).$implicit,l=t.oxw(2);return t.KtG(l.onEdit(a.MA_KHANG))}),t._uU(2),t.qZA(),t.TgZ(3,"td",17),t.NdJ("click",function(){const a=t.CHM(e).$implicit,l=t.oxw(2);return t.KtG(l.onEdit(a.MA_KHANG))}),t._uU(4),t.qZA(),t.TgZ(5,"td",17),t.NdJ("click",function(){const a=t.CHM(e).$implicit,l=t.oxw(2);return t.KtG(l.onEdit(a.TEN_KHANG))}),t._uU(6),t.qZA(),t.TgZ(7,"td",17),t.NdJ("click",function(){const a=t.CHM(e).$implicit,l=t.oxw(2);return t.KtG(l.onEdit(a.DIA_CHI))}),t._uU(8),t.qZA(),t.TgZ(9,"td",17),t.NdJ("click",function(){const a=t.CHM(e).$implicit,l=t.oxw(2);return t.KtG(l.onEdit(a.DTHOAI_DVU))}),t._uU(10),t.qZA(),t.TgZ(11,"td",17),t.NdJ("click",function(){const a=t.CHM(e).$implicit,l=t.oxw(2);return t.KtG(l.onEdit(a.EMAIL))}),t._uU(12),t.qZA(),t.TgZ(13,"td",17),t.NdJ("click",function(){const a=t.CHM(e).$implicit,l=t.oxw(2);return t.KtG(l.onEdit(a.MUC_DICHSD))}),t._uU(14),t.qZA(),t.TgZ(15,"td",17),t.NdJ("click",function(){const a=t.CHM(e).$implicit,l=t.oxw(2);return t.KtG(l.onEdit(a.CHUOI_GIA))}),t._uU(16),t.qZA(),t.TgZ(17,"td",17),t.NdJ("click",function(){const a=t.CHM(e).$implicit,l=t.oxw(2);return t.KtG(l.onEdit(a.MA_SOGCS))}),t._uU(18),t.qZA(),t._UZ(19,"td"),t.qZA()}if(2&i){const e=r.$implicit,n=r.index;t.xp6(2),t.Oqu(n+1),t.xp6(2),t.Oqu(e.MA_KHANG),t.xp6(2),t.Oqu(e.TEN_KHANG),t.xp6(2),t.Oqu(e.TEN_DDIEN),t.xp6(2),t.Oqu(e.DTHOAI_DVU),t.xp6(2),t.Oqu(e.EMAIL),t.xp6(2),t.Oqu(e.MUC_DICHSD),t.xp6(2),t.Oqu(e.CHUOI_GIA),t.xp6(2),t.Oqu(e.MA_SOGCS)}}function Mt(i,r){if(1&i&&(t.TgZ(0,"table",15)(1,"thead")(2,"tr")(3,"th"),t._uU(4,"TT"),t.qZA(),t.TgZ(5,"th"),t._uU(6,"MA_KHANG"),t.qZA(),t.TgZ(7,"th"),t._uU(8,"TEN_KHANG"),t.qZA(),t.TgZ(9,"th"),t._uU(10,"TEN_DDIEN"),t.qZA(),t.TgZ(11,"th"),t._uU(12,"DTHOAI"),t.qZA(),t.TgZ(13,"th"),t._uU(14,"EMAIL"),t.qZA(),t.TgZ(15,"th"),t._uU(16,"MUC_DICHSD"),t.qZA(),t.TgZ(17,"th"),t._uU(18,"CHUOI_GIA"),t.qZA(),t.TgZ(19,"th"),t._uU(20,"MA_SOGCS"),t.qZA(),t.TgZ(21,"th"),t._uU(22,"MAU"),t.qZA()()(),t.TgZ(23,"tbody"),t.YNc(24,Yt,20,9,"tr",16),t.qZA()()),2&i){const e=t.oxw();t.xp6(24),t.Q6J("ngForOf",e.items)}}let Ot=(()=>{class i{constructor(e,n,o,a,l){this.plus=e,this.cmis4SV=n,this.excelSV=o,this.sheetdbSV=a,this.docxSV=l,this.ThongTinKHs=[],this.dataExport=[],this.user=JSON.parse(localStorage.getItem("USERCMIS"))||null,this.db=null,this.dbName="cmis4",this.api="cmis4-tra-cuu",this.allowLoadmore=!0,this.perPageItems=100,this.items=[],this.xlsArr=[],this.optDM=[],this.optSelected="",this.ngay1=new Date,this.ngay2=new Date,this.sotien=0,this.searchArr=[],this.searchBodyArr=[],this.excelObj=[],this.doituong=[],this.isDanhSach=!1,this.theoLo=[]}ngOnInit(){this.getDanhMuc()}convertTheoLo(){for(let e=0;e<this.ThongTinKHs.length;e++){const n=this.ThongTinKHs[e];let o={MA_DVIQLY:n.MA_KHANG.slice(0,6),MA_YCAU_KNAI:n.MA_KHANG,MA_KHANG:n.MA_KHANG,MA_DDO:n.MA_KHANG+"001",TEN_KHANG:n.TEN_KHANG,DIA_CHI_KH:n.DIA_CHI,DIA_CHI_DDO:n.DCHI_DIEMDO,MA_HDONG:n.MA_HDONG2,MA_TRAM:n.MA_TRAM,HLUC_TUNGAY:N()().format("DD/MM/YYYY"),HLUC_DENNGAY:n.HLUC_DENNGAY||"",EMAIL:n.EMAIL,MASO_THUE:n.MASO_THUE,NGAY_SINH:n.NGAY_SINH,DTHOAI:n.DTHOAI+"",TEN_DDIEN:n.TEN_KHANG,SO_CMT:n.SO_CMT,NGAY_CAP:n.NGAY_CAP,NOI_CAP:"C\u1ee5c c\u1ea3nh s\xe1t QLHC v\u1ec1 TTXH",SOGIAY_UQUYEN:"",TEN_UQUYEN:"",NGAY_UQUYEN:"",GIAY_KDOANH:"",DVI_CAP_KDOANH:"",NGAY_CAP_KDOANH:""};this.theoLo.push(o)}this.excelSV.export(this.theoLo,"theoLo")}getTCD(){}getDanhMuc(){this.sheetdbSV.get("1duYS3zmzr_dyLfh3AIIBRw5K0rqZeVGkgEXmpG-QDmU","CMIS").subscribe(e=>{console.log(e),this.optDM=e.data})}exportDocx(){if(this.isDanhSach){let e={_Merge:{Ngay2:this.ngay2},tb:this.ThongTinKHs,Ngay1:this.ngay1,SoTien:this.sotien};this.docxSV.loadFileUrl(`https://thuctd.github.io/templates/CMIS/${this.optSelected}.docx`).then(n=>{this.docxSV.generateOne(e,n,this.optSelected+".docx").then(o=>{this.plus.alertSuccess()})})}else if(this.isDanhSach||1!=this.ThongTinKHs.length)this.docxSV.loadFileUrl(`https://thuctd.github.io/templates/CMIS/${this.optSelected}.docx`).then(e=>{this.docxSV.generateZipFile({_Merge:this.items},e,this.optSelected+".docx").then(n=>{this.plus.alertSuccess()})});else{let e=Object.assign(this.ThongTinKHs[0],{_Merge:{Ngay2:this.ngay2},Ngay1:this.ngay1,SoTien:this.sotien});this.docxSV.loadFileUrl(`https://thuctd.github.io/templates/CMIS/${this.optSelected}.docx`).then(n=>{this.docxSV.generateOne(e,n,this.optSelected+".docx").then(o=>{this.plus.alertSuccess()})})}}themTtinKhangDtuong(e){var n=this;return(0,g.Z)(function*(){let o={MA_DVIQLY:n.user.SUBDIVISIONID,MA_KHANG:e.MA_KHANG,MA_YCAU_KNAI:""},a=yield n.cmis4SV.layTtinKhangDtuongMoinhat([o]);console.log(a);let l={HDG_KHANG_EVN_C06:[],bangDvXminhCdan:[],DV_XMINH_CDAN:[],DV_XMINH_DNGHIEP:[],DV_XMINH_CDAN_HDC:[],DV_XMINH_CDAN_U:[],HDG_KHANG_DTUONG_U:[],HDG_KHACH_HANG:a.HDG_KHACH_HANG,HDG_KHACH_HANG_U:a.HDG_KHACH_HANG_U,HDG_KHANG_DTUONG:[{MA_DVIQLY:n.user.SUBDIVISIONID,ID_DTUONG:-1,NGAY_HLUC:e.NGAY_HLUC,NGAY_HHLUC:"",MA_KHANG:e.MA_KHANG,MANHOM_KHANG:e.MANHOM_KHANG,TEN_NHOM:e.TEN_NHOM,TEN_KHANG:a.HDG_KHACH_HANG[0].TEN_KHANG,DCHI_KHANG:a.HDG_KHACH_HANG[0].DCHI_KHANG,NGAY_TAO:N()().format("DD/MM/YYYY"),NGAY_SUA:N()().format("DD/MM/YYYY"),NGUOI_SUA:n.user.USERNAME,NGUOI_TAO:n.user.USERNAME,MA_CNANG:"511",TRANG_THAI:"I",MA_DVINBO:""}]};const p={path:"/serviceHopDong/layTtinKhangDtuongMoinhat",authority:"cmis-api.evnspc.vn",authorization:"Bearer "+n.cmis4SV.getUser().ACCESS_TOKEN};return v.Z.post("https://cmis-api.evnspc.vn/serviceHopDong/layTtinKhangDtuongMoinhat",l,{headers:p}).then(m=>(console.log(m.data),m.data)).catch(m=>{n.cmis4SV.handleError(m)})})()}themTtinKhangDtuongArr(){var e=this;return(0,g.Z)(function*(){0==e.xlsArr.length&&e.plus.alertWarning("Vui l\xf2ng copy m\xe3 PK d\xe1n v\xe0o \xf4 t\xecm ki\u1ebfm ho\u1eb7c import file excel"),(0,E.D)(e.xlsArr).pipe((0,U.b)(n=>e.themTtinKhangDtuong(n))).subscribe()})()}selectedFile(e){console.log(e)}getMonth(e,n){1==n?this.ngay1=e:this.ngay2=e}layTtinKhangDtuongMoinhat(){var e=this;return(0,g.Z)(function*(){let n=[];for(let o=0;o<e.searchArr.length;o++)n.push({MA_DVIQLY:e.user.SUBDIVISIONID,MA_KHANG:e.searchArr[o],MA_YCAU_KNAI:""});e.cmis4SV.layTtinKhangDtuongMoinhat(n).then(o=>e.doituong=o.HDG_KHANG_DTUONG)})()}getThongTinMoiNhatArr(){var e=this;return(0,g.Z)(function*(){0==e.searchArr.length&&e.plus.alertWarning("Vui l\xf2ng copy m\xe3 PK d\xe1n v\xe0o \xf4 t\xecm ki\u1ebfm"),(0,E.D)(e.searchArr).pipe((0,U.b)(n=>e.lay_TTinHopDongDeKyLai_TheoLo(n))).subscribe()})()}lay_TTinHopDongDeKyLai_TheoLoArr(){var e=this;return(0,g.Z)(function*(){return e.cmis4SV.lay_TTinHopDongDeKyLai_TheoLoArr(e.searchBodyArr).then(n=>{n.forEach(o=>{o.NGAY1=e.ngay1,o.NGAY2=e.ngay2,o.SO_TIEN=e.sotien}),e.ThongTinKHs=e.ThongTinKHs.concat(n),e.items=n.slice(0,50),console.log(e.items)})})()}lay_TTinHopDongDeKyLai_TheoLo(e){var n=this;return(0,g.Z)(function*(){return n.cmis4SV.lay_TTinHopDongDeKyLai_TheoLo(e).then(o=>{n.ThongTinKHs.push(o)})})()}traCuuKH(e){var n=this;return(0,g.Z)(function*(){let o=yield n.cmis4SV.layTtinKHangMoinhat(e),a=Object.assign({},o.HDG_DIEM_DO,o.HDG_HOP_DONG,o.HDG_KHACH_HANG,o.HDG_KHANG_LIENHE,o.HDG_PHU_LUC_HD),l=n.plus.flattenObjectWithUniqueKeys(a);console.log(l);let u={};for(const C in o){let A=n.plus.Obj_clean(o[C]?.[0]);u={...u,...A}}let h=yield n.cmis4SV.timKiemKhachHang(e),p={},m=n.plus.Obj_clean(h[0]);p={...p,...m};let c={...u,...p};n.ThongTinKHs.push(c),c._id=e,console.log(c)})()}exportExcel(){this.ThongTinKHs.length>0&&this.excelSV.export(this.ThongTinKHs,"TraCuu"),this.doituong.length>0&&this.excelSV.export(this.doituong,"doituong")}onDrop(e){let n=[];this.excelSV.fileToJsonArray(e[0]).then(o=>{for(let a=0;a<o.length;a++)n.push(o[a].MA_KHANG);this.searchArr=n})}onEdit(e){this.plus.copyToClipboard(e)}getClip(e){var n=this;return(0,g.Z)(function*(){n.searchArr=[];for(let o=0;o<e.length;o++){const a=n.cmis4SV.convertPK(e[o][0]);n.searchArr.push(a);let l={MA_DVIQLY:a.slice(0,6),MA_KHANG:a,LOAI_YCAU:"KLLO"};n.searchBodyArr.push(l)}console.log(n.searchArr)})()}pushData(e){if(e&&this.allowLoadmore){let n=this.items.length,o=this.ThongTinKHs.slice(n,n+this.perPageItems);this.items=this.items.concat(o)}}onDropFile(e){this.excelSV.fileToJsonArray(e[0]).then(n=>{console.log(n),this.xlsArr=n})}checkPer(e,n=this.api){return!!window.max&&window.max.opt[n]>e}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(f.T),t.Y36(O.a),t.Y36(b.x),t.Y36(V.F),t.Y36(J.E))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-tra-cuu"]],decls:33,vars:14,consts:[[1,"container","py-3"],[1,"row"],[1,"row","py-3"],["color","warn",3,"ngModel","ngModelChange"],[1,"col"],["selected","",3,"value","click",4,"ngFor","ngForOf"],["type","number","matInput","","placeholder","S\u1ed1",1,"text-end",3,"ngModel","ngModelChange"],[3,"startDay","openOnFocus","label","format","month"],[3,"label","excel"],[1,"text-center"],["mat-raised-button","","color","accent",3,"click"],["mat-raised-button","","color","primary",3,"click"],["class","table table-hover table-bordered",4,"ngIf"],[3,"percentLoad","emit"],["selected","",3,"value","click"],[1,"table","table-hover","table-bordered"],[4,"ngFor","ngForOf"],[3,"click"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"mat-slide-toggle",3),t.NdJ("ngModelChange",function(a){return n.isDanhSach=a}),t._uU(4,"Danh s\xe1ch"),t.qZA()(),t.TgZ(5,"div",4)(6,"mat-form-field")(7,"mat-label"),t._uU(8,"Ch\u1ecdn m\u1eabu "),t.qZA(),t.TgZ(9,"mat-select"),t.YNc(10,It,2,2,"mat-option",5),t.qZA()()(),t.TgZ(11,"div",4)(12,"mat-form-field")(13,"mat-label"),t._uU(14,"S\u1ed1 "),t.qZA(),t.TgZ(15,"input",6),t.NdJ("ngModelChange",function(a){return n.sotien=a}),t.qZA()()(),t.TgZ(16,"div",4)(17,"app-date-picker",7),t.NdJ("month",function(a){return n.getMonth(a,1)}),t.qZA()(),t.TgZ(18,"div",4)(19,"app-date-picker",7),t.NdJ("month",function(a){return n.getMonth(a,2)}),t.qZA()()(),t.TgZ(20,"app-parse-excel-clipboard",8),t.NdJ("excel",function(a){return n.getClip(a)}),t.qZA()(),t.TgZ(21,"div",9)(22,"button",10),t.NdJ("click",function(){return n.lay_TTinHopDongDeKyLai_TheoLoArr()}),t._uU(23,"L\u1ea5y d\u1eef li\u1ec7u"),t.qZA(),t.TgZ(24,"button",11),t.NdJ("click",function(){return n.exportExcel()}),t._uU(25,"Xu\u1ea5t excel danh s\xe1ch"),t.qZA(),t.TgZ(26,"button",11),t.NdJ("click",function(){return n.exportDocx()}),t._uU(27,"Xu\u1ea5t theo file m\u1eabu"),t.qZA(),t.TgZ(28,"button",11),t.NdJ("click",function(){return n.convertTheoLo()}),t._uU(29,"Xu\u1ea5t file theo l\xf4"),t.qZA()(),t.TgZ(30,"div"),t.YNc(31,Mt,25,1,"table",12),t.qZA(),t.TgZ(32,"app-loadmore",13),t.NdJ("emit",function(a){return n.pushData(a)}),t.qZA()),2&e&&(t.xp6(3),t.Q6J("ngModel",n.isDanhSach),t.xp6(7),t.Q6J("ngForOf",n.optDM),t.xp6(5),t.Q6J("ngModel",n.sotien),t.xp6(2),t.Q6J("startDay",n.ngay1)("openOnFocus",!0)("label","Nga\u0300y 1")("format","DD/MM/YYYY"),t.xp6(2),t.Q6J("startDay",n.ngay2)("openOnFocus",!0)("label","Nga\u0300y 2")("format","DD/MM/YYYY"),t.xp6(1),t.Q6J("label","Copy m\xe3 PK d\xe1n v\xf4 \u0111\xe2y"),t.xp6(11),t.Q6J("ngIf",n.ThongTinKHs.length>0),t.xp6(1),t.Q6J("percentLoad",80))},dependencies:[H.sg,H.O5,d.Fj,d.wV,d.JJ,d.On,B.Rr,Y.lW,Z.Nt,M.KE,M.hX,W.ey,lt.gD,R.L,Gt.w,q.K]}),i})();var z=D(15228),K=D(94559),k=D(11147),F=D(51511);function ft(i,r){if(1&i&&(t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t.TgZ(7,"td"),t._uU(8),t.qZA()()),2&i){const e=r.$implicit;t.Q6J("@slideIn",void 0),t.xp6(2),t.hij(" ",e.STTU_UTIEN,""),t.xp6(2),t.hij(" ",e.DTHOAI_DVU,""),t.xp6(2),t.hij(" ",e.EMAIL,""),t.xp6(2),t.hij(" ",e.TEN_KH_LHE,"")}}function Et(i,r){if(1&i&&(t.TgZ(0,"div",15)(1,"table",16)(2,"thead")(3,"tr")(4,"th"),t._uU(5,"STT \u01afu ti\xean"),t.qZA(),t.TgZ(6,"th"),t._uU(7,"\u0110i\u1ec7n tho\u1ea1i"),t.qZA(),t.TgZ(8,"th"),t._uU(9,"Email"),t.qZA(),t.TgZ(10,"th"),t._uU(11,"H\u1ecd v\xe0 t\xean"),t.qZA()()(),t.TgZ(12,"tbody"),t.YNc(13,ft,9,5,"tr",17),t.qZA()()()),2&i){const e=t.oxw();t.xp6(13),t.Q6J("ngForOf",e.lienhes)}}function Ut(i,r){if(1&i&&(t.TgZ(0,"h5"),t._uU(1),t.qZA()),2&i){const e=t.oxw(2);t.xp6(1),t.AsE("\u0110\xe3 c\u1eadp nh\u1eadt: ",e.i,"/",e.excelObj.length,"")}}function Zt(i,r){if(1&i&&(t.TgZ(0,"tr")(1,"td",24),t._uU(2),t.qZA(),t.TgZ(3,"td",24),t._uU(4),t.qZA(),t.TgZ(5,"td",24),t._uU(6),t.qZA(),t.TgZ(7,"td",24),t._uU(8),t.qZA(),t.TgZ(9,"td",24),t._uU(10),t.qZA()()),2&i){const e=r.$implicit,n=r.index;t.xp6(2),t.Oqu(n+1),t.xp6(2),t.Oqu(e.MA_KHANG),t.xp6(2),t.Oqu(e.DTHOAI_DVU),t.xp6(2),t.Oqu(e.TEN_KH_LHE),t.xp6(2),t.Oqu(e.status)}}function bt(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"mat-expansion-panel")(1,"mat-expansion-panel-header"),t._uU(2," Import "),t.qZA(),t.TgZ(3,"app-drop-files",18),t.NdJ("files",function(o){t.CHM(e);const a=t.oxw();return t.KtG(a.onDropFile(o))})("ondragover",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.ondragover())}),t.qZA(),t._UZ(4,"hr"),t.TgZ(5,"app-parse-excel-clipboard",19),t.NdJ("json",function(o){t.CHM(e);const a=t.oxw();return t.KtG(a.getJson(o))}),t.qZA(),t._UZ(6,"hr"),t.TgZ(7,"div",9),t.YNc(8,Ut,2,2,"h5",14),t.TgZ(9,"button",20),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.updateLienHeArr())}),t._uU(10,"Import"),t.qZA()(),t.TgZ(11,"div")(12,"table",21)(13,"thead")(14,"tr")(15,"th",22),t._uU(16,"TT"),t.qZA(),t.TgZ(17,"th",22),t._uU(18,"M\xe3 PK"),t.qZA(),t.TgZ(19,"th",22),t._uU(20,"S\u1ed1 \u0111i\u1ec7n tho\u1ea1i"),t.qZA(),t.TgZ(21,"th",22),t._uU(22,"H\u1ecd t\xean"),t.qZA(),t.TgZ(23,"th",22),t._uU(24,"status"),t.qZA()()(),t.TgZ(25,"tbody"),t.YNc(26,Zt,11,5,"tr",17),t.qZA(),t.TgZ(27,"button",23),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.export())}),t._uU(28,"export"),t.qZA()()()()}if(2&i){const e=t.oxw();t.xp6(3),t.Q6J("label",""),t.xp6(2),t.Q6J("label","Copy m\xe3 PK d\xe1n v\xf4 \u0111\xe2y"),t.xp6(3),t.Q6J("ngIf",e.i>0||e.excelObj.length>0),t.xp6(18),t.Q6J("ngForOf",e.excelObj)}}let yt=(()=>{class i{constructor(e,n,o,a,l,u){this.excelSV=e,this.plus=n,this.cmis4SV=o,this.loadSV=a,this.formSV=l,this.authSV=u,this.user=JSON.parse(localStorage.getItem("USERCMIS")),this.api="cmis4-lien-he",this.lienhes=[],this.searchArr=[],this.report=[],this.excelObj=[],this.i=0,this.uutien=!1,this.main=this.formSV.fb.group({MA_KHANG:["",[d.kI.required,d.kI.minLength(13),d.kI.maxLength(13)]],DTHOAI_DVU:["",[d.kI.required,d.kI.minLength(10),d.kI.maxLength(11)]],TEN_KH_LHE:["",[d.kI.minLength(5)]],EMAIL:["",[d.kI.email]]})}ngOnInit(){this.user=this.cmis4SV.getUser(),this.main.patchValue({MA_KHANG:"",DTHOAI_DVU:""})}getJson(e){console.log(e),this.excelObj=e}updateLienHeArr(){let e;if(this.uutien){if(e=confirm("B\u1ea1n mu\u1ed1n l\u01b0u to\xe0n b\u1ed9 v\u1edbi s\u1ed1 th\u1ee9 t\u1ef1 \u01b0u ti\xean l\xe0 0?"),!e)return null}else if(e=confirm("B\u1ea1n mu\u1ed1n l\u01b0u to\xe0n b\u1ed9 danh s\xe1ch?"),!e)return null;(0,E.D)(this.excelObj).pipe((0,U.b)((n,o)=>this.updateLienHe(o,n.MA_KHANG,n.DTHOAI_DVU,n.TEN_KH_LHE,n.EMAIL))).subscribe()}xemlienhe(e){this.main.patchValue({MA_KHANG:this.cmis4SV.convertPK(e)}),this.cmis4SV.layTtinKHangMoinhat(this.cmis4SV.convertPK(e)).then(n=>{Array.isArray(n.HDG_KHANG_LIENHE)?this.lienhes=n.HDG_KHANG_LIENHE:this.plus.alertError(n.HDG_KHANG_LIENHE)})}updateLienHe(e,n,o,a="",l=""){var u=this;return(0,g.Z)(function*(){u.i=e+1;let h=0;yield u.plus.sleep(1e3);let p=yield u.cmis4SV.layTtinKHangMoinhat(u.cmis4SV.convertPK(n));if(p.hasOwnProperty("TYPE"))return null;for(let C=0;C<p.HDG_KHANG_LIENHE.length;C++){if(null==p){u.excelObj[e].status=!1,h++;break}const A=p.HDG_KHANG_LIENHE[C];if(A.DTHOAI_DVU==o&&!u.uutien){u.plus.alertWarning("S\u1ed1 \u0111i\u1ec7n tho\u1ea1i: "+A.DTHOAI_DVU+"- STT: "+A.STTU_UTIEN+u.cmis4SV.convertPK(n)+" \u0111\xe3 t\u1ed3n t\u1ea1i!"),u.excelObj[e].status=!1,h++;break}}u.lienhes=p.HDG_KHANG_LIENHE;let m={DCHI_KH_LHE:p.HDG_KHANG_LIENHE[0].DCHI_KH_LHE,TEN_KH_LHE:a.length>0?a:p.HDG_KHANG_LIENHE[0].TEN_KH_LHE,TRINH_DO:"",NGHE_NGHIEP:"",DTHOAI_DVU:o,EMAIL:l,FAX:"",ZALO:"",FACEBOOK:"",MA_QHE:"99",GIOI_TINH:p.HDG_KHANG_LIENHE[0].GIOI_TINH,ID_LIENHE:-1,MA_CNANG:"374",MA_DVIQLY:p.HDG_KHANG_LIENHE[0].MA_DVIQLY,MA_HDONG:p.HDG_KHANG_LIENHE[0].MA_HDONG,MA_KHANG:u.cmis4SV.convertPK(n),NGAY_HLUC:N()().add(1,"day").format("DD/MM/YYYY"),NGAY_SINH:"",NGUOI_SUA:u.user.USERNAME,NGUOI_TAO:u.user.USERNAME,ID_LOG_XMDC:"",SO_DINHDANH:null,NGAY_CAP_CCCD:"",NOI_CAP_CCCD:null,DAN_TOC:null,TON_GIAO:null,QUOC_TICH:null,TINHTRANG_HONNHAN:null,IS_SIGN_BBAN_TTHAO:!1,STTU_UTIEN:`${u.uutien?0:p.HDG_KHANG_LIENHE.length}`,GIOI_TINH_HTHI:"\xd4ng",NGAY_KY:N()().add(1,"day").format("DD/MM/YYYY")};u.uutien?p.HDG_KHANG_LIENHE.unshift(m):p.HDG_KHANG_LIENHE.push(m);let c={bangDvXminhCdan:[],DV_XMINH_CDAN:[],DV_XMINH_CDAN_HDC:[],HDG_KHANG_LIENHE:u.removeDuplicates(p.HDG_KHANG_LIENHE,"DTHOAI_DVU"),HDG_KHANG_LIENHE_U:p.HDG_KHANG_LIENHE_U,HDG_KHACH_HANG:p.HDG_KHACH_HANG,HDG_DIEM_DO:p.HDG_DIEM_DO,HDG_HOP_DONG:p.HDG_HOP_DONG};return 0==h?u.ThemTDoiTTinLienHe(c,e):null})()}ThemTDoiTTinLienHe(e,n){var o=this;return(0,g.Z)(function*(){o.loadSV.load("ThemTDoiTTinLienHe");const u={path:"/serviceHopDong/ThemTDoiTTinLienHe",authority:"cmis-api.evnspc.vn",authorization:"Bearer "+o.user.ACCESS_TOKEN};return o.plus.alertMatSnackBar(`\u0110ang thay \u0111\u1ed5i s\u1ed1 \u0111i\u1ec7n tho\u1ea1i ${e.HDG_HOP_DONG[0].MA_KHANG}...`),v.Z.post("https://cmis-api.evnspc.vn/serviceHopDong/ThemTDoiTTinLienHe",e,{headers:u}).then(h=>{o.cmis4SV.handleErrCmis(h),o.loadSV.loaded("ThemTDoiTTinLienHe"),o.plus.alertSuccess(`${e.HDG_HOP_DONG[0].MA_KHANG}`),o.main.patchValue({MA_KHANG:o.user.SUBDIVISIONID,DTHOAI_DVU:""}),o.excelObj[n].status=!0}).catch(h=>{401===h.response.status&&(localStorage.removeItem("USERCMIS"),o.plus.alertMatSnackBar("Phie\u0302n \u0111a\u0306ng nha\u0323\u0302p he\u0302\u0301t ha\u0323n. Vui lo\u0300ng \u0111a\u0306ng nha\u0323\u0302p la\u0323i"),o.authSV.reload("/cmis4"))})})()}removeDuplicates(e,n){const o=new Set;let a=e.filter(l=>{const u=l[n];return!o.has(u)&&""!=l.DTHOAI_DVU&&null!=l.DTHOAI_DVU&&(o.add(u),!0)});return a.map((l,u)=>{l.STTU_UTIEN=`${u}`}),this.lienhes=a,a}onDropFile(e){console.log("onDropFile()");for(let n=0;n<e.length;n++)"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"==e[n].type?this.excelSV.fileToJsonArray(e[n]).then(o=>{this.excelObj=o,console.log(this.excelObj)}):this.plus.alertError("File kh\xf4ng h\u1ee3p l\u1ec7")}ondragover(){document.getElementById("dropZone").setAttribute("drop-active","true")}checkPer(e,n=1){return this.authSV.checkPer(e,n)}export(){this.excelSV.export(this.excelObj,"CapNhatLienHe")}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(b.x),t.Y36(f.T),t.Y36(O.a),t.Y36(K.b),t.Y36(k.o),t.Y36(y.c1))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-cap-nhat-lien-he"]],decls:37,vars:5,consts:[[1,"container","my-3"],[1,"row",3,"formGroup"],[1,"col"],["appearance","outline"],["required","","type","text","autocomplete","off","matInput","","formControlName","MA_KHANG"],["matSuffix",""],["required","","type","text","autocomplete","off","matInput","","formControlName","DTHOAI_DVU"],["type","text","autocomplete","off","matInput","","formControlName","EMAIL"],["type","text","autocomplete","off","matInput","","formControlName","TEN_KH_LHE"],[1,"text-center"],["mat-raised-button","","color","primary",3,"click"],[3,"ngModel","ngModelChange"],["mat-raised-button","","color","warn",3,"disabled","click"],["class","row",4,"ngIf"],[4,"ngIf"],[1,"row"],[1,"table","table-hover","table-bordered"],[4,"ngFor","ngForOf"],[3,"label","files","ondragover"],[3,"label","json"],["mat-raised-button","","color","warn",3,"click"],[1,"table"],["scope","col"],["mat-button","",3,"click"],["scope","row"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"mat-form-field",3)(4,"mat-label"),t._uU(5,"M\xe3 kh\xe1ch h\xe0ng"),t.qZA(),t._UZ(6,"input",4)(7,"span",5),t.qZA()(),t.TgZ(8,"div",2)(9,"mat-form-field",3)(10,"mat-label"),t._uU(11,"S\u1ed1 \u0111i\u1ec7n tho\u1ea1i"),t.qZA(),t._UZ(12,"input",6)(13,"span",5),t.qZA()(),t.TgZ(14,"div",2)(15,"mat-form-field",3)(16,"mat-label"),t._uU(17,"Email"),t.qZA(),t._UZ(18,"input",7)(19,"span",5),t.qZA()(),t.TgZ(20,"div",2)(21,"mat-form-field",3)(22,"mat-label"),t._uU(23,"H\u1ecd v\xe0 t\xean"),t.qZA(),t._UZ(24,"input",8)(25,"span",5),t.qZA()()(),t.TgZ(26,"div",9)(27,"button",10),t.NdJ("click",function(){return n.xemlienhe(n.main.value.MA_KHANG)}),t.TgZ(28,"mat-icon"),t._uU(29,"search"),t.qZA()(),t.TgZ(30,"mat-slide-toggle",11),t.NdJ("ngModelChange",function(a){return n.uutien=a}),t._uU(31,"STT \u01b0u ti\xean b\u1eb1ng 0"),t.qZA(),t.TgZ(32,"button",12),t.NdJ("click",function(){return n.updateLienHe(0,n.main.value.MA_KHANG,n.main.value.DTHOAI_DVU,n.main.value.TEN_KH_LHE,n.main.value.EMAIL)}),t.TgZ(33,"mat-icon"),t._uU(34,"save"),t.qZA()()(),t.YNc(35,Et,14,1,"div",13),t.YNc(36,bt,29,4,"mat-expansion-panel",14),t.qZA()),2&e&&(t.xp6(1),t.Q6J("formGroup",n.main),t.xp6(29),t.Q6J("ngModel",n.uutien),t.xp6(2),t.Q6J("disabled",n.main.invalid),t.xp6(3),t.Q6J("ngIf",(null==n.lienhes?null:n.lienhes.length)>0),t.xp6(1),t.Q6J("ngIf",n.checkPer(n.api,2)))},dependencies:[H.sg,H.O5,d.Fj,d.JJ,d.JL,d.Q7,d.On,d.sg,d.u,B.Rr,Y.lW,L.Hw,Z.Nt,M.KE,M.hX,M.R9,x.ib,x.yz,q.K,F.k],data:{animation:[z.Ym]}}),i})();var Kt=D(58687),P=D(1208),tt=D(30627);function Lt(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"div",8)(1,"button",9),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.getBCTEST())}),t._uU(2,"test"),t.qZA()()}}function vt(i,r){if(1&i&&(t.TgZ(0,"tr",13)(1,"td",11),t._uU(2),t.qZA(),t.TgZ(3,"td",11),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.ALo(7,"numberPipe"),t.qZA(),t.TgZ(8,"td"),t._uU(9),t.ALo(10,"numberPipe"),t.qZA(),t.TgZ(11,"td"),t._uU(12),t.ALo(13,"numberPipe"),t.qZA()()),2&i){const e=r.$implicit,n=r.index;t.xp6(2),t.Oqu(n+1),t.xp6(2),t.Oqu(e.NGAY_QTOAN),t.xp6(2),t.Oqu(t.lcZ(7,5,e.SO_TIEN)),t.xp6(3),t.Oqu(t.lcZ(10,7,e.TIEN_GTGT)),t.xp6(3),t.Oqu(t.lcZ(13,9,e.TONG_TIEN))}}function xt(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"div")(1,"h5"),t._uU(2),t.qZA(),t.TgZ(3,"h6"),t._uU(4),t.ALo(5,"numberPipe"),t.qZA(),t.TgZ(6,"h6"),t._uU(7),t.ALo(8,"numberPipe"),t.qZA(),t.TgZ(9,"h6"),t._uU(10),t.ALo(11,"numberPipe"),t.qZA(),t.TgZ(12,"h6"),t._uU(13),t.ALo(14,"numberPipe"),t.qZA(),t.TgZ(15,"h6"),t._uU(16),t.ALo(17,"numberPipe"),t.qZA(),t.TgZ(18,"table",10)(19,"thead",11)(20,"tr")(21,"th",12),t._uU(22,"N\u1ed9i dung"),t.qZA(),t.TgZ(23,"th",12),t._uU(24,"Bi\u1ec3u 1.1"),t.qZA(),t.TgZ(25,"th",12),t._uU(26,"Bi\u1ec3u 1.4"),t.qZA(),t.TgZ(27,"th",12),t._uU(28,"Bi\u1ec3u 1.6"),t.qZA(),t.TgZ(29,"th",12),t._uU(30,"Bi\u1ec3u 1.7"),t.qZA(),t.TgZ(31,"th",12),t._uU(32,"Bi\u1ec3u 1.8"),t.qZA(),t.TgZ(33,"th",12),t._uU(34,"Bi\u1ec3u 1.9"),t.qZA(),t.TgZ(35,"th",12),t._uU(36,"Bi\u1ec3u 1.10 "),t.qZA(),t.TgZ(37,"th",12),t._uU(38,"Bi\u1ec3u 2.6"),t.qZA(),t.TgZ(39,"th",12),t._uU(40,"Bi\u1ec3u 2.9"),t.qZA()()(),t.TgZ(41,"tbody",13)(42,"tr",13)(43,"th",14),t._uU(44," T\u1ed5ng kh\xe1ch h\xe0ng "),t.qZA(),t.TgZ(45,"td"),t._uU(46),t.ALo(47,"numberPipe"),t.qZA(),t.TgZ(48,"td"),t._uU(49),t.ALo(50,"numberPipe"),t.qZA(),t.TgZ(51,"td"),t._uU(52),t.ALo(53,"numberPipe"),t.qZA(),t.TgZ(54,"td"),t._uU(55," - "),t.qZA(),t.TgZ(56,"td"),t._uU(57," -"),t.qZA(),t.TgZ(58,"td"),t._uU(59),t.ALo(60,"numberPipe"),t.qZA(),t.TgZ(61,"td")(62,"b"),t._uU(63),t.ALo(64,"numberPipe"),t.ALo(65,"sum"),t.qZA(),t._uU(66),t.ALo(67,"numberPipe"),t.ALo(68,"sum"),t.ALo(69,"numberPipe"),t.ALo(70,"sum"),t.ALo(71,"numberPipe"),t.ALo(72,"sum"),t.qZA(),t.TgZ(73,"td"),t._uU(74),t.qZA(),t.TgZ(75,"td"),t._uU(76),t.qZA()(),t.TgZ(77,"tr",15)(78,"th",14),t._uU(79,"C\xf4ng su\u1ea5t t\u1ed5ng"),t.qZA(),t.TgZ(80,"td"),t._uU(81),t.ALo(82,"numberPipe"),t.qZA(),t.TgZ(83,"td"),t._uU(84),t.ALo(85,"numberPipe"),t.qZA(),t.TgZ(86,"td"),t._uU(87),t.ALo(88,"numberPipe"),t.qZA(),t.TgZ(89,"td"),t._uU(90," -"),t.qZA(),t.TgZ(91,"td"),t._uU(92," -"),t.qZA(),t.TgZ(93,"td"),t._uU(94),t.ALo(95,"numberPipe"),t.qZA(),t.TgZ(96,"td"),t._uU(97," -"),t.qZA(),t.TgZ(98,"td"),t._uU(99),t.ALo(100,"numberPipe"),t.qZA(),t.TgZ(101,"td"),t._uU(102," -"),t.qZA()(),t.TgZ(103,"tr",15)(104,"th",14),t._uU(105,"S\u1ea3n l\u01b0\u1ee3ng"),t.qZA(),t.TgZ(106,"td"),t._uU(107),t.ALo(108,"numberPipe"),t.qZA(),t.TgZ(109,"td"),t._uU(110),t.ALo(111,"numberPipe"),t.qZA(),t.TgZ(112,"td"),t._uU(113," -"),t.qZA(),t.TgZ(114,"td"),t._uU(115),t.ALo(116,"numberPipe"),t.qZA(),t.TgZ(117,"td"),t._uU(118),t.ALo(119,"numberPipe"),t.qZA(),t.TgZ(120,"td"),t._uU(121," -"),t.qZA(),t.TgZ(122,"td"),t._uU(123," -"),t.qZA(),t.TgZ(124,"td"),t._uU(125),t.ALo(126,"numberPipe"),t.qZA(),t.TgZ(127,"td"),t._uU(128),t.ALo(129,"numberPipe"),t.qZA()(),t.TgZ(130,"tr",13)(131,"th",14),t._uU(132," Ti\u1ec1n ph\xe1t sinh "),t.qZA(),t.TgZ(133,"td"),t._uU(134," -"),t.qZA(),t.TgZ(135,"td"),t._uU(136),t.ALo(137,"numberPipe"),t.qZA(),t.TgZ(138,"td"),t._uU(139," -"),t.qZA(),t.TgZ(140,"td"),t._uU(141),t.ALo(142,"numberPipe"),t.qZA(),t.TgZ(143,"td"),t._uU(144),t.ALo(145,"numberPipe"),t.qZA(),t.TgZ(146,"td"),t._uU(147," -"),t.qZA(),t.TgZ(148,"td"),t._uU(149," -"),t.qZA(),t.TgZ(150,"td"),t._uU(151),t.ALo(152,"numberPipe"),t.qZA(),t.TgZ(153,"td"),t._uU(154),t.ALo(155,"numberPipe"),t.qZA()(),t.TgZ(156,"tr",13)(157,"th",14),t._uU(158,"Thu\u1ebf ph\xe1t sinh "),t.qZA(),t.TgZ(159,"td"),t._uU(160," -"),t.qZA(),t.TgZ(161,"td"),t._uU(162),t.ALo(163,"numberPipe"),t.qZA(),t.TgZ(164,"td"),t._uU(165," -"),t.qZA(),t.TgZ(166,"td"),t._uU(167," -"),t.qZA(),t.TgZ(168,"td"),t._uU(169),t.ALo(170,"numberPipe"),t.qZA(),t.TgZ(171,"td"),t._uU(172," -"),t.qZA(),t.TgZ(173,"td"),t._uU(174," -"),t.qZA(),t.TgZ(175,"td"),t._uU(176),t.ALo(177,"numberPipe"),t.qZA(),t.TgZ(178,"td"),t._uU(179," -"),t.qZA()(),t.TgZ(180,"tr",13)(181,"th",14),t._uU(182," Ti\u1ec1n thanh to\xe1n ch\u01b0a VAT "),t.qZA(),t.TgZ(183,"td"),t._uU(184," -"),t.qZA(),t.TgZ(185,"td"),t._uU(186," -"),t.qZA(),t.TgZ(187,"td"),t._uU(188," -"),t.qZA(),t._UZ(189,"td"),t.TgZ(190,"td"),t._uU(191),t.ALo(192,"numberPipe"),t.qZA(),t.TgZ(193,"td"),t._uU(194," -"),t.qZA(),t.TgZ(195,"td"),t._uU(196," -"),t.qZA(),t.TgZ(197,"td"),t._uU(198),t.ALo(199,"numberPipe"),t.qZA(),t.TgZ(200,"td"),t._uU(201," -"),t.qZA()(),t.TgZ(202,"tr",13)(203,"th",14),t._uU(204," Ti\u1ec1n thanh to\xe1n "),t.qZA(),t.TgZ(205,"td"),t._uU(206," -"),t.qZA(),t.TgZ(207,"td"),t._uU(208," -"),t.qZA(),t.TgZ(209,"td"),t._uU(210," -"),t.qZA(),t._UZ(211,"td"),t.TgZ(212,"td"),t._uU(213),t.ALo(214,"numberPipe"),t.qZA(),t.TgZ(215,"td"),t._uU(216," -"),t.qZA(),t.TgZ(217,"td"),t._uU(218," -"),t.qZA(),t.TgZ(219,"td"),t._uU(220," -"),t.qZA(),t.TgZ(221,"td"),t._uU(222),t.ALo(223,"numberPipe"),t.qZA()(),t.TgZ(224,"tr",13)(225,"th",14),t._uU(226," \u0110i\u1ec1u ch\u1ec9nh"),t.qZA(),t.TgZ(227,"td"),t._uU(228," -"),t.qZA(),t.TgZ(229,"td"),t._uU(230," -"),t.qZA(),t.TgZ(231,"td"),t._uU(232," -"),t.qZA(),t._UZ(233,"td"),t.TgZ(234,"td"),t._uU(235),t.ALo(236,"numberPipe"),t.qZA(),t.TgZ(237,"td"),t._uU(238," -"),t.qZA(),t.TgZ(239,"td"),t._uU(240," -"),t.qZA(),t.TgZ(241,"td"),t._uU(242," -"),t.qZA(),t.TgZ(243,"td"),t._uU(244),t.ALo(245,"numberPipe"),t.qZA()()()(),t.TgZ(246,"h6"),t._uU(247,"Bi\u1ec3u 1.2 "),t.TgZ(248,"button",16),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.getB12())}),t.TgZ(249,"mat-icon"),t._uU(250,"download_for_offline"),t.qZA()()(),t.TgZ(251,"div")(252,"table",17)(253,"thead")(254,"tr",11)(255,"th",12),t._uU(256,"TT"),t.qZA(),t.TgZ(257,"th",12),t._uU(258,"Ng\xe0y quy\u1ebft to\xe1n"),t.qZA(),t.TgZ(259,"th",12),t._uU(260,"S\u1ed1 ti\u1ec1n"),t.qZA(),t.TgZ(261,"th",12),t._uU(262,"Thu\u1ebf"),t.qZA(),t.TgZ(263,"th",12),t._uU(264,"T\u1ed5ng ti\u1ec1n"),t.qZA()()(),t.TgZ(265,"tbody"),t.YNc(266,vt,14,11,"tr",18),t.TgZ(267,"tr",19),t._UZ(268,"td")(269,"td"),t.TgZ(270,"td"),t._uU(271),t.ALo(272,"numberPipe"),t.qZA(),t.TgZ(273,"td"),t._uU(274),t.ALo(275,"numberPipe"),t.qZA(),t.TgZ(276,"td"),t._uU(277),t.ALo(278,"numberPipe"),t.qZA()()()()()()}if(2&i){const e=t.oxw();t.Q6J("@slideIn",void 0),t.xp6(2),t.AsE("K\u1ef2 B\xc1O C\xc1O: ",null==e.dataB14[0]?null:e.dataB14[0].THANG,"/",null==e.dataB14[0]?null:e.dataB14[0].NAM,""),t.xp6(2),t.hij("T\u1ed5ng KH: ",t.lcZ(5,47,null==e.dataB11[0]?null:e.dataB11[0].KHANG_TONG),""),t.xp6(3),t.hij("KH sinh ho\u1ea1t: ",t.lcZ(8,49,null==e.dataB11[0]?null:e.dataB11[0].KHANG_SHOAT),""),t.xp6(3),t.hij("KH ngo\xe0i sinh ho\u1ea1t: ",t.lcZ(11,51,null==e.dataB11[0]?null:e.dataB11[0].KHANG_NGSHOAT),""),t.xp6(3),t.hij("KH ngo\xe0i h\u1ea1 \xe1p: ",t.lcZ(14,53,null==e.dataB14[0]?null:e.dataB14[0].CSUAT_100),""),t.xp6(3),t.hij("KH ngo\xe0i trung \xe1p: ",t.lcZ(17,55,(null==e.dataB14[0]?null:e.dataB14[0].CSUAT_200)+(null==e.dataB14[0]?null:e.dataB14[0].CSUAT_1000)),""),t.xp6(30),t.hij(" ",t.lcZ(47,57,null==e.dataB11[0]?null:e.dataB11[0].KHANG_TONG),""),t.xp6(3),t.hij(" ",t.lcZ(50,59,null==e.dataB14[0]?null:e.dataB14[0].DUAN_TONG)," "),t.xp6(3),t.hij(" ",t.lcZ(53,61,(null==e.dataB16[0]?null:e.dataB16[0].TONG_DUAN)+(null==e.dataB16[1]?null:e.dataB16[1].TONG_DUAN)),""),t.xp6(7),t.hij(" ",t.lcZ(60,63,null==e.dataB19[0]?null:e.dataB19[0].SOLUONG_CKY),""),t.xp6(4),t.hij("",t.lcZ(64,65,t.xi3(65,67,e.dataB110,"TONG_DUAN"))," "),t.xp6(3),t.lnq(" [",t.lcZ(67,70,t.xi3(68,72,e.dataB110,"CO_GIAYCHUNG_DKKD"))," GPKD; ",t.lcZ(69,75,t.xi3(70,77,e.dataB110,"CO_BBAN_PCCC"))," PCCC; ",t.lcZ(71,80,t.xi3(72,82,e.dataB110,"CO_BBAN_KTRA_ANTOAN"))," ATXD]"),t.xp6(8),t.hij(" ",e.dataB26.length,""),t.xp6(2),t.hij(" ",e.dataB29.length,""),t.xp6(5),t.hij(" ",t.lcZ(82,85,null==e.dataB11[0]?null:e.dataB11[0].CSUAT_TONG),""),t.xp6(3),t.hij(" ",t.lcZ(85,87,null==e.dataB14[0]?null:e.dataB14[0].CSUAT_TONG),""),t.xp6(3),t.hij(" ",t.lcZ(88,89,(null==e.dataB16[0]?null:e.dataB16[0].TONG_CSUAT)+(null==e.dataB16[1]?null:e.dataB16[1].TONG_CSUAT)),""),t.xp6(7),t.hij(" ",t.lcZ(95,91,null==e.dataB19[0]?null:e.dataB19[0].CSUAT_CKY),""),t.xp6(5),t.hij(" ",t.lcZ(100,93,e.tongB26.CONG_SUAT),""),t.xp6(8),t.hij(" ",t.lcZ(108,95,null==e.dataB11[0]?null:e.dataB11[0].SLUONG_TONG),""),t.xp6(3),t.hij(" ",t.lcZ(111,97,null==e.dataB14[0]?null:e.dataB14[0].DNANG_EVNMUA),""),t.xp6(5),t.hij(" ",t.lcZ(116,99,(null==e.dataB17[0]?null:e.dataB17[0].TONG_SLUONG)+(null==e.dataB17[1]?null:e.dataB17[1].TONG_SLUONG)),""),t.xp6(3),t.hij(" ",t.lcZ(119,101,null==e.dataB18[0]?null:e.dataB18[0].SLUONG_PS),""),t.xp6(7),t.hij(" ",t.lcZ(126,103,e.tongB26.DNANG_EVNMUA),""),t.xp6(3),t.hij(" ",t.lcZ(129,105,e.tongB29.SLUONG_PS),""),t.xp6(8),t.hij(" ",t.lcZ(137,107,null==e.dataB14[0]?null:e.dataB14[0].TIEN_EVNMUA)," "),t.xp6(5),t.hij(" ",t.lcZ(142,109,(null==e.dataB17[0]?null:e.dataB17[0].TONG_TIEN)+(null==e.dataB17[1]?null:e.dataB17[1].TONG_TIEN)),""),t.xp6(3),t.hij(" ",t.lcZ(145,111,null==e.dataB18[0]?null:e.dataB18[0].TIEN_PS),""),t.xp6(7),t.hij(" ",t.lcZ(152,113,e.tongB26.TIEN_EVNMUA),""),t.xp6(3),t.hij(" ",t.lcZ(155,115,e.tongB29.TIEN_PS),""),t.xp6(8),t.hij(" ",t.lcZ(163,117,null==e.dataB14[0]?null:e.dataB14[0].VAT_EVNMUA)," "),t.xp6(7),t.hij(" ",t.lcZ(170,119,null==e.dataB18[0]?null:e.dataB18[0].THUE_PS_KT),""),t.xp6(7),t.hij(" ",t.lcZ(177,121,e.tongB26.VAT_EVNMUA),""),t.xp6(15),t.hij(" ",t.lcZ(192,123,null==e.dataB18[0]?null:e.dataB18[0].TIEN_TT),""),t.xp6(7),t.hij(" ",t.lcZ(199,125,e.tongB26.TIEN_TTOAN),""),t.xp6(15),t.hij(" ",t.lcZ(214,127,null==e.dataB18[0]?null:e.dataB18[0].TONG_TT),""),t.xp6(9),t.hij(" ",t.lcZ(223,129,e.tongB29.TONG_TT),""),t.xp6(13),t.hij(" ",t.lcZ(236,131,null==e.dataB18[0]?null:e.dataB18[0].TONG_DC),""),t.xp6(9),t.hij(" ",t.lcZ(245,133,e.tongB29.TONG_DC),""),t.xp6(22),t.Q6J("ngForOf",e.dataB12),t.xp6(5),t.Oqu(t.lcZ(272,135,null==e.tongB12?null:e.tongB12.SO_TIEN)),t.xp6(3),t.Oqu(t.lcZ(275,137,null==e.tongB12?null:e.tongB12.TIEN_GTGT)),t.xp6(3),t.Oqu(t.lcZ(278,139,null==e.tongB12?null:e.tongB12.TONG_TIEN))}}function Bt(i,r){if(1&i&&(t.TgZ(0,"div",20)(1,"div",21)(2,"div",22)(3,"h4"),t._uU(4,"B\u1ea3ng \u0111\u1ed1i so\xe1t"),t.qZA(),t.TgZ(5,"table",17)(6,"thead")(7,"tr",11)(8,"th"),t._uU(9,"N\u1ed9i dung"),t.qZA(),t.TgZ(10,"th"),t._uU(11,"S\u1ed1 ti\u1ec1n sau thu\u1ebf"),t.qZA()()(),t.TgZ(12,"tbody",23)(13,"tr")(14,"td")(15,"b"),t._uU(16," T\u1ed3n \u0111\u1ea7u th\xe1ng"),t.qZA()(),t.TgZ(17,"td",13),t._uU(18),t.ALo(19,"numberPipe"),t.qZA()(),t.TgZ(20,"tr")(21,"td")(22,"b"),t._uU(23," Ph\xe1t sinh"),t.qZA()(),t.TgZ(24,"td",13),t._uU(25),t.ALo(26,"numberPipe"),t.qZA()(),t.TgZ(27,"tr")(28,"td")(29,"b"),t._uU(30," \u0110i\u1ec1u ch\u1ec9nh"),t.qZA()(),t.TgZ(31,"td",13),t._uU(32),t.ALo(33,"numberPipe"),t.qZA()(),t.TgZ(34,"tr")(35,"td")(36,"b"),t._uU(37," T\u1ed5ng Ph\xe1t sinh sau \u0111i\u1ec1u ch\u1ec9nh"),t.qZA()(),t.TgZ(38,"td",13),t._uU(39),t.ALo(40,"numberPipe"),t.qZA()(),t.TgZ(41,"tr")(42,"td")(43,"b"),t._uU(44," \u0110\xe3 thanh to\xe1n"),t.qZA()(),t.TgZ(45,"td",13),t._uU(46),t.ALo(47,"numberPipe"),t.qZA()(),t.TgZ(48,"tr")(49,"td")(50,"b"),t._uU(51," T\u1ed3n cu\u1ed1i th\xe1ng Tr\u01b0\u1edbc thu\u1ebf"),t.qZA()(),t.TgZ(52,"td",13),t._uU(53),t.ALo(54,"numberPipe"),t.qZA()(),t.TgZ(55,"tr")(56,"td")(57,"b"),t._uU(58," T\u1ed3n cu\u1ed1i th\xe1ng"),t.qZA()(),t.TgZ(59,"td",13),t._uU(60),t.ALo(61,"numberPipe"),t.qZA()()()()()()()),2&i){const e=t.oxw();t.xp6(18),t.Oqu(t.lcZ(19,7,e.dataB18[0].TONG_DKY)),t.xp6(7),t.Oqu(t.lcZ(26,9,e.dataB18[0].TONG_PS)),t.xp6(7),t.Oqu(t.lcZ(33,11,e.dataB18[0].TONG_DC)),t.xp6(7),t.Oqu(t.lcZ(40,13,e.dataB18[0].TONG_DC+e.dataB18[0].TONG_PS)),t.xp6(7),t.Oqu(t.lcZ(47,15,e.dataB18[0].TONG_TT)),t.xp6(7),t.Oqu(t.lcZ(54,17,e.dataB18[0].TIEN_CKY)),t.xp6(7),t.Oqu(t.lcZ(61,19,e.dataB18[0].TONG_CKY))}}let Vt=(()=>{class i{constructor(e,n,o,a,l){this.cmis4DmtSV=e,this.plus=n,this.cmis4SV=o,this.loadSV=a,this.authSV=l,this.user=JSON.parse(localStorage.getItem("USERCMIS")),this.showDMT=!1,this.dataB11=[],this.dataB12=JSON.parse(localStorage.getItem("BIEU12"))||[],this.dataB14=[],this.dataB16=[],this.dataB17=[],this.dataB18=[],this.dataB19=[],this.dataB110=[],this.dataB26=[],this.dataB29=[],this.tongB26=null,this.tongB29=null,this.tongB12=null,this.startDay=N()().subtract(10,"days").toDate(),this.luyke=!1}ngOnInit(){this.user=this.cmis4SV.getUser(),this.getLocal()}test(){var e=this;return(0,g.Z)(function*(){let n=e.luyke?1:0,o=N()(e.ngayBaoCao,"MM/YYYY").format("M"),a=N()(e.ngayBaoCao,"MM/YYYY").format("YYYY"),l=N()(e.ngayBaoCao,"MM/YYYY").startOf("month").format("DD/MM/YYYY"),u=N()(e.ngayBaoCao,"MM/YYYY").endOf("month").format("DD/MM/YYYY"),p=Object.assign({BIEU:"BIEU18",LUY_KE:n,QUYET_TOAN:0,NGAY_COD:1},{NAM:a,THANG:o,TU_NGAY_GCS:l,DEN_NGAY_GCS:u,MA_DVIQLY:e.user.SUBDIVISIONID,TCHAT_MTAM:0});e.dataB18=yield e.cmis4DmtSV.getBaoCaoDMT(p)})()}getMonth(e){console.log(e),this.ngayBaoCao=e}kiemTra(){var e=this;return(0,g.Z)(function*(){e.reset(),e.loadSV.load("kiemTra"),e.plus.alertMatSnackBar("\u0110ang ta\u0309i du\u031b\u0303 lie\u0323\u0302u..."),e.showDMT=!1;let n=e.luyke?1:0,o=N()(e.ngayBaoCao,"MM/YYYY").format("M"),a=N()(e.ngayBaoCao,"MM/YYYY").format("YYYY"),l=N()(e.ngayBaoCao,"MM/YYYY").startOf("month").format("DD/MM/YYYY"),u=N()(e.ngayBaoCao,"MM/YYYY").endOf("month").format("DD/MM/YYYY"),h={NAM:a,THANG:o,TU_NGAY_GCS:l,DEN_NGAY_GCS:u,MA_DVIQLY:e.user.SUBDIVISIONID,TCHAT_MTAM:0},p=Object.assign({BIEU:"BIEU11",LUY_KE:n,QUYET_TOAN:1,NGAY_COD:-1},h),m=Object.assign({BIEU:"BIEU14",LUY_KE:n,QUYET_TOAN:1,NGAY_COD:-1},h),c=Object.assign({BIEU:"BIEU16_MOI",LUY_KE:n,QUYET_TOAN:0,NGAY_COD:-1,CO_CHE:-1},h),C=Object.assign({BIEU:"BIEU17_MOI",LUY_KE:n,QUYET_TOAN:0,NGAY_COD:-1,CO_CHE:-1},h),A=Object.assign({BIEU:"BIEU18",LUY_KE:n,QUYET_TOAN:0,NGAY_COD:1},h),T=Object.assign({BIEU:"BIEU19",LUY_KE:n,QUYET_TOAN:0,NGAY_COD:1},h),s=Object.assign({BIEU:"BIEU110",LUY_KE:1,QUYET_TOAN:0,NGAY_COD:1},h),S=Object.assign({BIEU:"BIEU29",LUY_KE:n,QUYET_TOAN:1,NGAY_COD:-1},h),G={BIEU:"BIEU12",LUY_KE:0,TCHAT_MTAM:-1,QUYET_TOAN:1,NGAY_COD:-1,TU_NGAY_GCS:l,DEN_NGAY_GCS:u,NAM:a,THANG:o,MA_DVIQLY:e.user.SUBDIVISIONID};e.dataB11=[],e.dataB12=[],e.dataB14=[],e.dataB16=[],e.dataB17=[],e.dataB18=[],e.dataB19=[],e.dataB110=[],e.dataB29=[],e.dataB26=[],e.dataB11=yield e.cmis4DmtSV.getBaoCaoDMT(p),e.plus.alertSuccess("Bi\u1ec3u 1.1 \u0111\xe3 xong!"),e.dataB12=yield e.cmis4DmtSV.getBaoCaoDMT(G),e.plus.alertSuccess("Bi\u1ec3u 1.2 \u0111\xe3 xong!"),e.dataB14=yield e.cmis4DmtSV.getBaoCaoDMT(m),e.plus.alertSuccess("Bi\u1ec3u 1.4 \u0111\xe3 xong!"),e.dataB16=yield e.cmis4DmtSV.getBaoCaoDMT(c),e.plus.alertSuccess("Bi\u1ec3u 1.6 \u0111\xe3 xong!"),e.dataB17=yield e.cmis4DmtSV.getBaoCaoDMT(C),e.plus.alertSuccess("Bi\u1ec3u 1.7 \u0111\xe3 xong!"),e.dataB18=yield e.cmis4DmtSV.getBaoCaoDMT(A),e.plus.alertSuccess("Bi\u1ec3u 1.8 \u0111\xe3 xong!"),e.dataB19=yield e.cmis4DmtSV.getBaoCaoDMT(T),e.plus.alertSuccess("Bi\u1ec3u 1.9 \u0111\xe3 xong!"),e.dataB110=yield e.cmis4DmtSV.getBaoCaoDMT(s),e.plus.alertSuccess("Bi\u1ec3u 1.10 \u0111\xe3 xong!");let I=Object.assign({BIEU:"BIEU26",LUY_KE:n,QUYET_TOAN:1,NGAY_COD:3,LOAI_BAO_CAO:1},h);e.dataB26=yield e.cmis4DmtSV.getBaoCaoDMT(I),e.tongB26=e.plus.sumByKeys(e.dataB26,["DNANG_EVNMUA","CONG_SUAT","TIEN_TTOAN","VAT_EVNMUA","TIEN_EVNMUA","VAT_TTOAN"]),e.plus.alertSuccess("Bi\u1ec3u 2.6 \u0111\xe3 xong!"),e.dataB29=yield e.cmis4DmtSV.getBaoCaoDMT(S),e.plus.alertSuccess("Bi\u1ec3u 2.9 \u0111\xe3 xong!"),e.tongB29=e.plus.sumByKeys(e.dataB29,["SLUONG_PS","TIEN_PS","THUE_PS_KT","TIEN_CKY","TONG_CKY","TONG_DC","TONG_DKY","TONG_PS","TONG_TT"]),e.tongB12=e.plus.sumByKeys(e.dataB12,["SO_TIEN","TIEN_GTGT","TONG_TIEN"]),e.showDMT=!0,e.loadSV.loaded("kiemTra")})()}getBCTEST(){var e=this;return(0,g.Z)(function*(){let n=e.luyke?1:0,o=N()(e.ngayBaoCao,"MM/YYYY").format("M"),a=N()(e.ngayBaoCao,"MM/YYYY").format("YYYY"),l=N()(e.ngayBaoCao,"MM/YYYY").startOf("month").format("DD/MM/YYYY"),u=N()(e.ngayBaoCao,"MM/YYYY").endOf("month").format("DD/MM/YYYY"),p=Object.assign({BIEU:"BIEU16_MOI",LUY_KE:n,QUYET_TOAN:0,NGAY_COD:-1,CO_CHE:-1},{NAM:a,THANG:o,TU_NGAY_GCS:l,DEN_NGAY_GCS:u,MA_DVIQLY:e.user.SUBDIVISIONID,TCHAT_MTAM:0});e.dataB16=yield e.cmis4DmtSV.getBaoCaoDMT(p)})()}getB12(){var e=this;return(0,g.Z)(function*(){let o=N()(e.ngayBaoCao,"MM/YYYY").format("M"),a=N()(e.ngayBaoCao,"MM/YYYY").format("YYYY"),p={BIEU:"BIEU12",LUY_KE:0,TCHAT_MTAM:-1,QUYET_TOAN:1,NGAY_COD:-1,TU_NGAY_GCS:N()(e.ngayBaoCao,"MM/YYYY").startOf("month").format("DD/MM/YYYY"),DEN_NGAY_GCS:N()(e.ngayBaoCao,"MM/YYYY").endOf("month").format("DD/MM/YYYY"),NAM:a,THANG:o,MA_DVIQLY:e.user.SUBDIVISIONID};e.dataB12=yield e.cmis4DmtSV.getBaoCaoDMT(p),e.tongB12=e.plus.sumByKeys(e.dataB12,["SO_TIEN","TIEN_GTGT","TONG_TIEN"])})()}getLocal(){this.dataB11=Array.isArray(JSON.parse(localStorage.getItem("BIEU11")))?JSON.parse(localStorage.getItem("BIEU11")):[],this.dataB12=Array.isArray(JSON.parse(localStorage.getItem("BIEU12")))?JSON.parse(localStorage.getItem("BIEU12")):[],this.dataB14=Array.isArray(JSON.parse(localStorage.getItem("BIEU14")))?JSON.parse(localStorage.getItem("BIEU14")):[],this.dataB16=Array.isArray(JSON.parse(localStorage.getItem("BIEU16_MOI")))?JSON.parse(localStorage.getItem("BIEU16_MOI")):[],this.dataB17=Array.isArray(JSON.parse(localStorage.getItem("BIEU17_MOI")))?JSON.parse(localStorage.getItem("BIEU17_MOI")):[],this.dataB18=Array.isArray(JSON.parse(localStorage.getItem("BIEU18")))?JSON.parse(localStorage.getItem("BIEU18")):[],this.dataB19=Array.isArray(JSON.parse(localStorage.getItem("BIEU19")))?JSON.parse(localStorage.getItem("BIEU19")):[],this.dataB110=Array.isArray(JSON.parse(localStorage.getItem("BIEU110")))?JSON.parse(localStorage.getItem("BIEU110")):[],this.dataB26=Array.isArray(JSON.parse(localStorage.getItem("BIEU26")))?JSON.parse(localStorage.getItem("BIEU26")):[],this.dataB29=Array.isArray(JSON.parse(localStorage.getItem("BIEU29")))?JSON.parse(localStorage.getItem("BIEU29")):[],this.tongB26=this.plus.sumByKeys(this.dataB26,["DNANG_EVNMUA","CONG_SUAT","TIEN_TTOAN","VAT_EVNMUA","TIEN_EVNMUA"]),this.tongB29=this.plus.sumByKeys(this.dataB29,["SLUONG_PS","TIEN_PS","THUE_PS_KT","THUE_TT_KT","TIEN_CKY","TONG_CKY","TONG_DC","TONG_DKY","TONG_PS","TONG_TT"]),this.tongB12=this.plus.sumByKeys(this.dataB12,["SO_TIEN","TIEN_GTGT","TONG_TIEN"]),this.showDMT=!0}reset(){this.dataB11=[],this.dataB14=[],this.dataB16=[],this.dataB17=[],this.dataB18=[],this.dataB19=[],this.dataB110=[],this.dataB26=[],this.dataB29=[],this.tongB26=this.plus.sumByKeys(this.dataB26,["DNANG_EVNMUA","CONG_SUAT","TIEN_TTOAN","VAT_EVNMUA","TIEN_EVNMUA","VAT_TTOAN"]),this.tongB29=this.plus.sumByKeys(this.dataB29,["SLUONG_PS","TIEN_PS","THUE_PS_KT","TIEN_CKY","TONG_CKY","TONG_DC","TONG_DKY","TONG_PS","TONG_TT"]),localStorage.removeItem("BIEU11"),localStorage.removeItem("BIEU12"),localStorage.removeItem("BIEU14"),localStorage.removeItem("BIEU16"),localStorage.removeItem("BIEU17"),localStorage.removeItem("BIEU18"),localStorage.removeItem("BIEU19"),localStorage.removeItem("BIEU110"),localStorage.removeItem("BIEU26"),localStorage.removeItem("BIEU29"),this.showDMT=!1}checkPer(e,n=1){return this.authSV.checkPer(e,n)}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(Kt.X),t.Y36(f.T),t.Y36(O.a),t.Y36(K.b),t.Y36(y.c1))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-bao-cao-dmt"]],decls:10,vars:6,consts:[[1,"container","my-3"],["class","test",4,"ngIf"],[1,"row"],[3,"label","startDay","month"],[3,"ngModel","ngModelChange"],["mat-raised-button","","color","warn",3,"click"],[4,"ngIf"],["class","row justify-content-center",4,"ngIf"],[1,"test"],["mat-raised-button","",3,"click"],[1,"table","table-bordered","table-hover"],[1,"text-center"],["scope","col"],[1,"text-end"],["scope","row"],[1,""],["mat-icon-button","",3,"click"],[1,"table","table-hover","table-bordered"],["class","text-end",4,"ngFor","ngForOf"],[1,"text-end",2,"font-weight","bolder"],[1,"row","justify-content-center"],[1,"col-4"],[1,"table-responsive"],[1,"fw-bold"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0),t.YNc(1,Lt,3,0,"div",1),t.TgZ(2,"div",2)(3,"app-month-year",3),t.NdJ("month",function(a){return n.getMonth(a)}),t.qZA(),t.TgZ(4,"mat-slide-toggle",4),t.NdJ("ngModelChange",function(a){return n.luyke=a}),t._uU(5,"L\u0169y k\u1ebf"),t.qZA()(),t.TgZ(6,"button",5),t.NdJ("click",function(){return n.kiemTra()}),t._uU(7,"L\u1ea5y d\u1eef li\u1ec7u"),t.qZA(),t.YNc(8,xt,279,141,"div",6),t.qZA(),t.YNc(9,Bt,62,21,"div",7)),2&e&&(t.xp6(1),t.Q6J("ngIf",n.checkPer("dev")),t.xp6(2),t.Q6J("label","Ch\u1ecdn k\u1ef3 b\xe1o c\xe1o")("startDay",n.startDay),t.xp6(1),t.Q6J("ngModel",n.luyke),t.xp6(4),t.Q6J("ngIf",n.showDMT),t.xp6(1),t.Q6J("ngIf",n.dataB18.length>0))},dependencies:[H.sg,H.O5,d.JJ,d.On,B.Rr,Y.lW,Y.RK,L.Hw,P.k,tt._2,tt.qU],styles:['*[_ngcontent-%COMP%]{box-sizing:border-box}.column2[_ngcontent-%COMP%]{float:left;width:50%;padding:10px;height:300px}.row2[_ngcontent-%COMP%]:after{content:"";display:table;clear:both}'],data:{animation:[z.Mq,z.Ym]}}),i})();var qt=D(49808),ut=D(54654),kt=D(88689);let Ft=(()=>{class i{constructor(e,n,o,a,l,u,h){this.plus=e,this.docxSV=n,this.loadSV=o,this.idbSV=a,this.authSV=l,this.excelSV=u,this.remoteConfig=h,this.searchArr=[],this.nam=N()().year()-1,this.user=JSON.parse(localStorage.getItem("USERCMIS")),this.img=null,this.db=null,this.in6Thang=!1,this.remote=window.remote}ngOnInit(){var e=this;this.idbSV.IDB_InitDB("dien-luc").subscribe(function(){var n=(0,g.Z)(function*(o){e.db=o,e.remote=yield(0,qt.n)(e.remoteConfig.strings),e.donGia=+e.remote.DonGiaDMT,e.thuevat=+e.remote.ThueVAT/100,console.log(e.remote)});return function(o){return n.apply(this,arguments)}}()),this.user=JSON.parse(localStorage.getItem("USERCMIS")),this.nam=(new Date).getFullYear()}getBaocaoTongHopDienMTMN(){var e=this;return(0,g.Z)(function*(){e.loadSV.load("getBaocaoTongHopDienMTMN");let n="https://cmis-api.evnspc.vn/serviceBCaoThang/getBaocaoTongHopDienMTMN";const a={path:"/serviceBCaoThang/getBaocaoTongHopDienMTMN",authority:"cmis-api.evnspc.vn",authorization:"Bearer "+e.user.ACCESS_TOKEN};e.plus.alertWarning("\u0110ang l\u1ea5y d\u1eef li\u1ec7u CMIS ");let l={BIEU:"BIEU23",MA_DVIQLY:"PK0500",TU_NGAY_GCS:"1/1/"+(+e.nam-1),DEN_NGAY_GCS:`31/12/${e.nam}`,QUYET_TOAN:"1",THANG:"1",NAM:"2021",LUY_KE:0,TCHAT_MTAM:-1,NGAY_COD:-1},u={BIEU:"BIEU23",MA_DVIQLY:"PK0500",TU_NGAY_GCS:"1/1/2018",DEN_NGAY_GCS:`31/12/${e.nam}`,QUYET_TOAN:"0",THANG:"1",NAM:"2021",LUY_KE:0,TCHAT_MTAM:-1,NGAY_COD:-1},h=yield v.Z.post(n,l,{headers:a}).then(C=>C.data),p=yield v.Z.post(n,u,{headers:a}).then(C=>C.data);e.plus.alertSuccess("L\u1ea5y d\u1eef li\u1ec7u CMIS th\xe0nh c\xf4ng");let m=h.concat(p),c=[];for(let C=0;C<m.length;C++){const A=m[C];if(+A.NAM==+e.nam){let T=c.findIndex(s=>s.MA_KHANG===A.MA_KHANG);-1==T?(delete A.DON_GIA,delete A.ID_DMT,delete A.LOAI_DCHINH,delete A.MA_DDO,delete A.MA_DVIQLY,delete A.NGAY_QTOAN,delete A.MA_GIA,delete A.SO_BBANQT,delete A.THANG,c.push(A)):(c[T].SAN_LUONG+=A.SAN_LUONG,c[T].SO_TIEN+=A.SO_TIEN,c[T].TONG_TIEN+=A.TONG_TIEN,c[T].SAN_LUONG+=A.SAN_LUONG,c[T].TIEN_GTGT+=A.TIEN_GTGT)}}e.excelSV.export(h,"DaQT"+(e.nam-1)),e.excelSV.export(p,"ChuaQT"),e.excelSV.export(c,`DoanhThuNam${e.nam}`),e.loadSV.loaded("getBaocaoTongHopDienMTMN")})()}getBBQTArr(e){var n=this;return(0,g.Z)(function*(){(0,E.D)(n.searchArr).pipe((0,U.b)(o=>n.getBBanXnhanDienMTAM(o,n.nam,e))).subscribe(o=>{console.log(o)})})()}getBBanXnhanDienMTAM(e,n,o){var a=this;return(0,g.Z)(function*(){a.loadSV.load("getBBanXnhanDienMTAM");let l="https://cmis-api.evnspc.vn/serviceBCaoThang/getBBanXnhanDienMTAM";const h={path:"/serviceBCaoThang/getDsachKhangCSoSLuong",authority:"cmis-api.evnspc.vn",authorization:"Bearer "+a.user.ACCESS_TOKEN};a.plus.alertWarning(`\u0110ang l\u1ea5y d\u1eef li\u1ec7u CMIS ${e}`);let p={MA_DVIQLY:e.slice(0,6),MA_KHANG:[e],NAM:n,QUYET_TOAN:1},m={MA_DVIQLY:e.slice(0,6),MA_KHANG:[e],NAM:n,QUYET_TOAN:0},c=yield v.Z.post(l,p,{headers:h}).then(G=>G.data).catch(G=>(localStorage.removeItem("USERCMIS"),a.plus.alertMatSnackBar("Phie\u0302n \u0111a\u0306ng nha\u0323\u0302p he\u0302\u0301t ha\u0323n. Vui lo\u0300ng \u0111a\u0306ng nha\u0323\u0302p la\u0323i"),a.authSV.reload("/cmis4"),a.loadSV.clear(),console.log(G),[])),C=yield v.Z.post(l,m,{headers:h}).then(G=>G.data).catch(G=>(localStorage.removeItem("USERCMIS"),a.plus.alertMatSnackBar("Phie\u0302n \u0111a\u0306ng nha\u0323\u0302p he\u0302\u0301t ha\u0323n. Vui lo\u0300ng \u0111a\u0306ng nha\u0323\u0302p la\u0323i"),a.authSV.reload("/cmis4"),a.loadSV.clear(),console.log(G),[]));a.plus.alertSuccess(`L\u1ea5y d\u1eef li\u1ec7u CMIS ${e} th\xe0nh c\xf4ng`);let A=c.concat(C),T=[],s=[],S=[];for(let G=0;G<A.length;G++){const I=A[G];I.NAM==n&&T.push(I),I.THANG<7&&0==I.TIEN_GTGT&&I.NAM==n&&s.push(I),I.THANG>6&&0==I.TIEN_GTGT&&I.NAM==n&&S.push(I)}a.exportDoc(T,e,n),a.in6Thang&&(a.exportDocThue(s,1,6,.1),a.exportDocThue(S,7,12,.08)),o&&a.exportDocThue(T,1,12,a.thuevat),a.loadSV.loaded("getBBanXnhanDienMTAM")})()}exportDocThue(e,n,o,a){var l=this;return(0,g.Z)(function*(){let u=yield l.idbSV.IDB_DB_GetAllByIndexKey(l.db,"dmt-khach-hang","MaKhachHang","=",e[0].MA_KHANG),h="",p="",m=e.length-1;u.length>0?(h=u[0].DiaChi,p=u[0].DaiDien):(h=e[m].DCHI_KHANG,p=e[m].TEN_KHANG);let c={TenKH:e[m].TEN_KHANG,DiaChi:h,MaKH:e[m].MA_KHANG,DaiDien:p,Nam:l.nam,tongSL:0,donGia:l.donGia,tongDG:l.donGia,tongCVAT:0,tongVAT:0,tongTien:0,ThueDuocGiam:0,TTSauGiam:0,tb:[]};for(let A=n;A<=o;A++)c.tb.push({thang:A,tg:[],dk:[],ck:[],hsn:[],sl:0,dg:0,cvat:0,vat:0,tong:0,sl2:0,dg2:0,cvat2:0,vat2:0,tong2:0});let C=[];for(let A=0;A<e.length;A++){const T=e[A];c.tongCVAT+=T.SO_TIEN,c.tongVAT+=T.TIEN_GTGT,c.tongDG+=T.DON_GIA,c.tongSL+=T.SAN_LUONG,c.tongTien+=T.TONG_TIEN;for(let s=0;s<c.tb.length;s++)T.THANG==c.tb[s].thang&&(C.push(T),c.tb[s].tg.push({type:T.BCS}),c.tb[s].dk.push({type:" "==T.MA_GIA?new Intl.NumberFormat("it-IT").format(+T.CHISO_CU.replace(/,/g,".")):""}),c.tb[s].ck.push({type:" "==T.MA_GIA?new Intl.NumberFormat("it-IT").format(+T.CHISO_MOI.replace(/,/g,".")):""}),c.tb[s].hsn.push({type:" "==T.MA_GIA?new Intl.NumberFormat("it-IT").format(+T.HS_NHAN.replace(/,/g,".")):""}),c.tb[s].sl+="MT"==T.MA_GIA?+T.SAN_LUONG:0,c.tb[s].dg="MT"==T.MA_GIA?+T.DON_GIA:c.tb[s].dg,c.tb[s].cvat+="MT"==T.MA_GIA?+T.SO_TIEN:0,c.tb[s].vat+="MT"==T.MA_GIA?+T.TIEN_GTGT:0,c.tb[s].tong+="MT"==T.MA_GIA?+T.TONG_TIEN:0,c.tb[s].sl2+="MT2"==T.MA_GIA?+T.SAN_LUONG:0,c.tb[s].dg2="MT2"==T.MA_GIA?+T.DON_GIA:c.tb[s].dg2,c.tb[s].cvat2+="MT2"==T.MA_GIA?+T.SO_TIEN:0,c.tb[s].vat2+="MT2"==T.MA_GIA?+T.TIEN_GTGT:0,c.tb[s].tong2+="MT2"==T.MA_GIA?+T.TONG_TIEN:0)}c.tongVAT=Math.round(c.tongSL*+l.remote.DonGiaDMT),c.ThueDuocGiam=l.thuevat<.1?Math.round(.08==a?.2*c.tongVAT*.03:0):0,c.TTSauGiam=Math.round(c.tongVAT-c.ThueDuocGiam),console.log(c),l.docxSV.loadFileUrl(`https://thuctd.github.io/templates/DMT/MauBienBan6T-${l.user.SUBDIVISIONID}.docx`).then(A=>{l.docxSV.generateOne(c,A,e[0].MA_KHANG+"ChotSL").then(T=>{console.log(T)})})})()}exportDoc(e,n,o){var a=this;return(0,g.Z)(function*(){let l=yield a.idbSV.IDB_DB_GetAllByIndexKey(a.db,"dmt-khach-hang","MaKhachHang","=",n),u="",h="",p=e.length-1;l.length>0?(u=l[0].DiaChi,h=l[0].DaiDien):(u=e[p].DCHI_KHANG,h=e[p].TEN_KHANG);let m={TenKH:e[p].TEN_KHANG,DiaChi:u,MaKH:e[p].MA_KHANG,DaiDien:h,Nam:o,tongSL:0,tongDG:0,tongCVAT:0,tongVAT:0,tongTien:0,tb:[]};for(let C=1;C<13;C++)m.tb.push({thang:C,tg:[],dk:[],ck:[],hsn:[],sl:0,dg:0,cvat:0,vat:0,tong:0,sl2:0,dg2:0,cvat2:0,vat2:0,tong2:0});let c=[];for(let C=0;C<e.length;C++){const A=e[C];if(A.NAM==o){m.tongCVAT+=A.SO_TIEN,m.tongVAT+=A.TIEN_GTGT,m.tongDG+=A.DON_GIA,m.tongSL+=A.SAN_LUONG,m.tongTien+=A.TONG_TIEN;for(let T=0;T<m.tb.length;T++)A.THANG==m.tb[T].thang&&(c.push(A),m.tb[T].tg.push({type:A.BCS}),m.tb[T].dk.push({type:" "==A.MA_GIA?new Intl.NumberFormat("it-IT").format(+A.CHISO_CU.replace(/,/g,".")):""}),m.tb[T].ck.push({type:" "==A.MA_GIA?new Intl.NumberFormat("it-IT").format(+A.CHISO_MOI.replace(/,/g,".")):""}),m.tb[T].hsn.push({type:" "==A.MA_GIA?new Intl.NumberFormat("it-IT").format(+A.HS_NHAN.replace(/,/g,".")):""}),m.tb[T].sl+="MT"==A.MA_GIA?+A.SAN_LUONG:0,m.tb[T].dg="MT"==A.MA_GIA?+A.DON_GIA:m.tb[T].dg,m.tb[T].cvat+="MT"==A.MA_GIA?+A.SO_TIEN:0,m.tb[T].vat+="MT"==A.MA_GIA?+A.TIEN_GTGT:0,m.tb[T].tong+="MT"==A.MA_GIA?+A.TONG_TIEN:0,m.tb[T].sl2+="MT2"==A.MA_GIA?+A.SAN_LUONG:0,m.tb[T].dg2="MT2"==A.MA_GIA?+A.DON_GIA:m.tb[T].dg2,m.tb[T].cvat2+="MT2"==A.MA_GIA?+A.SO_TIEN:0,m.tb[T].vat2+="MT2"==A.MA_GIA?+A.TIEN_GTGT:0,m.tb[T].tong2+="MT2"==A.MA_GIA?+A.TONG_TIEN:0)}}a.docxSV.loadFileUrl(`https://thuctd.github.io/templates/DMT/MauBienBan-${a.user.SUBDIVISIONID}.docx`).then(C=>{a.docxSV.generateOne(m,C,"ChotSL-"+n).then(A=>{console.log(A)})})})()}getCongNoArr(){var e=this;return(0,g.Z)(function*(){(0,E.D)(e.searchArr).pipe((0,U.b)(n=>e.getDsachKhangQToanDienMTAM(n,e.nam))).subscribe(n=>{console.log(n)})})()}getDsachKhangQToanDienMTAM(e,n){var o=this;return(0,g.Z)(function*(){if(o.user.SUBDIVISIONID!==e.slice(0,6))return o.plus.alertError("Kh\xf4ng \u0111\u01b0\u1ee3c ph\xe9p truy c\u1eadp!");const u={path:"/serviceBCaoThang/getDsachKhangQToanDienMTAM",authority:"cmis-api.evnspc.vn",authorization:"Bearer "+o.user.ACCESS_TOKEN};let h={MA_DVIQLY:e.slice(0,6),MA_KHANG:e,NAM:-1,QUYET_TOAN:0};yield v.Z.post("https://cmis-api.evnspc.vn/serviceBCaoThang/getDsachKhangQToanDienMTAM",h,{headers:u}).then(p=>{let m=p.data;console.table(m),o.xuatCongNo(m)}).catch(p=>(localStorage.removeItem("USERCMIS"),o.plus.alertMatSnackBar("Phie\u0302n \u0111a\u0306ng nha\u0323\u0302p he\u0302\u0301t ha\u0323n. Vui lo\u0300ng \u0111a\u0306ng nha\u0323\u0302p la\u0323i"),o.authSV.reload("/cmis4"),o.loadSV.clear(),console.log(p),[]))})()}xuatCongNo(e){var n=this;return(0,g.Z)(function*(){n.loadSV.load("xuatCongNo");let o=yield n.authSV._getOpt(y.HB.NLMTSETUP),a=yield n.idbSV.IDB_DB_GetAllByIndexKey(n.db,"dmt-khach-hang","MaKhachHang","=",e[0].MA_KHANG);console.log(a,o);let l=[];for(let m=0;m<e.length;m++){const c=e[m];c.NAM<=n.nam&&l.push({MaGCS:a[0].MaKV,MaKH:c.MA_KHANG,ThangNam:c.THANG+"/"+c.NAM,SanLuong:c.SAN_LUONG,TongTien:c.SO_TIEN+c.TIEN_GTGT})}let u=n.plus.sumByKey(l,"TongTien"),h={_id:e[0].MA_KHANG,TenDonVi:o.TenDonVi,DiaChi:o.DiaChi,GiamDoc:o.GiamDoc,TenKH:e[0].TEN_KHANG,DiaChiKH:a[0].DiaChi,DaiDien:a[0].DaiDien,ChucVu:a[0].ChucVu,TongTien:u,Nam:n.nam,table:l},p=yield n.docxSV.loadFileUrl(`https://thuctd.github.io/templates/DMT/BBCongNo-${n.user.SUBDIVISIONID}.docx`);n.docxSV.generateOne(h,p,e[0].MA_KHANG+"-CongNo").then(m=>{console.log(m),n.loadSV.loaded("xuatCongNo")})})()}getClip(e){var n=this;return(0,g.Z)(function*(){n.searchArr=[];for(let o=0;o<e.length;o++)n.searchArr.push(e[o][0]);console.log(n.searchArr)})()}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(f.T),t.Y36(J.E),t.Y36(K.b),t.Y36(ut.Y),t.Y36(y.c1),t.Y36(b.x),t.Y36(kt.uR))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-bien-ban-chot-dmt"]],decls:13,vars:3,consts:[[1,"container"],[3,"label","excel"],["matInput","","type","number","placeholder","N\u0103m",3,"ngModel","ngModelChange"],[1,"text-center"],["color","warn",3,"ngModel","ngModelChange"],["mat-raised-button","",3,"click"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"app-parse-excel-clipboard",1),t.NdJ("excel",function(a){return n.getClip(a)}),t.qZA(),t.TgZ(2,"mat-form-field")(3,"input",2),t.NdJ("ngModelChange",function(a){return n.nam=a}),t.qZA()(),t.TgZ(4,"div",3)(5,"mat-slide-toggle",4),t.NdJ("ngModelChange",function(a){return n.in6Thang=a}),t._uU(6,"6 th\xe1ng"),t.qZA(),t.TgZ(7,"button",5),t.NdJ("click",function(){return n.getBBQTArr(!1)}),t._uU(8,"Bi\xean b\u1ea3n"),t.qZA(),t.TgZ(9,"button",5),t.NdJ("click",function(){return n.getCongNoArr()}),t._uU(10,"C\xf4ng n\u1ee3"),t.qZA(),t.TgZ(11,"button",5),t.NdJ("click",function(){return n.getBBQTArr(!0)}),t._uU(12,"Phi\u1ebfu c\xf3 thu\u1ebf"),t.qZA()()()),2&e&&(t.xp6(1),t.Q6J("label","Copy m\xe3 PK d\xe1n v\xf4 \u0111\xe2y"),t.xp6(2),t.Q6J("ngModel",n.nam),t.xp6(2),t.Q6J("ngModel",n.in6Thang))},dependencies:[d.Fj,d.wV,d.JJ,d.On,B.Rr,Y.lW,Z.Nt,M.KE,q.K]}),i})();var et=D(10266);function Jt(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td",12),t.NdJ("click",function(){const a=t.CHM(e).$implicit,l=t.oxw(3);return t.KtG(l.copy(a.MA_YCAU_KNAI))}),t._uU(4),t.qZA(),t.TgZ(5,"td",12),t.NdJ("click",function(){const a=t.CHM(e).$implicit,l=t.oxw(3);return t.KtG(l.copy(a.MA_DDO_DDIEN))}),t._uU(6),t.qZA(),t.TgZ(7,"td",13),t._uU(8),t.qZA(),t.TgZ(9,"td"),t._uU(10),t.qZA(),t.TgZ(11,"td"),t._uU(12),t.qZA(),t.TgZ(13,"td"),t._uU(14),t.qZA(),t.TgZ(15,"td"),t._uU(16),t.qZA(),t.TgZ(17,"td"),t._uU(18),t.qZA()()}if(2&i){const e=r.$implicit,n=r.index;t.xp6(2),t.Oqu(n+1),t.xp6(2),t.Oqu(e.MA_YCAU_KNAI),t.xp6(2),t.Oqu(e.MA_DDO_DDIEN),t.xp6(2),t.Oqu(e.TEN_KHANG),t.xp6(2),t.Oqu(e.NGAY_NHAN),t.xp6(2),t.Oqu(e.NGAY_KS),t.xp6(2),t.Oqu(e.NGAY_LDAT),t.xp6(2),t.Oqu(e.NGAY_HTHANH),t.xp6(2),t.Oqu(e.TSONGAY_CDIEN)}}function Pt(i,r){if(1&i&&(t.TgZ(0,"table",10)(1,"thead")(2,"tr",6)(3,"th"),t._uU(4,"TT"),t.qZA(),t.TgZ(5,"th"),t._uU(6,"M\xe3 y\xeau c\u1ea7u"),t.qZA(),t.TgZ(7,"th"),t._uU(8,"M\xe3 \u0111i\u1ec3m \u0111o"),t.qZA(),t.TgZ(9,"th"),t._uU(10,"T\xean kh\xe1ch h\xe0ng"),t.qZA(),t.TgZ(11,"th"),t._uU(12,"Ng\xe0y ti\u1ebfp nh\u1eadn"),t.qZA(),t.TgZ(13,"th"),t._uU(14,"Ng\xe0y kh\u1ea3o s\xe1t"),t.qZA(),t.TgZ(15,"th"),t._uU(16,"Ng\xe0y l\u1eafp \u0111\u1eb7t"),t.qZA(),t.TgZ(17,"th"),t._uU(18,"Ng\xe0y ho\xe0n th\xe0nh"),t.qZA(),t.TgZ(19,"th"),t._uU(20,"T\u1ed5ng s\u1ed1 ng\xe0y"),t.qZA()()(),t.TgZ(21,"tbody",6),t.YNc(22,Jt,19,9,"tr",11),t.qZA()()),2&i){const e=t.oxw(2);t.xp6(22),t.Q6J("ngForOf",e.items)}}function Qt(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"div",5)(1,"div",6)(2,"h4",7),t._uU(3),t.ALo(4,"number"),t.TgZ(5,"mat-icon",8),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.export(o.items))}),t._uU(6,"file_download"),t.qZA()()(),t.YNc(7,Pt,23,1,"table",9),t.qZA()}if(2&i){const e=t.oxw();t.xp6(3),t.hij("DANH S\xc1CH PHI\u1ebeU Y\xcaU C\u1ea6U QU\xc1 H\u1ea0N TRONG K\u1ef2: ",t.lcZ(4,2,e.items.length)," PHI\u1ebeU "),t.xp6(4),t.Q6J("ngIf",e.items.length>0)}}function Rt(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td",12),t.NdJ("click",function(){const a=t.CHM(e).$implicit,l=t.oxw(2);return t.KtG(l.copy(a.MA_YCAU_KNAI))}),t._uU(4),t.qZA(),t.TgZ(5,"td",12),t.NdJ("click",function(){const a=t.CHM(e).$implicit,l=t.oxw(2);return t.KtG(l.copy(a.MA_DDO_DDIEN))}),t._uU(6),t.qZA(),t.TgZ(7,"td",13),t._uU(8),t.qZA(),t.TgZ(9,"td"),t._uU(10),t.qZA(),t.TgZ(11,"td"),t._uU(12),t.qZA(),t.TgZ(13,"td"),t._uU(14),t.qZA(),t.TgZ(15,"td"),t._uU(16),t.qZA(),t.TgZ(17,"td"),t._uU(18),t.qZA()()}if(2&i){const e=r.$implicit,n=r.index;t.xp6(2),t.Oqu(n+1),t.xp6(2),t.Oqu(e.MA_YCAU_KNAI),t.xp6(2),t.Oqu(e.MA_DDO_DDIEN),t.xp6(2),t.Oqu(e.TEN_KHANG),t.xp6(2),t.Oqu(e.NGAY_NHAN),t.xp6(2),t.Oqu(e.NGAY_KS),t.xp6(2),t.Oqu(e.NGAY_LDAT),t.xp6(2),t.Oqu(e.NGAY_HTHANH),t.xp6(2),t.Oqu(e.TSONGAY_CDIEN)}}function wt(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"div",5)(1,"div",6)(2,"h4",14),t._uU(3),t.ALo(4,"number"),t.TgZ(5,"mat-icon",15),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.export(o.itemsFull))}),t._uU(6,"file_download"),t.qZA()()(),t.TgZ(7,"table",10)(8,"thead")(9,"tr",6)(10,"th"),t._uU(11,"TT"),t.qZA(),t.TgZ(12,"th"),t._uU(13,"M\xe3 y\xeau c\u1ea7u"),t.qZA(),t.TgZ(14,"th"),t._uU(15,"M\xe3 \u0111i\u1ec3m \u0111o"),t.qZA(),t.TgZ(16,"th"),t._uU(17,"T\xean kh\xe1ch h\xe0ng"),t.qZA(),t.TgZ(18,"th"),t._uU(19,"Ng\xe0y ti\u1ebfp nh\u1eadn"),t.qZA(),t.TgZ(20,"th"),t._uU(21,"Ng\xe0y kh\u1ea3o s\xe1t"),t.qZA(),t.TgZ(22,"th"),t._uU(23,"Ng\xe0y l\u1eafp \u0111\u1eb7t"),t.qZA(),t.TgZ(24,"th"),t._uU(25,"Ng\xe0y ho\xe0n th\xe0nh"),t.qZA(),t.TgZ(26,"th"),t._uU(27,"T\u1ed5ng s\u1ed1 ng\xe0y"),t.qZA()()(),t.TgZ(28,"tbody",6),t.YNc(29,Rt,19,9,"tr",11),t.qZA()()()}if(2&i){const e=t.oxw();t.xp6(3),t.hij("DANH S\xc1CH PHI\u1ebeU Y\xcaU C\u1ea6U \u0110\xc3 HO\xc0N T\u1ea4T TRONG K\u1ef2: ",t.lcZ(4,2,e.itemsFull.length)," PHI\u1ebeU "),t.xp6(26),t.Q6J("ngForOf",e.itemsFull)}}let $t=(()=>{class i{constructor(e,n,o,a,l){this.plus=e,this.Cmis4SV=n,this.loadSV=o,this.excelSV=a,this.authSV=l,this.user=JSON.parse(localStorage.getItem("USERCMIS")),this.items=[],this.itemsFull=[],this.startDay=new Date,this.maDV=""}ngOnInit(){this.user=this.Cmis4SV.getUser(),this.maDV=this.user.SUBDIVISIONID}export(e){this.excelSV.export(e,`BaoCaoCapDien-${N()(this.kyBaoCao,"MM/YYYY").format("MM-YYYY")}`)}baoCaoCapDien(){var e=this;return(0,g.Z)(function*(){e.items=[],e.itemsFull=[];let n=+N()(e.kyBaoCao,"MM/YYYY").format("YYYY"),o=+N()(e.kyBaoCao,"MM/YYYY").format("MM");return e.loadSV.load("baoCaoCapDien"),v.Z.post("https://cmis-api.evnspc.vn/serviceBCaoThang/baoCaoCapDien",{CMD:2,SUBCMD:22,INFO:{MA_DVIQLY:e.maDV||e.user.SUBDIVISIONID,THANG:o,NAM:n,TU_NGAY:e.kyBaoCao,DEN_NGAY:e.kyBaoCao,TTRANG_HSO:"-1",MDICH_SHOAT:-1,LOAI_TRAM:"-1",DTU_CTRINH:0,SO_PHA:-1,ID_DCHINH:"ALL",HOAN_THANH:0,MA_HTHUC:"-1",NGAY_HTAT_TU:`01/${e.kyBaoCao}`,NGAY_HTAT_DEN:`30/${e.kyBaoCao}`,NGAY_CKT_TU:`01/${e.kyBaoCao}`,NGAY_CKT_DEN:`30/${e.kyBaoCao}`,TO:"ALL",KQUA_TCONG:"0",KQUA_KSAT:"0",TINH_TRANG:0,MA_LOAI_YCAU:"-1",CO_THANG_NAM_BCKD:!1,SO_NGAY:1,LUY_KE:!1,LOAI_TBA:"1",NHOM_KHANG:"ALL"}},{headers:{path:"/serviceBCaoThang/baoCaoCapDien",authority:"cmis-api.evnspc.vn",authorization:"Bearer "+e.user.ACCESS_TOKEN}}).then(p=>{e.Cmis4SV.handleErrCmis(p),e.loadSV.loaded("baoCaoCapDien");let m=p.data;e.itemsFull=m,0==m.length&&e.plus.alertSuccess("Kho\u0302ng co\u0301 tr\u01b0\u1eddng h\u1ee3p qu\xe1 h\u1ea1n d\u1ecbch v\u1ee5");for(let c=0;c<m.length;c++){const C=m[c];C.TEN_LOAI_YCAU.includes(">")&&e.items.push(C)}0==e.items.length&&e.plus.alertSuccess("Kho\u0302ng co\u0301 tr\u01b0\u1eddng h\u1ee3p qu\xe1 h\u1ea1n d\u1ecbch v\u1ee5")}).catch(p=>{localStorage.removeItem("USERCMIS"),e.plus.alertMatSnackBar("Phie\u0302n \u0111a\u0306ng nha\u0323\u0302p he\u0302\u0301t ha\u0323n. Vui lo\u0300ng \u0111a\u0306ng nha\u0323\u0302p la\u0323i"),e.authSV.reload("/cmis4"),e.loadSV.clear(),console.log(p)})})()}getMonth(e){console.log(e),this.kyBaoCao=e}copy(e){this.plus.copyToClipboard(e)}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(f.T),t.Y36(O.a),t.Y36(K.b),t.Y36(b.x),t.Y36(y.c1))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-bao-cap-cap-dien"]],decls:8,vars:4,consts:[[1,"container","my-3"],[3,"startDay","month"],["matInput","","placeholder","M\xe3 \u0111\u01a1n v\u1ecb",3,"ngModel","ngModelChange"],["color","accent","mat-raised-button","",3,"click"],["class","row",4,"ngIf"],[1,"row"],[1,"text-center"],[1,"text-warning"],["matTooltip","Xu\u1ea5t file excel","color","primary",3,"click"],["class","table table-bordered table-hover",4,"ngIf"],[1,"table","table-bordered","table-hover"],[4,"ngFor","ngForOf"],["matTooltip","B\u1ea5m \u0111\u1ec3 copy",3,"click"],[1,"text-start"],[1,"text-primary"],["matTooltip","Xu\u1ea5t file excel",3,"click"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"app-month-year",1),t.NdJ("month",function(a){return n.getMonth(a)}),t.qZA(),t.TgZ(2,"mat-form-field")(3,"input",2),t.NdJ("ngModelChange",function(a){return n.maDV=a}),t.qZA()(),t.TgZ(4,"button",3),t.NdJ("click",function(){return n.baoCaoCapDien()}),t._uU(5,"Xem b\xe1o c\xe1o"),t.qZA()(),t.YNc(6,Qt,8,4,"div",4),t.YNc(7,wt,30,4,"div",4)),2&e&&(t.xp6(1),t.Q6J("startDay",n.startDay),t.xp6(2),t.Q6J("ngModel",n.maDV),t.xp6(3),t.Q6J("ngIf",n.items.length>0),t.xp6(1),t.Q6J("ngIf",n.itemsFull.length>0))},dependencies:[H.sg,H.O5,d.Fj,d.JJ,d.On,Y.lW,L.Hw,Z.Nt,M.KE,et.gM,P.k,H.JJ]}),i})();var nt=D(65881),st=D(48878),jt=D(44071),Q=D(12012),w=D(96338);function Xt(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"div",3)(1,"div",11)(2,"mat-form-field")(3,"input",12),t.NdJ("ngModelChange",function(o){t.CHM(e);const a=t.oxw();return t.KtG(a.tile=o)}),t.qZA()(),t.TgZ(4,"button",6),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.loopSLLon())}),t._uU(5,"L\u1ea5y d\u1eef li\u1ec7u SL "),t.qZA(),t.TgZ(6,"button",7),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.exportFull())}),t._uU(7,"Xu\u1ea5t full"),t.qZA(),t.TgZ(8,"button",13),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.exportSLLon())}),t.TgZ(9,"mat-icon"),t._uU(10,"download"),t.qZA()()()()}if(2&i){const e=t.oxw();t.xp6(3),t.Q6J("ngModel",e.tile)}}const Wt=function(i){return{"bg-info":i}};function zt(i,r){if(1&i&&(t.TgZ(0,"mat-list")(1,"mat-list-item",14),t._uU(2),t.TgZ(3,"b"),t._uU(4),t.qZA()()()),2&i){const e=r.$implicit;t.xp6(1),t.Q6J("ngClass",t.VKq(3,Wt,e.status)),t.xp6(1),t.hij(" S\u1ed5 ",e.maSo," "),t.xp6(2),t.hij(" ",e.status?": "+e.SL+" bi\u1ec3u":""," ")}}let te=(()=>{class i{constructor(e,n,o,a,l,u,h,p){this.loadSV=e,this.cmis4SV=n,this.excelSV=o,this.plus=a,this.chiSoSV=l,this.fbSV=u,this.gcsSV=h,this.idbSV=p,this.startDay=N()().subtract(3,"days").toDate(),this.maSoGSCs=JSON.parse(localStorage.getItem("maSoGSCs"))||[],this.soGCSByListSoRES=null,this.dDoSoGCSPAYLOAD=null,this.getChisoRES=[],this.KhongCoSL=[],this.SanLuongBatThuong=[],this.MaTrangThai=[],this.tile=30,this.exportData={},this.isMerge=!0,this.dataGhiRot=[],this.dataSLNho=[],this.dataSLTren100=[],this.dataRES=[],this.chiSoAll=[]}ngOnInit(){this.idbSV.IDB_InitDB(this.gcsSV.dbName).subscribe(e=>{this.gcsSV.db=e,this.gcsSV.syncLichGhi().subscribe(n=>{this.loadSV.loaded("syncLichGhi"),this.plus.alertMatSnackBar("\u0110\xe3 \u0111\u1ed3ng b\u1ed9 l\u1ecbch ghi",2e3)})}),this.user=JSON.parse(localStorage.getItem("USERCMIS"))}loop(){var e=this;return(0,g.Z)(function*(){(0,E.D)(e.maSoGSCs).pipe((0,U.b)((n,o)=>e.layDuLieu(n.maSo,o))).subscribe()})()}loopSL(){var e=this;return(0,g.Z)(function*(){(0,E.D)(e.maSoGSCs).pipe((0,U.b)((n,o)=>e.locSLNho(n.maSo,o))).subscribe()})()}loopSLLon(){var e=this;return(0,g.Z)(function*(){(0,E.D)(e.maSoGSCs).pipe((0,U.b)((n,o)=>e.locSLNho(n.maSo,o))).subscribe()})()}importAPI(){console.log(this.dataGhiRot),this.loadSV.load("importAPI"),this.gcsSV.importRotPLC(this.dataGhiRot).then(e=>{this.plus.alertSuccess(),this.loadSV.loaded("importAPI")})}nhapChiso(e){var n=this;return(0,g.Z)(function*(){return n.cmis4SV.cmis4Request("https://cmis-api.evnspc.vn/serviceChiSoKHang/getChiso","/serviceChiSoKHang/getChiso",{KY:n.dDoSoGCSPAYLOAD.KY,THANG:n.dDoSoGCSPAYLOAD.THANG,NAM:n.dDoSoGCSPAYLOAD.NAM,MA_SOGCS:n.dDoSoGCSPAYLOAD.MA_SOGCS,MA_DVIQLY:n.user.SUBDIVISIONID,NGAY_CKY:n.dDoSoGCSPAYLOAD.NGAY_CKY,LST_DDO:e,IS_CHUANHAPCSO:!1,IS_CHOTCS:!1}).then(u=>(console.log(u),u))})()}locSLNho(e,n){var o=this;return(0,g.Z)(function*(){o.plus.alertMatSnackBar("\u0110ang l\u1ea5y d\u1eef li\u1ec7u "+e),o.loadSV.load("locSLNho"),o.dataSLNho=[];let a=yield o.get_gcslichgcsByMaSogcs(e),l=yield o.getDDoSoGCS(a);o.getChisoRES=yield o.getChiso(l),o.dataRES=o.dataRES.concat(o.getChisoRES),o.maSoGSCs[n].status=!0,o.loadSV.loaded("locSLNho")})()}locSLLon(e,n){var o=this;return(0,g.Z)(function*(){o.plus.alertMatSnackBar("\u0110ang l\u1ea5y d\u1eef li\u1ec7u "+e),o.loadSV.load("locSLNho"),o.dataSLNho=[];let a=yield o.get_gcslichgcsByMaSogcs(e),l=yield o.getDDoSoGCS(a);o.getChisoRES=yield o.getChiso(l),o.dataRES=o.dataRES.concat(o.getChisoRES),o.maSoGSCs[n].status=!0,o.loadSV.loaded("locSLNho")})()}layDuLieu(e,n){var o=this;return(0,g.Z)(function*(){o.plus.alertMatSnackBar("\u0110ang l\u1ea5y d\u1eef li\u1ec7u "+e),o.KhongCoSL=[],o.loadSV.load("layDuLieu");let a=yield o.get_gcslichgcsByMaSogcs(e);console.log(a);let l=yield o.getDDoSoGCS(a);o.getChisoRES=yield o.getChiso(l),o.chiSoAll=o.chiSoAll.concat(o.getChisoRES);let u=[];u.push({STT:"",MA_KHANG:"M\xe3 s\u1ed5 ghi: "+e,TEN_KHANG:`Th\xe1ng ${o.dDoSoGCSPAYLOAD.THANG}/${o.dDoSoGCSPAYLOAD.NAM}`});for(let p=0;p<o.getChisoRES.length;p++){const m=o.getChisoRES[p];let c={_id:m.ID_BCS,ID_BCS:m.ID_BCS,MA_KHANG:m.MA_KHANG,TEN_KHANG:m.TEN_KHANG,SO_CTO:m.SO_CTO,MA_SOGCS:m.MA_SOGCS,SLUONG_1:+m.SLUONG_1,BCS:m.BCS,CHISO_CU:+m.CHISO_CU,CHISO_MOI:+m.CHISO_MOI||null,MA_GHI_CHU:m.MA_GHI_CHU,status:1,KYCS:N()(m.NGAY_CKY,"DD/MM/YYYY").format("YY/MM")};if("MA_TTCTO"in m&&(c.MA_TTCTO=m.MA_TTCTO,o.MaTrangThai.push(c)),null==m.CHISO_MOI||""==m.CHISO_MOI||!("CHISO_MOI"in m)){u.push(c);let C=yield o.gcsSV.getLichByMaSo(m.MA_SOGCS);c.TEN_TRAM=C.TEN_TRAM,c.PHAN_CONG=C.PHAN_CONG,c.NGAY_GHI=C.NGAY_GCS,c.GHI_CHU="",o.dataGhiRot.push(c)}o.loadSV.loaded("layDuLieu")}o.maSoGSCs[n].status=!0,o.maSoGSCs[n].SL=u.length-1,u.length>1&&(o.exportData[e]=u)})()}exportSL(){for(let e=0;e<this.dataRES.length;e++){let n=this.dataRES[e];+n.SAN_LUONG<5&&+n.SAN_LUONG>0&&("SG"==n.BCS||"KT"==n.BCS||"SN"==n.BCS||"KN"==n.BCS)&&this.dataSLNho.push(n)}this.excelSV.export(this.dataSLNho)}exportSLLon(){let e=["SG","SN","KT","KN"];for(let n=0;n<this.dataRES.length;n++){let o=this.dataRES[n];if((+o.SAN_LUONG>+o.SLUONG_BQUAN+100||+o.SAN_LUONG>+o.SLUONG_1+100)&&e.includes(o.BCS)){let a=this.plus.obj_extractByKeys(o,["MA_KHANG","TEN_KHANG","MA_SOGCS","SAN_LUONG","SLUONG_1","SLUONG_BQUAN","BCS","MA_TTCTO"]);a.TI_LE_BQ=+o.SAN_LUONG/+o.SLUONG_BQUAN,a.TI_LE_KHAC=+o.SAN_LUONG>+o.SLUONG_BQUAN*(this.tile+100)/100?">":"<",this.dataSLTren100.push(a)}}this.excelSV.export(this.plus.sortArr(this.dataSLTren100,"TI_LE",-1))}exportFull(){N()().format("YY/MM"),this.excelSV.export(this.dataRES)}export(){if(this.MaTrangThai.length>0&&(this.exportData.MaTrangThai=this.MaTrangThai),this.MaTrangThai.forEach(e=>delete e.SLUONG_1),this.isMerge)this.excelSV.exportMultiSheets(this.exportData,N()().format("YYYYMMDD")+"-GhiChiSo");else for(let e=0;e<Object.keys(this.exportData).length;e++){const n=Object.keys(this.exportData)[e];this.excelSV.export(this.exportData[n],N()().format("YYYYMMDD")+"-GhiChiSo-"+n)}}exportMaTT(){this.MaTrangThai.length>0&&(this.exportData.MaTrangThai=this.MaTrangThai)}getChiso(e){var n=this;return(0,g.Z)(function*(){return n.cmis4SV.cmis4Request("https://cmis-api.evnspc.vn/serviceChiSoKHang/getChiso","/serviceChiSoKHang/getChiso",{KY:n.dDoSoGCSPAYLOAD.KY,THANG:n.dDoSoGCSPAYLOAD.THANG,NAM:n.dDoSoGCSPAYLOAD.NAM,MA_SOGCS:n.dDoSoGCSPAYLOAD.MA_SOGCS,MA_DVIQLY:n.user.SUBDIVISIONID,NGAY_CKY:n.dDoSoGCSPAYLOAD.NGAY_CKY,LST_DDO:e,IS_CHUANHAPCSO:!1,IS_CHOTCS:!1}).then(u=>(console.log(u),u))})()}getDDoSoGCS(e){var n=this;return(0,g.Z)(function*(){let o={KY:`${e.ky}`,THANG:e.thang,NAM:e.nam,MA_SOGCS:e.maSogcs,MA_DVIQLY:n.user.SUBDIVISIONID,THANG_HT:n.startDay.getMonth()+1,NAM_HT:n.startDay.getFullYear(),NGAY_DKY:N()(e.ngayDky).format("DD/MM/YYYY"),NGAY_CKY:N()(e.ngayCky).format("DD/MM/YYYY")};return n.dDoSoGCSPAYLOAD=o,n.cmis4SV.cmis4Request("https://cmis-api.evnspc.vn/serviceHopDong/getDDoSoGCS","/serviceHopDong/getDDoSoGCS",o).then(u=>(console.log(u),u))})()}getSoGCSByListSo(e){var n=this;return(0,g.Z)(function*(){return n.cmis4SV.cmis4Request("https://cmis-api.evnspc.vn/serviceDanhMuc/getSoGCSByListSo","/serviceDanhMuc/getSoGCSByListSo",{TEN_DANH_MUC:"D_SOGCS",MA_DVIQLY:n.user.SUBDIVISIONID,PARAM:[e]}).then(u=>(console.log(u),u))})()}get_gcslichgcsByMaSogcs(e){var n=this;return(0,g.Z)(function*(){let o={MA_SOGCS:e,MA_DVIQLY:n.user.SUBDIVISIONID,THANG:`${n.startDay.getMonth()+1}`,NAM:`${n.startDay.getFullYear()}`,KY:"0"};return n.cmis4SV.cmis4Request("https://cmis-api.evnspc.vn/serviceChiSoKHang/get_gcslichgcsByMaSogcs","/serviceChiSoKHang/get_gcslichgcsByMaSogcs",o).then(u=>u[u.length-1])})()}getClip(e){localStorage.removeItem("maSoGSCs"),this.maSoGSCs=[];for(let n=0;n<e.length;n++)this.maSoGSCs.push({maSo:`${e[n][0]}`.toUpperCase(),status:!1,SL:0});localStorage.setItem("maSoGSCs",JSON.stringify(this.maSoGSCs)),console.log(this.maSoGSCs)}getMonth(e){console.log(e),this.startDay=N()(e,"MM/YYYY").toDate()}checkPer(e,n="dev"){return!!window.max&&window.max.opt[n]>e}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(K.b),t.Y36(O.a),t.Y36(b.x),t.Y36(f.T),t.Y36(nt.v),t.Y36(st.C),t.Y36(jt.fn),t.Y36(Q.F))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-chi-so-dinh-ky"]],decls:24,vars:7,consts:[[1,"container","py-5"],[3,"label","startDay","month"],[3,"label","excel"],[1,"row"],[1,"col","text-center"],[3,"ngModel","ngModelChange"],["color","accent","mat-raised-button","",3,"click"],["color","primary","mat-raised-button","",3,"click"],["color","primary","mat-raised-button","","matTooltip","Xu\u1ea5t excel DS SL th\u1ea5p",3,"click"],["class","row",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"btn"],["matInput","","placeholder","T\u1ec9 l\u1ec7 ki\u1ec3m tra",3,"ngModel","ngModelChange"],["color","primary","mat-raised-button","","matTooltip","Xu\u1ea5t excel DS SL b\u1ea5t th\u01b0\u1eddng",3,"click"],[1,"text-primary",3,"ngClass"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"app-month-year",1),t.NdJ("month",function(a){return n.getMonth(a)}),t.qZA(),t.TgZ(2,"app-parse-excel-clipboard",2),t.NdJ("excel",function(a){return n.getClip(a)}),t.qZA(),t.TgZ(3,"div",3)(4,"div",4)(5,"mat-slide-toggle",5),t.NdJ("ngModelChange",function(a){return n.isMerge=a}),t._uU(6,"Gom th\xe0nh 1 file"),t.qZA(),t.TgZ(7,"button",6),t.NdJ("click",function(){return n.loop()}),t._uU(8,"L\u1ea5y d\u1eef li\u1ec7u"),t.qZA(),t.TgZ(9,"button",7),t.NdJ("click",function(){return n.export()}),t._uU(10,"Xu\u1ea5t excel"),t.qZA(),t.TgZ(11,"button",7),t.NdJ("click",function(){return n.importAPI()}),t._uU(12,"Giao s\u1ed5 ghi"),t.qZA()()(),t.TgZ(13,"div",3)(14,"div",4)(15,"button",6),t.NdJ("click",function(){return n.loopSL()}),t._uU(16,"L\u1ecdc SL <5 "),t.qZA(),t.TgZ(17,"button",8),t.NdJ("click",function(){return n.exportSL()}),t.TgZ(18,"mat-icon"),t._uU(19,"download"),t.qZA()()()(),t.YNc(20,Xt,11,1,"div",9),t.qZA(),t.TgZ(21,"p"),t._uU(22),t.qZA(),t.YNc(23,zt,5,5,"mat-list",10)),2&e&&(t.xp6(1),t.Q6J("label","K\u1ef3 ghi ch\u1ec9 s\u1ed1")("startDay",n.startDay),t.xp6(1),t.Q6J("label","Copy m\xe3 s\u1ed5 d\xe1n v\xf4 \u0111\xe2y"),t.xp6(3),t.Q6J("ngModel",n.isMerge),t.xp6(15),t.Q6J("ngIf",n.checkPer(1)),t.xp6(2),t.hij("",n.dataGhiRot.length," C\xf4ng t\u01a1 kh\xf4ng c\xf3 d\u1eef li\u1ec7u"),t.xp6(1),t.Q6J("ngForOf",n.maSoGSCs))},dependencies:[H.mk,H.sg,H.O5,d.Fj,d.JJ,d.On,B.Rr,Y.lW,L.Hw,Z.Nt,M.KE,et.gM,w.i$,w.Tg,P.k,q.K]}),i})();function ee(i,r){if(1&i&&(t.TgZ(0,"h5",11),t._uU(1),t.ALo(2,"number"),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.hij(" S\u1ed1 l\u01b0\u1ee3ng d\xf2ng: ",t.lcZ(2,1,e.dataChiSo.length),"")}}function ne(i,r){if(1&i&&(t.TgZ(0,"mat-list")(1,"mat-list-item",11),t._uU(2),t.TgZ(3,"b"),t._uU(4),t.qZA()()()),2&i){const e=r.$implicit;t.xp6(2),t.hij(" S\u1ed5 ",e.maSo," "),t.xp6(2),t.hij(" ",e.SL>0?": "+e.SL+" d\xf2ng":""," ")}}let oe=(()=>{class i{constructor(e,n,o){this.chiSoSV=e,this.excelSV=n,this.authSV=o,this.startDay=N()("10/05/2025","DD/MM/YYYY").toDate()||N()().toDate(),this.maSoGSCs=[],this.exportData={},this.userCmis=JSON.parse(localStorage.getItem("USERCMIS")),this.dataChiSo=localStorage.getItem("dataChiSo")?JSON.parse(localStorage.getItem("dataChiSo")):[],this.error=[],this.NGAY_CKY="",this.NgayDoiGia="10/05/2025",this.testMS="050623D14",this.dataChuaCCS=[]}ngOnInit(){this.NGAY_CKY=N()("10/05/2025","DD/MM/YYYY").subtract(1,"days").format("DD/MM/YYYY"),console.log(" this.NGAY_CKY",this.NGAY_CKY)}loop(){var e=this;return(0,g.Z)(function*(){(0,E.D)(e.maSoGSCs).pipe((0,U.b)(n=>e.layDuLieu(n.maSo))).subscribe()})()}loopGhiDe(){var e=this;return(0,g.Z)(function*(){(0,E.D)(e.maSoGSCs).pipe((0,U.b)(n=>e.ghiDeDuLieu(n.maSo))).subscribe()})()}loopRotCS(){var e=this;return(0,g.Z)(function*(){(0,E.D)(e.maSoGSCs).pipe((0,U.b)(n=>e.getChiSoRot(n.maSo))).subscribe()})()}getChiSoRot(e){var n=this;return(0,g.Z)(function*(){let o={MA_SOGCS:e,KY:1,THANG:+`${n.startDay.getMonth()+1}`,NAM:+`${n.startDay.getFullYear()}`,MA_DVIQLY:n.userCmis.SUBDIVISIONID},a=yield n.chiSoSV.get_Lich_SoGCS(o),l={THANG_HT:+`${n.startDay.getMonth()+1}`,NAM_HT:+`${n.startDay.getFullYear()}`,NGAY_DKY:N()(a.lstLichgcs[0].ngayDky).format("DD/MM/YYYY"),NGAY_CKY:n.NGAY_CKY},u=yield n.chiSoSV.getDDoSoGCS(Object.assign(o,l)),h={KY:o.KY,THANG:o.THANG,NAM:o.NAM,MA_SOGCS:o.MA_SOGCS,IS_CHUANHAPCSO:!0,MA_DVIQLY:o.MA_DVIQLY,NGAY_CKY:N()(n.NGAY_CKY,"DD/MM/YYYY").add(1,"days").format("DD/MM/YYYY"),LST_DDO:u},p=yield n.chiSoSV.getChiso_DGia(h);console.log(p),n.dataChuaCCS.concat(p)})()}ghiDeDuLieu(e){var n=this;return(0,g.Z)(function*(){let o={MA_SOGCS:e,KY:1,THANG:+`${n.startDay.getMonth()+1}`,NAM:+`${n.startDay.getFullYear()}`,MA_DVIQLY:n.userCmis.SUBDIVISIONID},a=yield n.chiSoSV.get_Lich_SoGCS(o),l={THANG_HT:+`${n.startDay.getMonth()+1}`,NAM_HT:+`${n.startDay.getFullYear()}`,NGAY_DKY:N()(a.lstLichgcs[0].ngayDky).format("DD/MM/YYYY"),NGAY_CKY:n.NGAY_CKY},u=yield n.chiSoSV.getDDoSoGCS(Object.assign(o,l)),h={KY:o.KY,THANG:o.THANG,NAM:o.NAM,MA_SOGCS:o.MA_SOGCS,IS_CHUANHAPCSO:!0,MA_DVIQLY:o.MA_DVIQLY,NGAY_CKY:N()(n.NGAY_CKY,"DD/MM/YYYY").add(1,"days").format("DD/MM/YYYY"),LST_DDO:u},p=yield n.chiSoSV.getChiso_DGia(h);console.log(p);let m=[],c=[];if(0==n.dataChiSo.length)return alert("Ch\u01b0a c\xf3 d\u1eef li\u1ec7u \u01b0\u1edbc");for(let T=0;T<p.length;T++){let S,s=p[T];for(let G=0;G<n.dataChiSo.length;G++){const I=n.dataChiSo[G];if(I.MA_KHANG==s.MA_KHANG&&s.BCS==I.BCS){S=I;break}S=null}null==S||"CCS"!==s.LOAICHISO?(s.DIEN_GIAI="\u0110\u01b0\u1ee3c s\u1eeda \u0111\u1ed5i",s.STT_GOC=s.STT,s.DMLTYPE="",s.TEN_CAPDA="1"==s.MA_CAPDA?["D\u01b0\u1edbi 380V"]:["T\u1eeb 380V \u0111\u1ebfn d\u01b0\u1edbi 6kV"],s.NGAY_CHOT=s.NGAY_DKY,s.DMLTYPE_CS="",m.push(s)):"CCS"==s.LOAICHISO&&(s.DIEN_GIAI="\u0110\u01b0\u1ee3c s\u1eeda \u0111\u1ed5i",s.STT_GOC=s.STT,s.DMLTYPE="Update",s.TEN_CAPDA="1"==s.MA_CAPDA?["D\u01b0\u1edbi 380V"]:["T\u1eeb 380V \u0111\u1ebfn d\u01b0\u1edbi 6kV"],s.CHISO_MOI=`${S.UOCCHISOCHOT}`,s.NGAY_CHOT=s.NGAY_DKY,s.NGAY_CKY=n.NGAY_CKY,s.SAN_LUONG=""+(+S.UOCCHISOCHOT-+s.CHISO_CU),s.TONG=""+(+S.UOCCHISOCHOT-+s.CHISO_CU),s.IS_SELECTED="0",s.SLUONG_THAO="0",s.MA_DVICTREN="PK",s.IS_SELECTED="0",s.FLAG="X",s.MA_TTCTO="",s.MA_CNANG="80",s.NGUOI_SUA=n.userCmis.USERNAME,s.NGUOI_TAO=n.userCmis.USERNAME,m.push(s),c.push(s.MA_KHANG))}let C={LST_CHISO:m,LST_LICH:[a.lstLichgcs[0]],LST_CSUAT_DDO:[]};console.log("change",c),console.log(C),yield n.chiSoSV.ExcuteNhapCSDoiGia(C),n.maSoGSCs.find(T=>T.maSo==e).SL=c.length})()}layDuLieu(e){var n=this;return(0,g.Z)(function*(){let o={MA_SOGCS:e,KY:1,THANG:+`${n.startDay.getMonth()+1}`,NAM:+`${n.startDay.getFullYear()}`,MA_DVIQLY:n.userCmis.SUBDIVISIONID},a=yield n.chiSoSV.get_Lich_SoGCS(o),l={THANG_HT:+`${n.startDay.getMonth()+1}`,NAM_HT:+`${n.startDay.getFullYear()}`,NGAY_DKY:N()(a.lstLichgcs[0].ngayDky).format("DD/MM/YYYY"),NGAY_CKY:n.NGAY_CKY},u=yield n.chiSoSV.getDDoSoGCS(Object.assign(o,l));console.log(u);let h={KY:o.KY,THANG:o.THANG,IS_CHUANHAPCSO:!0,NAM:o.NAM,MA_SOGCS:o.MA_SOGCS,MA_DVIQLY:o.MA_DVIQLY,NGAY_CKY:N()(n.NGAY_CKY,"DD/MM/YYYY").add(1,"days").format("DD/MM/YYYY"),LST_DDO:u},p=yield n.chiSoSV.getChiso_DGia(h);console.log(p);let m=[],c=[];if(0==n.dataChiSo.length)return alert("Ch\u01b0a c\xf3 d\u1eef li\u1ec7u \u01b0\u1edbc");for(let T=0;T<p.length;T++){let S,s=p[T];for(let G=0;G<n.dataChiSo.length;G++){const I=n.dataChiSo[G];if(I.MA_KHANG==s.MA_KHANG&&s.BCS==I.BCS){S=I;break}S=null}"CCS"==s.LOAICHISO||null==S||"SAN_LUONG"in s||parseInt(s.CHISO_CU)>parseInt(S.UOCCHISOCHOT)?(console.log("SAN_LUONG"in s,s),s.DIEN_GIAI="\u0110\u01b0\u1ee3c s\u1eeda \u0111\u1ed5i",s.STT_GOC=s.STT,s.DMLTYPE="",s.TEN_CAPDA="1"==s.MA_CAPDA?["D\u01b0\u1edbi 380V"]:["T\u1eeb 380V \u0111\u1ebfn d\u01b0\u1edbi 6kV"],s.NGAY_CHOT=s.NGAY_DKY,s.TONG=s.SAN_LUONG,m.push(s)):("DDK"==s.LOAICHISO||"DUP"==s.LOAICHISO)&&null!=S&&(s.DIEN_GIAI="\u0110\u01b0\u1ee3c s\u1eeda \u0111\u1ed5i",s.STT_GOC=s.STT,s.DMLTYPE="Insert",s.TEN_CAPDA="1"==s.MA_CAPDA?["D\u01b0\u1edbi 380V"]:["T\u1eeb 380V \u0111\u1ebfn d\u01b0\u1edbi 6kV"],s.CHISO_MOI=`${S.UOCCHISOCHOT}`,s.NGAY_CHOT=s.NGAY_DKY,s.NGAY_CKY=n.NGAY_CKY,s.SAN_LUONG=""+(+S.UOCCHISOCHOT-+s.CHISO_CU),s.TONG=""+(+S.UOCCHISOCHOT-+s.CHISO_CU),s.IS_SELECTED="0",s.SLUONG_THAO="0",s.MA_DVICTREN="PK",s.IS_SELECTED="0",s.MA_TTCTO="",s.MA_CNANG="80",s.NGUOI_SUA=n.userCmis.USERNAME,s.NGUOI_TAO=n.userCmis.USERNAME,s.DMLTYPE_CS="",m.push(s),c.push(s.MA_KHANG))}let C={LST_CHISO:m,LST_LICH:[a.lstLichgcs[0]],LST_CSUAT_DDO:[]};console.log("change",c),console.log(C),yield n.chiSoSV.ExcuteNhapCSDoiGia(C),n.maSoGSCs.find(T=>T.maSo==e).SL=c.length})()}getClip(e){this.maSoGSCs=[];for(let n=0;n<e.length;n++)this.maSoGSCs.push({maSo:`${e[n][0]}`.toUpperCase(),status:!1,SL:0});console.log(this.maSoGSCs)}getMonth(e){console.log(e),this.startDay=N()(e,"MM/YYYY").toDate()}getDay(e){console.log(e),this.NGAY_CKY=N()(e,"DD/MM/YYYY").subtract(1,"days").format("DD/MM/YYYY")}export(){this.excelSV.exportMultiSheets({NhapCS:this.dataChiSo,KetQua:this.maSoGSCs},N()().format("YYYYMMDD")+"-GhiChiSo")}exportRot(){this.excelSV.exportMultiSheets({ThieuCS:this.dataChuaCCS},N()().format("YYYYMMDD")+"-ChiSoRot")}onDropFile(e){localStorage.removeItem("dataChiSo"),console.log("onDropFile()"),this.excelSV.fileToJsonArray(e[0]).then(n=>{console.log(n),this.dataChiSo=n,localStorage.setItem("dataChiSo",JSON.stringify(this.dataChiSo))})}xuatFileMau(){this.excelSV.export([{MA_SOGCS:"051229D10",MA_KHANG:"PK05000016655",BCS:"KT",UOCCHISOCHOT:600}])}xoaDuLieuTam(){localStorage.removeItem("dataChiSo"),localStorage.removeItem("DSMaSO"),this.authSV.reload()}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(nt.v),t.Y36(b.x),t.Y36(y.c1))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-chot-doi-gia"]],decls:27,vars:5,consts:[[1,"container","py-5"],["matTooltip","Click t\u1ea3i file m\u1eabu",1,"text-primary",3,"click"],[3,"label","files"],[3,"label","excel"],[1,"row","text-center"],["class","text-primary",4,"ngIf"],[1,"row"],[1,"col","text-center"],["color","accent","mat-raised-button","",3,"click"],["color","primary","mat-raised-button","",3,"click"],[4,"ngFor","ngForOf"],[1,"text-primary"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0),t._UZ(1,"hr"),t.TgZ(2,"h4",1),t.NdJ("click",function(){return n.xuatFileMau()}),t._uU(3),t.qZA(),t._UZ(4,"hr")(5,"hr"),t.TgZ(6,"app-drop-files",2),t.NdJ("files",function(a){return n.onDropFile(a)}),t.qZA(),t.TgZ(7,"app-parse-excel-clipboard",3),t.NdJ("excel",function(a){return n.getClip(a)}),t.qZA(),t.TgZ(8,"div",4),t.YNc(9,ee,3,3,"h5",5),t.qZA(),t.TgZ(10,"div",6)(11,"div",7)(12,"button",8),t.NdJ("click",function(){return n.loopGhiDe()}),t._uU(13,"Ghi \u0111\xe8 ch\u1ec9 s\u1ed1"),t.qZA(),t.TgZ(14,"button",8),t.NdJ("click",function(){return n.loop()}),t._uU(15,"Nh\u1eadp ch\u1ec9 s\u1ed1"),t.qZA(),t.TgZ(16,"button",8),t.NdJ("click",function(){return n.loopRotCS()}),t._uU(17,"L\u1ea5y d\u1eef li\u1ec7u ch\u1ed1t"),t.qZA(),t.TgZ(18,"button",9),t.NdJ("click",function(){return n.export()}),t._uU(19,"Xu\u1ea5t excel"),t.qZA(),t.TgZ(20,"button",9),t.NdJ("click",function(){return n.exportRot()}),t._uU(21,"Xu\u1ea5t excel r\u1edbt CS"),t.qZA(),t.TgZ(22,"button",9),t.NdJ("click",function(){return n.xoaDuLieuTam()}),t._uU(23,"X\xf3a d\u1eef li\u1ec7u t\u1ea1m"),t.qZA(),t.TgZ(24,"button",9),t.NdJ("click",function(){return n.xuatFileMau()}),t._uU(25,"File m\u1eabu"),t.qZA()()(),t.YNc(26,ne,5,2,"mat-list",10),t.qZA()),2&e&&(t.xp6(3),t.hij("Ng\xe0y \u0111\u1ed5i gi\xe1: ",n.NgayDoiGia," "),t.xp6(3),t.Q6J("label","Th\u1ea3 file v\xf4 \u0111\xe2y r\u1ed3i l\u1ecdc s\u1ed5 c\u1ea7n th\u1ef1c hi\u1ec7n d\xe1n v\xf4 clip"),t.xp6(1),t.Q6J("label","Copy m\xe3 s\u1ed5 c\u1ea7n \u0111\u1ea9y v\xf4 CMIS d\xe1n v\xf4 \u0111\xe2y r\u1ed3i nh\u1eadp CSC"),t.xp6(2),t.Q6J("ngIf",n.dataChiSo.length>0),t.xp6(17),t.Q6J("ngForOf",n.maSoGSCs))},dependencies:[H.sg,H.O5,Y.lW,et.gM,w.i$,w.Tg,q.K,F.k,H.JJ]}),i})();var ae=D(70511);function ie(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"button",7),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.export())}),t._uU(1,"Xu\u1ea5t "),t.qZA()}}function le(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"button",7),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.exportMau())}),t._uU(1,"File m\u1eabu "),t.qZA()}}function ue(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"button",11),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.search())}),t._uU(1,"\u0110\u1ed1i so\xe1t file"),t.qZA()}}let ct=(()=>{class i{constructor(e,n,o,a,l,u,h,p,m){this.cmis4SV=e,this.excelSV=n,this.fbSV=o,this.authSV=a,this.loadSV=l,this.idbSV=u,this.plus=h,this.httpSV=p,this.formSV=m,this.searchForm=this.formSV.fb.group({input:["",[d.kI.required,d.kI.minLength(4)]]}),this.main=this.formSV.fb.group({}),this.dbName="kinh-doanh",this.api="cmis4-c06",this.db=null,this.perPageItems=100,this.allowLoadmore=!0,this.TINH_TRANG=null,this.list=[],this.outData=[],this.ilits=0,this.maPK="",this.outHTML="",this.ngaysinh=""}ngOnInit(){}timKiemThongTinKhachHangDoiSoat(e){var n=this;return(0,g.Z)(function*(){return n.cmis4SV.cmis4Request("https://cmis-api.evnspc.vn/service-interfaces/timKiemThongTinKhachHangDoiSoat","",{MA_KHANG:e,ONLY_CCCD_NSINH_EMPTY:!1,TAKE_IT_ALL:!1,LOAI_TKIEM:3,TTHAI_CHOA:"ALL",GIOI_TINH:"ALL",LIST_MA_SOGCS:[],TEN_KHANG:null,MA_DVIQLY:"PK0500",NGAY_SINH_TUNGAY:null,NGAY_SINH_DENNGAY:null,HTHUC_DSOAT:null})})()}updateC06(e){var n=this;return(0,g.Z)(function*(){if(n.ilits++,n.maPK=e,localStorage.setItem("MA_KHANG",e),null==n.TINH_TRANG)return n.plus.alertWarning("Vui lo\u1ea1i nh\u1eadp t\xecnh tr\u1ea1ng C06");let o=yield n.timKiemThongTinKhachHangDoiSoat(e);if(yield n.plus.sleep(1e3),null!==o.data){let a=o.data[0],l="https://cmis-api.evnspc.vn/service-hopdong/updateKhachHangEvnC06";return a.LY_DO="Kh\xe1ch h\xe0ng l\xe0 t\u1ed5 ch\u1ee9c",a.NGUOI_SUA=n.getRandomString(),a.NGAY_SUA=(new Date).toISOString(),a.NGAY_SINH_CHOA=5==+n.TINH_TRANG?a.NGAY_SINH_CHOA+"T00:00:00.000Z":null,a.MA_CNANG="719",a.TINH_TRANG=+n.TINH_TRANG,a.CAN_CHOOSE=!0,n.cmis4SV.cmis4Request(l,"",[a])}return null})()}getRandomString(){let e=["truongnd1.dn","trungvl.dn","thuttt.dn","ancn.dn","conglt.dn","tientv1.dn","chungnh.dn","nhatdm.dn","duyntm.dn","hieunq1.dn","canvn.dn","phongna.dn","dungnt2.dn","tuann.dn","lieudc.dn","thinhnd.dn","khoanna.dn","duypd1.dn","linhnc.dn","luonglv1.dn","tranglc.dn","baonp.dn","nhannt1.dn","nhadt.dn","hanhhv.dn","baotd.dn","tuanlq.dn","dungph.dn","namlk1.dn","anhnh2.dn","tuannt1.dn","hoangnk.dn","tuanna3.dn","viettq1.dn","sunglq.dn","hieunq2.dn","hieult.dn","hattn.dn","truongdb.dn","phuonglv.dn"];return e[Math.floor(Math.random()*e.length)]}search(){var e=this;return(0,g.Z)(function*(){e.outData=[],(0,E.D)(e.list).pipe((0,U.b)(n=>e.doiSoat(n))).subscribe()})()}khongPhaiDS(){var e=this;return(0,g.Z)(function*(){e.outData=[],(0,E.D)(e.list).pipe((0,U.b)(n=>e.updateC06(n.MA_KHANG))).subscribe()})()}doiSoat(e){var n=this;return(0,g.Z)(function*(){let o=yield n.cmis4SV.TraCuuThongTinDanCu(e.CMND,e.DDPL,e.NGAY_SINH);console.log(o),"DV_XMINH_CDAN"in o&&(n.outData.push({...e,...o.DV_XMINH_CDAN}),n.outHTML=n.plus.generateHtmlTable(n.outData))})()}doiSoat1(){var e=this;return(0,g.Z)(function*(){if(""==e.cccd||""==e.hoten||""==e.ngaysinh)return;let n=yield e.cmis4SV.TraCuuThongTinDanCu(e.cccd,e.hoten,"01/01/"+e.ngaysinh);if(console.log(n),!("DV_XMINH_CDAN"in n))return;let o=n.DV_XMINH_CDAN;delete o.MA_YCAU_KNAI,delete o.MA_DVIQLY,delete o.ID_XMINH,delete o.LOAI_TTIN,delete o.TEN_CNANG,delete o.QUEQUAN,delete o.SOSOHOKHAU,delete o.NGAY_TAO,delete o.NGAY_SUA,delete o.NGUOI_TAO,delete o.NGUOI_SUA,delete o.MA_CNANG,delete o.ID_LOG_XMDC,delete o.NOIDANGKYKHAISINH,delete o.NGAYTHANGNAMSINH,e.outData.push(o),e.outHTML=e.plus.generateHtmlTable(e.outData)})()}export(){this.excelSV.export(this.outData,"DoiSoatC06")}exportMau(){this.excelSV.export([{CMND:"",DDPL:"",NGAY_SINH:"",MA_KHANG:""}],"DoiSoatC06")}getExcel(e){this.list=e,console.log(e)}reset(){this.authSV.reload()}reload(){this.authSV.reload()}checkPer(e,n=this.api){return!!window.max&&window.max.opt[n]>e}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(O.a),t.Y36(b.x),t.Y36(st.C),t.Y36(y.c1),t.Y36(K.b),t.Y36(ut.Y),t.Y36(f.T),t.Y36(ae.O),t.Y36(k.o))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-doi-soat-c06"]],inputs:{hoten:"hoten",cccd:"cccd"},decls:17,vars:7,consts:[[1,"container","py-3"],[1,"row"],[3,"json"],["matInput","","placeholder","H\u1ecd t\xean",3,"ngModel","ngModelChange"],["matInput","","placeholder","N\u0103m sinh",3,"ngModel","ngModelChange"],["matInput","","placeholder","CCCD",3,"ngModel","ngModelChange"],[1,"text-center","py-3"],["mat-raised-button","","color","primary",3,"click"],["mat-raised-button","","color","primary",3,"click",4,"ngIf"],["mat-raised-button","","color","warn",3,"click",4,"ngIf"],[1,"table-responsive",3,"innerHTML"],["mat-raised-button","","color","warn",3,"click"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"app-parse-excel-clipboard",2),t.NdJ("json",function(a){return n.getExcel(a)}),t.qZA(),t.TgZ(3,"div",1)(4,"mat-form-field")(5,"input",3),t.NdJ("ngModelChange",function(a){return n.hoten=a}),t.qZA()(),t.TgZ(6,"mat-form-field")(7,"input",4),t.NdJ("ngModelChange",function(a){return n.ngaysinh=a}),t.qZA()(),t.TgZ(8,"mat-form-field")(9,"input",5),t.NdJ("ngModelChange",function(a){return n.cccd=a}),t.qZA()()(),t.TgZ(10,"div",6)(11,"button",7),t.NdJ("click",function(){return n.doiSoat1()}),t._uU(12,"\u0110\u1ed1i so\xe1t"),t.qZA(),t.YNc(13,ie,2,0,"button",8),t.YNc(14,le,2,0,"button",8),t.YNc(15,ue,2,0,"button",9),t.qZA()(),t._UZ(16,"div",10),t.qZA()),2&e&&(t.xp6(5),t.Q6J("ngModel",n.hoten),t.xp6(2),t.Q6J("ngModel",n.ngaysinh),t.xp6(2),t.Q6J("ngModel",n.cccd),t.xp6(4),t.Q6J("ngIf",n.checkPer(4)),t.xp6(1),t.Q6J("ngIf",n.checkPer(4)),t.xp6(1),t.Q6J("ngIf",n.checkPer(4)),t.xp6(1),t.Q6J("innerHTML",n.outHTML,t.oJD))},dependencies:[H.O5,d.Fj,d.JJ,d.On,Y.lW,Z.Nt,M.KE,q.K]}),i})();var _=D(27360),se=D(11481),ot=D(33015),$=D(71948);function ce(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"ul")(1,"mat-radio-button",23),t.NdJ("click",function(){const a=t.CHM(e).$implicit,l=t.oxw();return t.KtG(l.main.controls.MA_YCAU_KNAI.setValue(a.MA_YCAU_KNAI))}),t._uU(2),t.qZA()()}if(2&i){const e=r.$implicit;t.xp6(2),t.lnq("",e.MA_YCAU_KNAI," - ",e.NGAY_TNHAN," - ",e.NOI_DUNG_YCAU,"")}}function re(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"mat-option",27),t.NdJ("click",function(){const a=t.CHM(e).$implicit,l=t.oxw(2);return t.KtG(l.selectOpt(a))}),t._uU(1),t.qZA()}if(2&i){const e=r.$implicit;t.Q6J("value",e.MA_LOAI_HSO),t.xp6(1),t.hij("",e.TEN_LOAI_HSO," ")}}function _e(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"div")(1,"div",3)(2,"mat-form-field")(3,"mat-label"),t._uU(4,"Lo\u1ea1i h\u1ed3 s\u01a1"),t.qZA(),t.TgZ(5,"mat-select",24),t.YNc(6,re,2,2,"mat-option",25),t.qZA()()(),t.TgZ(7,"app-drop-files",26),t.NdJ("files",function(o){t.CHM(e);const a=t.oxw();return t.KtG(a.onDropFile(o))})("ondragover",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.ondragover())}),t.qZA()()}if(2&i){const e=t.oxw();t.xp6(6),t.Q6J("ngForOf",e.LoaiHS),t.xp6(1),t.Q6J("label","")}}function he(i,r){if(1&i&&(t.TgZ(0,"div",28)(1,"b")(2,"p",29),t._uU(3),t.qZA(),t.TgZ(4,"p",29),t._uU(5),t.qZA(),t.TgZ(6,"p",29),t._uU(7),t.qZA()()()),2&i){const e=t.oxw();t.xp6(3),t.Oqu(e.main.value.MA_YCAU_KNAI),t.xp6(2),t.hij(" ",null==e.opt?null:e.opt.TEN_LOAI_HSO,""),t.xp6(2),t.Oqu(e.fileName)}}function me(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"tr")(1,"td",34),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td",23),t.NdJ("click",function(){const a=t.CHM(e).$implicit,l=t.oxw(3);return t.KtG(l.main.controls.MA_YCAU_KNAI.setValue(a.MA_YCAU_KNAI))}),t._uU(6),t.qZA(),t.TgZ(7,"td"),t._uU(8),t.qZA(),t.TgZ(9,"td")(10,"button",35),t.NdJ("click",function(){const a=t.CHM(e).$implicit,l=t.oxw(3);return t.KtG(l.GetBase64HDTHSoUploadByMaYCau(a))}),t.TgZ(11,"mat-icon",36),t._uU(12,"description"),t.qZA()()()()}if(2&i){const e=r.$implicit,n=r.index,o=t.oxw(3);t.xp6(2),t.Oqu(n+1),t.xp6(2),t.Oqu(e.TEN_HSGT),t.xp6(2),t.Oqu(e.MA_YCAU_KNAI),t.xp6(2),t.AsE("","3"==e.TINH_TRANG?"\u0110\xe3 k\xfd s\u1ed1":"\u0110\xednh k\xe8m"," - ",o.getFileType(e.DUONG_DAN),"")}}function pe(i,r){if(1&i&&(t.TgZ(0,"div",32)(1,"h6"),t._uU(2,"H\u1ed3 s\u01a1 \u0111ang c\xf3"),t.qZA(),t.TgZ(3,"table",33)(4,"thead")(5,"tr")(6,"th"),t._uU(7,"STT"),t.qZA(),t.TgZ(8,"th"),t._uU(9,"T\xean h\u1ed3 s\u01a1"),t.qZA(),t.TgZ(10,"th"),t._uU(11,"M\xe3 y\xeau c\u1ea7u"),t.qZA(),t.TgZ(12,"th"),t._uU(13,"T\xecnh tr\u1ea1ng"),t.qZA(),t._UZ(14,"th"),t.qZA()(),t.TgZ(15,"tbody"),t.YNc(16,me,13,5,"tr",7),t.qZA()()()),2&i){const e=t.oxw(2);t.xp6(16),t.Q6J("ngForOf",e.HoSo)}}function Te(i,r){if(1&i&&(t.TgZ(0,"div",30),t.YNc(1,pe,17,1,"div",31),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",e.HoSo.length>0)}}function ge(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"span")(1,"button",39),t.NdJ("click",function(){t.CHM(e);const o=t.oxw().$implicit,a=t.oxw(2);return t.KtG(a.removeFile(o))}),t.TgZ(2,"mat-icon"),t._uU(3,"delete"),t.qZA()()()}}function Ae(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"li",23),t.NdJ("click",function(){const a=t.CHM(e).$implicit,l=t.oxw(2);return t.KtG(l.getpdf(a))}),t._uU(1),t.TgZ(2,"mat-icon",38),t.NdJ("click",function(){const a=t.CHM(e).$implicit,l=t.oxw(2);return t.KtG(l.getpdf(a))}),t._uU(3,"description"),t.qZA(),t._uU(4," - "),t.YNc(5,ge,4,0,"span",8),t.qZA()}if(2&i){const e=r.$implicit,n=t.oxw(2);t.xp6(1),t.AsE("",e.DUONG_DAN," - ",e.NGAY_UPLOAD," "),t.xp6(4),t.Q6J("ngIf",n.checkPer(4))}}function Ne(i,r){if(1&i&&(t.TgZ(0,"ul"),t.YNc(1,Ae,6,3,"li",37),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",e.multiHS)}}function de(i,r){if(1&i&&(t.TgZ(0,"h3",47),t._uU(1),t.qZA()),2&i){const e=t.oxw(3);t.xp6(1),t.hij("S\u1ed1 h\u1ed9: ",e.item.SO_HO,"")}}function Ce(i,r){1&i&&(t.TgZ(0,"h3",47),t._uU(1,"C\xf3 l\u1eb7p \u0111i\u1ec7n m\u1eb7t tr\u1eddi m\xe1i nh\xe0"),t.qZA())}function De(i,r){if(1&i&&(t.TgZ(0,"div",42)(1,"h6",43),t._uU(2),t.qZA(),t.TgZ(3,"h6",43),t._uU(4),t.qZA(),t.TgZ(5,"h6",43),t._uU(6),t.qZA(),t.TgZ(7,"h6",43),t._uU(8),t.qZA(),t.YNc(9,de,2,1,"h3",46),t.YNc(10,Ce,2,0,"h3",46),t.qZA()),2&i){const e=t.oxw(2);t.xp6(2),t.hij("T\xean KH: ",e.item.TEN_KHANG,""),t.xp6(2),t.AsE("T\xean tr\u1ea1m: ",e.item.TEN_TRAM," - ",e.item.MA_TRAM,""),t.xp6(2),t.hij("Chu\u1ed7i gi\xe1: ",e.item.CHUOI_GIA,""),t.xp6(2),t.hij("\u0110\u1ecba ch\u1ec9: ",e.item.DUONG_PHO,""),t.xp6(1),t.Q6J("ngIf",+e.item.SO_HO>1),t.xp6(1),t.Q6J("ngIf",0==+e.item.TCHAT_MTAM)}}function Se(i,r){if(1&i&&(t.TgZ(0,"h5",47),t._uU(1),t.qZA()),2&i){const e=t.oxw(2);t.xp6(1),t.hij(" K\xfd qu\u1ef9: ",e.kyQuy,"")}}function He(i,r){if(1&i&&(t.TgZ(0,"tr")(1,"td",34),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.ALo(7,"numberPipe"),t.qZA(),t.TgZ(8,"td"),t._uU(9),t.ALo(10,"numberPipe"),t.qZA(),t.TgZ(11,"td"),t._uU(12),t.qZA(),t.TgZ(13,"td"),t._uU(14),t.ALo(15,"numberPipe"),t.qZA(),t.TgZ(16,"td"),t._uU(17),t.ALo(18,"numberPipe"),t.qZA()()),2&i){const e=r.$implicit,n=r.index;t.xp6(2),t.Oqu(n+1),t.xp6(2),t.AsE("",e.THANG,"/",e.NAM,""),t.xp6(2),t.Oqu(t.lcZ(7,8,e.DNTT_CTIET)),t.xp6(3),t.Oqu(t.lcZ(10,10,e.TIEN_CTIET)),t.xp6(3),t.Oqu(e.BCS),t.xp6(2),t.Oqu(t.lcZ(15,12,e.CHISO_CU)),t.xp6(3),t.Oqu(t.lcZ(18,14,e.CHISO_MOI))}}function Ge(i,r){if(1&i&&(t.TgZ(0,"div",40),t.YNc(1,De,11,7,"div",41),t.TgZ(2,"div",42)(3,"h5",43),t._uU(4),t.ALo(5,"numberPipe"),t.qZA(),t.YNc(6,Se,2,1,"h5",44),t.TgZ(7,"mat-expansion-panel")(8,"mat-expansion-panel-header")(9,"h5",43),t._uU(10,"S\u1ea3n l\u01b0\u1ee3ng"),t.qZA()(),t.TgZ(11,"table",33)(12,"thead")(13,"tr")(14,"th"),t._uU(15,"STT"),t.qZA(),t.TgZ(16,"th"),t._uU(17,"Th\xe1ng"),t.qZA(),t.TgZ(18,"th"),t._uU(19,"\u0110NTT"),t.qZA(),t.TgZ(20,"th"),t._uU(21,"S\u1ed1 ti\u1ec1n"),t.qZA(),t.TgZ(22,"th"),t._uU(23,"BCS"),t.qZA(),t.TgZ(24,"th"),t._uU(25,"CHISO_CU"),t.qZA(),t.TgZ(26,"th"),t._uU(27,"CHISO_MOI"),t.qZA()()(),t.TgZ(28,"tbody"),t.YNc(29,He,19,16,"tr",7),t.qZA()()()(),t.TgZ(30,"h5",43),t._uU(31,"\xc1p gi\xe1"),t.qZA(),t._UZ(32,"div",45),t.TgZ(33,"h5",43),t._uU(34,"H\u1ee3p \u0111\u1ed3ng"),t.qZA(),t._UZ(35,"div",45),t.TgZ(36,"h5",43),t._uU(37,"\u0110o \u0111\u1ebfm"),t.qZA(),t._UZ(38,"div",45),t.TgZ(39,"h5",43),t._uU(40,"Treo Th\xe1o"),t.qZA(),t._UZ(41,"div",45),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",e.item),t.xp6(3),t.hij("Ti\u1ec1n b\xecnh qu\xe2n: ",t.lcZ(5,8,e.bq),""),t.xp6(2),t.Q6J("ngIf",e.kyQuy.length>0),t.xp6(23),t.Q6J("ngForOf",e.sanLuong),t.xp6(3),t.Q6J("innerHTML",e.ttApGia,t.oJD),t.xp6(3),t.Q6J("innerHTML",e.ttHopDong,t.oJD),t.xp6(3),t.Q6J("innerHTML",e.ttDoDem,t.oJD),t.xp6(3),t.Q6J("innerHTML",e.ttTreoThao,t.oJD)}}let Ie=(()=>{class i{constructor(e,n,o,a,l,u,h,p,m){this.cmis4SV=e,this.plus=n,this.formSV=o,this.authSV=a,this.loadSV=l,this.sanitizer=u,this.kyQuySV=h,this.sheetdbSV=p,this.idbSV=m,this.api="cmis4-so-hoa",this.db=null,this.dbKD=null,this.dbName="cmis4",this.dbNameKD="kinh-doanh",this.opt=null,this.fileName="",this.main=this.formSV.fb.group({MA_DVIQLY:"PK0500",MA_LOAI_HSO:["",[d.kI.required]],MA_YCAU_KNAI:["",[d.kI.required,d.kI.pattern("^[a-zA-Z0-9]*$")]],DINH_DANG:["",[d.kI.required]],FILE_VALUE:["",[d.kI.required]]}),this.header={MA_DVIQLY:"Ma \u0111\u01a1n v\u1ecb qu\u1ea3n l\xfd",MA_YCAU_KNAI:"M\xe3 KH",MA_LOAI_HSO:"Lo\u1ea1i h\u1ed3 s\u01a1",DINH_DANG:"File",FILE_VALUE:"File"},this.nam=N()().format("YYYY"),this.thang=N()().format("M"),this.LoaiHS=[],this.HoSo=[],this.multiHS=[],this.dsYeuCau=[],this.maYeuCau="",this.sttSoHoa=[],this.sanLuong=[],this.sttHS="",this.ttHopDong="",this.ttApGia="",this.ttDoDem="",this.ttTreoThao="",this.bq=0,this.kyQuy="",this.item=null}ngOnInit(){this.idbSV.IDB_InitDB(this.dbNameKD).subscribe(e=>{this.dbKD=e,this.kyQuySV.db=e,this.kyQuySV.sync().subscribe()}),this.idbSV.IDB_InitDB(this.dbName).subscribe(e=>{this.db=e,this.getSoTT()}),this.getGToCViecLoaiYC()}timkiem(){var e=this;return(0,g.Z)(function*(){let n=e.cmis4SV.convertPK(e.main.value.MA_YCAU_KNAI);return e.cmis4SV.timKiemKhachHang(n).then(o=>{console.log(o),e.item=o[0]})})()}getSL(){var e=this;return(0,g.Z)(function*(){let n=e.cmis4SV.convertPK(e.main.value.MA_YCAU_KNAI),o=N()().subtract(12,"months").format("MM/YYYY"),a=N()().subtract(1,"months").format("MM/YYYY");yield e.cmis4SV.getSaoLucChiSo(n,o,a).then(l=>{console.log(l),e.sanLuong=l;let u=0,h=0;for(let p=0;p<l.length;p++){const m=l[p];1==m.KY&&("SG"==m.BCS||"KT"==m.BCS)&&(u+=m.TIEN_CTIET)}return h=Math.round(u/12),e.bq=h})})()}tracuu(){var e=this;return(0,g.Z)(function*(){let n=e.cmis4SV.convertPK(e.main.value.MA_YCAU_KNAI),o={strMaDViQLy:"PK0500",strMaKhang:n,strMaDdo:n+"001",iKy:"1",iThang:e.thang,iNam:e.nam,nLoaiTraCuu:12,trangThaiHL:"1"},a="https://cmis-api.evnspc.vn/serviceBCaoThang/traCuuTtinKhang";e.cmis4SV.cmis4Request(a,"",o).then(l=>{let u=JSON.parse(l.TTIN_TRACUU[0]);u=e.plus.sortArr(u,"HLUC_TUNGAY",-1),u=e.filterKeys(u,["MA_HDONG","HLUC_TUNGAY","HLUC_DENNGAY","THOIHAN_TTOAN"]),e.ttHopDong=e.plus.generateHtmlTable(u),console.log(l)}),o.nLoaiTraCuu=1,e.cmis4SV.cmis4Request(a,"",o).then(l=>{let u=JSON.parse(l.TTIN_TRACUU[0]);u=e.filterKeys(u,["MA_KHANG","NGAY_HLUC","LOAI_BCS_APGIA","MA_NHOMNN","DINH_MUC","SO_HO_APGIA"]),e.ttApGia=e.plus.generateHtmlTable(u),console.log(l)}),o.nLoaiTraCuu=0,e.cmis4SV.cmis4Request(a,"",o).then(l=>{let u=JSON.parse(l.TTIN_TRACUU[0]);u=e.filterKeys(u,["DIA_CHI_KH","SO_HO","LOAI_DDO","KIMUA_CSPK","SO_PHA","NGAY_HLUC"]),e.ttDoDem=e.plus.generateHtmlTable(u),console.log(l)}),o.nLoaiTraCuu=13,e.cmis4SV.cmis4Request(a,"",o).then(l=>{let u=JSON.parse(l.TTIN_TRACUU[0]);u=e.plus.sortArr(u,"ID_BBAN",-1),u=e.filterKeys(u,["MA_KHANG","TEN_KHANG","NGAY_TTHAO","MA_TBI","TEN_LDO"]),e.ttTreoThao=e.plus.generateHtmlTable(u),console.log(l)}),o.nLoaiTraCuu=14,e.cmis4SV.cmis4Request(a,"",o).then(l=>{`${JSON.parse(l.TTIN_TRACUU[0])[0]}`.includes("TM")&&e.plus.alertError("Ti\u1ec1n m\u1eb7t")})})()}filterKeys(e,n){return e.map(o=>Object.fromEntries(n.map(a=>[a,o[a]])))}getSttByPK(){let e=this.cmis4SV.convertPK(this.main.value.MA_YCAU_KNAI);this.idbSV.IDB_DB_GetById(this.db,this.api,e).then(n=>{this.sttHS=n.SoThuTu||"",alert(this.sttHS)})}getSoTT(){this.idbSV.IDB_DB_GetAll(this.db,this.api).subscribe(e=>{this.sttSoHoa=e,console.log(e[0]),0==e.length&&this.sheetdbSV.get("1zhuwB9qoLm5kyFfpJFoa-1yKKsMN1Ltn9tejML8Dguo","SoHoa").subscribe(n=>{console.log(n),this.idbSV.IDB_DB_Add(this.db,this.api,n.data).then(o=>{console.log(o)})})})}xemKyQuy(){var e=this;return(0,g.Z)(function*(){e.kyQuySV.getByPK(e.cmis4SV.convertPK(e.main.value.MA_YCAU_KNAI)).then(n=>{console.log(n),e.kyQuy=e.plus.numberWithCommas(n[0].STIEN_DCOC)+n[0].TRANG_THAI})})()}getYeuCau(){var e=this;return(0,g.Z)(function*(){e.multiHS=[],e.pdfUrl=null,e.cmis4SV.timKiemYeuCau(e.cmis4SV.convertPK(e.main.value.MA_YCAU_KNAI)).then(n=>{console.log("Response from timKiemYeuCau:",n),Array.isArray(n)&&(e.dsYeuCau=n),1==e.dsYeuCau.length&&(e.maYeuCau=e.dsYeuCau[0].MA_YCAU_KNAI),e.loadSV.clear()}).catch(n=>{console.error("Error in timKiemYeuCau:",n)})})()}viewDetails(e){this.cmis4SV.cmis4RequestGETPDF("/123/123/"+this.cmis4SV.user.SUBDIVISIONID+"/"+e.MA_YCAU_KNAI+"/"+e.MA_HSGT).subscribe(o=>{const a=URL.createObjectURL(o);window.open(a)})}uploadHSoGTo(){this.loadSV.load("uploadHSoGTo");let o=this.formSV.getErrValidateFormV2(this.main,this.header);if(o.length>0)return this.plus.alertError(o);let a=this.main.value;a.MA_YCAU_KNAI=this.cmis4SV.convertPK(a.MA_YCAU_KNAI),this.cmis4SV.cmis4Request("https://cmis-api.evnspc.vn/serviceInterface/uploadHSoGTo","/serviceInterface/uploadHSoGTo",a).then(l=>{this.plus.alertMatSnackBar(l.MESSAGE),this.loadSV.loaded("uploadHSoGTo"),this.main.reset(),this.main.patchValue({MA_YCAU_KNAI:a.MA_YCAU_KNAI,MA_DVIQLY:a.MA_DVIQLY}),this.GetAllListHSoGToOfKHang()})}getGToCViecLoaiYC(){this.cmis4SV.cmis4Request("https://cmis-api.evnspc.vn/serviceDanhMuc/getGToCViecLoaiYC","/serviceDanhMuc/getGToCViecLoaiYC",{MA_LOAI_HSO:"ALL",MA_LOAI_YCAU:"TLYKMOI",MA_CVIEC:"TN",LOAI_SOHUU:"2"}).then(a=>{localStorage.setItem("getGToCViecLoaiYC",JSON.stringify(a)),this.LoaiHS=a})}onDropFile(e){this.parse64(e[0]).then(n=>{let o=e[0].type.replace(/^.*\./,"");this.main.controls.DINH_DANG.setValue(o.indexOf("/")<0?o:o.split("/")[o.split("/").length-1]),this.main.controls.FILE_VALUE.setValue(n.toString().split(",")[1]),this.fileName=e[0].name,console.log(this.main.value)})}ondragover(){document.getElementById("dropZone").setAttribute("drop-active","true")}selectOpt(e){var n=this;return(0,g.Z)(function*(){n.main.controls.MA_LOAI_HSO.setValue(e.MA_LOAI_HSO),n.opt=e})()}checkPer(e){return this.authSV.checkPer(this.api,e)}GetAllListHSoGToOfKHang(){this.reset(),this.tracuu(),this.getSL(),this.xemKyQuy(),this.timkiem(),this.multiHS=[],this.pdfUrl=null,this.main.controls.MA_YCAU_KNAI.setValue(this.cmis4SV.convertPK(this.main.value.MA_YCAU_KNAI));let n={MA_DVIQLY:"PK0500",MA_KHANG:this.cmis4SV.convertPK(this.main.value.MA_YCAU_KNAI)};return this.cmis4SV.cmis4Request("https://cmis-api.evnspc.vn/serviceInterface/GetAllListHSoGToOfKHang","",n).then(o=>{this.HoSo=o})}GetBase64HDTHSoUploadByMaYCau(e){let a="SD"==e.MA_HSGT?"SD":this.LoaiHS.filter(u=>u.TEN_LOAI_HSO===e.TEN_HSGT)[0]?.MA_LOAI_HSO;return this.cmis4SV.cmis4Request("https://cmis-api.evnspc.vn/serviceInterface/GetBase64HDTHSoUploadByMaYCau","/serviceInterface/GetBase64HDTHSoUploadByMaYCau",{MA_DVIQLY:"PK0500",MA_YCAU_KNAI:e.MA_YCAU_KNAI,MA_LOAI_HSO:a}).then(u=>{if("TYPE"in u)return this.plus.alertMatSnackBar(u.MESSAGE),this.viewDetails(e);Array.isArray(u)&&u.length>0&&(this.multiHS=u,this.getpdf(u[0]))})}getpdf(e){let n=e.DUONG_DAN.replace(/^.*\./,""),o="pdf"==n?"application/pdf":`image/${n}`;const a=Buffer.from(e.BASE64,"base64"),l=new Blob([a],{type:o}),u=URL.createObjectURL(l);this.pdfUrl=this.sanitizer.bypassSecurityTrustResourceUrl(u),this.plus.clickBtn("modalXHSGT")}getFileType(e){return e.replace(/^.*\./,"")}removeFile(e){let o={MA_DVIQLY:"PK0500",MA_YCAU_KNAI:this.cmis4SV.convertPK(e.MA_YCAU_KNAI),MA_LOAI_HSO:e.MA_LOAI_HSO,STT:e.STT};return this.cmis4SV.postData(_.IF.INTERFACE,_.xY.POST_REMOVEHSOGTO_STT,o).then(a=>{this.plus.alertMatSnackBar(a.MESSAGE)})}parse64(e){return this.loadSV.load("parse64"),new Promise((n,o)=>{const l=new FileReader;l.readAsDataURL(e),l.onload=u=>(this.loadSV.loaded("parse64"),n(l.result),n),l.onerror=u=>(o(u),"")})}reset(){this.multiHS=[],this.dsYeuCau=[],this.maYeuCau="",this.sttSoHoa=[],this.sanLuong=[],this.sttHS="",this.ttHopDong="",this.ttApGia="",this.ttDoDem="",this.ttTreoThao="",this.bq=0,this.kyQuy="",this.HoSo=[]}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(O.a),t.Y36(f.T),t.Y36(k.o),t.Y36(y.c1),t.Y36(K.b),t.Y36(se.H7),t.Y36(ot.fq),t.Y36(V.F),t.Y36(Q.F))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-so-hoa"]],decls:37,vars:11,consts:[[1,"container","py-4"],[1,"row",3,"formGroup"],[1,"form","py-1"],[1,"col"],["id","search-api","required","","matInput","","placeholder","M\xe3 Kh\xe1ch h\xe0ng","formControlName","MA_YCAU_KNAI",3,"keydown.enter","focus"],["mat-raised-button","","color","accent",1,"py-2",3,"click"],["mat-raised-button","","color","primary",3,"click"],[4,"ngFor","ngForOf"],[4,"ngIf"],["class","fontweigth-bold",4,"ngIf"],["mat-raised-button","","color","warn",3,"disabled","click"],["class","adm",4,"ngIf"],[1,"row","text-center"],["hidden","","id","modalXHSGT","type","button","data-bs-toggle","modal","data-bs-target","#XHSGT",1,"btn","btn-primary"],["id","XHSGT","data-bs-backdrop","static","data-bs-keyboard","true","tabindex","-1","aria-labelledby","staticBackdropLabel","aria-hidden","true",1,"modal","fade"],[1,"modal-dialog","modal-fullscreen"],[1,"modal-content"],[1,"modal-body"],["width","100%","height","720px",3,"src"],[1,"modal-footer"],["color","primary","id","closeModalXHSGT","data-bs-dismiss","modal","mat-raised-button",""],["class","container",4,"ngIf"],[3,"hoten","cccd"],[3,"click"],["formControlName","MA_LOAI_HSO"],[3,"value","click",4,"ngFor","ngForOf"],[3,"label","files","ondragover"],[3,"value","click"],[1,"fontweigth-bold"],[1,"text-danger"],[1,"adm"],["class","row",4,"ngIf"],[1,"row"],[1,"table","table-striped"],[1,"text-center"],["mat-icon-button","",3,"click"],["color","primary"],[3,"click",4,"ngFor","ngForOf"],["color","primary",3,"click"],["color","warn","mat-icon-button","",3,"click"],[1,"container"],["class","row  py-3",4,"ngIf"],[1,"row","py-3"],[1,"font-blue"],["class","text-danger","class","bg-danger",4,"ngIf"],[1,"row",3,"innerHTML"],["class","bg-danger",4,"ngIf"],[1,"bg-danger"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2),t._UZ(3,"div",3),t.TgZ(4,"mat-form-field")(5,"mat-label"),t._uU(6,"M\xe3 KH"),t.qZA(),t.TgZ(7,"input",4),t.NdJ("keydown.enter",function(){return n.GetAllListHSoGToOfKHang()})("focus",function(){return n.main.controls.MA_YCAU_KNAI.setValue("")}),t.qZA()(),t.TgZ(8,"button",5),t.NdJ("click",function(){return n.GetAllListHSoGToOfKHang()}),t._uU(9,"Xem h\u1ed3 s\u01a1"),t.qZA(),t.TgZ(10,"button",6),t.NdJ("click",function(){return n.getYeuCau()}),t._uU(11," T\xecm y\xeau c\u1ea7u g\u1ea7n \u0111\xe2y"),t.qZA(),t.TgZ(12,"button",6),t.NdJ("click",function(){return n.getSttByPK()}),t._uU(13," Xem STT"),t.qZA(),t.YNc(14,ce,3,3,"ul",7),t.qZA(),t.TgZ(15,"mat-expansion-panel")(16,"mat-expansion-panel-header"),t._uU(17," S\u1ed1 h\xf3a "),t.qZA(),t.YNc(18,_e,8,2,"div",8),t.YNc(19,he,8,3,"div",9),t.TgZ(20,"button",10),t.NdJ("click",function(){return n.uploadHSoGTo()}),t._uU(21,"Upload"),t.qZA()()(),t.YNc(22,Te,2,1,"div",11),t.qZA(),t.YNc(23,Ne,2,1,"ul",8),t._UZ(24,"div",12),t.TgZ(25,"button",13),t._uU(26," Launch static backdrop modal "),t.qZA(),t.TgZ(27,"div",14)(28,"div",15)(29,"div",16)(30,"div",17),t._UZ(31,"iframe",18),t.qZA(),t.TgZ(32,"div",19)(33,"button",20),t._uU(34,"\u0110\xf3ng"),t.qZA()()()()(),t.YNc(35,Ge,42,10,"div",21),t._UZ(36,"app-doi-soat-c06",22)),2&e&&(t.xp6(1),t.Q6J("formGroup",n.main),t.xp6(13),t.Q6J("ngForOf",n.dsYeuCau),t.xp6(4),t.Q6J("ngIf",n.main.value.MA_YCAU_KNAI.length>0),t.xp6(1),t.Q6J("ngIf",13==n.main.value.MA_YCAU_KNAI.length),t.xp6(1),t.Q6J("disabled",n.main.invalid),t.xp6(2),t.Q6J("ngIf",n.checkPer(2)),t.xp6(1),t.Q6J("ngIf",n.multiHS.length>0),t.xp6(8),t.Q6J("src",n.pdfUrl,t.uOi),t.xp6(4),t.Q6J("ngIf",n.checkPer(5)&&n.main.value.MA_YCAU_KNAI.length>0),t.xp6(1),t.Q6J("hoten",null==n.item?null:n.item.TEN_KHANG)("cccd",null==n.item?null:n.item.SO_CMT))},dependencies:[H.sg,H.O5,d.Fj,d.JJ,d.JL,d.Q7,d.sg,d.u,$.U0,Y.lW,Y.RK,L.Hw,Z.Nt,M.KE,M.hX,W.ey,lt.gD,x.ib,x.yz,F.k,ct,tt._2]}),i})();var Ye=D(62843),rt=D(80529);let Me=(()=>{class i{constructor(e,n,o,a){this.httpClient=e,this.plus=n,this.loadSV=o,this.authSV=a,this.user=null}getUser(){let e=JSON.parse(localStorage.getItem("USERCMIS"))||null;return e?e.HetHan<Date.now()?(localStorage.removeItem("USERCMIS"),this.user=null,this.authSV.reload("/cmis4"),null):e:(this.plus.alertError("Vui l\xf2ng \u0111\u0103ng nh\u1eadp l\u1ea1i"),this.user=null,null)}postData(e,n,o,a,l){var u=this;return(0,g.Z)(function*(){const h=`${e=u.getURLService(e,l)}${n}`,p={authority:"cmis-api.evnspc.vn",authorization:"Bearer "+u.getUser().ACCESS_TOKEN};return v.Z.post(h,o,{headers:p}).catch(m=>{401===m.response.status&&(localStorage.removeItem("USERCMIS"),u.plus.alertMatSnackBar("Phie\u0302n \u0111a\u0306ng nha\u0323\u0302p he\u0302\u0301t ha\u0323n. Vui lo\u0300ng \u0111a\u0306ng nha\u0323\u0302p la\u0323i"),u.authSV.reload("/cmis4"))})})()}getOptionsRequest(e,n,o){const a={};return null!=e&&e&&(a.reportProgress=!0),null!=n&&n&&(a.responseType=n),a}getURLService(e,n){try{const o="https://cmis-api.evnspc.vn";if(n&&"1"==n)switch(e){case _.IF.DICHVU:return o+_.cp.DICHVU_SPRING;case _.IF.FILEDTU:return o+_.cp.FILEDTU_SPRING;case _.IF.HOPDONG:return o+_.cp.HOPDONG_SPRING;case _.IF.HOSOTBI:return o+_.cp.HOSOTBI_SPRING;case _.IF.BDONGTBI:return o+_.cp.BDONGTBI_SPRING;case _.IF.BDONGTTHAO:return o+_.cp.BDONGTTHAO_SPRING;case _.IF.QLYSOGCS:return o+_.cp.QLYSOGCS_SPRING;case _.IF.CHISOKHANG:return o+_.cp.CHISOKHANG_SPRING;case _.IF.HDONPSINH:return o+_.cp.HDONPSINH_SPRING;case _.IF.HDONDCHINH:return o+_.cp.HDONDCHINH_SPRING;case _.IF.HDONDTU:return o+_.cp.HDONDTU_SPRING;case _.IF.TTIENCNO:return o+_.cp.TTIENCNO_SPRING;case _.IF.NOKHODOI:return o+_.cp.NOKHODOI;case _.IF.PHIDCAT:return o+_.cp.PHIDCAT_SPRING;case _.IF.KHONO:return o+_.cp.KHONO_SPRING;case _.IF.CAYTTHAT:return o+_.cp.CAYTTHAT_SPRING;case _.IF.CHISOTTHAT:return o+_.cp.CHISOTTHAT_SPRING;case _.IF.GNHANDNANG:return o+_.cp.GNHANDNANG_SPRING;case _.IF.QTRIHTHONG:return o+_.cp.QTRIHTHONG_SPRING;case _.IF.SMS:return o+_.cp.SMS_SPRING;case _.IF.EMAIL:return o+_.cp.EMAIL_SPRING;case _.IF.TBIHTRUONG:return o+_.cp.TBIHTRUONG_SPRING;case _.IF.KTRAGSATMBD:return o+_.cp.KTRAGSATMBD_SPRING;case _.IF.BANLEDNANG:return o+_.cp.BANLEDNANG_SPRING;case _.IF.DANHMUC:return o+_.cp.DANHMUC_SPRING;case _.IF.BCAOTHANG:return o+_.cp.BCAOTHANG_SPRING;case _.IF.BCAOLICHSU:return o+_.cp.BCAOLICHSU_SPRING;case _.IF.QTRIDHANH:return o+_.cp.QTRIDHANH_SPRING;case _.IF.REPORT:return o+_.cp.REPORT_SPRING;case _.IF.COMMON:return o+_.cp.COMMON_SPRING;case _.IF.INTERFACE:return o+_.cp.INTERFACE_SPRING;case _.IF.DIENNTHON:return o+_.cp.DIENNTHON_SPRING;case _.IF.CSBT:return o+_.cp.CSBT_SPRING;case _.IF.EVNHUB:return o+_.cp.EVNHUB_SPRING;case _.IF.UDUNGHTRUONGHCMC:return o+_.cp.UDUNGHTRUONGHCMC_SPRING;case _.IF.AUTH:return o+_.cp.AUTH;case _.IF.QUANLYTHUHO:return o+_.cp.QUANLYTHUHO;case _.IF.QUANLYTIEPNHANLUOIDIEN:return o+_.cp.QUANLYTIEPNHANLUOIDIEN;case _.IF.DIENMATTROI:return o+_.cp.DIENMATTROI;case _.IF.UTILS:return o+_.cp.UTILS;default:return o+"/"}else switch(e){case _.IF.DICHVU:return o+_.cp.DICHVU;case _.IF.FILEDTU:return o+_.cp.FILEDTU;case _.IF.HOPDONG:return o+_.cp.HOPDONG;case _.IF.HOSOTBI:return o+_.cp.HOSOTBI;case _.IF.BDONGTBI:return o+_.cp.BDONGTBI;case _.IF.BDONGTTHAO:return o+_.cp.BDONGTTHAO;case _.IF.QLYSOGCS:return o+_.cp.QLYSOGCS;case _.IF.CHISOKHANG:return o+_.cp.CHISOKHANG;case _.IF.HDONPSINH:return o+_.cp.HDONPSINH;case _.IF.HDONDCHINH:return o+_.cp.HDONDCHINH;case _.IF.HDONDTU:return o+_.cp.HDONDTU;case _.IF.TTIENCNO:return o+_.cp.TTIENCNO;case _.IF.NOKHODOI:return o+_.cp.NOKHODOI;case _.IF.PHIDCAT:return o+_.cp.PHIDCAT;case _.IF.KHONO:return o+_.cp.KHONO;case _.IF.CAYTTHAT:return o+_.cp.CAYTTHAT;case _.IF.CHISOTTHAT:return o+_.cp.CHISOTTHAT;case _.IF.GNHANDNANG:return o+_.cp.GNHANDNANG;case _.IF.QTRIHTHONG:return o+_.cp.QTRIHTHONG;case _.IF.SMS:return o+_.cp.SMS;case _.IF.EMAIL:return o+_.cp.EMAIL;case _.IF.TBIHTRUONG:return o+_.cp.TBIHTRUONG;case _.IF.KTRAGSATMBD:return o+_.cp.KTRAGSATMBD;case _.IF.BANLEDNANG:return o+_.cp.BANLEDNANG;case _.IF.DANHMUC:return o+_.cp.DANHMUC;case _.IF.BCAOTHANG:return o+_.cp.BCAOTHANG;case _.IF.BCAOLICHSU:return o+_.cp.BCAOLICHSU;case _.IF.QTRIDHANH:return o+_.cp.QTRIDHANH;case _.IF.REPORT:return o+_.cp.REPORT;case _.IF.COMMON:return o+_.cp.COMMON;case _.IF.INTERFACE:return o+_.cp.INTERFACE;case _.IF.DIENNTHON:return o+_.cp.DIENNTHON;case _.IF.CSBT:return o+_.cp.CSBT;case _.IF.EVNHUB:return o+_.cp.EVNHUB;case _.IF.UDUNGHTRUONGHCMC:return o+_.cp.UDUNGHTRUONGHCMC;case _.IF.AUTH:return o+_.cp.AUTH;case _.IF.QUANLYTHUHO:return o+_.cp.QUANLYTHUHO;case _.IF.QUANLYTIEPNHANLUOIDIEN:return o+_.cp.QUANLYTIEPNHANLUOIDIEN;case _.IF.DIENMATTROI:return o+_.cp.DIENMATTROI;case _.IF.UTILS:return o+_.cp.UTILS;default:return o+"/"}}catch(o){return console.log("L\u1ed7i l\u1ea5y IP APT Gate way"+o),o?.error??null}}handleError(e){let n="An unknown error occurred!";return n=e.error instanceof ErrorEvent?`Error: ${e.error.message}`:"object"==typeof e?.error?`Error Code: ${e.status}\nMessage: ${JSON.stringify(e?.error)}`:`Error Code: ${e.status}\nMessage: ${e.message}`,(0,Ye._)(n)}}return i.\u0275fac=function(e){return new(e||i)(t.LFG(rt.eN),t.LFG(f.T),t.LFG(K.b),t.LFG(y.c1))},i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),Oe=(()=>{class i{constructor(e,n){this.cmis4V2SV=e,this.chiSoSV=n,this.startDay=N()().subtract(5,"days").toDate(),this.thang="",this.nam="",this.maSo="050631X19",this.userCmis=JSON.parse(localStorage.getItem("USERCMIS")),this.NGAY_CKY="",this.dataChiSo=[],this.maSoGSCs=JSON.parse(localStorage.getItem("DSMaSO"))||[]}ngOnInit(){this.userCmis=this.cmis4V2SV.getUser()}test(){var e=this;return(0,g.Z)(function*(){let n=yield e.get_gcslichgcsByMaSogcs(e.maSo)[0];N()(n.ngayDky).format("DD/MM/YYYY"),N()(n.ngayCky).format("DD/MM/YYYY"),yield e.getDDoSoGCS(n)})()}getDDoSoGCS(e){var n=this;return(0,g.Z)(function*(){let o={KY:"1",THANG:e.thang,NAM:e.nam,MA_SOGCS:e.maSogcs,MA_DVIQLY:"PK0500",THANG_HT:e.thang,NAM_HT:e.nam,NGAY_DKY:N()(e.ngayDky).format("DD/MM/YYYY"),NGAY_CKY:N()(e.ngayCky).format("DD/MM/YYYY")};return n.cmis4V2SV.postData(_.IF.HOPDONG,_.td.POST_GET_DDO_SO_GCS,o)})()}get_gcslichgcsByMaSogcs(e){var n=this;return(0,g.Z)(function*(){return n.cmis4V2SV.postData(_.IF.CHISOKHANG,_.Li.POST_GCS_LICH_GCS_BY_MA_SOGCS,{MA_SOGCS:e,MA_DVIQLY:"PK0500",THANG:`${n.thang}`,NAM:`${n.nam}`,KY:"0"})})()}getSoGCSByListSo(e){return this.cmis4V2SV.postData(_.IF.DANHMUC,_.ST.POST_GET_SO_GCS_BY_LIST_SO,{TEN_DANH_MUC:"D_SOGCS",MA_DVIQLY:"PK0500",PARAM:[e]})}ghiDeDuLieu(e){var n=this;return(0,g.Z)(function*(){let o={MA_SOGCS:e,KY:1,THANG:+`${n.startDay.getMonth()+1}`,NAM:+`${n.startDay.getFullYear()}`,MA_DVIQLY:n.userCmis.SUBDIVISIONID},a=yield n.chiSoSV.get_Lich_SoGCS(o),l={THANG_HT:+`${n.startDay.getMonth()+1}`,NAM_HT:+`${n.startDay.getFullYear()}`,NGAY_DKY:N()(a.lstLichgcs[0].ngayDky).format("DD/MM/YYYY"),NGAY_CKY:n.NGAY_CKY},u=yield n.chiSoSV.getDDoSoGCS(Object.assign(o,l));console.log(u);let h={KY:o.KY,THANG:o.THANG,NAM:o.NAM,IS_CHUANHAPCSO:!0,MA_SOGCS:o.MA_SOGCS,MA_DVIQLY:o.MA_DVIQLY,NGAY_CKY:N()(n.NGAY_CKY,"DD/MM/YYYY").add(1,"days").format("DD/MM/YYYY"),LST_DDO:u},p=yield n.chiSoSV.getChiso_DGia(h);console.log(p);let m=[],c=[];if(0==n.dataChiSo.length)return alert("Ch\u01b0a c\xf3 d\u1eef li\u1ec7u \u01b0\u1edbc");for(let T=0;T<p.length;T++){let S,s=p[T];for(let G=0;G<n.dataChiSo.length;G++){const I=n.dataChiSo[G];if(I.MA_KHANG==s.MA_KHANG&&s.BCS==I.BCS){S=I;break}S=null}null==S||"CCS"!==s.LOAICHISO?(s.DIEN_GIAI="\u0110\u01b0\u1ee3c s\u1eeda \u0111\u1ed5i",s.STT_GOC=s.STT,s.DMLTYPE="",s.TEN_CAPDA="1"==s.MA_CAPDA?["D\u01b0\u1edbi 380V"]:["T\u1eeb 380V \u0111\u1ebfn d\u01b0\u1edbi 6kV"],s.NGAY_CHOT=s.NGAY_DKY,s.DMLTYPE_CS="",m.push(s)):"CCS"==s.LOAICHISO&&(s.DIEN_GIAI="\u0110\u01b0\u1ee3c s\u1eeda \u0111\u1ed5i",s.STT_GOC=s.STT,s.DMLTYPE="Update",s.TEN_CAPDA="1"==s.MA_CAPDA?["D\u01b0\u1edbi 380V"]:["T\u1eeb 380V \u0111\u1ebfn d\u01b0\u1edbi 6kV"],s.CHISO_MOI=`${S.UOCCHISOCHOT}`,s.NGAY_CHOT=s.NGAY_DKY,s.NGAY_CKY=n.NGAY_CKY,s.SAN_LUONG=""+(+S.UOCCHISOCHOT-+s.CHISO_CU),s.TONG=""+(+S.UOCCHISOCHOT-+s.CHISO_CU),s.IS_SELECTED="0",s.SLUONG_THAO="0",s.MA_DVICTREN="PK",s.IS_SELECTED="0",s.FLAG="X",s.MA_TTCTO="",s.MA_CNANG="80",s.NGUOI_SUA=n.userCmis.USERNAME,s.NGUOI_TAO=n.userCmis.USERNAME,m.push(s),c.push(s.MA_KHANG))}let C={LST_CHISO:m,LST_LICH:[a.lstLichgcs[0]],LST_CSUAT_DDO:[]};console.log("change",c),console.log(C),yield n.chiSoSV.ExcuteNhapCSDoiGia(C),n.maSoGSCs.find(T=>T.maSo==e).SL=c.length})()}layDuLieu(e){var n=this;return(0,g.Z)(function*(){let o={MA_SOGCS:e,KY:1,THANG:+`${n.startDay.getMonth()+1}`,NAM:+`${n.startDay.getFullYear()}`,MA_DVIQLY:n.userCmis.SUBDIVISIONID},a=yield n.chiSoSV.get_Lich_SoGCS(o),l={THANG_HT:+`${n.startDay.getMonth()+1}`,NAM_HT:+`${n.startDay.getFullYear()}`,NGAY_DKY:N()(a.lstLichgcs[0].ngayDky).format("DD/MM/YYYY"),NGAY_CKY:n.NGAY_CKY},u=yield n.chiSoSV.getDDoSoGCS(Object.assign(o,l));console.log(u);let h={KY:o.KY,THANG:o.THANG,IS_CHUANHAPCSO:!0,NAM:o.NAM,MA_SOGCS:o.MA_SOGCS,MA_DVIQLY:o.MA_DVIQLY,NGAY_CKY:N()(n.NGAY_CKY,"DD/MM/YYYY").add(1,"days").format("DD/MM/YYYY"),LST_DDO:u},p=yield n.chiSoSV.getChiso_DGia(h);console.log(p);let m=[],c=[];if(0==n.dataChiSo.length)return alert("Ch\u01b0a c\xf3 d\u1eef li\u1ec7u \u01b0\u1edbc");for(let T=0;T<p.length;T++){let S,s=p[T];for(let G=0;G<n.dataChiSo.length;G++){const I=n.dataChiSo[G];if(I.MA_KHANG==s.MA_KHANG&&s.BCS==I.BCS){S=I;break}S=null}"CCS"==s.LOAICHISO||null==S||"SAN_LUONG"in s||+s.CHISO_CU>=+S.UOCCHISOCHOT?(console.log("SAN_LUONG"in s,s),s.DIEN_GIAI="\u0110\u01b0\u1ee3c s\u1eeda \u0111\u1ed5i",s.STT_GOC=s.STT,s.DMLTYPE="",s.TEN_CAPDA="1"==s.MA_CAPDA?["D\u01b0\u1edbi 380V"]:["T\u1eeb 380V \u0111\u1ebfn d\u01b0\u1edbi 6kV"],s.NGAY_CHOT=s.NGAY_DKY,s.TONG=s.SAN_LUONG,m.push(s)):"DDK"==s.LOAICHISO&&null!=S&&(s.DIEN_GIAI="\u0110\u01b0\u1ee3c s\u1eeda \u0111\u1ed5i",s.STT_GOC=s.STT,s.DMLTYPE="Insert",s.TEN_CAPDA="1"==s.MA_CAPDA?["D\u01b0\u1edbi 380V"]:["T\u1eeb 380V \u0111\u1ebfn d\u01b0\u1edbi 6kV"],s.CHISO_MOI=`${S.UOCCHISOCHOT}`,s.NGAY_CHOT=s.NGAY_DKY,s.NGAY_CKY=n.NGAY_CKY,s.SAN_LUONG=""+(+S.UOCCHISOCHOT-+s.CHISO_CU),s.TONG=""+(+S.UOCCHISOCHOT-+s.CHISO_CU),s.IS_SELECTED="0",s.SLUONG_THAO="0",s.MA_DVICTREN="PK",s.IS_SELECTED="0",s.FLAG="X",s.MA_TTCTO="",s.MA_CNANG="80",s.NGUOI_SUA=n.userCmis.USERNAME,s.NGUOI_TAO=n.userCmis.USERNAME,s.DMLTYPE_CS="",m.push(s),c.push(s.MA_KHANG))}let C={LST_CHISO:m,LST_LICH:[a.lstLichgcs[0]],LST_CSUAT_DDO:[]};console.log("change",c),console.log(C),yield n.chiSoSV.ExcuteNhapCSDoiGia(C),n.maSoGSCs.find(T=>T.maSo==e).SL=c.length})()}getMonth(e){console.log(e),this.startDay=N()(e,"MM/YYYY").toDate(),this.thang=`${this.startDay.getMonth()+1}`,this.nam=`${this.startDay.getFullYear()}`}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(Me),t.Y36(nt.v))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-nhap-chi-so-dinh-ky"]],decls:11,vars:5,consts:[[1,"container","pt-4"],[3,"label","startDay","month"],[1,"row"],["matInput","","placeholder","M\xe3 s\u1ed1",3,"ngModel","ngModelChange"],["type","button",3,"click"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"app-month-year",1),t.NdJ("month",function(a){return n.getMonth(a)}),t.qZA(),t.TgZ(2,"p"),t._uU(3),t.qZA(),t.TgZ(4,"p"),t._uU(5),t.qZA(),t.TgZ(6,"div",2)(7,"mat-form-field")(8,"input",3),t.NdJ("ngModelChange",function(a){return n.maSo=a}),t.qZA()(),t.TgZ(9,"button",4),t.NdJ("click",function(){return n.test()}),t._uU(10," test"),t.qZA()()()),2&e&&(t.xp6(1),t.Q6J("label","K\u1ef3 ghi ch\u1ec9 s\u1ed1")("startDay",n.startDay),t.xp6(2),t.hij("Th\xe1ng: ",n.thang,""),t.xp6(2),t.hij("N\u0103m: ",n.nam,""),t.xp6(3),t.Q6J("ngModel",n.maSo))},dependencies:[d.Fj,d.JJ,d.On,Z.Nt,M.KE,P.k]}),i})();var _t=D(56709);function fe(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"ul")(1,"mat-radio-button",11),t.NdJ("click",function(){const a=t.CHM(e).$implicit,l=t.oxw(2);return t.KtG(l.maYeuCau=a.MA_YCAU_KNAI)}),t._uU(2),t.qZA()()}if(2&i){const e=r.$implicit;t.xp6(2),t.lnq("",e.MA_YCAU_KNAI," - ",e.NGAY_TNHAN," - ",e.NOI_DUNG_YCAU,"")}}function Ee(i,r){if(1&i&&(t.TgZ(0,"div",1),t.YNc(1,fe,3,3,"ul",7),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",e.dsYeuCau)}}function Ue(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"span")(1,"mat-checkbox",12),t.NdJ("change",function(o){const l=t.CHM(e).$implicit,u=t.oxw();return t.KtG(u.onCheckboxChange(o,l))}),t._uU(2),t.qZA()()}if(2&i){const e=r.$implicit;t.xp6(2),t.hij(" ",e._id," ")}}function Ze(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"pre"),t._uU(1,"    "),t.TgZ(2,"button",13),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.getData())}),t._uU(3,"xem"),t.qZA(),t._uU(4),t.ALo(5,"json"),t.qZA()}if(2&i){const e=t.oxw();t.xp6(4),t.hij("\n    ",t.lcZ(5,1,e.item),"\n  ")}}let be=(()=>{class i{constructor(e,n,o,a,l,u){this.cmis4SV=e,this.docxSV=n,this.plus=o,this.loadSV=a,this.sheetdbSV=l,this.kyQuySV=u,this.api="cmis4-in-hop-dong",this.maYeuCau="",this.maKH="",this.item=null,this.dev=!X.N.production,this.dmDichVu=[],this.dsYeuCau=[],this.loaiHD=!1,this.isKyQuy=!1,this.istcd=!1,this.is1TR=!1,this.tkk=[],this.ttkcheck=[],this.lienhes=""}ngOnInit(){this.cmis4SV.getDanhMuc().then(e=>{console.log("Danh m\u1ee5c d\u1ecbch v\u1ee5:",e)}).catch(e=>{console.error("Error fetching danh m\u1ee5c:",e)}),this.getTTK()}getTTK(){var e=this;return(0,g.Z)(function*(){e.sheetdbSV.get("1duYS3zmzr_dyLfh3AIIBRw5K0rqZeVGkgEXmpG-QDmU","TTK").subscribe(n=>{e.tkk=n.data,console.log("Response from getTTK:",n)})})()}onCheckboxChange(e,n){console.log("Checkbox changed:",e,n),this.ttkcheck=e.checked?[...this.ttkcheck,n]:this.ttkcheck.filter(o=>o!==n),"istcd"==n&&e.checked&&(this.istcd=!0),"is1TR"==n&&e.checked&&(this.is1TR=!0)}getYeuCau(){var e=this;return(0,g.Z)(function*(){e.cmis4SV.timKiemYeuCau(e.cmis4SV.convertPK(e.maKH)).then(n=>{console.log("Response from timKiemYeuCau:",n),Array.isArray(n)&&(e.dsYeuCau=n),1==n.length?e.maYeuCau=n[0].MA_YCAU_KNAI:e.dsYeuCau=n,e.loadSV.clear()}).catch(n=>{console.error("Error in timKiemYeuCau:",n)})})()}xemlienhe(e){""!=e&&this.cmis4SV.layTtinKHangMoinhat(this.cmis4SV.convertPK(e)).then(n=>{Array.isArray(n.HDG_KHANG_LIENHE)&&(this.lienhes=n.HDG_KHANG_LIENHE.map(o=>o.DTHOAI_DVU).join(" - "))})}getData(){var e=this;return(0,g.Z)(function*(){e.xemlienhe(e.maKH);let n=e.loaiHD?"HDNH":"HDNSH",o=yield e.cmis4SV.getDataDuThao(e.maYeuCau,n),a=yield e.cmis4SV.DataPhanHeCapDien(e.maYeuCau);console.log("duthao",o);let h=[];h.push(o.DTHOAI),h.push(o.DTHOAI_DD);let p="TYPE"in a?[]:a.bangCdKhangLienhe.map(C=>C.DTHOAI_DVU||"");h.concat(p).filter(C=>`${C}`.length>9),h=[...new Set(h)];let m="CT"==o.NGAY_GCS?"Ng\xe0y cu\u1ed1i c\xf9ng c\u1ee7a m\u1ed7i th\xe1ng":"15;CT"==o.NGAY_GCS?"Ng\xe0y 15 v\xe0 ng\xe0y cu\u1ed1i c\xf9ng c\u1ee7a m\u1ed7i th\xe1ng":"Ng\xe0y 10, 20 v\xe0 ng\xe0y cu\u1ed1i c\xf9ng c\u1ee7a m\u1ed7i th\xe1ng",c={};c.DU_THAO=o,c.DATA_CAP_DIEN=a,c.s1=o.SO_HDONG1,c.s2=o.SO_HDONG2,c.s3=o.SO_HDONG3,c.s4=o.SO_HDONG4,c.s5=o.SO_HDONG5,c.s6=o.SO_HDONG6,c.s7=o.SO_HDONG7,c.s8=o.SO_HDONG8,c.s9=o.SO_HDONG9,c.s10=o.SO_HDONG10,c.s11=o.SO_HOP_DONG3,c.s12=o.SO_HOP_DONG4,c.s13=o.SO_HOP_DONG5,c.s14=o.SO_HOP_DONG6,c.s15=o.SO_HOP_DONG7,c.s16=o.SO_HOP_DONG8,c.TEN_DDIEN=o.TEN_DDIEN,c.CHUC_VU_DD=o.CHUC_VU_DD,c.MA_HDONG=o.MA_HDONG,c.SO_HDONG=o.MA_HDONG.slice(8),c.HLUC_TUNGAY=o.HLUC_TUNGAY_FULL,c.HLUC_DENNGAY=o.HLUC_DENNGAY,c.DCHI_DDIEN=o.DIA_CHI_KH,c.DTHOAI=o.DTHOAI||"          ",c.DTHOAI_DD=e.lienhes.length>0?e.lienhes:h.join(" - "),c.DTHOAI_DDIEN=c.DTHOAI_DD||"          ",c.TEN_KHANG=o.TEN_KHANG,c.TEN_NHANG_KH=o.TEN_NHANG_KH||"          ",c.TKHOAN_KHANG=o.TKHOAN_KHANG||"          ",c.MA_KHANG=o.MA_KHANG,c.MASO_THUE=o.MASO_THUE_KHACH?o.MASO_THUE_KHACH:o.MASO_THUE_KH?o.MASO_THUE_KH:o.CAUHINHIN[0].GIAY_KDOANH||"          ",c.GPKD=o.CAUHINHIN.length>0?`S\u1ed1 ${o.CAUHINHIN[0].GIAY_KDOANH} do ${o.CAUHINHIN[0].DVI_CAP_KDOANH} c\u1ea5p ng\xe0y ${o.CAUHINHIN[0].NGAY_CAP_KDOANH}`:"          ",c.EMAIL=o.EMAIL_KH||"",c.TEN_DDIEN=o.TEN_DDIEN,c.CHUC_VU_DDIEN=o.CHUC_VU_DD,c.MASO_DVIQHNS=o.MASO_DVIQHNS||"          ",c.SO_CMT=o.SO_CMT||"          ",c.NGAY_CAP=o.NGAY_CAP_CMT_FULL||"          ",c.NOI_CAP=o.NOI_CAP||"          ",c.UY_QUYEN=o.NGUOI_UQUYEN_KH?`(Theo v\u0103n b\u1ea3n u\u1ef7 quy\u1ec1n: S\u1ed1 ${o.SOGIAY_UQUYEN} c\u1ee7a \xf4ng (b\xe0) ${o.NGUOI_UQUYEN_KH} - Ch\u1ee9c v\u1ee5 ${o.CVU_UQUYENKH} v\xe0o ng\xe0y ${o.NGAYUQ_KH_FLL})`:"",c.DIA_CHI_DDO=o.PLUCHDONG[0].DDIEM_DDIEN,c.MUC_DICH=o.PLUCHDONG[0].MUC_DICHSD,c.DIEN_AP=o.PLUCHDONG[0].DIEN_AP||"          ",c.DONVI_DIENAP=o.PLUCHDONG[0].DONVI_DIENAP||"          ",c.P_TBINH=o.PLUCHDONG[0].P_TBINH||"          ",c.PMAX=o.PLUCHDONG[0].PMAX||"5",c.PMIN=o.PLUCHDONG[0].PMIN||"",c.A_TBINH=o.PLUCHDONG[0].A_TBINH||"350",c.NGAY_GCS=m||"          ",c.TRACH_NHIEM=e.istcd||e.is1TR?"B":"A",c.SOLAN_TTOAN=o.PLUCHDONG[0].SO_KY||"          ",c.THOIHAN_TTOAN=o.CAUHINHIN[0].THOIHAN_TTOAN||7,c.DIEM_DAUNOI=o.PLUCHDONG[0].DIEM_DAUNOI||"          ",c.RGIOI_SOHUU=e.istcd||e.is1TR?o.PLUCHDONG[0].RGIOI_SOHUU:"T\u1eeb MCB t\u1ed5ng tr\u1edf v\u1ec1 l\u01b0\u1edbi \u0111i\u1ec7n qu\u1ed1c gia l\xe0 t\xe0i s\u1ea3n thu\u1ed9c s\u1edf h\u1eefu c\u1ee7a b\xean A; \u0111\u01b0\u1eddng d\xe2y h\u1ea1 th\u1ebf sau MCB t\u1ed5ng \u0111\u1ebfn n\u01a1i s\u1eed d\u1ee5ng \u0111i\u1ec7n l\xe0 t\xe0i s\u1ea3n thu\u1ed9c s\u1edf h\u1eefu c\u1ee7a b\xean B",c.RGIOI_VHANH=o.PLUCHDONG[0].RGIOI_VHANH||"          ",c.STIEN_DCOC=e.plus.cleanToNumber(o.CAUHINHIN[0].TIEN_DBAO_HDONG||o.STIEN_DCOC||0),c.SO_NGAYBD1=o.CAUHINHIN[0].SO_NGAYBD1||"          ",c.HTHUC_DBAO_HDONG=o.CAUHINHIN[0].HTHUC_DBAO_HDONG||"",c.KY_QUY=+c.STIEN_DCOC>0?"C\xf3":"Kh\xf4ng",c.KIMUA_CSPK=1==+o.KIMUA_CSPK?"C\xf3":"Kh\xf4ng",1==+o.KIMUA_CSPK&&e.ttkcheck.unshift({_id:"40k",NoiDung:"Khi B\xean B thay \u0111\u1ed5i c\xf4ng su\u1ea5t v\xe0 s\u1ea3n l\u01b0\u1ee3ng \u0111i\u1ec7n \u0111\xe3 th\u1ecfa thu\u1eadn trong h\u1ee3p \u0111\u1ed3ng n\xe0y th\xec b\xean B ph\u1ea3i g\u1eedi v\u0103n b\u1ea3n \u0111\u0103ng k\xfd, b\u1ea3ng k\xea c\xf4ng su\u1ea5t thi\u1ebft b\u1ecb v\xe0 bi\u1ec3u \u0111\u1ed3 ph\u1ee5 t\u1ea3i ng\xe0y s\u1ea3n xu\u1ea5t \u0111i\u1ec3n h\xecnh cho b\xean A tr\u01b0\u1edbc 60 ng\xe0y. B\u1ea3ng \u0111\u0103ng k\xfd ch\u1ebf \u0111\u1ed9 s\u1eed d\u1ee5ng \u0111i\u1ec7n c\xf9ng bi\u1ec3u \u0111\u1ed3 ph\u1ee5 t\u1ea3i m\u1edbi \u0111\xe3 \u0111\u01b0\u1ee3c 02 b\xean th\u1ed1ng nh\u1ea5t \u0111\u01b0\u1ee3c xem l\xe0 ph\u1ee5 l\u1ee5c c\u1ee7a h\u1ee3p \u0111\u1ed3ng n\xe0y v\xe0 thay th\u1ebf cho ch\u1ebf \u0111\u1ed9 s\u1eed d\u1ee5ng \u0111i\u1ec7n \u0111\xe3 \u0111\u0103ng k\xfd tr\u01b0\u1edbc \u0111\xf3."}),c.THOA_THUAN_KHAC=e.ttkcheck.map(C=>C.NoiDung).filter(C=>""!==C),c.HIEU_LUC_TEXT=+c.STIEN_DCOC>0?"Hi\u1ec7u l\u1ef1c h\u1ee3p \u0111\u1ed3ng l\xe0 ng\xe0y \u0111\u1ebfn tr\u01b0\u1edbc gi\u1eefa ng\xe0y B\xean A nh\u1eadn \u0111\u01b0\u1ee3c t\xe0i li\u1ec7u x\xe1c nh\u1eadn/ch\u1ee9ng minh ho\xe0n t\u1ea5t vi\u1ec7c x\xe1c l\u1eadp b\u1ea3o \u0111\u1ea3m h\u1ee3p \u0111\u1ed3ng v\xe0 "+(e.istcd?"ng\xe0y \u0111\xf3ng \u0111i\u1ec7n v\u1eadn h\xe0nh":"ng\xe0y treo thi\u1ebft b\u1ecb \u0111o \u0111\u1ebfm"):`Hi\u1ec7u l\u1ef1c h\u1ee3p \u0111\u1ed3ng k\u1ec3 t\u1eeb ng\xe0y ${o.HLUC_TUNGAY_FULL}`,Array.isArray(a.bangCdKhangLienhe)?(c.LIEN_HE=a.bangCdKhangLienhe,c.LIEN_HE[0].TEN_KH_LHE=c.TEN_DDIEN):c.LIEN_HE=[{TEN_KH_LHE:c.TEN_DDIEN,DTHOAI_DVU:c.DTHOAI}],o.DDOGIA&&Array.isArray(o.DDOGIA)&&(c.DDOGIA=o.DDOGIA.map(C=>({...C,MUC_DICH:o.PLUCHDONG[0].MUC_DICHSD}))),e.item=e.item?Object.assign(c,e.item):c,console.log("body",e.item)})()}exportDocx(){var e=this;return(0,g.Z)(function*(){yield e.getData(),e.docxSV.loadFileUrl(`https://thuctd.github.io/templates/CMIS/${e.is1TR?"HD-NSH-1Tr":e.istcd?"HD-NSH-TCD":"HD-NSH"}.docx`).then(o=>{e.docxSV.generateOne(e.item,o,`${e.maYeuCau}-${e.cmis4SV.convertPK(e.maKH)}-HD-NSH.docx`).then(a=>{e.plus.alertSuccess(),e.reset()})})})()}exportCongNo(){var e=this;return(0,g.Z)(function*(){yield e.getData(),e.docxSV.loadFileUrl("https://thuctd.github.io/templates/CMIS/CongNo-App.docx").then(n=>{e.docxSV.generateOne(e.item,n,`${e.maYeuCau}-CongNo.docx`).then(o=>{e.plus.alertSuccess()})})})()}addKyQuy(){var e=this;return(0,g.Z)(function*(){if(yield e.getData(),13!=e.cmis4SV.convertPK(e.maKH).length)return void e.plus.alertError("Vui l\xf2ng nh\u1eadp m\xe3 kh\xe1ch h\xe0ng tr\u01b0\u1edbc khi th\xeam v\xe0o k\xfd qu\u1ef9");let o={MA_KHANG:e.cmis4SV.convertPK(e.maKH),TEN_KHANG:e.item.TEN_KHANG,STIEN_DCOC:e.item.STIEN_DCOC,HLUC_DENNGAY:e.item.HLUC_DENNGAY,HTHUC_DBAO_HDONG:e.item.HTHUC_DBAO_HDONG,HLUC_TUNGAY:e.item.HLUC_TUNGAY,DCHI_DDIEN:e.item.DCHI_DDIEN,DTHOAI_DD:e.item.DTHOAI_DDIEN,TRANG_THAI:ot.G9.CHUATH,status:1,_id:e.cmis4SV.convertPK(e.maKH),dateModify:Date.now()};e.kyQuySV.updateApi(o).subscribe(()=>{e.plus.alertSuccess("\u0110\xe3 th\xeam v\xe0o k\xfd qu\u1ef9 th\xe0nh c\xf4ng")})})()}reload(){this.plus.reload()}reset(){this.maYeuCau="",this.maKH="",this.item=null,this.dsYeuCau=[]}checkPer(e,n=this.api){return!!window.max&&window.max.opt[n]>e}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(O.a),t.Y36(J.E),t.Y36(f.T),t.Y36(K.b),t.Y36(V.F),t.Y36(ot.fq))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-in-hop-dong"]],decls:27,vars:7,consts:[[1,"container","pt-3"],[1,"row"],["matInput","","placeholder","M\xe3 kh\xe1ch h\xe0ng",3,"ngModel","keydown.enter","ngModelChange"],[1,"btn"],["mat-raised-button","","color","primary",3,"click"],["mat-icon-button","",3,"click"],["class","row",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"py-3",3,"ngModel","change","ngModelChange"],["mat-raised-button","","color","accent",3,"click"],[4,"ngIf"],[3,"click"],[3,"change"],["mat-button","",3,"click"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"mat-form-field")(3,"input",2),t.NdJ("keydown.enter",function(){return n.getYeuCau()})("ngModelChange",function(a){return n.maKH=a}),t.qZA()(),t.TgZ(4,"div",3)(5,"button",4),t.NdJ("click",function(){return n.getYeuCau()}),t._uU(6," T\xecm y\xeau c\u1ea7u"),t.qZA(),t.TgZ(7,"button",5),t.NdJ("click",function(){return n.reload()}),t.TgZ(8,"mat-icon"),t._uU(9,"refresh"),t.qZA()()(),t.YNc(10,Ee,2,1,"div",6),t.TgZ(11,"div",1),t.YNc(12,Ue,3,1,"span",7),t.TgZ(13,"mat-slide-toggle",8),t.NdJ("change",function(a){return n.onCheckboxChange(a,"loaiHD")})("ngModelChange",function(a){return n.loaiHD=a}),t._uU(14,"Ng\u1eafn h\u1ea1n"),t.qZA(),t.TgZ(15,"mat-slide-toggle",8),t.NdJ("change",function(a){return n.onCheckboxChange(a,"istcd")})("ngModelChange",function(a){return n.istcd=a}),t._uU(16,"C\xf3 tr\u1ea1m chuy\xean d\xf9ng"),t.qZA(),t.TgZ(17,"mat-slide-toggle",8),t.NdJ("change",function(a){return n.onCheckboxChange(a,"is1TR")})("ngModelChange",function(a){return n.is1TR=a}),t._uU(18,"KH 02 ph\xe2n k\u1ef3 ho\u1eb7c xi m\u0103ng/s\u1eaft th\xe9p "),t.qZA(),t.TgZ(19,"div",3)(20,"button",9),t.NdJ("click",function(){return n.exportDocx()}),t._uU(21," Xu\u1ea5t file"),t.qZA(),t.TgZ(22,"button",4),t.NdJ("click",function(){return n.exportCongNo()}),t._uU(23," C\xf4ng n\u1ee3"),t.qZA(),t.TgZ(24,"button",4),t.NdJ("click",function(){return n.addKyQuy()}),t._uU(25," Th\xeam v\xe0o k\xfd qu\u1ef9"),t.qZA()()()()(),t.YNc(26,Ze,6,3,"pre",10)),2&e&&(t.xp6(3),t.Q6J("ngModel",n.maKH),t.xp6(7),t.Q6J("ngIf",n.dsYeuCau.length>0),t.xp6(2),t.Q6J("ngForOf",n.tkk),t.xp6(1),t.Q6J("ngModel",n.loaiHD),t.xp6(2),t.Q6J("ngModel",n.istcd),t.xp6(2),t.Q6J("ngModel",n.is1TR),t.xp6(9),t.Q6J("ngIf",n.checkPer(4)))},dependencies:[H.sg,H.O5,d.Fj,d.JJ,d.On,B.Rr,_t.oG,$.U0,Y.lW,Y.RK,L.Hw,Z.Nt,M.KE,H.Ts]}),i})();var ye=D(17489);function Ke(i,r){if(1&i&&t._UZ(0,"div",10),2&i){const e=t.oxw();t.Q6J("innerHTML",e.html,t.oJD)}}let Le=(()=>{class i{constructor(e,n,o,a){this.http=e,this.cmis4SV=n,this.plus=o,this.excelSV=a,this.url=localStorage.getItem("CMIS4-TOOLS-URL"),this.body=null,this.html="",this.items=[],this.gomFile=!1}ngOnInit(){}loopRequest(){(0,E.D)(this.dataInXls).pipe((0,U.b)(e=>this.request(e))).subscribe()}convert(){let e=JSON.parse(this.body);e.name='=C2&TEXT(B2;"00")',this.dataInXls=Array.isArray(e)?e:[e],this.excelSV.export(this.dataInXls,"tools")}request(e){var n=this;return(0,g.Z)(function*(){(0,ye.isString)(e)&&(e=JSON.parse(e));let o=e.name||"cmis4";return delete e.name,console.log(e,o,n.url),localStorage.setItem("CMIS4-TOOLS-URL",n.url),n.cmis4SV.cmis4Request(n.url,"",e).then(a=>{if(n.gomFile)return a.forEach(l=>{l.name=o}),void(n.items=n.items.concat(a));Array.isArray(a)&&a.length>0?n.excelSV.export(a,o):n.excelSV.exportMultiSheets(a,o)})})()}exportMau(){this.excelSV.export([{url:"",body:"",name:""}],"mau")}export(){this.excelSV.export(this.items,"cmis4")}onDropFile(e){console.log("onDropFile()");for(let n=0;n<e.length;n++)"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"==e[n].type?this.excelSV.fileToJsonArray(e[n]).then(o=>{this.dataInXls=o}):this.plus.alertError("File kh\xf4ng h\u1ee3p l\u1ec7")}ondragover(){document.getElementById("dropZone").setAttribute("drop-active","true")}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(rt.eN),t.Y36(O.a),t.Y36(f.T),t.Y36(b.x))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-cmis-tool"]],decls:20,vars:5,consts:[[1,"container"],[3,"label","files","ondragover"],[1,"row"],["matInput","","placeholder","URL",3,"ngModel","ngModelChange"],["matInput","","placeholder","Body",3,"ngModel","ngModelChange"],["color","primary","mat-raised-button","",3,"click"],["mat-raised-button","","color","primay",3,"click"],["mat-raised-button","","color","warn",3,"click"],[3,"ngModel","ngModelChange"],["class","row",3,"innerHTML",4,"ngIf"],[1,"row",3,"innerHTML"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"app-drop-files",1),t.NdJ("files",function(a){return n.onDropFile(a)})("ondragover",function(){return n.ondragover()}),t.qZA(),t.TgZ(2,"div",2)(3,"mat-form-field")(4,"input",3),t.NdJ("ngModelChange",function(a){return n.url=a}),t.qZA()(),t.TgZ(5,"mat-form-field")(6,"textarea",4),t.NdJ("ngModelChange",function(a){return n.body=a}),t.qZA()()(),t.TgZ(7,"button",5),t.NdJ("click",function(){return n.convert()}),t.TgZ(8,"mat-icon"),t._uU(9,"download"),t.qZA()(),t.TgZ(10,"button",6),t.NdJ("click",function(){return n.request(n.body)}),t._uU(11,"OK"),t.qZA(),t.TgZ(12,"button",7),t.NdJ("click",function(){return n.loopRequest()}),t._uU(13,"Loop"),t.qZA(),t.TgZ(14,"mat-slide-toggle",8),t.NdJ("ngModelChange",function(a){return n.gomFile=a}),t._uU(15,"Gom l\u1ea1i"),t.qZA(),t.TgZ(16,"button",5),t.NdJ("click",function(){return n.export()}),t.TgZ(17,"mat-icon"),t._uU(18,"download"),t.qZA()(),t.YNc(19,Ke,1,1,"div",9),t.qZA()),2&e&&(t.xp6(1),t.Q6J("label","Nh\u1edb th\xeam c\u1ed9t name"),t.xp6(3),t.Q6J("ngModel",n.url),t.xp6(2),t.Q6J("ngModel",n.body),t.xp6(8),t.Q6J("ngModel",n.gomFile),t.xp6(5),t.Q6J("ngIf",n.html.length>0))},dependencies:[H.O5,d.Fj,d.JJ,d.On,B.Rr,Y.lW,L.Hw,Z.Nt,M.KE,F.k]}),i})();function ve(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"button",10),t.NdJ("click",function(){t.CHM(e);const o=t.oxw(2);return t.KtG(o.exportSMS(2))}),t._uU(1,"SMS l\u1ea7n 1"),t.qZA()}}function xe(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"button",10),t.NdJ("click",function(){t.CHM(e);const o=t.oxw(2);return t.KtG(o.exportSMS(3))}),t._uU(1,"SMS ng\u1eebng"),t.qZA()}}function Be(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"div",9)(1,"button",10),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.exportSMS(1))}),t._uU(2,"SMS TB"),t.qZA(),t.YNc(3,ve,2,0,"button",11),t.YNc(4,xe,2,0,"button",11),t.TgZ(5,"button",12),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.export())}),t._uU(6,"Excel"),t.qZA()()}if(2&i){const e=t.oxw();t.xp6(3),t.Q6J("ngIf",(null==e.cutDay?null:e.cutDay.length)>0),t.xp6(1),t.Q6J("ngIf",(null==e.cutDay?null:e.cutDay.length)>0)}}let Ve=(()=>{class i{constructor(e,n,o,a){this.cmis4SV=e,this.excelSV=n,this.plus=o,this.idbSV=a,this.dbName="kinh-doanh",this.api="ky-quy",this.db=null,this.startDay="",this.items=[],this.tableHtml="",this.initDate=new Date}ngOnInit(){this.idbSV.IDB_InitDB(this.dbName).subscribe(e=>{this.db=e,this.getData()})}exportSMSTB(){let e=[];for(let n=0;n<this.items.length;n++){const o=this.items[n],a=o.TEN_KHANG.match(/^(.*?)(?:\.|\s)*sdt:\s*(\d{10,11})/i);let l={SDT:a?o.TEN_KHANG.match(/sdt:\s*(\d{10,11})/)[1]:"",ND:`\u0110QL \u0111i\u1ec7n Xu\xe2n L\u1ed9c \u0111\u1ec1 ngh\u1ecb Qu\xfd KH ${a?a[1].trim():o.TEN_KHANG}-${o.MA_KHANG} mang CCCD, h\u1ed3 s\u01a1 \u0111\u1ea5t \u0111\u1ebfn v\u0103n ph\xf2ng \u0110LXL gia h\u1ea1n h\u1ee3p \u0111\u1ed3ng mua b\xe1n \u0111i\u1ec7n do H\u0110MB\u0110 s\u1ebd h\u1ebft h\u1ea1n v\xe0o ng\xe0y ${o.HLUC_DENNGAY}. Tr\xe2n tr\u1ecdng`,SL:1,MA_KHANG:o.MA_KHANG};e.push(l)}this.excelSV.export(e,"SMS")}exportSMS(e){let n=[];n.push({SDT:"0968647647",ND:"\u0110QL \u0111i\u1ec7n Xu\xe2n L\u1ed9c TB h\u1ee3p \u0111\u1ed3ng mua b\xe1n \u0111i\u1ec7n c\u1ee7a Qu\xfd KH s\u1ebd h\u1ebft h\u1ea1n v\xe0o ng\xe0y 30/11/2023. Vui l\xf2ng mang CCCD, h\u1ed3 s\u01a1 \u0111\u1ea5t \u0111\u1ebfn v\u0103n ph\xf2ng \u0110LXL gia h\u1ea1n tr\u01b0\u1edbc ng\xe0y 15/11/2023 \u0111\u1ec3 tr\xe1nh b\u1ecb ng\u1eebng c\u1ea5p \u0111i\u1ec7n. Tr\xe2n tr\u1ecdng",SL:1});for(let o=0;o<this.items.length;o++){const a=this.items[o],l=a.TEN_KHANG.match(/^(.*?)(?:\.|\s)*sdt:\s*(\d{10,11})/i);let u=N()(a.HLUC_DENNGAY,"DD/MM/YYYY").subtract(15,"days").format("DD/MM/YYYY");N()(u,"DD/MM/YYYY").isBefore(N()())&&(u=N()().add(7,"days").format("DD/MM/YYYY"));let h={SDT:l?a.TEN_KHANG.match(/sdt:\s*(\d{10,11})/)[1]:""};switch(e){case 1:h.ND=`\u0110QL \u0111i\u1ec7n Xu\xe2n L\u1ed9c TB h\u1ee3p \u0111\u1ed3ng mua b\xe1n \u0111i\u1ec7n c\u1ee7a Qu\xfd KH ${l?l[1].trim():a.TEN_KHANG}-${a.MA_KHANG} s\u1eafp h\u1ebft h\u1ea1n. Vui l\xf2ng mang CCCD, h\u1ed3 s\u01a1 \u0111\u1ea5t \u0111\u1ebfn v\u0103n ph\xf2ng DQL \u0111i\u1ec7n Xu\xe2n L\u1ed9c gia h\u1ea1n tr\u01b0\u1edbc ng\xe0y ${this.cutDay} \u0111\u1ec3 tr\xe1nh b\u1ecb ng\u1eebng c\u1ea5p \u0111i\u1ec7n. Tr\xe2n tr\u1ecdng`;break;case 2:h.ND=`\u0110QL \u0111i\u1ec7n Xu\xe2n L\u1ed9c \u0111\u1ec1 ngh\u1ecb Qu\xfd KH ${l?l[1].trim():a.TEN_KHANG}-${a.MA_KHANG} mang CCCD, h\u1ed3 s\u01a1 \u0111\u1ea5t \u0111\u1ebfn v\u0103n ph\xf2ng \u0110LXL gia h\u1ea1n h\u1ee3p \u0111\u1ed3ng tr\u01b0\u1edbc ng\xe0y ${this.cutDay} \u0111\u1ec3 tr\xe1nh b\u1ecb ng\u1eebng cung c\u1ea5p \u0111i\u1ec7n. Tr\xe2n tr\u1ecdng`;break;case 3:h.ND=`\u0110QL \u0111i\u1ec7n Xu\xe2n L\u1ed9c TB t\u1ea1m ng\u1eebng c\u1ea5p \u0111i\u1ec7n Qu\xfd KH ${l?l[1].trim():a.TEN_KHANG}-${a.MA_KHANG} t\u1eeb ng\xe0y ${this.cutDay} do h\u1ebft h\u1ea1n h\u1ee3p \u0111\u1ed3ng mua b\xe1n \u0111i\u1ec7n. Tr\xe2n tr\u1ecdng`}h.SL=1,h.MA_KHANG=a.MA_KHANG,n.push(h)}this.excelSV.export(n,"SMS")}getData(){var e=this;this.cmis4SV.bcHD22(this.startDay,this.endDay).then(function(){var n=(0,g.Z)(function*(o){console.log(o),e.items=[];for(let a=0;a<o.length;a++){const l=o[a];let u=yield e.idbSV.IDB_DB_GetById(e.db,e.api,l.MA_KHANG),h={MA_KHANG:l.MA_KHANG,TEN_KHANG:l.TEN_KHANG,HLUC_DENNGAY:l.HLUC_DENNGAY,CHUOI_GIA:l.CHUOI_GIA,DIA_CHI:l.DIA_CHI,KYQUY:e.plus.numberWithCommas(u?.STIEN_DCOC||"")};e.items.push(h)}});return function(o){return n.apply(this,arguments)}}()),this.items=this.plus.sortArr(this.items,"HLUC_DENNGAY",1),this.tableHtml=this.plus.generateHtmlTable(this.items)}getMonth(e,n){1==n?this.startDay=e:2==n?this.endDay=e:this.cutDay=e}export(){this.excelSV.export(this.items,"het_han_hdmbd")}getMonthBC(e){this.startDay=N()(e,"MM/YYYY").startOf("month").format("DD/MM/YYYY"),this.endDay=N()(e,"MM/YYYY").endOf("month").format("DD/MM/YYYY")}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(O.a),t.Y36(b.x),t.Y36(f.T),t.Y36(Q.F))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-het-han-hdmbd"]],decls:11,vars:8,consts:[[1,"py-3","container"],[1,"row"],[1,"col"],[3,"label","startDay","month"],[3,"startDay","openOnFocus","label","format","month"],[1,"btn"],["color","primary","mat-raised-button","",3,"click"],["class"," group mt-3",4,"ngIf"],[1,"row",3,"innerHTML"],[1,"group","mt-3"],["color","accent","mat-raised-button","",3,"click"],["color","accent","mat-raised-button","",3,"click",4,"ngIf"],["mat-raised-button","",3,"click"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"app-month-year",3),t.NdJ("month",function(a){return n.getMonthBC(a)}),t.qZA()(),t.TgZ(4,"div",2)(5,"app-date-picker",4),t.NdJ("month",function(a){return n.getMonth(a,3)}),t.qZA()()(),t.TgZ(6,"div",5)(7,"button",6),t.NdJ("click",function(){return n.getData()}),t._uU(8,"T\xecm ki\u1ebfm"),t.qZA()(),t.YNc(9,Be,7,2,"div",7),t._UZ(10,"div",8),t.qZA()),2&e&&(t.xp6(3),t.Q6J("label","Th\xe1ng ba\u0301o c\xe1o")("startDay",n.initDate),t.xp6(2),t.Q6J("startDay",n.cutDay)("openOnFocus",!0)("label","Ng\xe0y")("format","DD/MM/YYYY"),t.xp6(4),t.Q6J("ngIf",n.items.length>0),t.xp6(1),t.Q6J("innerHTML",n.tableHtml,t.oJD))},dependencies:[H.O5,Y.lW,P.k,R.L]}),i})();function qe(i,r){if(1&i&&(t.TgZ(0,"ul",12)(1,"li"),t._uU(2),t.qZA(),t.TgZ(3,"li"),t._uU(4),t.qZA(),t.TgZ(5,"li"),t._uU(6),t.qZA()()),2&i){const e=t.oxw(2);t.xp6(2),t.hij("M\xe3 y\xeau c\u1ea7u: ",e.maYeuCau,""),t.xp6(2),t.hij("Nga\u0300y Ti\u1ebfp nh\u1eadn: ",e.tienTrinh.DV_TIEN_TNHAN[0].NGAY_YCAU,""),t.xp6(2),t.hij("Nga\u0300y h\u1eb9n: ",e.tienTrinh.DV_TIEN_TNHAN[0].NGAY_HEN,"")}}function ke(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"div",2)(1,"mat-form-field")(2,"input",8),t.NdJ("ngModelChange",function(o){t.CHM(e);const a=t.oxw();return t.KtG(a.maYeuCau=o)}),t.qZA()(),t.TgZ(3,"app-date-picker",9),t.NdJ("month",function(o){t.CHM(e);const a=t.oxw();return t.KtG(a.getMonth(o,1))}),t.qZA(),t.TgZ(4,"app-date-picker",9),t.NdJ("month",function(o){t.CHM(e);const a=t.oxw();return t.KtG(a.getMonth(o,2))}),t.qZA(),t.YNc(5,qe,7,3,"ul",10),t.TgZ(6,"div",5)(7,"button",11),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.timYC())}),t._uU(8,"T\xecm ki\u1ebfm"),t.qZA(),t.TgZ(9,"button",11),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.capNhat())}),t._uU(10,"C\u1eadp nh\u1eadt"),t.qZA()()()}if(2&i){const e=t.oxw();t.xp6(2),t.Q6J("ngModel",e.maYeuCau),t.xp6(1),t.Q6J("openOnFocus",!0)("label","Nga\u0300y Ti\u1ebfp nh\u1eadn")("format","DD/MM/YYYY"),t.xp6(1),t.Q6J("openOnFocus",!0)("label","Nga\u0300y h\u1eb9n")("format","DD/MM/YYYY"),t.xp6(1),t.Q6J("ngIf",e.tienTrinh),t.xp6(2),t.Q6J("disabled",0==e.maYeuCau.length),t.xp6(2),t.Q6J("disabled",0==e.maYeuCau.length||0==e.ngayHen.length)}}let Fe=(()=>{class i{constructor(e,n){this.cmis4SV=e,this.plus=n,this.api="cmis4-tiep-nhan-yeu-cau",this.maYeuCau="",this.ngayTiepNhan="",this.ngayHen="",this.tienTrinh=null,this.textInput="",this.htmlCRM=""}ngOnInit(){}parseRequestArray(){let e=this.textInput;const n=[],o=e.split("\n").filter(a=>/^\d{8}/.test(a.trim()));for(let a=0;a<o.length;a++){const l=o[a],u=l.split("\t").map(c=>c.trim()),h={LOAI_YEU_CAU:"",MA_PHIEU:"",MA_KH:"",NGUOI_YEU_CAU:"",NOI_DUNG:"",SO_DT:"",HAN_GQ:""};u[0].match(/^\d{8}$/)&&(h.MA_PHIEU=u[0]),u[1]&&u[1].startsWith("Kh\xe1ch h\xe0ng: ")&&(h.NGUOI_YEU_CAU=u[1].replace("Kh\xe1ch h\xe0ng: ","")),u[2]&&u[2].startsWith("M\xe3 KH: ")&&(h.MA_KH=u[2].replace("M\xe3 KH: ","")),u[3]&&u[3].startsWith("\u0110i\u1ec7n tho\u1ea1i: ")&&(h.SO_DT=u[3].replace("\u0110i\u1ec7n tho\u1ea1i: ","")),u[5]&&u[5].startsWith("Lo\u1ea1i y\xeau c\u1ea7u: ")&&(h.LOAI_YEU_CAU=u[5].replace("Lo\u1ea1i y\xeau c\u1ea7u: ",""));const m=(e.split("\n")[e.split("\n").indexOf(l)+1]||"").split("\t").map(c=>c.trim());if(m[0]&&m[0].startsWith("Ng\u01b0\u1eddi y\xeau c\u1ea7u: ")&&(m[3]&&m[3].startsWith("N\u1ed9i dung y\xeau c\u1ea7u: ")&&(h.NOI_DUNG=m[3].replace("N\u1ed9i dung y\xeau c\u1ea7u: ","")),m[4]&&m[4].match(/^\d{2}\/\d{2}\/\d{4} \d{1,2}:\d{2}:\d{2} (SA|CH)$/))){const c=m[4],C=c.includes("SA"),A=c.replace(" SA","").replace(" CH",""),T=N()(A,"DD/MM/YYYY H:mm:ss");C&&T.hours()>=12?T.subtract(12,"hours"):!C&&T.hours()<12&&T.add(12,"hours"),h.HAN_GQ=T.format("DD/MM/YYYY HH:mm")}h.MA_PHIEU&&n.push(h)}return n.sort((a,l)=>{const u=N()(a.HAN_GQ,"DD/MM/YYYY HH:mm"),h=N()(l.HAN_GQ,"DD/MM/YYYY HH:mm");return u.isValid()&&h.isValid()?u.diff(h):0}),this.htmlCRM=this.plus.generateHtmlTable(n),n}timYC(){var e=this;return(0,g.Z)(function*(){e.tienTrinh=yield e.cmis4SV.layDvTienTiepNhanTheoTinhTrang(e.maYeuCau)})()}capNhat(){var e=this;return(0,g.Z)(function*(){e.tienTrinh.DV_TIEN_TNHAN[0].NGAY_YCAU=e.ngayTiepNhan,e.tienTrinh.DV_TIEN_TNHAN[0].NGAY_TAO=e.ngayTiepNhan,e.tienTrinh.DV_TIEN_TNHAN[0].NGAY_HEN=e.ngayHen,e.cmis4SV.capnhatTienTiepNhan(e.tienTrinh).then(()=>{e.plus.alertSuccess("Ca\u0323\u0302p nha\u0323\u0302t ti\u0300nh tra\u0323ng ti\u0301nh tie\u0302\u0301p nha\u0323\u0302n")})})()}getMonth(e,n){1==n?this.ngayTiepNhan=e:this.ngayHen=e}checkPer(e,n=this.api){return!!window.max&&window.max.opt[n]>e}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(O.a),t.Y36(f.T))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-tiep-nhan-yeu-cau"]],decls:11,vars:3,consts:[[1,"container","py-3"],["class","row",4,"ngIf"],[1,"row"],[1,"example-full-width"],["matInput","",3,"ngModel","ngModelChange"],[1,"btn"],["mat-raised-button","","color","primary",3,"click"],[3,"innerHTML"],["matInput","","placeholder","M\xe3 y\xeau c\u1ea7u",3,"ngModel","ngModelChange"],[3,"openOnFocus","label","format","month"],["class","list-group",4,"ngIf"],["mat-raised-button","","color","primary",3,"disabled","click"],[1,"list-group"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0),t.YNc(1,ke,11,10,"div",1),t.TgZ(2,"div",2)(3,"mat-form-field",3)(4,"mat-label"),t._uU(5,"item"),t.qZA(),t.TgZ(6,"textarea",4),t.NdJ("ngModelChange",function(a){return n.textInput=a}),t.qZA()(),t.TgZ(7,"div",5)(8,"button",6),t.NdJ("click",function(){return n.parseRequestArray()}),t._uU(9,"Xem"),t.qZA()(),t._UZ(10,"div",7),t.qZA()()),2&e&&(t.xp6(1),t.Q6J("ngIf",n.checkPer(4)),t.xp6(5),t.Q6J("ngModel",n.textInput),t.xp6(4),t.Q6J("innerHTML",n.htmlCRM,t.oJD))},dependencies:[H.O5,d.Fj,d.JJ,d.On,Y.lW,Z.Nt,M.KE,M.hX,R.L]}),i})();function Je(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"span")(1,"mat-checkbox",6),t.NdJ("change",function(o){const l=t.CHM(e).$implicit,u=t.oxw();return t.KtG(u.onCheckboxChange(o,l))}),t._uU(2),t.qZA()()}if(2&i){const e=r.$implicit;t.xp6(2),t.hij(" ",e," ")}}let Pe=(()=>{class i{constructor(e,n,o){this.cmis4SV=e,this.sheetdbSV=n,this.docxSV=o,this.donGia=null,this.loaiKD=null,this.listKD=["DoiGia","TreoThao","SoHo"],this.item=null,this.maKH="",this.khachHang=null}ngOnInit(){}getSaoLuc(){var e=this;return(0,g.Z)(function*(){e.khachHang=yield e.cmis4SV.layTtinKHangMoinhat(e.cmis4SV.convertPK(e.maKH)),e.cmis4SV.getSaoLucChiSoCT(e.cmis4SV.convertPK(e.maKH),"5/2025","5/2025").then(n=>{e.item=e.parseInputString(n[0].CHI_TIET_GIA)})})()}onCheckboxChange(e,n){e.checked&&(this.loaiKD=n)}parseInputString(e){return e.split("\r").filter(a=>""!==a.trim()).map(a=>{const l=a.split(":");if(3!==l.length)return null;const u=l[1].split("-");if(2!==u.length)return null;const h=u[0],p=u[1],m=l[2].split("*");if(2!==m.length)return null;const c=parseInt(m[0],10),C=m[1].split("=");if(2!==C.length)return null;const A=parseInt(C[0],10),T=parseInt(C[1],10);return isNaN(c)||isNaN(A)||isNaN(T)?null:{GIA:h,BIEU:p,SL:c,DON_GIA:A,THANH_TIEN:T}}).filter(a=>null!==a)}convertoDoc(){var e=this;return(0,g.Z)(function*(){let n={GC:e.item,GM:e.item,HD:[],CHUOI_GIA:e.khachHang.HDG_KHACH_HANG[0].CHUOI_GIA,TEN_KHANG:e.khachHang.HDG_KHACH_HANG[0].TEN_KHANG,MA_KHANG:e.cmis4SV.convertPK(e.maKH)},o=yield e.docxSV.loadFileUrl(`https://thuctd.github.io/templates/CMIS/KiemDo-${e.loaiKD}.docx`);e.docxSV.generateOne(n,o,e.maKH+"-KiemDo").then(a=>{console.log(a)})})()}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(O.a),t.Y36(V.F),t.Y36(J.E))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-kiem-do-hoa-don"]],decls:16,vars:8,consts:[[1,"container","py-3"],[1,"row"],[4,"ngFor","ngForOf"],["matInput","","placeholder","M\xe3 kh\xe1ch h\xe0ng",3,"ngModel","ngModelChange"],[1,"tbn"],["mat-raised-button","",3,"click"],[3,"change"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"div",1),t.YNc(2,Je,3,1,"span",2),t.TgZ(3,"mat-form-field")(4,"input",3),t.NdJ("ngModelChange",function(a){return n.maKH=a}),t.qZA()(),t.TgZ(5,"div",4)(6,"button",5),t.NdJ("click",function(){return n.getSaoLuc()}),t._uU(7,"L\u1ea5y d\u1eef li\u1ec7u"),t.qZA(),t.TgZ(8,"button",5),t.NdJ("click",function(){return n.convertoDoc()}),t._uU(9,"Xu\u1ea5t file"),t.qZA()(),t.TgZ(10,"pre"),t._uU(11),t.ALo(12,"json"),t.qZA(),t.TgZ(13,"pre"),t._uU(14),t.ALo(15,"json"),t.qZA()()()),2&e&&(t.xp6(2),t.Q6J("ngForOf",n.listKD),t.xp6(2),t.Q6J("ngModel",n.maKH),t.xp6(7),t.Oqu(t.lcZ(12,4,n.khachHang)),t.xp6(3),t.Oqu(t.lcZ(15,6,n.item)))},dependencies:[H.sg,d.Fj,d.JJ,d.On,_t.oG,Y.lW,Z.Nt,M.KE,H.Ts]}),i})(),Qe=(()=>{class i{constructor(e,n,o,a){this.cmis4SV=e,this.excelSV=n,this.plus=o,this.formSV=a,this.makh="",this.maNganSach="",this.ngayCN=N()().subtract(1,"days").format("DD/MM/YYYY"),this.dataInXls=[],this.outHTML="",this.dcocFrom=this.formSV.fb.group({MA_KHANG:""})}ngOnInit(){}loopRequest(){(0,E.D)(this.dataInXls).pipe((0,U.b)(e=>this.capnhatByKey(e.MAPK,e.KEY,e.VALUE))).subscribe()}capnhatByKey(e,n,o){var a=this;return(0,g.Z)(function*(){let l="truongnd1.dn",u=yield a.cmis4SV.timKiemKhachHang(e),h=yield a.cmis4SV.layTtinKHangMoinhat(e);h.HDG_KHACH_HANG[0].MA_CNANG="10",h.HDG_KHACH_HANG[0].NGAY_HLUC=a.ngayCN,h.HDG_KHACH_HANG[0].NGUOI_SUA=l,h.HDG_KHACH_HANG[0].NGUOI_TAO=h.HDG_KHACH_HANG[0].NGUOI_SUA,h.HDG_KHACH_HANG[0][n]=o,h.HDG_KHACH_HANG_U[0].MA_CNANG="10",h.HDG_KHACH_HANG_U[0].NGAY_HHLUC=a.ngayCN,h.HDG_KHACH_HANG_U[0].NGUOI_TAO=h.HDG_KHACH_HANG[0].NGUOI_SUA,h.HDG_KHACH_HANG_U[0][n]=null;let p={HDG_KHACH_HANG:h.HDG_KHACH_HANG,HDG_KHACH_HANG_U:h.HDG_KHACH_HANG_U,HDG_TDOITTIN:[],HDG_TDOITTIN_U:null};return p.HDG_TDOITTIN=[{ID_TDOI:-1,MA_YCAU_KNAI:"",MA_DVIQLY:"PK0500",DCHI_DDIEN:u[0].DIA_CHI_DDO,DCHI_KHANG:u[0].DIA_CHI_KH,DLIEU_CU:"",DLIEU_MOI:o,ID_KT_CU:u[0].ID_KHANG,ID_KT_MOI:"-1",ID_KT_CHA:"",NAMHD:"2025",NAMKH:"2025",THANGHD:"6",THANGKH:"6",TEN_BANG:"HDG_KHACH_HANG",MA_KHANG:e,TEN_KHANG:u[0].TEN_KHANG,MA_DDO:u[0].MA_DDO,MA_CNANG:"10",NGAY_HLUC:a.ngayCN,MA_HDONG:u[0].MA_HDONG,TEN_COT:"MASO_DVIQHNS",NGAY_TAO:N()().format("DD/MM/YYYY HH:mm:ss"),NGAY_SUA:N()().format("DD/MM/YYYY HH:mm:ss"),NGUOI_TAO:l,NGUOI_SUA:l}],a.cmis4SV.themTtinKhang(p).then(m=>{let c=a.dataInXls.findIndex(C=>C.MAPK==e);a.dataInXls[c].MANGANSACH="OK",a.plus.generateHtmlTable(a.dataInXls),console.log(m)})})()}capnhatmaNganSach(e,n){var o=this;return(0,g.Z)(function*(){let a=yield o.cmis4SV.timKiemKhachHang(e),l=yield o.cmis4SV.layTtinKHangMoinhat(e);if(l.HDG_KHACH_HANG[0].MASO_DVIQHNS)return null;l.HDG_KHACH_HANG[0].MA_CNANG="10",l.HDG_KHACH_HANG[0].NGAY_HLUC=o.ngayCN,l.HDG_KHACH_HANG[0].NGUOI_SUA=o.getRandomString(),l.HDG_KHACH_HANG[0].NGUOI_TAO=l.HDG_KHACH_HANG[0].NGUOI_SUA,l.HDG_KHACH_HANG[0].MASO_DVIQHNS=n,l.HDG_KHACH_HANG_U[0].MA_CNANG="10",l.HDG_KHACH_HANG_U[0].NGAY_HHLUC=o.ngayCN,l.HDG_KHACH_HANG_U[0].NGUOI_TAO=l.HDG_KHACH_HANG[0].NGUOI_SUA,l.HDG_KHACH_HANG_U[0].MASO_DVIQHNS=null;let u={HDG_KHACH_HANG:l.HDG_KHACH_HANG,HDG_KHACH_HANG_U:l.HDG_KHACH_HANG_U,HDG_TDOITTIN:[],HDG_TDOITTIN_U:null};return u.HDG_TDOITTIN=[{ID_TDOI:-1,MA_YCAU_KNAI:"",MA_DVIQLY:"PK0500",DCHI_DDIEN:a[0].DIA_CHI_DDO,DCHI_KHANG:a[0].DIA_CHI_KH,DLIEU_CU:"",DLIEU_MOI:n,ID_KT_CU:a[0].ID_KHANG,ID_KT_MOI:"-1",ID_KT_CHA:"",NAMHD:"2025",NAMKH:"2025",THANGHD:"6",THANGKH:"6",TEN_BANG:"HDG_KHACH_HANG",MA_KHANG:e,TEN_KHANG:a[0].TEN_KHANG,MA_DDO:a[0].MA_DDO,MA_CNANG:"10",NGAY_HLUC:o.ngayCN,MA_HDONG:a[0].MA_HDONG,TEN_COT:"MASO_DVIQHNS",NGAY_TAO:N()().format("DD/MM/YYYY HH:mm:ss"),NGAY_SUA:N()().format("DD/MM/YYYY HH:mm:ss"),NGUOI_TAO:"thuctd.dn",NGUOI_SUA:"thuctd.dn"}],o.cmis4SV.themTtinKhang(u).then(h=>{let p=o.dataInXls.findIndex(m=>m.MAPK==e);o.dataInXls[p].MANGANSACH="OK",o.plus.generateHtmlTable(o.dataInXls),console.log(h)})})()}getRandomString(){let e=["truongnd1.dn","trungvl.dn","thuttt.dn","ancn.dn","thuctd.dn","anhnhp.dn"];return e[Math.floor(Math.random()*e.length)]}onDropFile(e){console.log("onDropFile()");for(let n=0;n<e.length;n++)"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"==e[n].type?this.excelSV.fileToJsonArray(e[n]).then(o=>{this.dataInXls=o,console.log(o),this.outHTML=this.plus.generateHtmlTable(this.dataInXls)}):this.plus.alertError("File kh\xf4ng h\u1ee3p l\u1ec7");this.plus.clickBtn("closeImportButton")}ondragover(){document.getElementById("dropZone").setAttribute("drop-active","true")}exportMau(){this.excelSV.export([{MAPK:"PK05001234",KEY:"DTHOAI",VALUE:"0909123456"}],"Mau")}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(O.a),t.Y36(b.x),t.Y36(f.T),t.Y36(k.o))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-thay-doi-thong-tin"]],decls:9,vars:1,consts:[[1,"container","py-3"],[1,"row"],[3,"files","ondragover"],[1,"btn"],["mat-raised-button","",3,"click"],["color","warn","mat-raised-button","",3,"click"],[1,"row",3,"innerHTML"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"app-drop-files",2),t.NdJ("files",function(a){return n.onDropFile(a)})("ondragover",function(){return n.ondragover()}),t.qZA(),t.TgZ(3,"div",3)(4,"button",4),t.NdJ("click",function(){return n.exportMau()}),t._uU(5,"File m\u1eabu"),t.qZA(),t.TgZ(6,"button",5),t.NdJ("click",function(){return n.loopRequest()}),t._uU(7,"import"),t.qZA()(),t._UZ(8,"div",6),t.qZA()()),2&e&&(t.xp6(8),t.Q6J("innerHTML",n.outHTML,t.oJD))},dependencies:[Y.lW,F.k]}),i})(),Re=(()=>{class i{constructor(e,n,o){this.cmis4SV=e,this.formSV=n,this.plus=o,this.body=null,this.searchArr=[]}ngOnInit(){}getClip(e){var n=this;return(0,g.Z)(function*(){for(const o of e)n.searchArr.push(o[0])})()}copy(e){this.plus.copyToClipboard(e)}removeItem(e){this.searchArr.splice(e,1)}reload(){this.plus.reload()}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(O.a),t.Y36(k.o),t.Y36(f.T))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-du-thao-ha-ap"]],decls:6,vars:0,consts:[[1,"container","py-3"],[1,"row"],[1,"input-group","input-group-sm","mb-3"],[1,"input-group-text"],["type","text",1,"form-control"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"span",3),t._uU(4,"Small"),t.qZA(),t._UZ(5,"input",4),t.qZA()()())}}),i})();var we=D(78372),ht=D(47957);function $e(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t.TgZ(7,"td"),t._uU(8),t.qZA(),t.TgZ(9,"td"),t._uU(10),t.qZA(),t.TgZ(11,"td")(12,"button",24),t.NdJ("click",function(){const a=t.CHM(e).index,l=t.oxw();return t.KtG(l.deleteCustomer(a))}),t.TgZ(13,"mat-icon"),t._uU(14,"delete"),t.qZA()()()()}if(2&i){const e=r.$implicit,n=r.index;t.xp6(2),t.Oqu(n+1),t.xp6(2),t.Oqu(e.MA_KHANG),t.xp6(2),t.Oqu(e.STT),t.xp6(2),t.Oqu(e.TEN_KHANG),t.xp6(2),t.Oqu(e.LOAI_HS)}}function je(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"td",25)(1,"button",26),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.saveCustomer())}),t.TgZ(2,"mat-icon"),t._uU(3,"save"),t.qZA()()()}}function Xe(i,r){if(1&i&&(t.TgZ(0,"mat-option",37),t._uU(1),t.qZA()),2&i){const e=r.$implicit;t.Q6J("value",e.NoiDung),t.xp6(1),t.hij(" ",e.NoiDung," ")}}function We(i,r){if(1&i&&(t.TgZ(0,"mat-option",37),t._uU(1),t.qZA()),2&i){const e=r.$implicit;t.Q6J("value",e.NoiDung),t.xp6(1),t.hij(" ",e.NoiDung," ")}}function ze(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"tr",8)(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t.TgZ(7,"td"),t._uU(8),t.qZA(),t.TgZ(9,"td"),t._uU(10),t.qZA(),t.TgZ(11,"td")(12,"div",12)(13,"mat-form-field")(14,"mat-label"),t._uU(15,"Lo\u1ea1i c\xf4ng t\u01a1"),t.qZA(),t.TgZ(16,"input",30),t.NdJ("blur",function(){const a=t.CHM(e).index,l=t.oxw(2);return t.KtG(l.setValueByKey("LOAI_CTO",a))}),t.qZA(),t.TgZ(17,"mat-autocomplete",31,32),t.YNc(19,Xe,2,2,"mat-option",33),t.qZA()()()(),t.TgZ(20,"td")(21,"div",12)(22,"mat-form-field")(23,"mat-label"),t._uU(24,"Ghi ch\xfa"),t.qZA(),t.TgZ(25,"input",34),t.NdJ("blur",function(){const a=t.CHM(e).index,l=t.oxw(2);return t.KtG(l.setValueByKey("GHI_CHU",a))}),t.qZA(),t.TgZ(26,"mat-autocomplete",31,35),t.YNc(28,We,2,2,"mat-option",33),t.qZA()()()(),t.TgZ(29,"td")(30,"mat-icon",36),t.NdJ("click",function(){const o=t.CHM(e),a=o.$implicit,l=o.index,u=t.oxw(2);return t.KtG(u.xoaPhanCong(a,l))}),t._uU(31,"delete"),t.qZA()()()}if(2&i){const e=r.$implicit,n=r.index,o=t.MAs(18),a=t.MAs(27),l=t.oxw(2);t.Q6J("formGroup",l.main),t.xp6(2),t.Oqu(n+1),t.xp6(2),t.Oqu(e.MA_KHANG),t.xp6(2),t.Oqu(e.TEN_KHANG),t.xp6(2),t.Oqu(e.DTHOAI_DVU),t.xp6(2),t.Oqu(e.SNGAY_HENMAX),t.xp6(6),t.Q6J("matAutocomplete",o),t.xp6(3),t.Q6J("ngForOf",l.catLOAI_CTO),t.xp6(6),t.Q6J("matAutocomplete",a),t.xp6(3),t.Q6J("ngForOf",l.catLOAI_GAN_CTO)}}function tn(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"tr")(1,"td",29)(2,"button",26),t.NdJ("click",function(){t.CHM(e);const o=t.oxw(2);return t.KtG(o.saveDienKe())}),t.TgZ(3,"mat-icon"),t._uU(4,"save"),t.qZA()()()()}}function en(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td",24),t.NdJ("click",function(){const o=t.CHM(e),a=o.$implicit,l=o.index,u=t.oxw(2);return t.KtG(u.addGiaoHS(a,l))}),t._uU(4),t.qZA(),t.TgZ(5,"td",38),t.NdJ("click",function(){const o=t.CHM(e),a=o.$implicit,l=o.index,u=t.oxw(2);return t.KtG(u.addGiaoHS(a,l))}),t._uU(6),t.qZA(),t.TgZ(7,"td",24),t.NdJ("click",function(){const o=t.CHM(e),a=o.$implicit,l=o.index,u=t.oxw(2);return t.KtG(u.addGiaoHS(a,l))}),t._uU(8),t.qZA(),t.TgZ(9,"td",24),t.NdJ("click",function(){const o=t.CHM(e),a=o.$implicit,l=o.index,u=t.oxw(2);return t.KtG(u.addGiaoHS(a,l))}),t._uU(10),t.qZA()()}if(2&i){const e=r.$implicit,n=r.index;t.xp6(2),t.Oqu(n+1),t.xp6(2),t.Oqu(e.MA_KHANG),t.xp6(2),t.Oqu(e.TEN_KHANG),t.xp6(2),t.Oqu(e.DTHOAI_DVU),t.xp6(2),t.Oqu(e.SNGAY_HENMAX)}}function nn(i,r){if(1&i&&(t.TgZ(0,"table",5)(1,"thead")(2,"tr")(3,"th",6),t._uU(4,"TT"),t.qZA(),t.TgZ(5,"th",6),t._uU(6,"M\xe3 KH"),t.qZA(),t.TgZ(7,"th",6),t._uU(8,"T\xean KH"),t.qZA(),t.TgZ(9,"th",6),t._uU(10,"\u0110i\u1ec7n tho\u1ea1i"),t.qZA(),t.TgZ(11,"th",6),t._uU(12,"Ng\xe0y h\u1eb9n"),t.qZA(),t._UZ(13,"th")(14,"th")(15,"th"),t.qZA()(),t.TgZ(16,"tbody"),t.YNc(17,ze,32,10,"tr",27),t.YNc(18,tn,5,0,"tr",28),t.TgZ(19,"tr")(20,"td",29),t._UZ(21,"hr"),t.qZA()(),t.YNc(22,en,11,5,"tr",7),t.qZA()()),2&i){const e=t.oxw();t.xp6(17),t.Q6J("ngForOf",e.giaoHS),t.xp6(1),t.Q6J("ngIf",e.giaoHS.length>0),t.xp6(4),t.Q6J("ngForOf",e.phanCong)}}function on(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"mat-radio-button",24),t.NdJ("click",function(){const a=t.CHM(e).$implicit,l=t.oxw(2);return t.KtG(l.loaiHS=a.NoiDung)}),t._uU(1),t.qZA()}if(2&i){const e=r.$implicit;t.xp6(1),t.Oqu(e.NoiDung)}}function an(i,r){if(1&i&&(t.TgZ(0,"div",4)(1,"mat-radio-group",39),t.YNc(2,on,2,1,"mat-radio-button",22),t.qZA()()),2&i){const e=t.oxw();t.xp6(2),t.Q6J("ngForOf",e.catalogs)}}function ln(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"mat-option",24),t.NdJ("click",function(){const a=t.CHM(e).$implicit,l=t.oxw();return t.KtG(l.ngKt.get("PHAN_CONG").setValue(a.NoiDung))}),t._uU(1),t.qZA()}if(2&i){const e=r.$implicit;t.xp6(1),t.hij(" ",e.NoiDung,"")}}function un(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t.TgZ(7,"td"),t._uU(8),t.qZA(),t.TgZ(9,"td")(10,"button",24),t.NdJ("click",function(){const a=t.CHM(e).index,l=t.oxw();return t.KtG(l.deleteCustomer(a))}),t.TgZ(11,"mat-icon"),t._uU(12,"delete"),t.qZA()()()()}if(2&i){const e=r.$implicit,n=r.index;t.xp6(2),t.Oqu(n+1),t.xp6(2),t.Oqu(e.MA_KHANG),t.xp6(2),t.Oqu(e.STT),t.xp6(2),t.Oqu(e.TEN_KHANG)}}function sn(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"td",25)(1,"button",26),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.saveKiemTra())}),t.TgZ(2,"mat-icon"),t._uU(3,"save"),t.qZA()()()}}const cn=[{path:"",component:St},{path:"cmis4-tra-cuu",component:Ot},{path:"cmis4-lien-he",component:yt},{path:"cmis4-cap-dien",component:$t},{path:"cmis4-bao-cao-dmt",component:Vt},{path:"cmis4-bien-ban-dmt",component:Ft},{path:"cmis4-chi-so",component:te},{path:"cmis4-doi-gia",component:oe},{path:"cmis4-c06",component:ct},{path:"cmis4-so-hoa",component:Ie},{path:"nhap-chi-so-dinh-ky",component:Oe},{path:"cmis4-in-hop-dong",component:be},{path:"cmis4-tools",component:Le},{path:"cmis4-han-hop-dong",component:Ve},{path:"cmis4-tiep-nhan-yeu-cau",component:Fe},{path:"cmis4-kiem-do-hoa-don",component:Pe},{path:"cmis4-thay-doi-thong-tin",component:Qe},{path:"cmis4-du-thao-ha-ap",component:Re},{path:"cmis4-giao-ho-so",component:(()=>{class i{constructor(e,n,o,a,l,u,h,p){this.cmis4SV=e,this.formSV=n,this.idbSV=o,this.plus=a,this.docxSV=l,this.excelSV=u,this.sheetdbSV=h,this.loadSV=p,this.main=this.formSV.fb.group({MA_KHANG:["",d.kI.required],STT:["",d.kI.required],TEN_KHANG:["",d.kI.required],LOAI_HS:["",[d.kI.required,d.kI.minLength(1)]],PHAN_CONG:[""],GHI_CHU:[""],LOAI_CTO:[""]}),this.ngKt=this.formSV.fb.group({PHAN_CONG:["",d.kI.required]}),this.api="cmis4-so-hoa",this.db=null,this.dbName="cmis4",this.items=[],this.localKey="items_LIST",this.spreadsheetId="1t5dkWvH7_lsSow8-e9eOA5VBHwTZJbZEJ9p7Ksl5Hrs",this.snGiaKho="Data",this.snKiemTra="KiemTra",this.snDienKe="DienKe",this.headerKeys=[],this.ngay=N()().format("DD/MM/YYYY"),this.tuNgay=N()().subtract(90,"days").format("DD/MM/YYYY"),this.denNgay=N()().format("DD/MM/YYYY"),this.tongYeuCau=[],this.phanCong=[],this.giaoHS=[],this.catalogs=[],this.nhanViens=[],this.catLOAI_CTO=[],this.catLOAI_GAN_CTO=[],this.nguoiKT="",this.loaiHS="",this.nvOpts=[]}ngOnInit(){this.plus.setTiTle("Giao h\u1ed3 s\u01a1"),this.loadFromStorage(),this.idbSV.IDB_InitDB(this.dbName).subscribe(e=>{this.db=e,this.catalogs=this.plus.getCatalog("LoaiKiemTra"),this.nhanViens=this.plus.getCatalog("NhanVien"),this.catLOAI_CTO=this.plus.getCatalog("LOAI_CTO"),this.catLOAI_GAN_CTO=this.plus.getCatalog("LOAI_GAN_CTO"),console.log(this.catLOAI_GAN_CTO,this.catLOAI_CTO),this.idbSV.IDB_DB_GetAll(e,this.api).subscribe(n=>{0==n.length&&this.getSoHoa()})}),this.filter()}filter(){this.ngKt.valueChanges.pipe((0,we.b)(500)).subscribe(e=>{let n=this.plus.removeAccents(e.PHAN_CONG).toLowerCase();this.nvOpts=this.nhanViens.filter(o=>this.plus.removeAccents(JSON.stringify(o)).toLowerCase().includes(n)),1==this.nhanViens.length&&(this.ngKt.get("PHAN_CONG").setValue(this.nhanViens[0].NoiDung),this.nguoiKT=this.nhanViens[0].NoiDung)})}get(){}addApp(){}timYeuCau(e){this.phanCong=[],this.cmis4SV.cmis4Request("https://cmis-api.evnspc.vn/serviceDichVu/timKiemYeuCau","",0==e?{strMaDviqly:"PK0500",loaiYcau:"CDHA_D",maYcau:"",strTNTuNgay:this.tuNgay,strTNDenNgay:this.denNgay,tuNgay:this.tuNgay,denNgay:this.denNgay,daTN:!0,buocThien:"",nguoiYcau:"",kieuNgay:"",diaChi:"",typeDiaChi:"DCKHANG",dauTuCT:0,mucDich:-1,thuanLoi:1,maKhang:"",sNgayND:"0",maHosoDVC:"",techID:"",lstLoaiDVAll:[{label:"CDIEN - C\xe2\u0301p \u0111i\xea\u0323n ha\u0323 a\u0301p (SH v\xe0 NSH)",value:"CDIEN",item:{maDtuong:"DD",maLoaiYcau:"CDIEN",maNhomYcau:1,maTto:"GK",moTa:null,soNgay:7,stt:1,tenLoaiYcau:"C\xe2\u0301p \u0111i\xea\u0323n ha\u0323 a\u0301p (SH v\xe0 NSH)",_persistence_fetchGroup:null}},{label:"TCCS_D - D\u1ecbch v\u1ee5 thay \u0111\u1ed5i c\xf4ng su\u1ea5t s\u1eed d\u1ee5ng",value:"TCCS_D",item:{maDtuong:null,maLoaiYcau:"TCCS_D",maNhomYcau:20,maTto:"TC",moTa:null,soNgay:null,stt:1,tenLoaiYcau:"D\u1ecbch v\u1ee5 thay \u0111\u1ed5i c\xf4ng su\u1ea5t s\u1eed d\u1ee5ng",_persistence_fetchGroup:null}},{label:"CDHA_D - D\u1ecbch v\u1ee5 c\u1ea5p \u0111i\u1ec7n h\u1ea1 \xe1p",value:"CDHA_D",item:{maDtuong:null,maLoaiYcau:"CDHA_D",maNhomYcau:17,maTto:"GK",moTa:null,soNgay:7,stt:1,tenLoaiYcau:"D\u1ecbch v\u1ee5 c\u1ea5p \u0111i\u1ec7n h\u1ea1 \xe1p",_persistence_fetchGroup:null}},{label:"CDMT - C\u1ea5p \u0111i\u1ec7n m\u1eb7t tr\u1eddi m\xe1i nh\xe0",value:"CDMT",item:{maDtuong:"DD",maLoaiYcau:"CDMT",maNhomYcau:1,maTto:"GK",moTa:null,soNgay:7,stt:2,tenLoaiYcau:"C\u1ea5p \u0111i\u1ec7n m\u1eb7t tr\u1eddi m\xe1i nh\xe0",_persistence_fetchGroup:null}},{label:"CDMT_D - C\u1ea5p \u0111i\u1ec7n m\u1eb7t tr\u1eddi m\xe1i nh\xe0",value:"CDMT_D",item:{maDtuong:"DD",maLoaiYcau:"CDMT_D",maNhomYcau:17,maTto:"GK",moTa:null,soNgay:7,stt:2,tenLoaiYcau:"C\u1ea5p \u0111i\u1ec7n m\u1eb7t tr\u1eddi m\xe1i nh\xe0",_persistence_fetchGroup:null}},{label:"CDTC - C\xe2\u0301p \u0111i\xea\u0323n ta\u0301ch c\xf4ng t\u01a1",value:"CDTC",item:{maDtuong:"DD",maLoaiYcau:"CDTC",maNhomYcau:20,maTto:"GK",moTa:null,soNgay:7,stt:2,tenLoaiYcau:"C\xe2\u0301p \u0111i\xea\u0323n ta\u0301ch c\xf4ng t\u01a1",_persistence_fetchGroup:null}},{label:"CDCC - C\xe2\u0301p \u0111i\xea\u0323n chung c\xf4ng t\u01a1",value:"CDCC",item:{maDtuong:"DD",maLoaiYcau:"CDCC",maNhomYcau:20,maTto:"GK",moTa:null,soNgay:7,stt:3,tenLoaiYcau:"C\xe2\u0301p \u0111i\xea\u0323n chung c\xf4ng t\u01a1",_persistence_fetchGroup:null}},{label:"CDNH - C\xe2\u0301p \u0111i\xea\u0323n ngoa\u0300i sinh hoa\u0323t ng\u0103\u0301n ha\u0323n",value:"CDNH",item:{maDtuong:null,maLoaiYcau:"CDNH",maNhomYcau:2,maTto:"GN",moTa:null,soNgay:null,stt:3,tenLoaiYcau:"C\xe2\u0301p \u0111i\xea\u0323n ngoa\u0300i sinh hoa\u0323t ng\u0103\u0301n ha\u0323n",_persistence_fetchGroup:null}},{label:"CDNM - C\xe2\u0301p \u0111i\xea\u0323n NSH c\xf4ng su\xe2\u0301t max >= 40kW",value:"CDNM",item:{maDtuong:"DD",maLoaiYcau:"CDNM",maNhomYcau:20,maTto:"GK",moTa:null,soNgay:7,stt:3,tenLoaiYcau:"C\xe2\u0301p \u0111i\xea\u0323n NSH c\xf4ng su\xe2\u0301t max >= 40kW",_persistence_fetchGroup:null}},{label:"CDNS - C\xe2\u0301p \u0111i\xea\u0323n NSH c\xf4ng su\xe2\u0301t max < 40kW",value:"CDNS",item:{maDtuong:"DD",maLoaiYcau:"CDNS",maNhomYcau:20,maTto:"GK",moTa:null,soNgay:7,stt:3,tenLoaiYcau:"C\xe2\u0301p \u0111i\xea\u0323n NSH c\xf4ng su\xe2\u0301t max < 40kW",_persistence_fetchGroup:null}},{label:"TBAC - C\u1ea5p \u0111i\u1ec7n trung \xe1p qua tr\u1ea1m chuy\xean d\xf9ng",value:"TBAC",item:{maDtuong:"DD",maLoaiYcau:"TBAC",maNhomYcau:3,maTto:"GC",moTa:null,soNgay:18,stt:23,tenLoaiYcau:"C\u1ea5p \u0111i\u1ec7n trung \xe1p qua tr\u1ea1m chuy\xean d\xf9ng",_persistence_fetchGroup:null}},{label:"TCCS - Thay \u0111\u1ed5i c\xf4ng su\u1ea5t",value:"TCCS",item:{maDtuong:"DD",maLoaiYcau:"TCCS",maNhomYcau:12,maTto:"TC",moTa:null,soNgay:7,stt:25,tenLoaiYcau:"Thay \u0111\u1ed5i c\xf4ng su\u1ea5t",_persistence_fetchGroup:null}},{label:"CKTS - C\u1ea5p \u0111i\u1ec7n trung \xe1p qua tr\u1ea1m CD KH SH",value:"CKTS",item:{maDtuong:"DD",maLoaiYcau:"CKTS",maNhomYcau:3,maTto:"GC",moTa:null,soNgay:18,stt:26,tenLoaiYcau:"C\u1ea5p \u0111i\u1ec7n trung \xe1p qua tr\u1ea1m CD KH SH",_persistence_fetchGroup:null}},{label:"TBAE - C\xe2\u0301p \u0111i\xea\u0323n TA N\u0110 \u0111\xe2\u0300u t\u01b0",value:"TBAE",item:{maDtuong:"DD",maLoaiYcau:"TBAE",maNhomYcau:4,maTto:"GC",moTa:null,soNgay:18,stt:26,tenLoaiYcau:"C\xe2\u0301p \u0111i\xea\u0323n TA N\u0110 \u0111\xe2\u0300u t\u01b0",_persistence_fetchGroup:null}},{label:"CKTM - C\xe2\u0301p \u0111i\xea\u0323n trung a\u0301p KH \u0111\xe2\u0300u t\u01b0, mua bu\xf4n \u0111i\xea\u0323n NT",value:"CKTM",item:{maDtuong:"DD",maLoaiYcau:"CKTM",maNhomYcau:3,maTto:"GC",moTa:null,soNgay:18,stt:26,tenLoaiYcau:"C\xe2\u0301p \u0111i\xea\u0323n trung a\u0301p KH \u0111\xe2\u0300u t\u01b0, mua bu\xf4n \u0111i\xea\u0323n NT",_persistence_fetchGroup:null}},{label:"TBAC_D - D\u1ecbch v\u1ee5 c\xe2\u0301p \u0111i\xea\u0323n TA KH \u0111\xe2\u0300u t\u01b0",value:"TBAC_D",item:{maDtuong:null,maLoaiYcau:"TBAC_D",maNhomYcau:18,maTto:"GC",moTa:null,soNgay:18,stt:27,tenLoaiYcau:"D\u1ecbch v\u1ee5 c\xe2\u0301p \u0111i\xea\u0323n TA KH \u0111\xe2\u0300u t\u01b0",_persistence_fetchGroup:null}},{label:"TCSTE_D - T\u0103ng c\u01b0\u1eddng c\xf4ng su\u1ea5t tr\u1ea1m chuy\xean d\xf9ng \u0111i\u1ec7n l\u1ef1c",value:"TCSTE_D",item:{maDtuong:null,maLoaiYcau:"TCSTE_D",maNhomYcau:18,maTto:"GC",moTa:null,soNgay:18,stt:28,tenLoaiYcau:"T\u0103ng c\u01b0\u1eddng c\xf4ng su\u1ea5t tr\u1ea1m chuy\xean d\xf9ng \u0111i\u1ec7n l\u1ef1c",_persistence_fetchGroup:null}},{label:"TBSC_D - D\u1ecbch v\u1ee5 c\xe2\u0301p \u0111i\xea\u0323n TA KH \u0111\xe2\u0300u t\u01b0, c\u1ea5p \u0111i\u1ec7n sinh ho\u1ea1t",value:"TBSC_D",item:{maDtuong:null,maLoaiYcau:"TBSC_D",maNhomYcau:18,maTto:"GC",moTa:"D\u1ecbch v\u1ee5 c\xe2\u0301p \u0111i\xea\u0323n TA KH \u0111\xe2\u0300u t\u01b0, c\u1ea5p \u0111i\u1ec7n sinh ho\u1ea1t",soNgay:18,stt:28,tenLoaiYcau:"D\u1ecbch v\u1ee5 c\xe2\u0301p \u0111i\xea\u0323n TA KH \u0111\xe2\u0300u t\u01b0, c\u1ea5p \u0111i\u1ec7n sinh ho\u1ea1t",_persistence_fetchGroup:null}},{label:"TBAE_D - D\u1ecbch v\u1ee5 c\xe2\u0301p \u0111i\xea\u0323n TA N\u0110 \u0111\xe2\u0300u t\u01b0",value:"TBAE_D",item:{maDtuong:null,maLoaiYcau:"TBAE_D",maNhomYcau:19,maTto:"GE",moTa:null,soNgay:18,stt:28,tenLoaiYcau:"D\u1ecbch v\u1ee5 c\xe2\u0301p \u0111i\xea\u0323n TA N\u0110 \u0111\xe2\u0300u t\u01b0",_persistence_fetchGroup:null}},{label:"TBMC_D - D\u1ecbch v\u1ee5 c\xe2\u0301p \u0111i\xea\u0323n TA KH \u0111\xe2\u0300u t\u01b0, c\u1ea5p \u0111i\u1ec7n mua bu\xf4n \u0111i\u1ec7n",value:"TBMC_D",item:{maDtuong:null,maLoaiYcau:"TBMC_D",maNhomYcau:18,maTto:"GC",moTa:"D\u1ecbch v\u1ee5 c\xe2\u0301p \u0111i\xea\u0323n TA KH \u0111\xe2\u0300u t\u01b0, c\u1ea5p \u0111i\u1ec7n mua bu\xf4n \u0111i\u1ec7n",soNgay:18,stt:29,tenLoaiYcau:"D\u1ecbch v\u1ee5 c\xe2\u0301p \u0111i\xea\u0323n TA KH \u0111\xe2\u0300u t\u01b0, c\u1ea5p \u0111i\u1ec7n mua bu\xf4n \u0111i\u1ec7n",_persistence_fetchGroup:null}},{label:"DDOI_D - D\u1ecbch v\u1ee5 thay \u0111\u1ed5i v\u1ecb tr\xed \u0111o \u0111\u1ebfm",value:"DDOI_D",item:{maDtuong:null,maLoaiYcau:"DDOI_D",maNhomYcau:21,maTto:"DC",moTa:null,soNgay:null,stt:30,tenLoaiYcau:"D\u1ecbch v\u1ee5 thay \u0111\u1ed5i v\u1ecb tr\xed \u0111o \u0111\u1ebfm",_persistence_fetchGroup:null}},{label:"MDSD_D - D\u1ecbch v\u1ee5 thay \u0111\u1ed5i m\u1ee5c \u0111\xedch s\u1eed d\u1ee5ng \u0111i\u1ec7n",value:"MDSD_D",item:{maDtuong:null,maLoaiYcau:"MDSD_D",maNhomYcau:22,maTto:"DM",moTa:null,soNgay:null,stt:31,tenLoaiYcau:"D\u1ecbch v\u1ee5 thay \u0111\u1ed5i m\u1ee5c \u0111\xedch s\u1eed d\u1ee5ng \u0111i\u1ec7n",_persistence_fetchGroup:null}},{label:"SOHO_D - D\u1ecbch v\u1ee5 thay \u0111\u1ed5i \u0111\u1ecbnh m\u1ee9c s\u1eed d\u1ee5ng \u0111i\u1ec7n",value:"SOHO_D",item:{maDtuong:null,maLoaiYcau:"SOHO_D",maNhomYcau:23,maTto:"SH",moTa:null,soNgay:null,stt:32,tenLoaiYcau:"D\u1ecbch v\u1ee5 thay \u0111\u1ed5i \u0111\u1ecbnh m\u1ee9c s\u1eed d\u1ee5ng \u0111i\u1ec7n",_persistence_fetchGroup:null}},{label:"CDKM_D - D\u1ecbch v\u1ee5 thay \u0111\u1ed5i ch\u1ee7 th\u1ec3 H\u0110MB\u0110",value:"CDKM_D",item:{maDtuong:null,maLoaiYcau:"CDKM_D",maNhomYcau:24,maTto:"ST",moTa:null,soNgay:null,stt:33,tenLoaiYcau:"D\u1ecbch v\u1ee5 thay \u0111\u1ed5i ch\u1ee7 th\u1ec3 H\u0110MB\u0110",_persistence_fetchGroup:null}},{label:"TTKH_D - D\u1ecbch v\u1ee5 thay \u0111\u1ed5i th\xf4ng tin",value:"TTKH_D",item:{maDtuong:null,maLoaiYcau:"TTKH_D",maNhomYcau:25,maTto:"TI",moTa:null,soNgay:null,stt:34,tenLoaiYcau:"D\u1ecbch v\u1ee5 thay \u0111\u1ed5i th\xf4ng tin",_persistence_fetchGroup:null}},{label:"GHAN_D - D\u1ecbch v\u1ee5 gia h\u1ea1n h\u1ee3p \u0111\u1ed3ng",value:"GHAN_D",item:{maDtuong:null,maLoaiYcau:"GHAN_D",maNhomYcau:26,maTto:"GH",moTa:null,soNgay:null,stt:35,tenLoaiYcau:"D\u1ecbch v\u1ee5 gia h\u1ea1n h\u1ee3p \u0111\u1ed3ng",_persistence_fetchGroup:null}},{label:"CDHD_D - D\u1ecbch v\u1ee5 ch\u1ea5m d\u1ee9t h\u1ee3p \u0111\u1ed3ng",value:"CDHD_D",item:{maDtuong:null,maLoaiYcau:"CDHD_D",maNhomYcau:27,maTto:"TL",moTa:null,soNgay:null,stt:36,tenLoaiYcau:"D\u1ecbch v\u1ee5 ch\u1ea5m d\u1ee9t h\u1ee3p \u0111\u1ed3ng",_persistence_fetchGroup:null}},{label:"HDSD - D\u1ecbch v\u1ee5 h\u1ee3p \u0111\u1ed3ng sau d\xe2y",value:"HDSD",item:{maDtuong:null,maLoaiYcau:"HDSD",maNhomYcau:28,maTto:"SD",moTa:null,soNgay:null,stt:37,tenLoaiYcau:"D\u1ecbch v\u1ee5 h\u1ee3p \u0111\u1ed3ng sau d\xe2y",_persistence_fetchGroup:null}},{label:"DDOI_N - Nghi\u1ec7p v\u1ee5 di d\u1eddi n\u1ed9i b\u1ed9",value:"DDOI_N",item:{maDtuong:null,maLoaiYcau:"DDOI_N",maNhomYcau:29,maTto:"DC",moTa:null,soNgay:null,stt:38,tenLoaiYcau:"Nghi\u1ec7p v\u1ee5 di d\u1eddi n\u1ed9i b\u1ed9",_persistence_fetchGroup:null}},{label:"MDSD_N - Nghi\u1ec7p v\u1ee5 thay \u0111\u1ed5i m\u1ee5c \u0111\xedch s\u1eed d\u1ee5ng \u0111i\u1ec7n n\u1ed9i b\u1ed9",value:"MDSD_N",item:{maDtuong:null,maLoaiYcau:"MDSD_N",maNhomYcau:30,maTto:"DM",moTa:null,soNgay:null,stt:39,tenLoaiYcau:"Nghi\u1ec7p v\u1ee5 thay \u0111\u1ed5i m\u1ee5c \u0111\xedch s\u1eed d\u1ee5ng \u0111i\u1ec7n n\u1ed9i b\u1ed9",_persistence_fetchGroup:null}},{label:"SOHO_N - Nghi\u1ec7p v\u1ee5 thay \u0111\u1ed5i s\u1ed1 h\u1ed9 n\u1ed9i b\u1ed9",value:"SOHO_N",item:{maDtuong:null,maLoaiYcau:"SOHO_N",maNhomYcau:31,maTto:"SH",moTa:null,soNgay:null,stt:40,tenLoaiYcau:"Nghi\u1ec7p v\u1ee5 thay \u0111\u1ed5i s\u1ed1 h\u1ed9 n\u1ed9i b\u1ed9",_persistence_fetchGroup:null}},{label:"TTKH_N - Nghi\u1ec7p v\u1ee5 thay \u0111\u1ed5i th\xf4ng tin kh\xe1ch h\xe0ng n\u1ed9i b\u1ed9",value:"TTKH_N",item:{maDtuong:null,maLoaiYcau:"TTKH_N",maNhomYcau:32,maTto:"TI",moTa:null,soNgay:null,stt:41,tenLoaiYcau:"Nghi\u1ec7p v\u1ee5 thay \u0111\u1ed5i th\xf4ng tin kh\xe1ch h\xe0ng n\u1ed9i b\u1ed9",_persistence_fetchGroup:null}},{label:"GHAN_N - Nghi\u1ec7p v\u1ee5 gia h\u1ea1n h\u1ee3p \u0111\u1ed3ng n\u1ed9i b\u1ed9",value:"GHAN_N",item:{maDtuong:null,maLoaiYcau:"GHAN_N",maNhomYcau:33,maTto:"GH",moTa:null,soNgay:null,stt:42,tenLoaiYcau:"Nghi\u1ec7p v\u1ee5 gia h\u1ea1n h\u1ee3p \u0111\u1ed3ng n\u1ed9i b\u1ed9",_persistence_fetchGroup:null}},{label:"CDHD_N - Nghi\u1ec7p v\u1ee5 ch\u1ea5m d\u1ee9t h\u1ee3p \u0111\u1ed3ng n\u1ed9i b\u1ed9",value:"CDHD_N",item:{maDtuong:null,maLoaiYcau:"CDHD_N",maNhomYcau:34,maTto:"TL",moTa:null,soNgay:null,stt:43,tenLoaiYcau:"Nghi\u1ec7p v\u1ee5 ch\u1ea5m d\u1ee9t h\u1ee3p \u0111\u1ed3ng n\u1ed9i b\u1ed9",_persistence_fetchGroup:null}},{label:"TTNB_N - Nghi\u1ec7p v\u1ee5 treo th\xe1o thi\u1ebft b\u1ecb \u0111o \u0111\u1ebfm n\u1ed9i b\u1ed9",value:"TTNB_N",item:{maDtuong:null,maLoaiYcau:"TTNB_N",maNhomYcau:35,maTto:"TD",moTa:null,soNgay:null,stt:44,tenLoaiYcau:"Nghi\u1ec7p v\u1ee5 treo th\xe1o thi\u1ebft b\u1ecb \u0111o \u0111\u1ebfm n\u1ed9i b\u1ed9",_persistence_fetchGroup:null}},{label:"CDKM_N - Nghi\u1ec7p v\u1ee5 ch\u1ea5m d\u1ee9t k\xfd m\u1edbi h\u1ee3p \u0111\u1ed3ng",value:"CDKM_N",item:{maDtuong:null,maLoaiYcau:"CDKM_N",maNhomYcau:38,maTto:"ST",moTa:null,soNgay:null,stt:45,tenLoaiYcau:"Nghi\u1ec7p v\u1ee5 ch\u1ea5m d\u1ee9t k\xfd m\u1edbi h\u1ee3p \u0111\u1ed3ng",_persistence_fetchGroup:null}},{label:"KLMT_D - K\xfd h\u1ee3p \u0111\u1ed3ng m\u1eb7t tr\u1eddi m\xe1i nh\xe0",value:"KLMT_D",item:{maDtuong:"DD",maLoaiYcau:"KLMT_D",maNhomYcau:36,maTto:"MT",moTa:null,soNgay:7,stt:46,tenLoaiYcau:"K\xfd h\u1ee3p \u0111\u1ed3ng m\u1eb7t tr\u1eddi m\xe1i nh\xe0",_persistence_fetchGroup:null}},{label:"KMMT_D - K\xfd m\u1edbi h\u1ee3p \u0111\u1ed3ng m\u1eb7t tr\u1eddi m\xe1i nh\xe0 TSTT",value:"KMMT_D",item:{maDtuong:"DD",maLoaiYcau:"KMMT_D",maNhomYcau:36,maTto:"MT",moTa:"K\xfd m\u1edbi h\u1ee3p \u0111\u1ed3ng m\u1eb7t tr\u1eddi m\xe1i nh\xe0 TSTT",soNgay:7,stt:47,tenLoaiYcau:"K\xfd m\u1edbi h\u1ee3p \u0111\u1ed3ng m\u1eb7t tr\u1eddi m\xe1i nh\xe0 TSTT",_persistence_fetchGroup:null}},{label:"TLMT_D - D\u1ecbch v\u1ee5 ch\u1ea5m d\u1ee9t h\u1ee3p \u0111\u1ed3ng m\u1eb7t tr\u1eddi",value:"TLMT_D",item:{maDtuong:"KH",maLoaiYcau:"TLMT_D",maNhomYcau:37,maTto:"LT",moTa:"D\u1ecbch v\u1ee5 ch\u1ea5m d\u1ee9t h\u1ee3p \u0111\u1ed3ng m\u1eb7t tr\u1eddi",soNgay:null,stt:48,tenLoaiYcau:"D\u1ecbch v\u1ee5 ch\u1ea5m d\u1ee9t h\u1ee3p \u0111\u1ed3ng m\u1eb7t tr\u1eddi",_persistence_fetchGroup:null}},{label:"TTKM_D - D\u1ecbch v\u1ee5 thay \u0111\u1ed5i th\xf4ng tin h\u1ee3p \u0111\u1ed3ng \u0111i\u1ec7n MTNM",value:"TTKM_D",item:{maDtuong:"KH",maLoaiYcau:"TTKM_D",maNhomYcau:39,maTto:"TM",moTa:"D\u1ecbch v\u1ee5 thay \u0111\u1ed5i th\xf4ng tin h\u1ee3p \u0111\u1ed3ng \u0111i\u1ec7n MTNM",soNgay:null,stt:49,tenLoaiYcau:"D\u1ecbch v\u1ee5 thay \u0111\u1ed5i th\xf4ng tin h\u1ee3p \u0111\u1ed3ng \u0111i\u1ec7n MTNM",_persistence_fetchGroup:null}},{label:"CDCC_D - C\xe2\u0301p \u0111i\xea\u0323n chung c\xf4ng t\u01a1",value:"CDCC_D",item:{maDtuong:null,maLoaiYcau:"CDCC_D",maNhomYcau:17,maTto:"GK",moTa:"C\xe2\u0301p \u0111i\xea\u0323n chung c\xf4ng t\u01a1",soNgay:7,stt:50,tenLoaiYcau:"C\xe2\u0301p \u0111i\xea\u0323n chung c\xf4ng t\u01a1",_persistence_fetchGroup:null}},{label:"CDTC_D - C\u1ea5p \u0111i\u1ec7n t\xe1ch c\xf4ng t\u01a1 d\xf9ng chung",value:"CDTC_D",item:{maDtuong:null,maLoaiYcau:"CDTC_D",maNhomYcau:17,maTto:"GK",moTa:"C\u1ea5p \u0111i\u1ec7n t\xe1ch c\xf4ng t\u01a1 d\xf9ng chung",soNgay:7,stt:51,tenLoaiYcau:"C\u1ea5p \u0111i\u1ec7n t\xe1ch c\xf4ng t\u01a1 d\xf9ng chung",_persistence_fetchGroup:null}},{label:"CDNS_D - D\u1ecbch v\u1ee5 c\xe2\u0301p \u0111i\xea\u0323n NSH c\xf4ng su\xe2\u0301t max < 40kW",value:"CDNS_D",item:{maDtuong:null,maLoaiYcau:"CDNS_D",maNhomYcau:17,maTto:"GK",moTa:"D\u1ecbch v\u1ee5 c\xe2\u0301p \u0111i\xea\u0323n NSH c\xf4ng su\xe2\u0301t max < 40kW",soNgay:7,stt:52,tenLoaiYcau:"D\u1ecbch v\u1ee5 c\xe2\u0301p \u0111i\xea\u0323n NSH c\xf4ng su\xe2\u0301t max < 40kW",_persistence_fetchGroup:null}},{label:"CDNM_D - D\u1ecbch v\u1ee5 c\xe2\u0301p \u0111i\xea\u0323n NSH c\xf4ng su\xe2\u0301t max >= 40kW",value:"CDNM_D",item:{maDtuong:null,maLoaiYcau:"CDNM_D",maNhomYcau:17,maTto:"GK",moTa:"D\u1ecbch v\u1ee5 c\xe2\u0301p \u0111i\xea\u0323n NSH c\xf4ng su\xe2\u0301t max >= 40kW",soNgay:7,stt:53,tenLoaiYcau:"D\u1ecbch v\u1ee5 c\xe2\u0301p \u0111i\xea\u0323n NSH c\xf4ng su\xe2\u0301t max >= 40kW",_persistence_fetchGroup:null}},{label:"CDNH_D - D\u1ecbch v\u1ee5 c\xe2\u0301p \u0111i\xea\u0323n NSH ng\u1eafn h\u1ea1n",value:"CDNH_D",item:{maDtuong:null,maLoaiYcau:"CDNH_D",maNhomYcau:17,maTto:"GK",moTa:"D\u1ecbch v\u1ee5 c\xe2\u0301p \u0111i\xea\u0323n NSH ng\u1eafn h\u1ea1n",soNgay:7,stt:54,tenLoaiYcau:"D\u1ecbch v\u1ee5 c\xe2\u0301p \u0111i\xea\u0323n NSH ng\u1eafn h\u1ea1n",_persistence_fetchGroup:null}},{label:"KTCT_D - D\u1ecbch v\u1ee5 ki\u1ec3m tra c\xf4ng t\u01a1",value:"KTCT_D",item:{maDtuong:"DD",maLoaiYcau:"KTCT_D",maNhomYcau:40,maTto:"KR",moTa:"D\u1ecbch v\u1ee5 ki\u1ec3m tra c\xf4ng t\u01a1",soNgay:7,stt:55,tenLoaiYcau:"D\u1ecbch v\u1ee5 ki\u1ec3m tra c\xf4ng t\u01a1",_persistence_fetchGroup:null}},{label:"CDLAI_D - D\u1ecbch v\u1ee5 c\u1ea5p \u0111i\u1ec7n tr\u1edf l\u1ea1i theo KH y\xeau c\u1ea7u",value:"CDLAI_D",item:{maDtuong:null,maLoaiYcau:"CDLAI_D",maNhomYcau:41,maTto:"CL",moTa:"D\u1ecbch v\u1ee5 c\u1ea5p \u0111i\u1ec7n tr\u1edf l\u1ea1i theo KH y\xeau c\u1ea7u",soNgay:7,stt:56,tenLoaiYcau:"D\u1ecbch v\u1ee5 c\u1ea5p \u0111i\u1ec7n tr\u1edf l\u1ea1i theo KH y\xeau c\u1ea7u",_persistence_fetchGroup:null}},{label:"CSPK_N - Nghi\u1ec7p v\u1ee5 k\xfd mua CSPK",value:"CSPK_N",item:{maDtuong:null,maLoaiYcau:"CSPK_N",maNhomYcau:42,maTto:"CS",moTa:"Nghi\u1ec7p v\u1ee5 k\xfd mua CSPK",soNgay:null,stt:57,tenLoaiYcau:"Nghi\u1ec7p v\u1ee5 k\xfd mua CSPK",_persistence_fetchGroup:null}},{label:"BDHD_N - Nghi\u1ec7p v\u1ee5 b\u1ea3o \u0111\u1ea3m th\u1ef1c hi\u1ec7n h\u1ee3p \u0111\u1ed3ng",value:"BDHD_N",item:{maDtuong:null,maLoaiYcau:"BDHD_N",maNhomYcau:43,maTto:"BD",moTa:"Nghi\u1ec7p v\u1ee5 b\u1ea3o \u0111\u1ea3m th\u1ef1c hi\u1ec7n h\u1ee3p \u0111\u1ed3ng",soNgay:null,stt:58,tenLoaiYcau:"Nghi\u1ec7p v\u1ee5 b\u1ea3o \u0111\u1ea3m th\u1ef1c hi\u1ec7n h\u1ee3p \u0111\u1ed3ng",_persistence_fetchGroup:null}},{label:"TTKH - Y\xeau c\u1ea7u thay \u0111\u1ed5i th\xf4ng tin kh\xe1ch h\xe0ng",value:"TTKH",item:{maDtuong:null,maLoaiYcau:"TTKH",maNhomYcau:11,maTto:"TI",moTa:null,soNgay:null,stt:null,tenLoaiYcau:"Y\xeau c\u1ea7u thay \u0111\u1ed5i th\xf4ng tin kh\xe1ch h\xe0ng",_persistence_fetchGroup:null}},{label:"MDSD - Thay \u0111\u1ed5i m\u1ee5c \u0111\xedch s\u1eed d\u1ee5ng \u0111i\u1ec7n",value:"MDSD",item:{maDtuong:null,maLoaiYcau:"MDSD",maNhomYcau:6,maTto:"DM",moTa:null,soNgay:null,stt:null,tenLoaiYcau:"Thay \u0111\u1ed5i m\u1ee5c \u0111\xedch s\u1eed d\u1ee5ng \u0111i\u1ec7n",_persistence_fetchGroup:null}},{label:"KTCT - Ki\u1ec3m tra c\xf4ng t\u01a1",value:"KTCT",item:{maDtuong:"DD",maLoaiYcau:"KTCT",maNhomYcau:5,maTto:"KR",moTa:null,soNgay:null,stt:null,tenLoaiYcau:"Ki\u1ec3m tra c\xf4ng t\u01a1",_persistence_fetchGroup:null}},{label:"TNCD - Ng\u1eebng c\u1ea5p \u0111i\u1ec7n theo y\xeau c\u1ea7u c\u1ee7a KH",value:"TNCD",item:{maDtuong:null,maLoaiYcau:"TNCD",maNhomYcau:10,maTto:"NG",moTa:null,soNgay:null,stt:null,tenLoaiYcau:"Ng\u1eebng c\u1ea5p \u0111i\u1ec7n theo y\xeau c\u1ea7u c\u1ee7a KH",_persistence_fetchGroup:null}},{label:"DDOI - Di d\u1eddi c\xf4ng t\u01a1",value:"DDOI",item:{maDtuong:null,maLoaiYcau:"DDOI",maNhomYcau:14,maTto:"DC",moTa:null,soNgay:null,stt:null,tenLoaiYcau:"Di d\u1eddi c\xf4ng t\u01a1",_persistence_fetchGroup:null}},{label:"CDLAI - C\u1ea5p \u0111i\u1ec7n l\u1ea1i theo y\xeau c\u1ea7u",value:"CDLAI",item:{maDtuong:null,maLoaiYcau:"CDLAI",maNhomYcau:15,maTto:"CL",moTa:null,soNgay:null,stt:null,tenLoaiYcau:"C\u1ea5p \u0111i\u1ec7n l\u1ea1i theo y\xeau c\u1ea7u",_persistence_fetchGroup:null}},{label:"TTTT - Th\xf4ng tin thanh to\xe1n",value:"TTTT",item:{maDtuong:null,maLoaiYcau:"TTTT",maNhomYcau:16,maTto:"TT",moTa:null,soNgay:null,stt:null,tenLoaiYcau:"Th\xf4ng tin thanh to\xe1n",_persistence_fetchGroup:null}},{label:"TLYKMOI - Y\xeau c\u1ea7u thanh l\xfd k\xfd m\u1edbi h\u1ee3p \u0111\u1ed3ng",value:"TLYKMOI",item:{maDtuong:null,maLoaiYcau:"TLYKMOI",maNhomYcau:9,maTto:"ST",moTa:null,soNgay:null,stt:null,tenLoaiYcau:"Y\xeau c\u1ea7u thanh l\xfd k\xfd m\u1edbi h\u1ee3p \u0111\u1ed3ng",_persistence_fetchGroup:null}},{label:"TLYHD - Y\xeau c\u1ea7u thanh l\xfd h\u1ee3p \u0111\u1ed3ng",value:"TLYHD",item:{maDtuong:null,maLoaiYcau:"TLYHD",maNhomYcau:8,maTto:"TL",moTa:null,soNgay:null,stt:null,tenLoaiYcau:"Y\xeau c\u1ea7u thanh l\xfd h\u1ee3p \u0111\u1ed3ng",_persistence_fetchGroup:null}},{label:"GHAN - Y\xeau c\u1ea7u gia h\u1ea1n h\u1ee3p \u0111\u1ed3ng",value:"GHAN",item:{maDtuong:null,maLoaiYcau:"GHAN",maNhomYcau:13,maTto:"GH",moTa:null,soNgay:null,stt:null,tenLoaiYcau:"Y\xeau c\u1ea7u gia h\u1ea1n h\u1ee3p \u0111\u1ed3ng",_persistence_fetchGroup:null}},{label:"SOHO - Thay \u0111\u1ed5i s\u1ed1 h\u1ed9",value:"SOHO",item:{maDtuong:null,maLoaiYcau:"SOHO",maNhomYcau:7,maTto:"SH",moTa:null,soNgay:null,stt:null,tenLoaiYcau:"Thay \u0111\u1ed5i s\u1ed1 h\u1ed9",_persistence_fetchGroup:null}}],routeName:"CapDienSHoatDT",phanHeThucHien:"CDIENDTU"}:{strMaDviqly:"PK0500",loaiYcau:"TCCS_D",maYcau:"",strTNTuNgay:this.tuNgay,strTNDenNgay:this.denNgay,daTN:!0,buocThien:"",nguoiYcau:"",kieuNgay:"",diaChi:"",typeDiaChi:"DCKHANG",dauTuCT:0,tuNgay:"29/09/2025",denNgay:"06/10/2025",mucDich:-1,thuanLoi:1,maKhang:"",sNgayND:"0",maHosoDVC:"",techID:"",lstLoaiDVAll:[{label:"CDIEN - C\xe2\u0301p \u0111i\xea\u0323n ha\u0323 a\u0301p (SH v\xe0 NSH)",value:"CDIEN",item:{maDtuong:"DD",maLoaiYcau:"CDIEN",maNhomYcau:1,maTto:"GK",moTa:null,soNgay:7,stt:1,tenLoaiYcau:"C\xe2\u0301p \u0111i\xea\u0323n ha\u0323 a\u0301p (SH v\xe0 NSH)",_persistence_fetchGroup:null}},{label:"TCCS_D - D\u1ecbch v\u1ee5 thay \u0111\u1ed5i c\xf4ng su\u1ea5t s\u1eed d\u1ee5ng",value:"TCCS_D",item:{maDtuong:null,maLoaiYcau:"TCCS_D",maNhomYcau:20,maTto:"TC",moTa:null,soNgay:null,stt:1,tenLoaiYcau:"D\u1ecbch v\u1ee5 thay \u0111\u1ed5i c\xf4ng su\u1ea5t s\u1eed d\u1ee5ng",_persistence_fetchGroup:null}},{label:"CDHA_D - D\u1ecbch v\u1ee5 c\u1ea5p \u0111i\u1ec7n h\u1ea1 \xe1p",value:"CDHA_D",item:{maDtuong:null,maLoaiYcau:"CDHA_D",maNhomYcau:17,maTto:"GK",moTa:null,soNgay:7,stt:1,tenLoaiYcau:"D\u1ecbch v\u1ee5 c\u1ea5p \u0111i\u1ec7n h\u1ea1 \xe1p",_persistence_fetchGroup:null}},{label:"CDMT - C\u1ea5p \u0111i\u1ec7n m\u1eb7t tr\u1eddi m\xe1i nh\xe0",value:"CDMT",item:{maDtuong:"DD",maLoaiYcau:"CDMT",maNhomYcau:1,maTto:"GK",moTa:null,soNgay:7,stt:2,tenLoaiYcau:"C\u1ea5p \u0111i\u1ec7n m\u1eb7t tr\u1eddi m\xe1i nh\xe0",_persistence_fetchGroup:null}},{label:"CDMT_D - C\u1ea5p \u0111i\u1ec7n m\u1eb7t tr\u1eddi m\xe1i nh\xe0",value:"CDMT_D",item:{maDtuong:"DD",maLoaiYcau:"CDMT_D",maNhomYcau:17,maTto:"GK",moTa:null,soNgay:7,stt:2,tenLoaiYcau:"C\u1ea5p \u0111i\u1ec7n m\u1eb7t tr\u1eddi m\xe1i nh\xe0",_persistence_fetchGroup:null}},{label:"CDTC - C\xe2\u0301p \u0111i\xea\u0323n ta\u0301ch c\xf4ng t\u01a1",value:"CDTC",item:{maDtuong:"DD",maLoaiYcau:"CDTC",maNhomYcau:20,maTto:"GK",moTa:null,soNgay:7,stt:2,tenLoaiYcau:"C\xe2\u0301p \u0111i\xea\u0323n ta\u0301ch c\xf4ng t\u01a1",_persistence_fetchGroup:null}},{label:"CDCC - C\xe2\u0301p \u0111i\xea\u0323n chung c\xf4ng t\u01a1",value:"CDCC",item:{maDtuong:"DD",maLoaiYcau:"CDCC",maNhomYcau:20,maTto:"GK",moTa:null,soNgay:7,stt:3,tenLoaiYcau:"C\xe2\u0301p \u0111i\xea\u0323n chung c\xf4ng t\u01a1",_persistence_fetchGroup:null}},{label:"CDNH - C\xe2\u0301p \u0111i\xea\u0323n ngoa\u0300i sinh hoa\u0323t ng\u0103\u0301n ha\u0323n",value:"CDNH",item:{maDtuong:null,maLoaiYcau:"CDNH",maNhomYcau:2,maTto:"GN",moTa:null,soNgay:null,stt:3,tenLoaiYcau:"C\xe2\u0301p \u0111i\xea\u0323n ngoa\u0300i sinh hoa\u0323t ng\u0103\u0301n ha\u0323n",_persistence_fetchGroup:null}},{label:"CDNM - C\xe2\u0301p \u0111i\xea\u0323n NSH c\xf4ng su\xe2\u0301t max >= 40kW",value:"CDNM",item:{maDtuong:"DD",maLoaiYcau:"CDNM",maNhomYcau:20,maTto:"GK",moTa:null,soNgay:7,stt:3,tenLoaiYcau:"C\xe2\u0301p \u0111i\xea\u0323n NSH c\xf4ng su\xe2\u0301t max >= 40kW",_persistence_fetchGroup:null}},{label:"CDNS - C\xe2\u0301p \u0111i\xea\u0323n NSH c\xf4ng su\xe2\u0301t max < 40kW",value:"CDNS",item:{maDtuong:"DD",maLoaiYcau:"CDNS",maNhomYcau:20,maTto:"GK",moTa:null,soNgay:7,stt:3,tenLoaiYcau:"C\xe2\u0301p \u0111i\xea\u0323n NSH c\xf4ng su\xe2\u0301t max < 40kW",_persistence_fetchGroup:null}},{label:"TBAC - C\u1ea5p \u0111i\u1ec7n trung \xe1p qua tr\u1ea1m chuy\xean d\xf9ng",value:"TBAC",item:{maDtuong:"DD",maLoaiYcau:"TBAC",maNhomYcau:3,maTto:"GC",moTa:null,soNgay:18,stt:23,tenLoaiYcau:"C\u1ea5p \u0111i\u1ec7n trung \xe1p qua tr\u1ea1m chuy\xean d\xf9ng",_persistence_fetchGroup:null}},{label:"TCCS - Thay \u0111\u1ed5i c\xf4ng su\u1ea5t",value:"TCCS",item:{maDtuong:"DD",maLoaiYcau:"TCCS",maNhomYcau:12,maTto:"TC",moTa:null,soNgay:7,stt:25,tenLoaiYcau:"Thay \u0111\u1ed5i c\xf4ng su\u1ea5t",_persistence_fetchGroup:null}},{label:"CKTS - C\u1ea5p \u0111i\u1ec7n trung \xe1p qua tr\u1ea1m CD KH SH",value:"CKTS",item:{maDtuong:"DD",maLoaiYcau:"CKTS",maNhomYcau:3,maTto:"GC",moTa:null,soNgay:18,stt:26,tenLoaiYcau:"C\u1ea5p \u0111i\u1ec7n trung \xe1p qua tr\u1ea1m CD KH SH",_persistence_fetchGroup:null}},{label:"TBAE - C\xe2\u0301p \u0111i\xea\u0323n TA N\u0110 \u0111\xe2\u0300u t\u01b0",value:"TBAE",item:{maDtuong:"DD",maLoaiYcau:"TBAE",maNhomYcau:4,maTto:"GC",moTa:null,soNgay:18,stt:26,tenLoaiYcau:"C\xe2\u0301p \u0111i\xea\u0323n TA N\u0110 \u0111\xe2\u0300u t\u01b0",_persistence_fetchGroup:null}},{label:"CKTM - C\xe2\u0301p \u0111i\xea\u0323n trung a\u0301p KH \u0111\xe2\u0300u t\u01b0, mua bu\xf4n \u0111i\xea\u0323n NT",value:"CKTM",item:{maDtuong:"DD",maLoaiYcau:"CKTM",maNhomYcau:3,maTto:"GC",moTa:null,soNgay:18,stt:26,tenLoaiYcau:"C\xe2\u0301p \u0111i\xea\u0323n trung a\u0301p KH \u0111\xe2\u0300u t\u01b0, mua bu\xf4n \u0111i\xea\u0323n NT",_persistence_fetchGroup:null}},{label:"TBAC_D - D\u1ecbch v\u1ee5 c\xe2\u0301p \u0111i\xea\u0323n TA KH \u0111\xe2\u0300u t\u01b0",value:"TBAC_D",item:{maDtuong:null,maLoaiYcau:"TBAC_D",maNhomYcau:18,maTto:"GC",moTa:null,soNgay:18,stt:27,tenLoaiYcau:"D\u1ecbch v\u1ee5 c\xe2\u0301p \u0111i\xea\u0323n TA KH \u0111\xe2\u0300u t\u01b0",_persistence_fetchGroup:null}},{label:"TCSTE_D - T\u0103ng c\u01b0\u1eddng c\xf4ng su\u1ea5t tr\u1ea1m chuy\xean d\xf9ng \u0111i\u1ec7n l\u1ef1c",value:"TCSTE_D",item:{maDtuong:null,maLoaiYcau:"TCSTE_D",maNhomYcau:18,maTto:"GC",moTa:null,soNgay:18,stt:28,tenLoaiYcau:"T\u0103ng c\u01b0\u1eddng c\xf4ng su\u1ea5t tr\u1ea1m chuy\xean d\xf9ng \u0111i\u1ec7n l\u1ef1c",_persistence_fetchGroup:null}},{label:"TBSC_D - D\u1ecbch v\u1ee5 c\xe2\u0301p \u0111i\xea\u0323n TA KH \u0111\xe2\u0300u t\u01b0, c\u1ea5p \u0111i\u1ec7n sinh ho\u1ea1t",value:"TBSC_D",item:{maDtuong:null,maLoaiYcau:"TBSC_D",maNhomYcau:18,maTto:"GC",moTa:"D\u1ecbch v\u1ee5 c\xe2\u0301p \u0111i\xea\u0323n TA KH \u0111\xe2\u0300u t\u01b0, c\u1ea5p \u0111i\u1ec7n sinh ho\u1ea1t",soNgay:18,stt:28,tenLoaiYcau:"D\u1ecbch v\u1ee5 c\xe2\u0301p \u0111i\xea\u0323n TA KH \u0111\xe2\u0300u t\u01b0, c\u1ea5p \u0111i\u1ec7n sinh ho\u1ea1t",_persistence_fetchGroup:null}},{label:"TBAE_D - D\u1ecbch v\u1ee5 c\xe2\u0301p \u0111i\xea\u0323n TA N\u0110 \u0111\xe2\u0300u t\u01b0",value:"TBAE_D",item:{maDtuong:null,maLoaiYcau:"TBAE_D",maNhomYcau:19,maTto:"GE",moTa:null,soNgay:18,stt:28,tenLoaiYcau:"D\u1ecbch v\u1ee5 c\xe2\u0301p \u0111i\xea\u0323n TA N\u0110 \u0111\xe2\u0300u t\u01b0",_persistence_fetchGroup:null}},{label:"TBMC_D - D\u1ecbch v\u1ee5 c\xe2\u0301p \u0111i\xea\u0323n TA KH \u0111\xe2\u0300u t\u01b0, c\u1ea5p \u0111i\u1ec7n mua bu\xf4n \u0111i\u1ec7n",value:"TBMC_D",item:{maDtuong:null,maLoaiYcau:"TBMC_D",maNhomYcau:18,maTto:"GC",moTa:"D\u1ecbch v\u1ee5 c\xe2\u0301p \u0111i\xea\u0323n TA KH \u0111\xe2\u0300u t\u01b0, c\u1ea5p \u0111i\u1ec7n mua bu\xf4n \u0111i\u1ec7n",soNgay:18,stt:29,tenLoaiYcau:"D\u1ecbch v\u1ee5 c\xe2\u0301p \u0111i\xea\u0323n TA KH \u0111\xe2\u0300u t\u01b0, c\u1ea5p \u0111i\u1ec7n mua bu\xf4n \u0111i\u1ec7n",_persistence_fetchGroup:null}},{label:"DDOI_D - D\u1ecbch v\u1ee5 thay \u0111\u1ed5i v\u1ecb tr\xed \u0111o \u0111\u1ebfm",value:"DDOI_D",item:{maDtuong:null,maLoaiYcau:"DDOI_D",maNhomYcau:21,maTto:"DC",moTa:null,soNgay:null,stt:30,tenLoaiYcau:"D\u1ecbch v\u1ee5 thay \u0111\u1ed5i v\u1ecb tr\xed \u0111o \u0111\u1ebfm",_persistence_fetchGroup:null}},{label:"MDSD_D - D\u1ecbch v\u1ee5 thay \u0111\u1ed5i m\u1ee5c \u0111\xedch s\u1eed d\u1ee5ng \u0111i\u1ec7n",value:"MDSD_D",item:{maDtuong:null,maLoaiYcau:"MDSD_D",maNhomYcau:22,maTto:"DM",moTa:null,soNgay:null,stt:31,tenLoaiYcau:"D\u1ecbch v\u1ee5 thay \u0111\u1ed5i m\u1ee5c \u0111\xedch s\u1eed d\u1ee5ng \u0111i\u1ec7n",_persistence_fetchGroup:null}},{label:"SOHO_D - D\u1ecbch v\u1ee5 thay \u0111\u1ed5i \u0111\u1ecbnh m\u1ee9c s\u1eed d\u1ee5ng \u0111i\u1ec7n",value:"SOHO_D",item:{maDtuong:null,maLoaiYcau:"SOHO_D",maNhomYcau:23,maTto:"SH",moTa:null,soNgay:null,stt:32,tenLoaiYcau:"D\u1ecbch v\u1ee5 thay \u0111\u1ed5i \u0111\u1ecbnh m\u1ee9c s\u1eed d\u1ee5ng \u0111i\u1ec7n",_persistence_fetchGroup:null}},{label:"CDKM_D - D\u1ecbch v\u1ee5 thay \u0111\u1ed5i ch\u1ee7 th\u1ec3 H\u0110MB\u0110",value:"CDKM_D",item:{maDtuong:null,maLoaiYcau:"CDKM_D",maNhomYcau:24,maTto:"ST",moTa:null,soNgay:null,stt:33,tenLoaiYcau:"D\u1ecbch v\u1ee5 thay \u0111\u1ed5i ch\u1ee7 th\u1ec3 H\u0110MB\u0110",_persistence_fetchGroup:null}},{label:"TTKH_D - D\u1ecbch v\u1ee5 thay \u0111\u1ed5i th\xf4ng tin",value:"TTKH_D",item:{maDtuong:null,maLoaiYcau:"TTKH_D",maNhomYcau:25,maTto:"TI",moTa:null,soNgay:null,stt:34,tenLoaiYcau:"D\u1ecbch v\u1ee5 thay \u0111\u1ed5i th\xf4ng tin",_persistence_fetchGroup:null}},{label:"GHAN_D - D\u1ecbch v\u1ee5 gia h\u1ea1n h\u1ee3p \u0111\u1ed3ng",value:"GHAN_D",item:{maDtuong:null,maLoaiYcau:"GHAN_D",maNhomYcau:26,maTto:"GH",moTa:null,soNgay:null,stt:35,tenLoaiYcau:"D\u1ecbch v\u1ee5 gia h\u1ea1n h\u1ee3p \u0111\u1ed3ng",_persistence_fetchGroup:null}},{label:"CDHD_D - D\u1ecbch v\u1ee5 ch\u1ea5m d\u1ee9t h\u1ee3p \u0111\u1ed3ng",value:"CDHD_D",item:{maDtuong:null,maLoaiYcau:"CDHD_D",maNhomYcau:27,maTto:"TL",moTa:null,soNgay:null,stt:36,tenLoaiYcau:"D\u1ecbch v\u1ee5 ch\u1ea5m d\u1ee9t h\u1ee3p \u0111\u1ed3ng",_persistence_fetchGroup:null}},{label:"HDSD - D\u1ecbch v\u1ee5 h\u1ee3p \u0111\u1ed3ng sau d\xe2y",value:"HDSD",item:{maDtuong:null,maLoaiYcau:"HDSD",maNhomYcau:28,maTto:"SD",moTa:null,soNgay:null,stt:37,tenLoaiYcau:"D\u1ecbch v\u1ee5 h\u1ee3p \u0111\u1ed3ng sau d\xe2y",_persistence_fetchGroup:null}},{label:"DDOI_N - Nghi\u1ec7p v\u1ee5 di d\u1eddi n\u1ed9i b\u1ed9",value:"DDOI_N",item:{maDtuong:null,maLoaiYcau:"DDOI_N",maNhomYcau:29,maTto:"DC",moTa:null,soNgay:null,stt:38,tenLoaiYcau:"Nghi\u1ec7p v\u1ee5 di d\u1eddi n\u1ed9i b\u1ed9",_persistence_fetchGroup:null}},{label:"MDSD_N - Nghi\u1ec7p v\u1ee5 thay \u0111\u1ed5i m\u1ee5c \u0111\xedch s\u1eed d\u1ee5ng \u0111i\u1ec7n n\u1ed9i b\u1ed9",value:"MDSD_N",item:{maDtuong:null,maLoaiYcau:"MDSD_N",maNhomYcau:30,maTto:"DM",moTa:null,soNgay:null,stt:39,tenLoaiYcau:"Nghi\u1ec7p v\u1ee5 thay \u0111\u1ed5i m\u1ee5c \u0111\xedch s\u1eed d\u1ee5ng \u0111i\u1ec7n n\u1ed9i b\u1ed9",_persistence_fetchGroup:null}},{label:"SOHO_N - Nghi\u1ec7p v\u1ee5 thay \u0111\u1ed5i s\u1ed1 h\u1ed9 n\u1ed9i b\u1ed9",value:"SOHO_N",item:{maDtuong:null,maLoaiYcau:"SOHO_N",maNhomYcau:31,maTto:"SH",moTa:null,soNgay:null,stt:40,tenLoaiYcau:"Nghi\u1ec7p v\u1ee5 thay \u0111\u1ed5i s\u1ed1 h\u1ed9 n\u1ed9i b\u1ed9",_persistence_fetchGroup:null}},{label:"TTKH_N - Nghi\u1ec7p v\u1ee5 thay \u0111\u1ed5i th\xf4ng tin kh\xe1ch h\xe0ng n\u1ed9i b\u1ed9",value:"TTKH_N",item:{maDtuong:null,maLoaiYcau:"TTKH_N",maNhomYcau:32,maTto:"TI",moTa:null,soNgay:null,stt:41,tenLoaiYcau:"Nghi\u1ec7p v\u1ee5 thay \u0111\u1ed5i th\xf4ng tin kh\xe1ch h\xe0ng n\u1ed9i b\u1ed9",_persistence_fetchGroup:null}},{label:"GHAN_N - Nghi\u1ec7p v\u1ee5 gia h\u1ea1n h\u1ee3p \u0111\u1ed3ng n\u1ed9i b\u1ed9",value:"GHAN_N",item:{maDtuong:null,maLoaiYcau:"GHAN_N",maNhomYcau:33,maTto:"GH",moTa:null,soNgay:null,stt:42,tenLoaiYcau:"Nghi\u1ec7p v\u1ee5 gia h\u1ea1n h\u1ee3p \u0111\u1ed3ng n\u1ed9i b\u1ed9",_persistence_fetchGroup:null}},{label:"CDHD_N - Nghi\u1ec7p v\u1ee5 ch\u1ea5m d\u1ee9t h\u1ee3p \u0111\u1ed3ng n\u1ed9i b\u1ed9",value:"CDHD_N",item:{maDtuong:null,maLoaiYcau:"CDHD_N",maNhomYcau:34,maTto:"TL",moTa:null,soNgay:null,stt:43,tenLoaiYcau:"Nghi\u1ec7p v\u1ee5 ch\u1ea5m d\u1ee9t h\u1ee3p \u0111\u1ed3ng n\u1ed9i b\u1ed9",_persistence_fetchGroup:null}},{label:"TTNB_N - Nghi\u1ec7p v\u1ee5 treo th\xe1o thi\u1ebft b\u1ecb \u0111o \u0111\u1ebfm n\u1ed9i b\u1ed9",value:"TTNB_N",item:{maDtuong:null,maLoaiYcau:"TTNB_N",maNhomYcau:35,maTto:"TD",moTa:null,soNgay:null,stt:44,tenLoaiYcau:"Nghi\u1ec7p v\u1ee5 treo th\xe1o thi\u1ebft b\u1ecb \u0111o \u0111\u1ebfm n\u1ed9i b\u1ed9",_persistence_fetchGroup:null}},{label:"CDKM_N - Nghi\u1ec7p v\u1ee5 ch\u1ea5m d\u1ee9t k\xfd m\u1edbi h\u1ee3p \u0111\u1ed3ng",value:"CDKM_N",item:{maDtuong:null,maLoaiYcau:"CDKM_N",maNhomYcau:38,maTto:"ST",moTa:null,soNgay:null,stt:45,tenLoaiYcau:"Nghi\u1ec7p v\u1ee5 ch\u1ea5m d\u1ee9t k\xfd m\u1edbi h\u1ee3p \u0111\u1ed3ng",_persistence_fetchGroup:null}},{label:"KLMT_D - K\xfd h\u1ee3p \u0111\u1ed3ng m\u1eb7t tr\u1eddi m\xe1i nh\xe0",value:"KLMT_D",item:{maDtuong:"DD",maLoaiYcau:"KLMT_D",maNhomYcau:36,maTto:"MT",moTa:null,soNgay:7,stt:46,tenLoaiYcau:"K\xfd h\u1ee3p \u0111\u1ed3ng m\u1eb7t tr\u1eddi m\xe1i nh\xe0",_persistence_fetchGroup:null}},{label:"KMMT_D - K\xfd m\u1edbi h\u1ee3p \u0111\u1ed3ng m\u1eb7t tr\u1eddi m\xe1i nh\xe0 TSTT",value:"KMMT_D",item:{maDtuong:"DD",maLoaiYcau:"KMMT_D",maNhomYcau:36,maTto:"MT",moTa:"K\xfd m\u1edbi h\u1ee3p \u0111\u1ed3ng m\u1eb7t tr\u1eddi m\xe1i nh\xe0 TSTT",soNgay:7,stt:47,tenLoaiYcau:"K\xfd m\u1edbi h\u1ee3p \u0111\u1ed3ng m\u1eb7t tr\u1eddi m\xe1i nh\xe0 TSTT",_persistence_fetchGroup:null}},{label:"TLMT_D - D\u1ecbch v\u1ee5 ch\u1ea5m d\u1ee9t h\u1ee3p \u0111\u1ed3ng m\u1eb7t tr\u1eddi",value:"TLMT_D",item:{maDtuong:"KH",maLoaiYcau:"TLMT_D",maNhomYcau:37,maTto:"LT",moTa:"D\u1ecbch v\u1ee5 ch\u1ea5m d\u1ee9t h\u1ee3p \u0111\u1ed3ng m\u1eb7t tr\u1eddi",soNgay:null,stt:48,tenLoaiYcau:"D\u1ecbch v\u1ee5 ch\u1ea5m d\u1ee9t h\u1ee3p \u0111\u1ed3ng m\u1eb7t tr\u1eddi",_persistence_fetchGroup:null}},{label:"TTKM_D - D\u1ecbch v\u1ee5 thay \u0111\u1ed5i th\xf4ng tin h\u1ee3p \u0111\u1ed3ng \u0111i\u1ec7n MTNM",value:"TTKM_D",item:{maDtuong:"KH",maLoaiYcau:"TTKM_D",maNhomYcau:39,maTto:"TM",moTa:"D\u1ecbch v\u1ee5 thay \u0111\u1ed5i th\xf4ng tin h\u1ee3p \u0111\u1ed3ng \u0111i\u1ec7n MTNM",soNgay:null,stt:49,tenLoaiYcau:"D\u1ecbch v\u1ee5 thay \u0111\u1ed5i th\xf4ng tin h\u1ee3p \u0111\u1ed3ng \u0111i\u1ec7n MTNM",_persistence_fetchGroup:null}},{label:"CDCC_D - C\xe2\u0301p \u0111i\xea\u0323n chung c\xf4ng t\u01a1",value:"CDCC_D",item:{maDtuong:null,maLoaiYcau:"CDCC_D",maNhomYcau:17,maTto:"GK",moTa:"C\xe2\u0301p \u0111i\xea\u0323n chung c\xf4ng t\u01a1",soNgay:7,stt:50,tenLoaiYcau:"C\xe2\u0301p \u0111i\xea\u0323n chung c\xf4ng t\u01a1",_persistence_fetchGroup:null}},{label:"CDTC_D - C\u1ea5p \u0111i\u1ec7n t\xe1ch c\xf4ng t\u01a1 d\xf9ng chung",value:"CDTC_D",item:{maDtuong:null,maLoaiYcau:"CDTC_D",maNhomYcau:17,maTto:"GK",moTa:"C\u1ea5p \u0111i\u1ec7n t\xe1ch c\xf4ng t\u01a1 d\xf9ng chung",soNgay:7,stt:51,tenLoaiYcau:"C\u1ea5p \u0111i\u1ec7n t\xe1ch c\xf4ng t\u01a1 d\xf9ng chung",_persistence_fetchGroup:null}},{label:"CDNS_D - D\u1ecbch v\u1ee5 c\xe2\u0301p \u0111i\xea\u0323n NSH c\xf4ng su\xe2\u0301t max < 40kW",value:"CDNS_D",item:{maDtuong:null,maLoaiYcau:"CDNS_D",maNhomYcau:17,maTto:"GK",moTa:"D\u1ecbch v\u1ee5 c\xe2\u0301p \u0111i\xea\u0323n NSH c\xf4ng su\xe2\u0301t max < 40kW",soNgay:7,stt:52,tenLoaiYcau:"D\u1ecbch v\u1ee5 c\xe2\u0301p \u0111i\xea\u0323n NSH c\xf4ng su\xe2\u0301t max < 40kW",_persistence_fetchGroup:null}},{label:"CDNM_D - D\u1ecbch v\u1ee5 c\xe2\u0301p \u0111i\xea\u0323n NSH c\xf4ng su\xe2\u0301t max >= 40kW",value:"CDNM_D",item:{maDtuong:null,maLoaiYcau:"CDNM_D",maNhomYcau:17,maTto:"GK",moTa:"D\u1ecbch v\u1ee5 c\xe2\u0301p \u0111i\xea\u0323n NSH c\xf4ng su\xe2\u0301t max >= 40kW",soNgay:7,stt:53,tenLoaiYcau:"D\u1ecbch v\u1ee5 c\xe2\u0301p \u0111i\xea\u0323n NSH c\xf4ng su\xe2\u0301t max >= 40kW",_persistence_fetchGroup:null}},{label:"CDNH_D - D\u1ecbch v\u1ee5 c\xe2\u0301p \u0111i\xea\u0323n NSH ng\u1eafn h\u1ea1n",value:"CDNH_D",item:{maDtuong:null,maLoaiYcau:"CDNH_D",maNhomYcau:17,maTto:"GK",moTa:"D\u1ecbch v\u1ee5 c\xe2\u0301p \u0111i\xea\u0323n NSH ng\u1eafn h\u1ea1n",soNgay:7,stt:54,tenLoaiYcau:"D\u1ecbch v\u1ee5 c\xe2\u0301p \u0111i\xea\u0323n NSH ng\u1eafn h\u1ea1n",_persistence_fetchGroup:null}},{label:"KTCT_D - D\u1ecbch v\u1ee5 ki\u1ec3m tra c\xf4ng t\u01a1",value:"KTCT_D",item:{maDtuong:"DD",maLoaiYcau:"KTCT_D",maNhomYcau:40,maTto:"KR",moTa:"D\u1ecbch v\u1ee5 ki\u1ec3m tra c\xf4ng t\u01a1",soNgay:7,stt:55,tenLoaiYcau:"D\u1ecbch v\u1ee5 ki\u1ec3m tra c\xf4ng t\u01a1",_persistence_fetchGroup:null}},{label:"CDLAI_D - D\u1ecbch v\u1ee5 c\u1ea5p \u0111i\u1ec7n tr\u1edf l\u1ea1i theo KH y\xeau c\u1ea7u",value:"CDLAI_D",item:{maDtuong:null,maLoaiYcau:"CDLAI_D",maNhomYcau:41,maTto:"CL",moTa:"D\u1ecbch v\u1ee5 c\u1ea5p \u0111i\u1ec7n tr\u1edf l\u1ea1i theo KH y\xeau c\u1ea7u",soNgay:7,stt:56,tenLoaiYcau:"D\u1ecbch v\u1ee5 c\u1ea5p \u0111i\u1ec7n tr\u1edf l\u1ea1i theo KH y\xeau c\u1ea7u",_persistence_fetchGroup:null}},{label:"CSPK_N - Nghi\u1ec7p v\u1ee5 k\xfd mua CSPK",value:"CSPK_N",item:{maDtuong:null,maLoaiYcau:"CSPK_N",maNhomYcau:42,maTto:"CS",moTa:"Nghi\u1ec7p v\u1ee5 k\xfd mua CSPK",soNgay:null,stt:57,tenLoaiYcau:"Nghi\u1ec7p v\u1ee5 k\xfd mua CSPK",_persistence_fetchGroup:null}},{label:"BDHD_N - Nghi\u1ec7p v\u1ee5 b\u1ea3o \u0111\u1ea3m th\u1ef1c hi\u1ec7n h\u1ee3p \u0111\u1ed3ng",value:"BDHD_N",item:{maDtuong:null,maLoaiYcau:"BDHD_N",maNhomYcau:43,maTto:"BD",moTa:"Nghi\u1ec7p v\u1ee5 b\u1ea3o \u0111\u1ea3m th\u1ef1c hi\u1ec7n h\u1ee3p \u0111\u1ed3ng",soNgay:null,stt:58,tenLoaiYcau:"Nghi\u1ec7p v\u1ee5 b\u1ea3o \u0111\u1ea3m th\u1ef1c hi\u1ec7n h\u1ee3p \u0111\u1ed3ng",_persistence_fetchGroup:null}},{label:"TTKH - Y\xeau c\u1ea7u thay \u0111\u1ed5i th\xf4ng tin kh\xe1ch h\xe0ng",value:"TTKH",item:{maDtuong:null,maLoaiYcau:"TTKH",maNhomYcau:11,maTto:"TI",moTa:null,soNgay:null,stt:null,tenLoaiYcau:"Y\xeau c\u1ea7u thay \u0111\u1ed5i th\xf4ng tin kh\xe1ch h\xe0ng",_persistence_fetchGroup:null}},{label:"MDSD - Thay \u0111\u1ed5i m\u1ee5c \u0111\xedch s\u1eed d\u1ee5ng \u0111i\u1ec7n",value:"MDSD",item:{maDtuong:null,maLoaiYcau:"MDSD",maNhomYcau:6,maTto:"DM",moTa:null,soNgay:null,stt:null,tenLoaiYcau:"Thay \u0111\u1ed5i m\u1ee5c \u0111\xedch s\u1eed d\u1ee5ng \u0111i\u1ec7n",_persistence_fetchGroup:null}},{label:"KTCT - Ki\u1ec3m tra c\xf4ng t\u01a1",value:"KTCT",item:{maDtuong:"DD",maLoaiYcau:"KTCT",maNhomYcau:5,maTto:"KR",moTa:null,soNgay:null,stt:null,tenLoaiYcau:"Ki\u1ec3m tra c\xf4ng t\u01a1",_persistence_fetchGroup:null}},{label:"TNCD - Ng\u1eebng c\u1ea5p \u0111i\u1ec7n theo y\xeau c\u1ea7u c\u1ee7a KH",value:"TNCD",item:{maDtuong:null,maLoaiYcau:"TNCD",maNhomYcau:10,maTto:"NG",moTa:null,soNgay:null,stt:null,tenLoaiYcau:"Ng\u1eebng c\u1ea5p \u0111i\u1ec7n theo y\xeau c\u1ea7u c\u1ee7a KH",_persistence_fetchGroup:null}},{label:"DDOI - Di d\u1eddi c\xf4ng t\u01a1",value:"DDOI",item:{maDtuong:null,maLoaiYcau:"DDOI",maNhomYcau:14,maTto:"DC",moTa:null,soNgay:null,stt:null,tenLoaiYcau:"Di d\u1eddi c\xf4ng t\u01a1",_persistence_fetchGroup:null}},{label:"CDLAI - C\u1ea5p \u0111i\u1ec7n l\u1ea1i theo y\xeau c\u1ea7u",value:"CDLAI",item:{maDtuong:null,maLoaiYcau:"CDLAI",maNhomYcau:15,maTto:"CL",moTa:null,soNgay:null,stt:null,tenLoaiYcau:"C\u1ea5p \u0111i\u1ec7n l\u1ea1i theo y\xeau c\u1ea7u",_persistence_fetchGroup:null}},{label:"TTTT - Th\xf4ng tin thanh to\xe1n",value:"TTTT",item:{maDtuong:null,maLoaiYcau:"TTTT",maNhomYcau:16,maTto:"TT",moTa:null,soNgay:null,stt:null,tenLoaiYcau:"Th\xf4ng tin thanh to\xe1n",_persistence_fetchGroup:null}},{label:"TLYKMOI - Y\xeau c\u1ea7u thanh l\xfd k\xfd m\u1edbi h\u1ee3p \u0111\u1ed3ng",value:"TLYKMOI",item:{maDtuong:null,maLoaiYcau:"TLYKMOI",maNhomYcau:9,maTto:"ST",moTa:null,soNgay:null,stt:null,tenLoaiYcau:"Y\xeau c\u1ea7u thanh l\xfd k\xfd m\u1edbi h\u1ee3p \u0111\u1ed3ng",_persistence_fetchGroup:null}},{label:"TLYHD - Y\xeau c\u1ea7u thanh l\xfd h\u1ee3p \u0111\u1ed3ng",value:"TLYHD",item:{maDtuong:null,maLoaiYcau:"TLYHD",maNhomYcau:8,maTto:"TL",moTa:null,soNgay:null,stt:null,tenLoaiYcau:"Y\xeau c\u1ea7u thanh l\xfd h\u1ee3p \u0111\u1ed3ng",_persistence_fetchGroup:null}},{label:"GHAN - Y\xeau c\u1ea7u gia h\u1ea1n h\u1ee3p \u0111\u1ed3ng",value:"GHAN",item:{maDtuong:null,maLoaiYcau:"GHAN",maNhomYcau:13,maTto:"GH",moTa:null,soNgay:null,stt:null,tenLoaiYcau:"Y\xeau c\u1ea7u gia h\u1ea1n h\u1ee3p \u0111\u1ed3ng",_persistence_fetchGroup:null}},{label:"SOHO - Thay \u0111\u1ed5i s\u1ed1 h\u1ed9",value:"SOHO",item:{maDtuong:null,maLoaiYcau:"SOHO",maNhomYcau:7,maTto:"SH",moTa:null,soNgay:null,stt:null,tenLoaiYcau:"Thay \u0111\u1ed5i s\u1ed1 h\u1ed9",_persistence_fetchGroup:null}}],routeName:"CapDienSHoatHDDT",phanHeThucHien:"HDONGDTU"}).then(l=>{this.tongYeuCau=l;for(let u=0;u<l.length;u++){const h=l[u];if("CH9"==h.MA_CVIEC&&0==e||"PC"==h.MA_CVIEC&&1==e){let p={MA_KHANG:h.MA_KHANG,TEN_KHANG:h.TEN_KHANG,DTHOAI_DVU:h.DTHOAI,DIA_CHI:h.DUONG_PHO,CHUOI_GIA:h.CHUOI_GIA,MA_LOAI_YCAU:h.MA_LOAI_YCAU,SNGAY_HENMAX:h.SNGAY_HENMAX,NGAY_GIAO:N()().format("DD/MM/YYYY"),NGUOI_GIAO:window.max.fullName};console.log(h),this.phanCong.push(p)}}this.phanCong.sort((u,h)=>u.MA_KHANG>h.MA_KHANG?1:-1)})}exportCDHA(){this.excelSV.export(this.tongYeuCau,"CDHA")}setValueByKey(e,n){this.giaoHS[n][e]=this.main.get(e).value,console.log(this.giaoHS[n])}addGiaoHS(e,n){let o=this.main.value;e.GHI_CHU=o.GHI_CHU,e.LOAI_CTO=o.LOAI_CTO,this.giaoHS.push(e),this.phanCong.splice(n,1)}getDate(e,n){0==n?this.tuNgay=e:this.denNgay=e}xoaPhanCong(e,n){this.giaoHS.splice(n,1),this.phanCong.push(e)}getHeader(){var e=this;return(0,g.Z)(function*(){return e.sheetdbSV.get(e.spreadsheetId,e.snGiaKho+"!1:1").subscribe(n=>{console.log(n),e.headerKeys=n[0]})})()}getSoHoa(){var e=this;return(0,g.Z)(function*(){e.sheetdbSV.getAll("1zhuwB9qoLm5kyFfpJFoa-1yKKsMN1Ltn9tejML8Dguo","SoHoa").then(n=>{console.log(n[0]),e.idbSV.IDB_DB_Add(e.db,e.api,n)})})()}read(){var e=this;return(0,g.Z)(function*(){let n=[];const o=yield e.sheetdbSV.getAll(e.spreadsheetId,e.snGiaKho);if(console.log("D\u1eef li\u1ec7u:",o),0==o.length)return e.plus.alertSuccess("Kh\xf4ng c\xf3 h\u1ed3 s\u01a1 giao ng\xe0y n\xe0y");for(let l=0;l<o.length;l++){const u=o[l];u.NGAY_GIAO==e.ngay&&u.NGUOI_GIAO==window.max.fullName&&n.push(u)}let a={NGUOI_GIAO:window.max.fullName,NGAY_GIAO:e.ngay,tb:n};e.docxSV.loadFileByName("BB-GiaoKho").then(function(){var l=(0,g.Z)(function*(u){e.docxSV.generateOne(a,u,e.ngay)});return function(u){return l.apply(this,arguments)}}())})()}readGanMoi(e=0){var n=this;return(0,g.Z)(function*(){let o=0==e?n.ngay:n.denNgay,a=[];const l=yield n.sheetdbSV.getAll(n.spreadsheetId,n.snDienKe);console.log("D\u1eef li\u1ec7u:",l);for(let h=0;h<l.length;h++){const p=l[h];p.NGAY_GIAO==o&&p.NGUOI_GIAO==window.max.fullName&&a.push(p)}let u={NGUOI_GIAO:window.max.fullName,NGAY_GIAO:n.ngay,tb:a};n.docxSV.loadFileByName("BB-GiaoGanMoi").then(function(){var h=(0,g.Z)(function*(p){n.docxSV.generateOne(u,p,n.ngay)});return function(p){return h.apply(this,arguments)}}())})()}saveToStorage(){localStorage.setItem(this.localKey,JSON.stringify(this.items))}clearToStorage(){localStorage.setItem(this.localKey,JSON.stringify([]))}loadFromStorage(){const e=localStorage.getItem(this.localKey);e&&(this.items=JSON.parse(e))}addKiemTra(){var e=this;return(0,g.Z)(function*(){let n=e.main.value;n.MA_KHANG=e.cmis4SV.convertPK(n.MA_KHANG);let o=yield e.getSoTT(n.MA_KHANG);n.STT=o?.SoThuTu||"";let a=yield e.cmis4SV.layTtinKHangMoinhat(n.MA_KHANG);if(n.TEN_KHANG=a.HDG_KHACH_HANG[0].TEN_KHANG,n.NGUOI_GIAO=window.max.fullName,n.NGAY_GIAO=N()().format("DD/MM/YYYY"),n.LOAI_HS=e.loaiHS,n.PHAN_CONG=e.ngKt.value.PHAN_CONG,0==n.MA_KHANG.length||0==n.LOAI_HS.length||0==n.PHAN_CONG.length)return e.plus.alertWarning("Vui l\xf2ng nh\u1eadp \u0111\u1ee7 th\xf4ng tin");e.items.push(n),e.main.reset(),e.main.controls.LOAI_HS.setValue(n.LOAI_HS),e.main.controls.PHAN_CONG.setValue(n.PHAN_CONG),e.saveToStorage(),e.plus.focusById("MA_KHANG")})()}addCustomer(){var e=this;return(0,g.Z)(function*(){let n=e.main.value;if(n.MA_KHANG=e.cmis4SV.convertPK(n.MA_KHANG),0==n.MA_KHANG.length||0==n.LOAI_HS.length)return e.plus.alertWarning("Vui l\xf2ng nh\u1eadp \u0111\u1ee7 th\xf4ng tin");let o=yield e.getSoTT(n.MA_KHANG);n.STT=o?.SoThuTu||"";let a=yield e.cmis4SV.layTtinKHangMoinhat(n.MA_KHANG);n.TEN_KHANG=a.HDG_KHACH_HANG[0].TEN_KHANG,n.NGUOI_GIAO=window.max.fullName,n.NGAY_GIAO=N()().format("DD/MM/YYYY"),e.items.push(n),e.main.reset(),e.main.controls.LOAI_HS.setValue(n.LOAI_HS),e.main.controls.PHAN_CONG.setValue(n.PHAN_CONG),e.saveToStorage(),e.plus.focusById("MA_KHANG")})()}deleteCustomer(e){this.items.splice(e,1),this.saveToStorage()}saveCustomer(){var e=this;return(0,g.Z)(function*(){e.loadSV.load("saveCustomer"),e.sheetdbSV.addMany(e.spreadsheetId,e.snGiaKho,e.items).then(n=>{console.log(n),200==+n.status&&(e.clearToStorage(),e.plus.alertSuccess("\u0110\xe3 l\u01b0u th\xe0nh c\xf4ng"),e.items=[]),e.loadSV.loaded("saveCustomer")})})()}saveDienKe(){var e=this;return(0,g.Z)(function*(){e.loadSV.load("saveDienKe"),e.sheetdbSV.addMany(e.spreadsheetId,e.snDienKe,e.giaoHS).then(n=>{console.log(n),200==+n.status&&(e.clearToStorage(),e.plus.alertSuccess("\u0110\xe3 l\u01b0u th\xe0nh c\xf4ng"),e.giaoHS=[],e.readGanMoi(),e.loadSV.loaded("saveDienKe"))})})()}saveKiemTra(){var e=this;return(0,g.Z)(function*(){e.loadSV.load("saveKiemTra"),e.sheetdbSV.addMany(e.spreadsheetId,e.snKiemTra,e.items).then(o=>{console.log(o),200==+o.status&&(e.clearToStorage(),e.plus.alertSuccess("\u0110\xe3 l\u01b0u th\xe0nh c\xf4ng"),e.items=[],e.readKiemTra(),e.loadSV.loaded("saveKiemTra"))})})()}readKiemTra(){var e=this;return(0,g.Z)(function*(){let n=[];const o=yield e.sheetdbSV.getAll(e.spreadsheetId,e.snKiemTra);console.log("D\u1eef li\u1ec7u:",o);for(let l=0;l<o.length;l++){const u=o[l];u.NGAY_GIAO==e.ngay&&n.push(u)}let a={NGUOI_GIAO:window.max.fullName,NGAY_GIAO:e.ngay,tb:n};e.docxSV.loadFileByName("BB-GiaoKho").then(function(){var l=(0,g.Z)(function*(u){e.docxSV.generateOne(a,u,e.ngay)});return function(u){return l.apply(this,arguments)}}())})()}getSoTT(e){var n=this;return(0,g.Z)(function*(){return n.idbSV.IDB_DB_GetById(n.db,n.api,n.cmis4SV.convertPK(e)).catch(o=>null)})()}checkPer(e,n=this.api){return!!window.max&&window.max.opt[n]>e}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(O.a),t.Y36(k.o),t.Y36(Q.F),t.Y36(f.T),t.Y36(J.E),t.Y36(b.x),t.Y36(V.F),t.Y36(K.b))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-giao-ho-so"]],decls:99,vars:27,consts:[[1,"container","py-3"],[1,"btn"],["href","https://docs.google.com/spreadsheets/d/e/2PACX-1vTafHDzF91q-8bUbDSincnSbiURNIvjrFLOq6XDAZ9sWTaSpKAMidqZMDYU3D0A7ylsszdQw_ksBkuB/pubhtml","target","_blank"],["mat-raised-button",""],[1,"row"],[1,"table","table-striped","table-hover"],["scope","col"],[4,"ngFor","ngForOf"],[3,"formGroup"],["matInput","","id","MA_KHANG","required","","placeholder","M\xe3 kh\xe1ch h\xe0ng","formControlName","MA_KHANG",3,"keyup.enter"],["matInput","","required","","placeholder","Lo\u1ea1i h\u1ed3 s\u01a1","formControlName","LOAI_HS",3,"keyup.enter"],["colspan","5","class","text-center",4,"ngIf"],[1,"col"],[3,"startDay","openOnFocus","label","format","month"],["mat-raised-button","","color","primary",3,"click"],["mat-raised-button","","color","accent",3,"click"],["class","table  table-striped table-hover",4,"ngIf"],["class","row",4,"ngIf"],[1,"col",3,"formGroup"],["type","text","placeholder","Ng\xe2n h\xe0ng \u0111\u01a1n v\u1ecb nh\u1eadn ti\u1ec1n","matInput","","formControlName","PHAN_CONG",3,"matAutocomplete"],["matPrefix","","color","warn","mat-icon-button","",3,"click"],["auto","matAutocomplete"],[3,"click",4,"ngFor","ngForOf"],["colspan","3"],[3,"click"],["colspan","5",1,"text-center"],["mat-raised-button","","color","warn",3,"click"],[3,"formGroup",4,"ngFor","ngForOf"],[4,"ngIf"],["colspan","8"],["matInput","","formControlName","LOAI_CTO",3,"matAutocomplete","blur"],["autoActiveFirstOption",""],["autoLOAI_CTO","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],["matInput","","formControlName","GHI_CHU",3,"matAutocomplete","blur"],["autoGHI_CHU","matAutocomplete"],["color","warn",3,"click"],[3,"value"],["colspan","4",3,"click"],[1,"font-blue"]],template:function(e,n){if(1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"a",2)(3,"button",3),t._uU(4," Xem d\u1eef li\u1ec7u"),t.qZA()()(),t.TgZ(5,"div",4)(6,"mat-expansion-panel")(7,"mat-expansion-panel-header"),t._uU(8," Giao Kho "),t.qZA(),t.TgZ(9,"table",5)(10,"thead")(11,"tr")(12,"th",6),t._uU(13,"TT"),t.qZA(),t.TgZ(14,"th",6),t._uU(15,"M\xe3 KH"),t.qZA(),t.TgZ(16,"th",6),t._uU(17,"STT h\u1ed3 s\u01a1"),t.qZA(),t.TgZ(18,"th",6),t._uU(19,"T\xean KH"),t.qZA(),t.TgZ(20,"th"),t._uU(21,"Lo\u1ea1i h\u1ed3 s\u01a1"),t.qZA(),t._UZ(22,"th"),t.qZA()(),t.TgZ(23,"tbody"),t.YNc(24,$e,15,5,"tr",7),t.TgZ(25,"tr",8),t._UZ(26,"td"),t.TgZ(27,"td")(28,"mat-form-field")(29,"input",9),t.NdJ("keyup.enter",function(){return n.addCustomer()}),t.qZA()()(),t.TgZ(30,"td")(31,"mat-form-field")(32,"input",10),t.NdJ("keyup.enter",function(){return n.addCustomer()}),t.qZA()()()(),t.TgZ(33,"tr"),t.YNc(34,je,4,0,"td",11),t.qZA()()(),t.TgZ(35,"div",4)(36,"div",12)(37,"app-date-picker",13),t.NdJ("month",function(a){return n.ngay=a}),t.qZA()(),t.TgZ(38,"button",14),t.NdJ("click",function(){return n.read()}),t._uU(39,"L\u1ea5y danh s\xe1ch theo ng\xe0y"),t.qZA()()()(),t.TgZ(40,"div",4)(41,"mat-expansion-panel")(42,"mat-expansion-panel-header"),t._uU(43," Giao G\u1eafn M\u1edbi "),t.qZA(),t.TgZ(44,"app-date-picker",13),t.NdJ("month",function(a){return n.getDate(a,0)}),t.qZA(),t.TgZ(45,"app-date-picker",13),t.NdJ("month",function(a){return n.getDate(a,1)}),t.qZA(),t.TgZ(46,"div",1)(47,"button",15),t.NdJ("click",function(){return n.timYeuCau(0)}),t._uU(48,"G\u1eafn m\u1edbi"),t.qZA(),t.TgZ(49,"button",15),t.NdJ("click",function(){return n.timYeuCau(1)}),t._uU(50,"T\u0103ng CS"),t.qZA(),t.TgZ(51,"button",14),t.NdJ("click",function(){return n.readGanMoi(1)}),t._uU(52,"L\u1ea5y danh s\xe1ch theo ng\xe0y"),t.qZA()(),t.YNc(53,nn,23,3,"table",16),t.qZA()(),t.TgZ(54,"div",4)(55,"mat-expansion-panel")(56,"mat-expansion-panel-header"),t._uU(57," Ki\u1ec3m Tra \u0110\u1ecbnh K\u1ef3 "),t.qZA(),t.YNc(58,an,3,1,"div",17),t.TgZ(59,"div",4)(60,"div",18)(61,"mat-form-field")(62,"mat-label"),t._uU(63,"Ng\u01b0\u1eddi ki\u1ec3m tra"),t.qZA(),t._UZ(64,"input",19),t.TgZ(65,"button",20),t.NdJ("click",function(){return n.ngKt.get("PHAN_CONG").setValue("")}),t.TgZ(66,"mat-icon"),t._uU(67,"close"),t.qZA()(),t.TgZ(68,"mat-autocomplete",null,21),t.YNc(70,ln,2,1,"mat-option",22),t.qZA()()()(),t.TgZ(71,"table",5)(72,"thead")(73,"tr")(74,"th",6),t._uU(75,"TT"),t.qZA(),t.TgZ(76,"th",6),t._uU(77,"M\xe3 KH"),t.qZA(),t.TgZ(78,"th",6),t._uU(79,"STT h\u1ed3 s\u01a1"),t.qZA(),t.TgZ(80,"th",6),t._uU(81,"T\xean KH"),t.qZA(),t.TgZ(82,"th"),t._uU(83,"Lo\u1ea1i h\u1ed3 s\u01a1"),t.qZA(),t._UZ(84,"th"),t.qZA()(),t.TgZ(85,"tbody"),t.YNc(86,un,13,4,"tr",7),t.TgZ(87,"tr",8),t._UZ(88,"td"),t.TgZ(89,"td",23)(90,"mat-form-field")(91,"input",9),t.NdJ("keyup.enter",function(){return n.addKiemTra()}),t.qZA()()()(),t.TgZ(92,"tr"),t.YNc(93,sn,4,0,"td",11),t.qZA()()(),t.TgZ(94,"div",4)(95,"div",12)(96,"app-date-picker",13),t.NdJ("month",function(a){return n.ngay=a}),t.qZA()(),t.TgZ(97,"button",14),t.NdJ("click",function(){return n.readKiemTra()}),t._uU(98,"L\u1ea5y d\u1eef li\u1ec7u"),t.qZA()()()()()),2&e){const o=t.MAs(69);t.xp6(24),t.Q6J("ngForOf",n.items),t.xp6(1),t.Q6J("formGroup",n.main),t.xp6(9),t.Q6J("ngIf",n.items.length>0),t.xp6(3),t.Q6J("startDay",n.ngay)("openOnFocus",!1)("label","Ng\xe0y")("format","DD/MM/YYYY"),t.xp6(7),t.Q6J("startDay",n.tuNgay)("openOnFocus",!1)("label","T\u1eeb Ng\xe0y")("format","DD/MM/YYYY"),t.xp6(1),t.Q6J("startDay",n.denNgay)("openOnFocus",!1)("label","\u0110\u1ebfn Ng\xe0y")("format","DD/MM/YYYY"),t.xp6(8),t.Q6J("ngIf",n.phanCong.length>0||n.giaoHS.length>0),t.xp6(5),t.Q6J("ngIf",n.catalogs.length>0),t.xp6(2),t.Q6J("formGroup",n.ngKt),t.xp6(4),t.Q6J("matAutocomplete",o),t.xp6(6),t.Q6J("ngForOf",n.nvOpts),t.xp6(16),t.Q6J("ngForOf",n.items),t.xp6(1),t.Q6J("formGroup",n.main),t.xp6(6),t.Q6J("ngIf",n.items.length>0),t.xp6(3),t.Q6J("startDay",n.ngay)("openOnFocus",!1)("label","Ng\xe0y")("format","DD/MM/YYYY")}},dependencies:[H.sg,H.O5,d.Fj,d.JJ,d.JL,d.Q7,d.sg,d.u,$.VQ,$.U0,Y.lW,Y.RK,L.Hw,Z.Nt,M.KE,M.hX,M.qo,ht.XC,W.ey,ht.ZL,x.ib,x.yz,R.L]}),i})()},{path:"cmis4-ghi-rot",component:(()=>{class i{constructor(e,n,o,a,l){this.excelSV=e,this.plus=n,this.sheetdbSV=o,this.cmis4SV=a,this.idbSV=l,this.dbName="cmis4",this.apiKH="cmis4-cap-dien",this.apiPC="cmis4-c06",this.db=null,this.dataInXls=[],this.dataRot=[],this.dataKH=[],this.dataPC=[],this.file=null}ngOnInit(){this.idbSV.IDB_InitDB(this.dbName).subscribe(e=>{this.db=e,this.idbSV.IDB_DB_GetAll(this.db,this.apiKH).subscribe(n=>{this.dataKH=n,console.log("Get data KH OK")})})}getKHPhanCong(){this.sheetdbSV.get("1X9NIeAsXEPJ8LG8Vr-KPN7Wn9uLiMqxNcM0fwdjXHIs","KH").subscribe(e=>{this.dataKH=e.data,this.idbSV.IDB_DB_Add(this.db,this.apiKH,this.dataKH).then(()=>{console.log("L\u01b0u d\u1eef li\u1ec7u KH v\xe0o indexedDB OK")})})}mergeKeepOriginalOnly(e,n,o,a=((l,u)=>({...l,...u}))){const l=new Map;for(const u of e)l.set(u[o],u);for(const u of n){const h=u[o];if(l.has(h)){const p=a(l.get(h),u);l.set(h,p)}}return Array.from(l.values())}onDropFile(e){var n=this;return(0,g.Z)(function*(){console.log("onDropFile()"),n.file=e[0],n.gopFile()})()}gopFile(){var e=this;return(0,g.Z)(function*(){"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"==e.file.type&&e.excelSV.fileToJson(e.file,5).then(n=>{for(const o in n)for(let a=0;a<n[o].length;a++){const l=n[o][a];let u={};u.MA_KHANG=l.Madiemdo.slice(0,13),u.TEN_KHANG=l.Tendiemdo,u.SO_TBI="["+l.Socongto+"]",u.MA_TRAM=l.Matram,u.KS=+l.Tonggiao,u.B1=+l.Bieugiao1,u.B2=+l.Bieugiao2,u.B3=+l.Bieugiao3,u.VC=+l.Voconggiao,u.Ngaygio=l.Ngaygio,e.dataInXls.push(u)}})})()}locDSRot(){for(let o=0;o<this.dataInXls.length;o++){const a=this.dataInXls[o];"NODATA"==a.Ngaygio&&this.dataRot.push(a)}let e=this.mergeKeepOriginalOnly(this.dataRot,this.dataKH,"MA_KHANG"),n=this.plus.obj_extract(e,["MA_SOGCS","MA_KHANG","TEN_KHANG","SO_TBI","MA_KVUC","NHAN_VIEN","TEN_SOGCS","MA_TRAM"]);this.excelSV.export(n,"DS_ROT_CHISO")}xuatFileMdis(){this.excelSV.export(this.dataInXls,"MDIS_CHISO")}reset(){}ondragover(){document.getElementById("dropZone").setAttribute("drop-active","true")}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(b.x),t.Y36(f.T),t.Y36(V.F),t.Y36(O.a),t.Y36(Q.F))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-ghi-rot-chi-so"]],decls:17,vars:4,consts:[[1,"container","py-3"],[1,"row"],[3,"label","files","ondragover"],[1,"btn"],["mat-raised-button","","color","primary",3,"click"],["mat-raised-button","","color","accent",3,"click"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"app-drop-files",2),t.NdJ("files",function(a){return n.onDropFile(a)})("ondragover",function(){return n.ondragover()}),t.qZA()(),t.TgZ(3,"div",1)(4,"p"),t._uU(5),t.qZA(),t.TgZ(6,"p"),t._uU(7),t.qZA(),t.TgZ(8,"p"),t._uU(9),t.qZA(),t.TgZ(10,"div",3)(11,"button",4),t.NdJ("click",function(){return n.getKHPhanCong()}),t._uU(12,"L\u1ea5y d\u1eef li\u1ec7u KH"),t.qZA(),t.TgZ(13,"button",5),t.NdJ("click",function(){return n.xuatFileMdis()}),t._uU(14,"Xu\u1ea5t file g\u1ed9p"),t.qZA(),t.TgZ(15,"button",4),t.NdJ("click",function(){return n.locDSRot()}),t._uU(16,"L\u1ea5y ds r\u1edbt CS"),t.qZA()()()()),2&e&&(t.xp6(2),t.Q6J("label",""),t.xp6(3),t.hij("",n.dataInXls.length," b\u1ea3n ghi ch\u1ec9 s\u1ed1"),t.xp6(2),t.hij(" ",n.dataKH.length," b\u1ea3n ghi kh\xe1ch h\xe0ng"),t.xp6(2),t.hij("",n.dataRot.length," b\u1ea3n ghi ch\u1ec9 s\u1ed1 r\u1edbt \u0111\u01b0\u1ee3c ghi nh\u1eadn"))},dependencies:[Y.lW,F.k]}),i})()}];let rn=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[j.Bz.forChild(cn),j.Bz]}),i})();var _n=D(24809),hn=D(48387),mn=D(5923),pn=D(12687);let Tn=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[H.ez,rn,_n.ShareModule,hn.D,mn.X,pn.rt]}),i})()}}]);