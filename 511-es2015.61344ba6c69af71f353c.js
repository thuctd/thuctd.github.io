"use strict";(self.webpackChunk_4la=self.webpackChunk_4la||[]).push([[511],{51511:function(e,t,r){r.d(t,{k:function(){return l}});var o=r(74788),n=r(57922),i=r(31409),s=r(15194);let l=(()=>{class e{constructor(e,t){this.plus=e,this.excel=t,this.files=new o.vpe}ngOnInit(){}ngOnDestroy(){this.files.unsubscribe(),console.log("ngOnDestroy app-drop-files")}onDrop(e){this.files.emit(e),document.getElementById("dropZone").setAttribute("drop-active","false")}selectedFile(e){this.files.emit(e.target.files)}ondragover(){document.getElementById("dropZone").setAttribute("drop-active","true")}}return e.\u0275fac=function(t){return new(t||e)(o.Y36(n.T),o.Y36(i.x))},e.\u0275cmp=o.Xpm({type:e,selectors:[["app-drop-files"]],outputs:{files:"files"},decls:10,vars:0,consts:[[1,"row","justify-content-center","d-none-print"],["id","dropZone",1,"col-6",3,"appDropZone","dragover"],["for","file-import"],["for","file-import",1,"custom-file-upload","text-primary","mx-5"],["hidden","","id","file-import","type","file","multiple","false",3,"change"]],template:function(e,t){1&e&&(o.TgZ(0,"div",0),o.TgZ(1,"div",1),o.NdJ("appDropZone",function(e){return t.onDrop(e)})("dragover",function(){return t.ondragover()}),o.TgZ(2,"label",2),o._uU(3," K\xe9o th\u1ea3 file v\xe0o \u0111\xe2y ho\u1eb7c "),o.TgZ(4,"span"),o._uU(5,"\u2794"),o.qZA(),o.TgZ(6,"a"),o._uU(7," Ch\u1ecdn file "),o.qZA(),o.qZA(),o._UZ(8,"label",3),o.TgZ(9,"input",4),o.NdJ("change",function(e){return t.selectedFile(e)}),o.qZA(),o.qZA(),o.qZA())},directives:[s.i],styles:["label[_ngcontent-%COMP%]{width:100%;height:100%;text-align:center;line-height:170px;color:#00f;font-weight:bolder}#dropZone[_ngcontent-%COMP%]{width:40%;height:15%;border:2px dashed rgb(38,16,165);border-radius:3%}#dropZone[drop-active=true][_ngcontent-%COMP%]{box-shadow:inset 0 0 0 2px #00c;border:solid blue}"]}),e})()},15194:function(e,t,r){r.d(t,{i:function(){return n}});var o=r(74788);let n=(()=>{class e{constructor(){this.fileDrop=new o.vpe,this.preventBodyDrop=!0,this.active=!1}onDrop(e){e.preventDefault(),this.active=!1;const{dataTransfer:t}=e;if(t.items){const e=[];for(let r=0;r<t.items.length;r++)"file"===t.items[r].kind&&e.push(t.items[r].getAsFile());t.items.clear(),this.fileDrop.emit(e)}else{const e=t.files;t.clearData(),this.fileDrop.emit(Array.from(e))}}onDragOver(e){e.stopPropagation(),e.preventDefault(),this.active=!0}onDragLeave(e){this.active=!1}onBodyDragOver(e){this.preventBodyDrop&&(e.preventDefault(),e.stopPropagation())}onBodyDrop(e){this.preventBodyDrop&&e.preventDefault()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=o.lG2({type:e,selectors:[["","appDropZone",""]],hostVars:2,hostBindings:function(e,t){1&e&&o.NdJ("drop",function(e){return t.onDrop(e)})("dragover",function(e){return t.onDragOver(e)})("dragleave",function(e){return t.onDragLeave(e)})("dragover",function(e){return t.onBodyDragOver(e)},!1,o.pYS)("drop",function(e){return t.onBodyDrop(e)},!1,o.pYS),2&e&&o.ekj("drop-zone-active",t.active)},inputs:{preventBodyDrop:"preventBodyDrop"},outputs:{fileDrop:"appDropZone"}}),e})()},31409:function(e,t,r){r.d(t,{x:function(){return s}});var o=r(84487),n=r(74788),i=r(57922);let s=(()=>{class e{constructor(e){this.plus=e}readXlsx(e,t=!0){return new Promise((r,n)=>{let i={};if(this.plus.load(),null!=e&&"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"!=e.type&&"application/vnd.ms-excel"!=e.type)return this.plus.alertError("Kh\xf4ng ph\u1ea3i file excel");const s=new FileReader;s.readAsBinaryString(e),s.onloadend=e=>{const n=o.read(e.target.result,{type:"binary",cellDates:!0,dateNF:"DD/MM/YYYY"}),s=n.SheetNames;for(let r=0;r<s.length;r++){const e=s[r],l=o.utils.sheet_to_json(n.Sheets[e],{header:1,raw:t});i[`${e}`]=this.convertJSon(l)}this.plus.loaded(),r(i)}})}convertJSon(e){const t=[];for(let r=1;r<e.length;r++){const o={};e[0].forEach((t,n)=>{o[`${t}`]=e[r][n]}),t.push(o)}return t}convertJSonByX(e){const t=[];for(let r=1;r<e.length;r++)if("x"==e[r][0]){const o={};e[0].forEach((t,n)=>{o[`${t}`]=e[r][n]}),t.push(o)}return t}readXlsxToMerge(e){return console.log(e),new Promise((t,r)=>{this.plus.load();let n={};if(null!=e&&"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"!=e.type&&"application/vnd.ms-excel"!=e.type)return this.plus.alertError("Kh\xf4ng ph\u1ea3i file excel");const i=new FileReader;i.readAsBinaryString(e),i.onloadend=e=>{const r=o.read(e.target.result,{type:"binary",cellDates:!0,dateNF:"DD/MM/YYYY"}),i=r.SheetNames;for(let t=0;t<i.length;t++){const e=i[t];if("_Merge"==e)return this.plus.alertError("Vui l\xf2ng \u0111\u1ed5i t\xean sheet _Merge th\xe0nh t\xean kh\xe1c");const s=o.utils.sheet_to_json(r.Sheets[e],{header:1,raw:!0});n[`${0==t?"_Merge":e}`]=this.convertJSon(s)}t(n),this.plus.loaded()}})}export(e,t=""){const r=o.utils.json_to_sheet(e,{skipHeader:!0}),n=o.utils.book_new();o.utils.book_append_sheet(n,r,"ChuaImport"),o.writeFile(n,"4la-"+t+"-ChuaImport.xlsx")}exportTar(e,t=""){for(let s=0;s<e.length;s++)delete e[s].dateModify,delete e[s].canEdit,delete e[s].keyWord,delete e[s].__v,delete e[s]._id;let r=JSON.stringify(e),o="data:application/json;charset=utf-8,"+encodeURIComponent(r);console.log(o);let n=`4la-${t||""}`+Date.now()+".tar",i=document.createElement("a");i.setAttribute("href",o),i.setAttribute("download",n),i.click()}}return e.\u0275fac=function(t){return new(t||e)(n.LFG(i.T))},e.\u0275prov=n.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()}}]);